"use strict";(self.webpackChunkekydum_ui=self.webpackChunkekydum_ui||[]).push([[259],{259:(b,j,a)=>{a.r(j),a.d(j,{VideoProvider:()=>o});var p=a(203),n=a(627),u=a(907);class c{constructor(t,i){this.qa=t,this.ph=i,t.textTracks.onaddtrack=this.va.bind(this),(0,p.zp)(this.Eh.bind(this))}va(t){const i=t.track;if(!i||function k(r,t){return Array.from(r.children).find(i=>i.track===t)}(this.qa,i))return;const s=new n.G({id:i.id,kind:i.kind,label:i.label,language:i.language,type:"vtt"});s[n.Y]={track:i},s[n.H]=2,s[n.Z]=!0;let l=0;const m=y=>{if(i.cues)for(let T=l;T<i.cues.length;T++)s.addCue(i.cues[T],y),l++};m(t),i.oncuechange=m,this.ph.textTracks.add(s,t),s.setMode(i.mode,t)}Eh(){this.qa.textTracks.onaddtrack=null;for(const t of this.ph.textTracks){const i=t[n.Y]?.track;i?.oncuechange&&(i.oncuechange=null)}}}var g=a(467),f=a(418);class v{constructor(t,i){this.qa=t,this.j=i,(0,f.k6)(this.qa,"enterpictureinpicture",this.Fh.bind(this)),(0,f.k6)(this.qa,"leavepictureinpicture",this.Gh.bind(this))}get active(){return document.pictureInPictureElement===this.qa}get supported(){return(0,n._)(this.qa)}enter(){var t=this;return(0,g.A)(function*(){return t.qa.requestPictureInPicture()})()}exit(){return document.exitPictureInPicture()}Fh(t){this.Hc(!0,t)}Gh(t){this.Hc(!1,t)}Hc=(t,i)=>{this.j.delegate.p("picture-in-picture-change",{detail:t,trigger:i})}}class e{constructor(t,i){this.qa=t,this.j=i,(0,f.k6)(this.qa,"webkitpresentationmodechanged",this.Kh.bind(this))}Ga="inline";get Jh(){return(0,n.$)(this.qa)}Ih(t){var i=this;return(0,g.A)(function*(){i.Ga!==t&&i.qa.webkitSetPresentationMode(t)})()}Kh(){const t=this.Ga;this.Ga=this.qa.webkitPresentationMode,this.j.player?.dispatchEvent(new f.vP("video-presentation-change",{detail:this.Ga,trigger:event})),["fullscreen","picture-in-picture"].forEach(i=>{(this.Ga===i||t===i)&&this.j.delegate.p(`${i}-change`,{detail:this.Ga===i,trigger:event})})}}class h{constructor(t){this.Hh=t}get active(){return"fullscreen"===this.Hh.Ga}get supported(){return this.Hh.Jh}enter(){var t=this;return(0,g.A)(function*(){t.Hh.Ih("fullscreen")})()}exit(){var t=this;return(0,g.A)(function*(){t.Hh.Ih("inline")})()}}class d{constructor(t){this.Hh=t}get active(){return"picture-in-picture"===this.Hh.Ga}get supported(){return this.Hh.Jh}enter(){var t=this;return(0,g.A)(function*(){t.Hh.Ih("picture-in-picture")})()}exit(){var t=this;return(0,g.A)(function*(){t.Hh.Ih("inline")})()}}class o extends u.H{$$PROVIDER_TYPE="VIDEO";get type(){return"video"}fullscreen;pictureInPicture;constructor(t,i){if(super(t),(0,n.$)(t)){const s=new e(t,i);this.fullscreen=new h(s),this.pictureInPicture=new d(s)}else(0,n._)(t)&&(this.pictureInPicture=new v(t,i))}setup(t){super.setup(t),(0,n.X)(this.video)&&new c(this.video,t),t.textRenderers[n.a0](this.video),(0,p.zp)(()=>{t.textRenderers[n.a0](null)}),"video"===this.type&&t.delegate.p("provider-setup",{detail:this})}get video(){return this.j}}},907:(b,j,a)=>{a.d(j,{H:()=>o});var p=a(467),n=a(418),u=a(460),c=a(462),k=a(203),g=a(166),f=a(931),v=a(404),e=a(627);class h{constructor(t,i){this.q=t,this.ph=i,this.Uh(),(0,u.QZ)(this.Vh.bind(this)),(0,k.zp)(this.Eh.bind(this))}ih=(0,g.useDisposalBin)();Nh=!1;Qh=!1;Rh=!1;Oh=new f.R(this.Wh.bind(this));get j(){return this.q.media}get jg(){return this.ph.delegate}Eh(){this.Oh.P(),this.ih.empty()}Wh(){const t=this.q.currentTime;this.ph.$store.currentTime()!==t&&this.Mh(t)}Uh(){this.Lh("loadstart",this.ge),this.Lh("abort",this.Sh),this.Lh("emptied",this.Xh),this.Lh("error",this.Wb)}Yh(){this.Qh||(this.ih.add(this.Lh("loadeddata",this.Zh),this.Lh("loadedmetadata",this._h),this.Lh("canplay",this.Rb),this.Lh("canplaythrough",this.$h),this.Lh("durationchange",this.ai),this.Lh("play",this.bi),this.Lh("progress",this.ci),this.Lh("stalled",this.di),this.Lh("suspend",this.ei)),this.Qh=!0)}fi(){this.Rh||(this.ih.add(this.Lh("pause",this.gi),this.Lh("playing",this.hi),this.Lh("ratechange",this.ii),this.Lh("seeked",this.ji),this.Lh("seeking",this.ki),this.Lh("ended",this.li),this.Lh("volumechange",this.ac),this.Lh("waiting",this.mi)),this.Rh=!0)}ni=void 0;pi=void 0;Lh(t,i){return(0,n.k6)(this.j,t,i.bind(this))}qi(t){}Mh(t,i){this.jg.p("time-update",{detail:{currentTime:Math.min(t,this.ph.$store.seekableEnd()),played:this.j.played},trigger:i})}ge(t){3!==this.j.networkState?(this.Yh(),this.jg.p("load-start",{trigger:t})):this.Sh(t)}Sh(t){this.jg.p("abort",{trigger:t})}Xh(){this.jg.p("emptied",{trigger:event})}Zh(t){this.jg.p("loaded-data",{trigger:t})}_h(t){this.Th(),this.fi(),this.jg.p("volume-change",{detail:{volume:this.j.volume,muted:this.j.muted}}),this.jg.p("loaded-metadata",{trigger:t}),e.I&&(0,c.i)(this.ph.$store.source())&&this.jg.lf(this.Ph(),t)}Ph(){return{duration:this.j.duration,buffered:this.j.buffered,seekable:this.j.seekable}}Th(){const t=!Number.isFinite(this.j.duration);this.jg.p("stream-type-change",{detail:t?"live":"on-demand"})}bi(t){this.ph.$store.canPlay&&this.jg.p("play",{trigger:t})}gi(t){1===this.j.readyState&&!this.Nh||(this.Nh=!1,this.Oh.P(),this.jg.p("pause",{trigger:t}))}Rb(t){this.jg.lf(this.Ph(),t)}$h(t){this.ph.$store.started()||this.jg.p("can-play-through",{trigger:t,detail:this.Ph()})}hi(t){this.Nh=!1,this.jg.p("playing",{trigger:t}),this.Oh.O()}di(t){this.jg.p("stalled",{trigger:t}),this.j.readyState<3&&(this.Nh=!0,this.jg.p("waiting",{trigger:t}))}mi(t){this.j.readyState<3&&(this.Nh=!0,this.jg.p("waiting",{trigger:t}))}li(t){this.Oh.P(),this.Mh(this.j.duration,t),this.jg.p("end",{trigger:t}),this.ph.$store.loop()?this.oi():this.jg.p("ended",{trigger:t})}Vh(){this.ph.$store.paused()&&(0,n.k6)(this.j,"timeupdate",this.Vb.bind(this))}Vb(t){this.Mh(this.j.currentTime,t)}ai(t){this.Th(),this.ph.$store.ended()&&this.Mh(this.j.duration,t),this.jg.p("duration-change",{detail:this.j.duration,trigger:t})}ac(t){this.jg.p("volume-change",{detail:{volume:this.j.volume,muted:this.j.muted},trigger:t})}ji(t){this.Mh(this.j.currentTime,t),this.jg.p("seeked",{detail:this.j.currentTime,trigger:t}),Math.trunc(this.j.currentTime)===Math.trunc(this.j.duration)&&(0,v.y)(this.j.duration)>(0,v.y)(this.j.currentTime)&&(this.Mh(this.j.duration,t),this.j.ended||this.ph.player.dispatchEvent(new n.vP("media-play-request",{trigger:t})))}ki(t){this.jg.p("seeking",{detail:this.j.currentTime,trigger:t})}ci(t){this.jg.p("progress",{detail:{buffered:this.j.buffered,seekable:this.j.seekable},trigger:t})}oi(){(0,u.gD)(this.j.controls)&&(this.j.controls=!1),this.ph.player.dispatchEvent(new n.vP("media-loop-request"))}ei(t){this.jg.p("suspend",{trigger:t})}ii(t){this.jg.p("rate-change",{detail:this.j.playbackRate,trigger:t})}Wb(t){const i=this.j.error;i&&this.jg.p("error",{detail:{message:i.message,code:i.code,mediaError:i},trigger:t})}}class d{constructor(t,i){this.q=t,this.ph=i,this.ri.onaddtrack=this.ti.bind(this),this.ri.onremovetrack=this.ui.bind(this),this.ri.onchange=this.vi.bind(this),(0,n.k6)(this.ph.audioTracks,"change",this.wi.bind(this))}get ri(){return this.q.media.audioTracks}ti(t){const i=t.track;if(""===i.label)return;const s={id:i.id+"",label:i.label,language:i.language,kind:i.kind,selected:!1};this.ph.audioTracks[e.N](s,t),i.enabled&&(s.selected=!0)}ui(t){const i=this.ph.audioTracks.getById(t.track.id);i&&this.ph.audioTracks[e.W](i,t)}vi(t){let i=this.si();if(!i)return;const s=this.ph.audioTracks.getById(i.id);s&&this.ph.audioTracks[e.L](s,!0,t)}si(){return Array.from(this.ri).find(t=>t.enabled)}wi(t){const{current:i}=t.detail;if(!i)return;const s=this.ri.getTrackById(i.id);if(s){const l=this.si();l&&(l.enabled=!1),s.enabled=!0}}}class o{constructor(t){this.j=t}setup(t){new h(this,t),"audioTracks"in this.media&&new d(this,t)}get type(){return""}get media(){return this.j}get paused(){return this.j.paused}get muted(){return this.j.muted}set muted(t){this.j.muted=t}get volume(){return this.j.volume}set volume(t){this.j.volume=t}get currentTime(){return this.j.currentTime}set currentTime(t){this.j.currentTime=t}get playsinline(){return this.j.hasAttribute("playsinline")}set playsinline(t){(0,n.Bq)(this.j,"playsinline",t)}get playbackRate(){return this.j.playbackRate}set playbackRate(t){this.j.playbackRate=t}play(){var t=this;return(0,p.A)(function*(){return t.j.play()})()}pause(){var t=this;return(0,p.A)(function*(){return t.j.pause()})()}loadSource(t,i){var s=this;return(0,p.A)(function*({src:l},m){s.j.preload=m,(0,c.b)(l)?s.j.srcObject=l:(s.j.srcObject=null,s.j.src=(0,u.Kg)(l)?l:window.URL.createObjectURL(l)),s.j.load()}).apply(this,arguments)}}},931:(b,j,a)=>{a.d(j,{H:()=>f,R:()=>k});var p=a(203),n=a(460),u=a(418),c=a(627);class k{constructor(e){this.jf=e}xi;O(){(0,n.b0)(this.xi)&&this.yi()}P(){(0,n.Et)(this.xi)&&window.cancelAnimationFrame(this.xi),this.xi=void 0}yi(){this.xi=window.requestAnimationFrame(()=>{(0,n.b0)(this.xi)||(this.jf(),this.yi())})}}class f{constructor(e){this.qa=e}ph;za=null;qh=null;nh={};oh=new Set;get instance(){return this.za}setup(e,h){this.ph=h;const d=(0,p.se)(h.$store.streamType).includes("live"),o=(0,p.se)(h.$store.streamType).includes("ll-");this.za=new e({lowLatencyMode:o,backBufferLength:o?4:d?8:void 0,renderTextTracksNatively:!1,...this.nh});const r=this.rh.bind(this);for(const t of Object.values(e.Events))this.za.on(t,r);this.za.on(e.Events.ERROR,this.Wb.bind(this));for(const t of this.oh)t(this.za);h.player.dispatchEvent(new u.vP("hls-instance",{detail:this.za})),this.za.attachMedia(this.qa),this.za.on(e.Events.AUDIO_TRACK_SWITCHED,this.sh.bind(this)),this.za.on(e.Events.LEVEL_SWITCHED,this.th.bind(this)),this.za.on(e.Events.LEVEL_LOADED,this.uh.bind(this)),this.za.on(e.Events.NON_NATIVE_TEXT_TRACKS_FOUND,this.vh.bind(this)),this.za.on(e.Events.CUES_PARSED,this.wh.bind(this)),h.qualities[c.F]=this.xh.bind(this),(0,u.k6)(h.qualities,"change",this.Pf.bind(this)),(0,u.k6)(h.audioTracks,"change",this.yh.bind(this)),this.qh=(0,n.QZ)(this.zh.bind(this))}zh(){if(!this.ph.$store.live())return;const e=new k(this.Ah.bind(this));return e.O(),e.P.bind(e)}Ah(){this.ph.$store.liveSyncPosition.set(this.za?.liveSyncPosition??1/0)}rh(e,h){this.ph.player.dispatchEvent(new u.vP((0,u.BW)(e),{detail:h}))}vh(e,h){const d=new u.vP(e,{detail:h});let o=-1;for(let r=0;r<h.tracks.length;r++){const t=h.tracks[r],i=t.subtitleTrack??t.closedCaptions,s=new c.G({id:`hls-${t.kind}${r}`,src:i?.url,label:t.label,language:i?.lang,kind:t.kind});s[c.H]=2,s[c.J]=()=>{"showing"===s.mode?(this.za.subtitleTrack=r,o=r):o===r&&(this.za.subtitleTrack=-1,o=-1)},t.default&&s.setMode("showing",d),this.ph.textTracks.add(s,d)}}wh(e,h){const d=this.ph.textTracks.getById(`hls-${h.track}`);if(!d)return;const o=new u.vP(e,{detail:h});for(const r of h.cues)r.positionAlign="auto",d.addCue(r,o)}sh(e,h){const d=this.ph.audioTracks[h.id];d&&this.ph.audioTracks[c.L](d,!0,new u.vP(e,{detail:h}))}th(e,h){const d=this.ph.qualities[h.level];d&&this.ph.qualities[c.L](d,!0,new u.vP(e,{detail:h}))}uh(e,h){if(this.ph.$store.canPlay())return;const{type:d,live:o,totalduration:r}=h.details,t=new u.vP(e,{detail:h});this.ph.delegate.p("stream-type-change",{detail:o?"EVENT"===d&&Number.isFinite(r)?"live:dvr":"live":"on-demand",trigger:t}),this.ph.delegate.p("duration-change",{detail:r,trigger:t});const i=this.za.media;-1===this.za.currentLevel&&this.ph.qualities[c.K](!0,t);for(const s of this.za.audioTracks)this.ph.audioTracks[c.N]({id:s.id+"",label:s.name,language:s.lang||"",kind:"main"},t);for(const s of this.za.levels)this.ph.qualities[c.N]({width:s.width,height:s.height,codec:s.codecSet,bitrate:s.bitrate},t);i.dispatchEvent(new u.vP("canplay",{trigger:t}))}Wb(e,h){if(h.fatal)switch(h.type){case"networkError":this.za?.startLoad();break;case"mediaError":this.za?.recoverMediaError();break;default:this.za?.destroy(),this.za=null}}xh(){this.za&&(this.za.currentLevel=-1)}Pf(){const{qualities:e}=this.ph;!this.za||e.auto||(this.za[e.switch+"Level"]=e.selectedIndex,c.P&&(this.qa.currentTime=this.qa.currentTime))}yh(){const{audioTracks:e}=this.ph;this.za&&this.za.audioTrack!==e.selectedIndex&&(this.za.audioTrack=e.selectedIndex)}Jg(){this.ph&&(this.ph.qualities[c.F]=void 0),this.za?.destroy(),this.za=null,this.qh?.(),this.qh=null}}}}]);