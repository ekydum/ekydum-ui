"use strict";(self.webpackChunkekydum_ui=self.webpackChunkekydum_ui||[]).push([[417],{417:(v,y,c)=>{c.r(y),c.d(y,{SSAParser:()=>A,default:()=>P});var F=c(467),k=c(488);const g=/^Format:[\s\t]*/,R=/^Style:[\s\t]*/,T=/^Dialogue:[\s\t]*/,b=/[\s\t]*,[\s\t]*/,O=/\{[^}]+\}/g,I=/\\N/g,M=/^\[(.*)[\s\t]?Styles\]$/,m=/^\[(.*)[\s\t]?Events\]$/;class A{f;O=0;a=null;j=[];k=[];N=null;d;P={};init(t){var r=this;return(0,F.A)(function*(){r.f=t,t.errors&&(r.d=(yield c.e(921).then(c.bind(c,921))).ParseErrorBuilder)})()}parse(t,r){if(this.O)switch(this.O){case 1:if(""===t)this.O=0;else if(R.test(t))if(this.N){const e=t.replace(R,"").split(b);this.S(e)}else this.e(this.d?.T("Style",r));else g.test(t)?this.N=t.replace(g,"").split(b):m.test(t)&&(this.N=null,this.O=2);break;case 2:if(""===t)this.Q();else if(T.test(t))if(this.Q(),this.N){const e=t.replace(T,"").split(b),s=this.U(e,r);s&&(this.a=s)}else this.e(this.d?.T("Dialogue",r));else this.a?this.a.text+="\n"+t.replace(O,"").replace(I,"\n"):g.test(t)?this.N=t.replace(g,"").split(b):M.test(t)?(this.N=null,this.O=1):m.test(t)&&(this.N=null)}else""===t||(M.test(t)?(this.N=null,this.O=1):m.test(t)&&(this.N=null,this.O=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}Q(){this.a&&(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null)}S(t){let s,S,n,u,r="Default",e={},a="center",l="bottom",h=1.2,o=3,p=[];for(let f=0;f<this.N.length;f++){const i=t[f];switch(this.N[f]){case"Name":r=i;break;case"Fontname":e["font-family"]=i;break;case"Fontsize":e["font-size"]=`calc(${i} / var(--overlay-height))`;break;case"PrimaryColour":const w=E(i);w&&(e["--cue-color"]=w);break;case"BorderStyle":o=parseInt(i,10);break;case"BackColour":u=E(i);break;case"OutlineColour":const x=E(i);x&&(n=x);break;case"Bold":parseInt(i)&&(e["font-weight"]="bold");break;case"Italic":parseInt(i)&&(e["font-style"]="italic");break;case"Underline":parseInt(i)&&(e["text-decoration"]="underline");break;case"StrikeOut":parseInt(i)&&(e["text-decoration"]="line-through");break;case"Spacing":e["letter-spacing"]=i+"px";break;case"AlphaLevel":e.opacity=parseFloat(i);break;case"ScaleX":p.push(`scaleX(${parseFloat(i)/100})`);break;case"ScaleY":p.push(`scaleY(${parseFloat(i)/100})`);break;case"Angle":p.push(`rotate(${i}deg)`);break;case"Shadow":h=1.2*parseInt(i,10);break;case"MarginL":e["--cue-width"]="auto",e["--cue-left"]=parseFloat(i)+"px";break;case"MarginR":e["--cue-width"]="auto",e["--cue-right"]=parseFloat(i)+"px";break;case"MarginV":S=parseFloat(i);break;case"Outline":s=parseInt(i,10);break;case"Alignment":const _=parseInt(i,10);switch(_>=4&&(l=_>=7?"top":"center"),_%3){case 1:a="start";break;case 2:a="center";break;case 3:a="end"}}}if(e.R=l,e["--cue-white-space"]="normal",e["--cue-line-height"]="normal",e["--cue-text-align"]=a,"center"===l?(e["--cue-top"]="50%",p.push("translateY(-50%)")):e[`--cue-${l}`]=(S||0)+"px",1===o&&(e["--cue-padding-y"]="0"),(1===o||u)&&(e["--cue-bg-color"]=1===o?"none":u),3===o&&n&&(e["--cue-outline"]=`${s}px solid ${n}`),1===o&&"number"==typeof s){const f=u??"#000";e["--cue-text-shadow"]=[n&&N(1.2*s,1.2*h,n),n?N(s*(s/2),h*(s/2),f):N(s,h,f)].filter(Boolean).join(", ")}p.length&&(e["--cue-transform"]=p.join(" ")),this.P[r]=e}U(t,r){const e=this.V(t),s=this.o(e.Start,e.End,r);if(!s)return;const a=new k.b(s[0],s[1],""),l={...this.P[e.Style]||{}},S=e.Name?`<v ${e.Name}>`:"",h=l.R,n=e.MarginL&&parseFloat(e.MarginL),u=e.MarginR&&parseFloat(e.MarginR),o=e.MarginV&&parseFloat(e.MarginV);return n&&(l["--cue-width"]="auto",l["--cue-left"]=n+"px"),u&&(l["--cue-width"]="auto",l["--cue-right"]=u+"px"),o&&"center"!==h&&(l[`--cue-${h}`]=o+"px"),a.text=S+t.slice(this.N.length-1).join(", ").replace(O,"").replace(I,"\n"),delete l.R,Object.keys(l).length&&(a.style=l),a}V(t){const r={};for(let e=0;e<this.N.length;e++)r[this.N[e]]=t[e];return r}o(t,r,e){const s=(0,k.p)(t),a=(0,k.p)(r);if(null!==s&&null!==a&&a>s)return[s,a];null===s&&this.e(this.d?.q(t,e)),null===a&&this.e(this.d?.r(r,e)),null!=s&&null!==a&&a>s&&this.e(this.d?.s(s,a,e))}e(t){if(t){if(this.k.push(t),this.f.strict)throw this.f.cancel(),t;this.f.onError?.(t)}}}function E(d){const t=parseInt(d.replace("&H",""),16);return t>=0?"rgba("+[255&t,t>>8&255,t>>16&255,(t>>24&255^255)/255].join(",")+")":null}function N(d,t,r){const e=Math.ceil(2*Math.PI*d);let s="";for(let a=0;a<e;a++){const l=2*Math.PI*a/e;s+=d*Math.cos(l)+"px "+t*Math.sin(l)+"px 0 "+r+(a==e-1?"":",")}return s}function P(){return new A}}}]);