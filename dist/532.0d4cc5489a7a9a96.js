"use strict";(self.webpackChunkekydum_ui=self.webpackChunkekydum_ui||[]).push([[532],{532:(k,p,a)=>{a.r(p),a.d(p,{AudioProvider:()=>o});var c=a(907);class o extends c.H{$$PROVIDER_TYPE="AUDIO";get type(){return"audio"}setup(n){super.setup(n),"audio"===this.type&&n.delegate.p("provider-setup",{detail:this})}get audio(){return this.j}}},907:(k,p,a)=>{a.d(p,{H:()=>u});var c=a(467),o=a(418),l=a(460),n=a(462),f=a(203),v=a(166),m=a(931),j=a(404),i=a(627);class e{constructor(t,s){this.q=t,this.ph=s,this.Uh(),(0,l.QZ)(this.Vh.bind(this)),(0,f.zp)(this.Eh.bind(this))}ih=(0,v.useDisposalBin)();Nh=!1;Qh=!1;Rh=!1;Oh=new m.R(this.Wh.bind(this));get j(){return this.q.media}get jg(){return this.ph.delegate}Eh(){this.Oh.P(),this.ih.empty()}Wh(){const t=this.q.currentTime;this.ph.$store.currentTime()!==t&&this.Mh(t)}Uh(){this.Lh("loadstart",this.ge),this.Lh("abort",this.Sh),this.Lh("emptied",this.Xh),this.Lh("error",this.Wb)}Yh(){this.Qh||(this.ih.add(this.Lh("loadeddata",this.Zh),this.Lh("loadedmetadata",this._h),this.Lh("canplay",this.Rb),this.Lh("canplaythrough",this.$h),this.Lh("durationchange",this.ai),this.Lh("play",this.bi),this.Lh("progress",this.ci),this.Lh("stalled",this.di),this.Lh("suspend",this.ei)),this.Qh=!0)}fi(){this.Rh||(this.ih.add(this.Lh("pause",this.gi),this.Lh("playing",this.hi),this.Lh("ratechange",this.ii),this.Lh("seeked",this.ji),this.Lh("seeking",this.ki),this.Lh("ended",this.li),this.Lh("volumechange",this.ac),this.Lh("waiting",this.mi)),this.Rh=!0)}ni=void 0;pi=void 0;Lh(t,s){return(0,o.k6)(this.j,t,s.bind(this))}qi(t){}Mh(t,s){this.jg.p("time-update",{detail:{currentTime:Math.min(t,this.ph.$store.seekableEnd()),played:this.j.played},trigger:s})}ge(t){3!==this.j.networkState?(this.Yh(),this.jg.p("load-start",{trigger:t})):this.Sh(t)}Sh(t){this.jg.p("abort",{trigger:t})}Xh(){this.jg.p("emptied",{trigger:event})}Zh(t){this.jg.p("loaded-data",{trigger:t})}_h(t){this.Th(),this.fi(),this.jg.p("volume-change",{detail:{volume:this.j.volume,muted:this.j.muted}}),this.jg.p("loaded-metadata",{trigger:t}),i.I&&(0,n.i)(this.ph.$store.source())&&this.jg.lf(this.Ph(),t)}Ph(){return{duration:this.j.duration,buffered:this.j.buffered,seekable:this.j.seekable}}Th(){const t=!Number.isFinite(this.j.duration);this.jg.p("stream-type-change",{detail:t?"live":"on-demand"})}bi(t){this.ph.$store.canPlay&&this.jg.p("play",{trigger:t})}gi(t){1===this.j.readyState&&!this.Nh||(this.Nh=!1,this.Oh.P(),this.jg.p("pause",{trigger:t}))}Rb(t){this.jg.lf(this.Ph(),t)}$h(t){this.ph.$store.started()||this.jg.p("can-play-through",{trigger:t,detail:this.Ph()})}hi(t){this.Nh=!1,this.jg.p("playing",{trigger:t}),this.Oh.O()}di(t){this.jg.p("stalled",{trigger:t}),this.j.readyState<3&&(this.Nh=!0,this.jg.p("waiting",{trigger:t}))}mi(t){this.j.readyState<3&&(this.Nh=!0,this.jg.p("waiting",{trigger:t}))}li(t){this.Oh.P(),this.Mh(this.j.duration,t),this.jg.p("end",{trigger:t}),this.ph.$store.loop()?this.oi():this.jg.p("ended",{trigger:t})}Vh(){this.ph.$store.paused()&&(0,o.k6)(this.j,"timeupdate",this.Vb.bind(this))}Vb(t){this.Mh(this.j.currentTime,t)}ai(t){this.Th(),this.ph.$store.ended()&&this.Mh(this.j.duration,t),this.jg.p("duration-change",{detail:this.j.duration,trigger:t})}ac(t){this.jg.p("volume-change",{detail:{volume:this.j.volume,muted:this.j.muted},trigger:t})}ji(t){this.Mh(this.j.currentTime,t),this.jg.p("seeked",{detail:this.j.currentTime,trigger:t}),Math.trunc(this.j.currentTime)===Math.trunc(this.j.duration)&&(0,j.y)(this.j.duration)>(0,j.y)(this.j.currentTime)&&(this.Mh(this.j.duration,t),this.j.ended||this.ph.player.dispatchEvent(new o.vP("media-play-request",{trigger:t})))}ki(t){this.jg.p("seeking",{detail:this.j.currentTime,trigger:t})}ci(t){this.jg.p("progress",{detail:{buffered:this.j.buffered,seekable:this.j.seekable},trigger:t})}oi(){(0,l.gD)(this.j.controls)&&(this.j.controls=!1),this.ph.player.dispatchEvent(new o.vP("media-loop-request"))}ei(t){this.jg.p("suspend",{trigger:t})}ii(t){this.jg.p("rate-change",{detail:this.j.playbackRate,trigger:t})}Wb(t){const s=this.j.error;s&&this.jg.p("error",{detail:{message:s.message,code:s.code,mediaError:s},trigger:t})}}class d{constructor(t,s){this.q=t,this.ph=s,this.ri.onaddtrack=this.ti.bind(this),this.ri.onremovetrack=this.ui.bind(this),this.ri.onchange=this.vi.bind(this),(0,o.k6)(this.ph.audioTracks,"change",this.wi.bind(this))}get ri(){return this.q.media.audioTracks}ti(t){const s=t.track;if(""===s.label)return;const h={id:s.id+"",label:s.label,language:s.language,kind:s.kind,selected:!1};this.ph.audioTracks[i.N](h,t),s.enabled&&(h.selected=!0)}ui(t){const s=this.ph.audioTracks.getById(t.track.id);s&&this.ph.audioTracks[i.W](s,t)}vi(t){let s=this.si();if(!s)return;const h=this.ph.audioTracks.getById(s.id);h&&this.ph.audioTracks[i.L](h,!0,t)}si(){return Array.from(this.ri).find(t=>t.enabled)}wi(t){const{current:s}=t.detail;if(!s)return;const h=this.ri.getTrackById(s.id);if(h){const g=this.si();g&&(g.enabled=!1),h.enabled=!0}}}class u{constructor(t){this.j=t}setup(t){new e(this,t),"audioTracks"in this.media&&new d(this,t)}get type(){return""}get media(){return this.j}get paused(){return this.j.paused}get muted(){return this.j.muted}set muted(t){this.j.muted=t}get volume(){return this.j.volume}set volume(t){this.j.volume=t}get currentTime(){return this.j.currentTime}set currentTime(t){this.j.currentTime=t}get playsinline(){return this.j.hasAttribute("playsinline")}set playsinline(t){(0,o.Bq)(this.j,"playsinline",t)}get playbackRate(){return this.j.playbackRate}set playbackRate(t){this.j.playbackRate=t}play(){var t=this;return(0,c.A)(function*(){return t.j.play()})()}pause(){var t=this;return(0,c.A)(function*(){return t.j.pause()})()}loadSource(t,s){var h=this;return(0,c.A)(function*({src:g},b){h.j.preload=b,(0,n.b)(g)?h.j.srcObject=g:(h.j.srcObject=null,h.j.src=(0,l.Kg)(g)?g:window.URL.createObjectURL(g)),h.j.load()}).apply(this,arguments)}}},931:(k,p,a)=>{a.d(p,{H:()=>m,R:()=>f});var c=a(203),o=a(460),l=a(418),n=a(627);class f{constructor(i){this.jf=i}xi;O(){(0,o.b0)(this.xi)&&this.yi()}P(){(0,o.Et)(this.xi)&&window.cancelAnimationFrame(this.xi),this.xi=void 0}yi(){this.xi=window.requestAnimationFrame(()=>{(0,o.b0)(this.xi)||(this.jf(),this.yi())})}}class m{constructor(i){this.qa=i}ph;za=null;qh=null;nh={};oh=new Set;get instance(){return this.za}setup(i,e){this.ph=e;const d=(0,c.se)(e.$store.streamType).includes("live"),u=(0,c.se)(e.$store.streamType).includes("ll-");this.za=new i({lowLatencyMode:u,backBufferLength:u?4:d?8:void 0,renderTextTracksNatively:!1,...this.nh});const r=this.rh.bind(this);for(const t of Object.values(i.Events))this.za.on(t,r);this.za.on(i.Events.ERROR,this.Wb.bind(this));for(const t of this.oh)t(this.za);e.player.dispatchEvent(new l.vP("hls-instance",{detail:this.za})),this.za.attachMedia(this.qa),this.za.on(i.Events.AUDIO_TRACK_SWITCHED,this.sh.bind(this)),this.za.on(i.Events.LEVEL_SWITCHED,this.th.bind(this)),this.za.on(i.Events.LEVEL_LOADED,this.uh.bind(this)),this.za.on(i.Events.NON_NATIVE_TEXT_TRACKS_FOUND,this.vh.bind(this)),this.za.on(i.Events.CUES_PARSED,this.wh.bind(this)),e.qualities[n.F]=this.xh.bind(this),(0,l.k6)(e.qualities,"change",this.Pf.bind(this)),(0,l.k6)(e.audioTracks,"change",this.yh.bind(this)),this.qh=(0,o.QZ)(this.zh.bind(this))}zh(){if(!this.ph.$store.live())return;const i=new f(this.Ah.bind(this));return i.O(),i.P.bind(i)}Ah(){this.ph.$store.liveSyncPosition.set(this.za?.liveSyncPosition??1/0)}rh(i,e){this.ph.player.dispatchEvent(new l.vP((0,l.BW)(i),{detail:e}))}vh(i,e){const d=new l.vP(i,{detail:e});let u=-1;for(let r=0;r<e.tracks.length;r++){const t=e.tracks[r],s=t.subtitleTrack??t.closedCaptions,h=new n.G({id:`hls-${t.kind}${r}`,src:s?.url,label:t.label,language:s?.lang,kind:t.kind});h[n.H]=2,h[n.J]=()=>{"showing"===h.mode?(this.za.subtitleTrack=r,u=r):u===r&&(this.za.subtitleTrack=-1,u=-1)},t.default&&h.setMode("showing",d),this.ph.textTracks.add(h,d)}}wh(i,e){const d=this.ph.textTracks.getById(`hls-${e.track}`);if(!d)return;const u=new l.vP(i,{detail:e});for(const r of e.cues)r.positionAlign="auto",d.addCue(r,u)}sh(i,e){const d=this.ph.audioTracks[e.id];d&&this.ph.audioTracks[n.L](d,!0,new l.vP(i,{detail:e}))}th(i,e){const d=this.ph.qualities[e.level];d&&this.ph.qualities[n.L](d,!0,new l.vP(i,{detail:e}))}uh(i,e){if(this.ph.$store.canPlay())return;const{type:d,live:u,totalduration:r}=e.details,t=new l.vP(i,{detail:e});this.ph.delegate.p("stream-type-change",{detail:u?"EVENT"===d&&Number.isFinite(r)?"live:dvr":"live":"on-demand",trigger:t}),this.ph.delegate.p("duration-change",{detail:r,trigger:t});const s=this.za.media;-1===this.za.currentLevel&&this.ph.qualities[n.K](!0,t);for(const h of this.za.audioTracks)this.ph.audioTracks[n.N]({id:h.id+"",label:h.name,language:h.lang||"",kind:"main"},t);for(const h of this.za.levels)this.ph.qualities[n.N]({width:h.width,height:h.height,codec:h.codecSet,bitrate:h.bitrate},t);s.dispatchEvent(new l.vP("canplay",{trigger:t}))}Wb(i,e){if(e.fatal)switch(e.type){case"networkError":this.za?.startLoad();break;case"mediaError":this.za?.recoverMediaError();break;default:this.za?.destroy(),this.za=null}}xh(){this.za&&(this.za.currentLevel=-1)}Pf(){const{qualities:i}=this.ph;!this.za||i.auto||(this.za[i.switch+"Level"]=i.selectedIndex,n.P&&(this.qa.currentTime=this.qa.currentTime))}yh(){const{audioTracks:i}=this.ph;this.za&&this.za.audioTrack!==i.selectedIndex&&(this.za.audioTrack=i.selectedIndex)}Jg(){this.ph&&(this.ph.qualities[n.F]=void 0),this.za?.destroy(),this.za=null,this.qh?.(),this.qh=null}}}}]);