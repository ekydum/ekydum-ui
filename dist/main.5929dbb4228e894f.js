"use strict";(self.webpackChunkekydum_ui=self.webpackChunkekydum_ui||[]).push([[792],{532:()=>{const ka=function(Q,...he){if(ka.translate){const Ve=ka.translate(Q,he);Q=Ve[0],he=Ve[1]}let ue=wo(Q[0],Q.raw[0]);for(let Ve=1;Ve<Q.length;Ve++)ue+=he[Ve-1]+wo(Q[Ve],Q.raw[Ve]);return ue},mm=":";function wo(Q,he){return he.charAt(0)===mm?Q.substring(function yc(Q,he){for(let ue=1,Ve=1;ue<Q.length;ue++,Ve++)if("\\"===he[Ve])Ve++;else if(":"===Q[ue])return ue;throw new Error(`Unterminated $localize metadata block in "${he}".`)}(Q,he)+1):Q}globalThis.$localize=ka},867:()=>{function Do(n,t){return Object.is(n,t)}let Ft=null,$s=!1,Ma=1;const un=Symbol("SIGNAL");function we(n){const t=Ft;return Ft=n,t}const Vs={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Co(n){if($s)throw new Error("");if(null===Ft)return;Ft.consumerOnSignalRead(n);const t=Ft.nextProducerIndex++;Yt(Ft),t<Ft.producerNode.length&&Ft.producerNode[t]!==n&&Li(Ft)&&tt(Ft.producerNode[t],Ft.producerIndexOfThis[t]),Ft.producerNode[t]!==n&&(Ft.producerNode[t]=n,Ft.producerIndexOfThis[t]=Li(Ft)?Bt(n,Ft,t):0),Ft.producerLastReadVersion[t]=n.version}function Io(n){if((!Li(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Ma)){if(!n.producerMustRecompute(n)&&!ue(n))return void wo(n);n.producerRecomputeValue(n),wo(n)}}function yc(n){if(void 0===n.liveConsumerNode)return;const t=$s;$s=!0;try{for(const e of n.liveConsumerNode)e.dirty||mm(e)}finally{$s=t}}function ka(){return!1!==Ft?.consumerAllowSignalWrites}function mm(n){n.dirty=!0,yc(n),n.consumerMarkedDirty?.(n)}function wo(n){n.dirty=!1,n.lastCleanEpoch=Ma}function Q(n){return n&&(n.nextProducerIndex=0),we(n)}function he(n,t){if(we(t),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(Li(n))for(let e=n.nextProducerIndex;e<n.producerNode.length;e++)tt(n.producerNode[e],n.producerIndexOfThis[e]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function ue(n){Yt(n);for(let t=0;t<n.producerNode.length;t++){const e=n.producerNode[t],i=n.producerLastReadVersion[t];if(i!==e.version||(Io(e),i!==e.version))return!0}return!1}function Ve(n){if(Yt(n),Li(n))for(let t=0;t<n.producerNode.length;t++)tt(n.producerNode[t],n.producerIndexOfThis[t]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Bt(n,t,e){if(Jt(n),0===n.liveConsumerNode.length&&or(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=Bt(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(e),n.liveConsumerNode.push(t)-1}function tt(n,t){if(Jt(n),1===n.liveConsumerNode.length&&or(n))for(let i=0;i<n.producerNode.length;i++)tt(n.producerNode[i],n.producerIndexOfThis[i]);const e=n.liveConsumerNode.length-1;if(n.liveConsumerNode[t]=n.liveConsumerNode[e],n.liveConsumerIndexOfThis[t]=n.liveConsumerIndexOfThis[e],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,t<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[t],r=n.liveConsumerNode[t];Yt(r),r.producerIndexOfThis[i]=t}}function Li(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Yt(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function Jt(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function or(n){return void 0!==n.producerNode}const ar=Symbol("UNSET"),os=Symbol("COMPUTING"),Ar=Symbol("ERRORED"),lr={...Vs,value:ar,dirty:!0,error:null,equal:Do,kind:"computed",producerMustRecompute:n=>n.value===ar||n.value===os,producerRecomputeValue(n){if(n.value===os)throw new Error("Detected cycle in computations.");const t=n.value;n.value=os;const e=Q(n);let i,r=!1;try{i=n.computation(),we(null),r=t!==ar&&t!==Ar&&i!==Ar&&n.equal(t,i)}catch(s){i=Ar,n.error=s}finally{he(n,e)}r?n.value=t:(n.value=i,n.version++)}};let js=function Zd(){throw new Error};function bc(n){js(n)}function Jd(n,t){ka()||bc(n),n.equal(n.value,t)||(n.value=t,function L2(n){n.version++,function Yd(){Ma++}(),yc(n)}(n))}const _m={...Vs,equal:Do,value:void 0,kind:"signal"};let vm;function ef(){return vm}function Hs(n){const t=vm;return vm=n,t}const ym=Symbol("NotFound");function Ze(n){return"function"==typeof n}function bm(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}Error;const Em=bm(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function tf(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class Pn{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(Ze(i))try{i()}catch(s){t=s instanceof Em?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{XE(s)}catch(o){t=t??[],o instanceof Em?t=[...t,...o.errors]:t.push(o)}}if(t)throw new Em(t)}}add(t){var e;if(t&&t!==this)if(this.closed)XE(t);else{if(t instanceof Pn){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&tf(e,t)}remove(t){const{_finalizers:e}=this;e&&tf(e,t),t instanceof Pn&&t._removeParent(this)}}Pn.EMPTY=(()=>{const n=new Pn;return n.closed=!0,n})();const QE=Pn.EMPTY;function ZE(n){return n instanceof Pn||n&&"closed"in n&&Ze(n.remove)&&Ze(n.add)&&Ze(n.unsubscribe)}function XE(n){Ze(n)?n():n.unsubscribe()}const xo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},nf={setTimeout(n,t,...e){const{delegate:i}=nf;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=nf;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function JE(n){nf.setTimeout(()=>{const{onUnhandledError:t}=xo;if(!t)throw n;t(n)})}function Ec(){}const j2=Sm("C",void 0,void 0);function Sm(n,t,e){return{kind:n,value:t,error:e}}let Ao=null;function rf(n){if(xo.useDeprecatedSynchronousErrorHandling){const t=!Ao;if(t&&(Ao={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=Ao;if(Ao=null,e)throw i}}else n()}class Tm extends Pn{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,ZE(t)&&t.add(this)):this.destination=Y2}static create(t,e,i){return new Cm(t,e,i)}next(t){this.isStopped?Im(function G2(n){return Sm("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Im(function H2(n){return Sm("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Im(j2,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const W2=Function.prototype.bind;function Dm(n,t){return W2.call(n,t)}class K2{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){sf(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){sf(i)}else sf(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){sf(e)}}}class Cm extends Tm{constructor(t,e,i){let r;if(super(),Ze(t)||!t)r={next:t??void 0,error:e??void 0,complete:i??void 0};else{let s;this&&xo.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&Dm(t.next,s),error:t.error&&Dm(t.error,s),complete:t.complete&&Dm(t.complete,s)}):r=t}this.destination=new K2(r)}}function sf(n){xo.useDeprecatedSynchronousErrorHandling?function z2(n){xo.useDeprecatedSynchronousErrorHandling&&Ao&&(Ao.errorThrown=!0,Ao.error=n)}(n):JE(n)}function Im(n,t){const{onStoppedNotification:e}=xo;e&&nf.setTimeout(()=>e(n,t))}const Y2={closed:!0,next:Ec,error:function q2(n){throw n},complete:Ec},wm="function"==typeof Symbol&&Symbol.observable||"@@observable";function as(n){return n}function eS(n){return 0===n.length?as:1===n.length?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}let wt=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){const s=function X2(n){return n&&n instanceof Tm||function Z2(n){return n&&Ze(n.next)&&Ze(n.error)&&Ze(n.complete)}(n)&&ZE(n)}(e)?e:new Cm(e,i,r);return rf(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=tS(i))((r,s)=>{const o=new Cm({next:a=>{try{e(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[wm](){return this}pipe(...e){return eS(e)(this)}toPromise(e){return new(e=tS(e))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=t=>new n(t),n})();function tS(n){var t;return null!==(t=n??xo.Promise)&&void 0!==t?t:Promise}const J2=bm(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ke=(()=>{class n extends wt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new nS(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new J2}next(e){rf(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){rf(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){rf(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:s}=this;return i||r?QE:(this.currentObservers=null,s.push(e),new Pn(()=>{this.currentObservers=null,tf(s,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:s}=this;i?e.error(r):s&&e.complete()}asObservable(){const e=new wt;return e.source=this,e}}return n.create=(t,e)=>new nS(t,e),n})();class nS extends ke{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:QE}}class en extends ke{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function iS(n){return Ze(n?.lift)}function Qt(n){return t=>{if(iS(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function yt(n,t,e,i,r){return new eB(n,t,e,i,r)}class eB extends Tm{constructor(t,e,i,r,s,o){super(t),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=e?function(a){try{e(a)}catch(l){t.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function Ne(n,t){return Qt((e,i)=>{let r=0;e.subscribe(yt(i,s=>{i.next(n.call(t,s,r++))}))})}const rS="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss";class V extends Error{code;constructor(t,e){super(function ls(n,t){return`${function tB(n){return`NG0${Math.abs(n)}`}(n)}${t?": "+t:""}`}(t,e)),this.code=t}}const af=Symbol("InputSignalNode#UNSET"),sS={..._m,transformFn:void 0,applyValueToInputSignal(n,t){Jd(n,t)}};function oS(n,t){const e=Object.create(sS);function i(){if(Co(e),e.value===af)throw new V(-950,null);return e.value}return e.value=n,e.transformFn=t?.transform,i[un]=e,i}function cs(n){return{toString:n}.toString()}const Na="__parameters__";function La(n,t,e){return cs(()=>{const i=function xm(n){return function(...e){if(n){const i=n(...e);for(const r in i)this[r]=i[r]}}}(t);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(Na)?l[Na]:Object.defineProperty(l,Na,{value:[]})[Na];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return r.prototype.ngMetadataName=n,r.annotationCls=r,r})}const Ht=globalThis;function ot(n){for(let t in n)if(n[t]===ot)return t;throw Error("Could not find renamed property on target object.")}function nB(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function dn(n){if("string"==typeof n)return n;if(Array.isArray(n))return`[${n.map(dn).join(", ")}]`;if(null==n)return""+n;const t=n.overriddenName||n.name;if(t)return`${t}`;const e=n.toString();if(null==e)return""+e;const i=e.indexOf("\n");return i>=0?e.slice(0,i):e}function Am(n,t){return n?t?`${n} ${t}`:n:t||""}const iB=ot({__forward_ref__:ot});function it(n){return n.__forward_ref__=it,n.toString=function(){return dn(this())},n}function De(n){return lf(n)?n():n}function lf(n){return"function"==typeof n&&n.hasOwnProperty(iB)&&n.__forward_ref__===it}function z(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function dt(n){return{providers:n.providers||[],imports:n.imports||[]}}function cf(n){return lS(n,df)||lS(n,cS)}function lS(n,t){return n.hasOwnProperty(t)?n[t]:null}function uf(n){return n&&(n.hasOwnProperty(Mm)||n.hasOwnProperty(cB))?n[Mm]:null}const df=ot({\u0275prov:ot}),Mm=ot({\u0275inj:ot}),cS=ot({ngInjectableDef:ot}),cB=ot({ngInjectorDef:ot});class W{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,e){this._desc=t,this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=z({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Om(n){return n&&!!n.\u0275providers}const Fa=ot({\u0275cmp:ot}),Nm=ot({\u0275dir:ot}),Pm=ot({\u0275pipe:ot}),dS=ot({\u0275mod:ot}),us=ot({\u0275fac:ot}),Sc=ot({__NG_ELEMENT_ID__:ot}),fS=ot({__NG_ENV_ID__:ot});function xe(n){return"string"==typeof n?n:null==n?"":String(n)}function hS(n,t){throw new V(-200,n)}function Lm(n,t){throw new V(-201,!1)}var Ue=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ue||{});let Fm;function pS(){return Fm}function ei(n){const t=Fm;return Fm=n,t}function gS(n,t,e){const i=cf(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&Ue.Optional?null:void 0!==t?t:void Lm()}const Ro={},Bm="__NG_DI_FLAG__";class mS{injector;constructor(t){this.injector=t}retrieve(t,e){return this.injector.get(t,e.optional?ym:Ro,e)}}const pf="ngTempTokenPath",pB=/\n/gm,_S="__source";function mB(n,t=Ue.Default){if(void 0===ef())throw new V(-203,!1);if(null===ef())return gS(n,void 0,t);{const e=ef();let i;return i=e instanceof mS?e.injector:e,i.get(n,t&Ue.Optional?null:void 0,t)}}function pe(n,t=Ue.Default){return(pS()||mB)(De(n),t)}function w(n,t=Ue.Default){return pe(n,gf(t))}function gf(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Um(n){const t=[];for(let e=0;e<n.length;e++){const i=De(n[e]);if(Array.isArray(i)){if(0===i.length)throw new V(900,!1);let r,s=Ue.Default;for(let o=0;o<i.length;o++){const a=i[o],l=_B(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}t.push(pe(r,s))}else t.push(pe(i))}return t}function Tc(n,t){return n[Bm]=t,n.prototype[Bm]=t,n}function _B(n){return n[Bm]}const $m=Tc(La("Optional"),8),Vm=Tc(La("SkipSelf"),4);function ko(n,t){return n.hasOwnProperty(us)?n[us]:null}function Ba(n,t){n.forEach(e=>Array.isArray(e)?Ba(e,t):t(e))}function yS(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function mf(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function vi(n,t,e){let i=Dc(n,t);return i>=0?n[1|i]=e:(i=~i,function ES(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(1===r)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;)n[r]=n[r-2],r--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function jm(n,t){const e=Dc(n,t);if(e>=0)return n[1|e]}function Dc(n,t){return function DB(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<e];if(t===o)return s<<e;o>t?r=s:i=s+1}return~(r<<e)}(n,t,1)}const cr={},Xe=[],Fi=new W(""),SS=new W("",-1),Hm=new W("");class vf{get(t,e=Ro){if(e===Ro){const i=new Error(`NullInjectorError: No provider for ${dn(t)}!`);throw i.name="NullInjectorError",i}return e}}function yi(n,t){const e=n[dS]||null;if(!e&&!0===t)throw new Error(`Type ${dn(n)} does not have '\u0275mod' property.`);return e}function Ge(n){return n[Fa]||null}function bi(n){return n[Pm]||null}function Gs(n){return{\u0275providers:n}}function CB(...n){return{\u0275providers:Gm(0,n),\u0275fromNgModule:!0}}function Gm(n,...t){const e=[],i=new Set;let r;const s=o=>{e.push(o)};return Ba(t,o=>{const a=o;yf(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&TS(r,s),e}function TS(n,t){for(let e=0;e<n.length;e++){const{ngModule:i,providers:r}=n[e];zm(r,s=>{t(s,i)})}}function yf(n,t,e,i){if(!(n=De(n)))return!1;let r=null,s=uf(n);const o=!s&&Ge(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=uf(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)yf(c,t,e,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Ba(s.imports,u=>{yf(u,t,e,i)&&(c||=[],c.push(u))})}finally{}void 0!==c&&TS(c,t)}if(!a){const c=ko(r)||(()=>new r);t({provide:r,useFactory:c,deps:Xe},r),t({provide:Hm,useValue:r,multi:!0},r),t({provide:Fi,useValue:()=>pe(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const c=n;zm(l,u=>{t(u,c)})}}}return r!==n&&void 0!==n.providers}function zm(n,t){for(let e of n)Om(e)&&(e=e.\u0275providers),Array.isArray(e)?zm(e,t):t(e)}const IB=ot({provide:String,useValue:ot});function Wm(n){return null!==n&&"object"==typeof n&&IB in n}function No(n){return"function"==typeof n}const Km=new W(""),bf={},IS={};let qm;function Ef(){return void 0===qm&&(qm=new vf),qm}class An{}class Po extends An{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,Qm(t,o=>this.processProvider(o)),this.records.set(SS,Ua(void 0,this)),r.has("environment")&&this.records.set(An,Ua(void 0,this));const s=this.records.get(Km);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Hm,Xe,Ue.Self))}retrieve(t,e){return this.get(t,e.optional?ym:Ro,e)}destroy(){Cc(this),this._destroyed=!0;const t=we(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of e)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),we(t)}}onDestroy(t){return Cc(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){Cc(this);const e=Hs(this),i=ei(void 0);try{return t()}finally{Hs(e),ei(i)}}get(t,e=Ro,i=Ue.Default){if(Cc(this),t.hasOwnProperty(fS))return t[fS](this);i=gf(i);const s=Hs(this),o=ei(void 0);try{if(!(i&Ue.SkipSelf)){let l=this.records.get(t);if(void 0===l){const c=function kB(n){return"function"==typeof n||"object"==typeof n&&n instanceof W}(t)&&cf(t);l=c&&this.injectableDefInScope(c)?Ua(Ym(t),bf):null,this.records.set(t,l)}if(null!=l)return this.hydrate(t,l,i)}return(i&Ue.Self?Ef():this.parent).get(t,e=i&Ue.Optional&&e===Ro?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[pf]=a[pf]||[]).unshift(dn(t)),s)throw a;return function vB(n,t,e,i){const r=n[pf];throw t[_S]&&r.unshift(t[_S]),n.message=function yB(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=dn(t);if(Array.isArray(t))r=t.map(dn).join(" -> ");else if("object"==typeof t){let s=[];for(let o in t)if(t.hasOwnProperty(o)){let a=t[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):dn(a)))}r=`{${s.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${n.replace(pB,"\n  ")}`}("\n"+n.message,r,e,i),n.ngTokenPath=r,n[pf]=null,n}(a,t,"R3InjectorError",this.source)}throw a}finally{ei(o),Hs(s)}}resolveInjectorInitializers(){const t=we(null),e=Hs(this),i=ei(void 0);try{const s=this.get(Fi,Xe,Ue.Self);for(const o of s)o()}finally{Hs(e),ei(i),we(t)}}toString(){const t=[],e=this.records;for(const i of e.keys())t.push(dn(i));return`R3Injector[${t.join(", ")}]`}processProvider(t){let e=No(t=De(t))?t:De(t&&t.provide);const i=function AB(n){return Wm(n)?Ua(void 0,n.useValue):Ua(wS(n),bf)}(t);if(!No(t)&&!0===t.multi){let r=this.records.get(e);r||(r=Ua(void 0,bf,!0),r.factory=()=>Um(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,i)}hydrate(t,e,i){const r=we(null);try{return e.value===IS?hS(dn(t)):e.value===bf&&(e.value=IS,e.value=e.factory(void 0,i)),"object"==typeof e.value&&e.value&&function RB(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{we(r)}}injectableDefInScope(t){if(!t.providedIn)return!1;const e=De(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){const e=this._onDestroyHooks.indexOf(t);-1!==e&&this._onDestroyHooks.splice(e,1)}}function Ym(n){const t=cf(n),e=null!==t?t.factory:ko(n);if(null!==e)return e;if(n instanceof W)throw new V(204,!1);if(n instanceof Function)return function xB(n){if(n.length>0)throw new V(204,!1);const e=function lB(n){return n&&(n[df]||n[cS])||null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new V(204,!1)}function wS(n,t,e){let i;if(No(n)){const r=De(n);return ko(r)||Ym(r)}if(Wm(n))i=()=>De(n.useValue);else if(function CS(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Um(n.deps||[]));else if(function DS(n){return!(!n||!n.useExisting)}(n))i=(r,s)=>pe(De(n.useExisting),void 0!==s&&s&Ue.Optional?Ue.Optional:void 0);else{const r=De(n&&(n.useClass||n.provide));if(!function MB(n){return!!n.deps}(n))return ko(r)||Ym(r);i=()=>new r(...Um(n.deps))}return i}function Cc(n){if(n.destroyed)throw new V(205,!1)}function Ua(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Qm(n,t){for(const e of n)Array.isArray(e)?Qm(e,t):e&&Om(e)?Qm(e.\u0275providers,t):t(e)}function Bi(n,t){let e;n instanceof Po?(Cc(n),e=n):e=new mS(n);const r=Hs(e),s=ei(void 0);try{return t()}finally{Hs(r),ei(s)}}function Zm(){return void 0!==pS()||null!=ef()}function Lo(n){if(!Zm())throw new V(-203,!1)}function Gt(n){return Array.isArray(n)&&"object"==typeof n[1]}function hn(n){return Array.isArray(n)&&!0===n[1]}function e0(n){return!!(4&n.flags)}function dr(n){return n.componentOffset>-1}function If(n){return!(1&~n.flags)}function Si(n){return!!n.template}function fs(n){return!!(512&n[2])}function hs(n){return!(256&~n[2])}class GB{previousValue;currentValue;firstChange;constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function PS(n,t,e,i){null!==t?t.applyValueToInputSignal(t,i):n[e]=i}const Fn=(()=>{const n=()=>LS;return n.ngInherit=!0,n})();function LS(n){return n.type.prototype.ngOnChanges&&(n.setInput=WB),zB}function zB(){const n=BS(this),t=n?.current;if(t){const e=n.previous;if(e===cr)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function WB(n,t,e,i,r){const s=this.declaredInputs[i],o=BS(n)||function KB(n,t){return n[FS]=t}(n,{previous:cr,current:null}),a=o.current||(o.current={}),l=o.previous,c=l[s];a[s]=new GB(c&&c.currentValue,e,l===cr),PS(n,t,r,e)}const FS="__ngSimpleChanges__";function BS(n){return n[FS]||null}function Ye(n){for(;Array.isArray(n);)n=n[0];return n}function Wa(n,t){return Ye(t[n])}function Vn(n,t){return Ye(t[n.index])}function $o(n,t){return n.data[t]}function Vo(n,t){return n[t]}function jn(n,t){const e=t[n];return Gt(e)?e:e[0]}function s0(n){return!(128&~n[2])}function Ui(n,t){return null==t?null:n[t]}function VS(n){n[17]=0}function o0(n){1024&n[2]||(n[2]|=1024,s0(n)&&Ka(n))}function xc(n){return!!(9216&n[2]||n[24]?.dirty)}function a0(n){n[10].changeDetectionScheduler?.notify(8),64&n[2]&&(n[2]|=1024),xc(n)&&Ka(n)}function Ka(n){n[10].changeDetectionScheduler?.notify(0);let t=ps(n);for(;null!==t&&!(8192&t[2])&&(t[2]|=8192,s0(t));)t=ps(t)}function xf(n,t){if(hs(n))throw new V(911,!1);null===n[21]&&(n[21]=[]),n[21].push(t)}function ps(n){const t=n[3];return hn(t)?t[3]:t}function c0(n){return n[7]??=[]}function u0(n){return n.cleanup??=[]}const Ce={lFrame:ZS(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let f0=!1;function h0(){return Ce.bindingsEnabled}function jo(){return null!==Ce.skipHydrationRootTNode}function L(){return Ce.lFrame.lView}function Ee(){return Ce.lFrame.tView}function X(n){return Ce.lFrame.contextLView=n,n[8]}function J(n){return Ce.lFrame.contextLView=null,n}function je(){let n=HS();for(;null!==n&&64===n.type;)n=n.parent;return n}function HS(){return Ce.lFrame.currentTNode}function fr(n,t){const e=Ce.lFrame;e.currentTNode=n,e.isParent=t}function p0(){return Ce.lFrame.isParent}function g0(){Ce.lFrame.isParent=!1}function WS(){return f0}function Mf(n){const t=f0;return f0=n,t}function Hn(){const n=Ce.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function gs(){return Ce.lFrame.bindingIndex}function $i(){return Ce.lFrame.bindingIndex++}function ms(n){const t=Ce.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function lU(n,t){const e=Ce.lFrame;e.bindingIndex=e.bindingRootIndex=n,m0(t)}function m0(n){Ce.lFrame.currentDirectiveIndex=n}function v0(){return Ce.lFrame.currentQueryIndex}function Rf(n){Ce.lFrame.currentQueryIndex=n}function uU(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[5]:null}function YS(n,t,e){if(e&Ue.SkipSelf){let r=t,s=n;for(;!(r=r.parent,null!==r||e&Ue.Host||(r=uU(s),null===r||(s=s[14],10&r.type))););if(null===r)return!1;t=r,n=s}const i=Ce.lFrame=QS();return i.currentTNode=t,i.lView=n,!0}function y0(n){const t=QS(),e=n[1];Ce.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function QS(){const n=Ce.lFrame,t=null===n?null:n.child;return null===t?ZS(n):t}function ZS(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function XS(){const n=Ce.lFrame;return Ce.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const JS=XS;function b0(){const n=XS();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Mn(){return Ce.lFrame.selectedIndex}function Ho(n){Ce.lFrame.selectedIndex=n}function ft(){const n=Ce.lFrame;return $o(n.tView,n.selectedIndex)}let tT=!0;function Mc(){return tT}function kr(n){tT=n}function E0(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const s=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-e,o),a&&((n.contentHooks??=[]).push(e,a),(n.contentCheckHooks??=[]).push(e,a)),l&&(n.viewHooks??=[]).push(-e,l),c&&((n.viewHooks??=[]).push(e,c),(n.viewCheckHooks??=[]).push(e,c)),null!=u&&(n.destroyHooks??=[]).push(e,u)}}function kf(n,t,e){nT(n,t,3,e)}function Of(n,t,e,i){(3&n[2])===e&&nT(n,t,e,i)}function S0(n,t){let e=n[2];(3&e)===t&&(e&=16383,e+=1,n[2]=e)}function nT(n,t,e,i){const s=i??-1,o=t.length-1;let a=0;for(let l=void 0!==i?65535&n[17]:0;l<o;l++)if("number"==typeof t[l+1]){if(a=t[l],null!=i&&a>=i)break}else t[l]<0&&(n[17]+=65536),(a<s||-1==s)&&(_U(n,e,t,l),n[17]=(4294901760&n[17])+l+2),l++}function iT(n,t){const e=we(null);try{t.call(n)}finally{we(e)}}function _U(n,t,e,i){const r=e[i]<0,s=e[i+1],a=n[r?-e[i]:e[i]];r?n[2]>>14<n[17]>>16&&(3&n[2])===t&&(n[2]+=16384,iT(a,s)):iT(a,s)}class Rc{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,e,i){this.factory=t,this.canSeeViewProviders=e,this.injectImpl=i}}function rT(n){return 3===n||4===n||6===n}function sT(n){return 64===n.charCodeAt(0)}function Ya(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?e=r:0===e||oT(n,e,r,0,-1===e||2===e?t[++i]:null)}}return n}function oT(n,t,e,i,r){let s=0,o=n.length;if(-1===t)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===t){o=-1;break}if(a>t){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===e)return void(null!==r&&(n[s+1]=r));s++,null!==r&&s++}-1!==o&&(n.splice(o,0,t),s=o+1),n.splice(s++,0,e),null!==r&&n.splice(s++,0,r)}function C0(n){return-1!==n}function kc(n){return 32767&n}function Oc(n,t){let e=function SU(n){return n>>16}(n),i=t;for(;e>0;)i=i[14],e--;return i}let I0=!0;function Nf(n){const t=I0;return I0=n,t}let TU=0;const Or={};function Pf(n,t){const e=cT(n,t);if(-1!==e)return e;const i=t[1];i.firstCreatePass&&(n.injectorIndex=t.length,w0(i.data,n),w0(t,null),w0(i.blueprint,null));const r=Lf(n,t),s=n.injectorIndex;if(C0(r)){const o=kc(r),a=Oc(r,t),l=a[1].data;for(let c=0;c<8;c++)t[s+c]=a[o+c]|l[o+c]}return t[s+8]=r,s}function w0(n,t){n.push(0,0,0,0,0,0,0,0,t)}function cT(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Lf(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;null!==r;){if(i=mT(r),null===i)return-1;if(e++,r=r[14],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function x0(n,t,e){!function DU(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Sc)&&(i=e[Sc]),null==i&&(i=e[Sc]=TU++);const r=255&i;t.data[n+(r>>5)]|=1<<r}(n,t,e)}function uT(n,t,e){if(e&Ue.Optional||void 0!==n)return n;Lm()}function dT(n,t,e,i){if(e&Ue.Optional&&void 0===i&&(i=null),!(e&(Ue.Self|Ue.Host))){const r=n[9],s=ei(void 0);try{return r?r.get(t,i,e&Ue.Optional):gS(t,i,e&Ue.Optional)}finally{ei(s)}}return uT(i,0,e)}function fT(n,t,e,i=Ue.Default,r){if(null!==n){if(2048&t[2]&&!(i&Ue.Self)){const o=function AU(n,t,e,i,r){let s=n,o=t;for(;null!==s&&null!==o&&2048&o[2]&&!fs(o);){const a=hT(s,o,e,i|Ue.Self,Or);if(a!==Or)return a;let l=s.parent;if(!l){const c=o[20];if(c){const u=c.get(e,Or,i);if(u!==Or)return u}l=mT(o),o=o[14]}s=l}return r}(n,t,e,i,Or);if(o!==Or)return o}const s=hT(n,t,e,i,Or);if(s!==Or)return s}return dT(t,e,i,r)}function hT(n,t,e,i,r){const s=function wU(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Sc)?n[Sc]:void 0;return"number"==typeof t?t>=0?255&t:xU:t}(e);if("function"==typeof s){if(!YS(t,n,i))return i&Ue.Host?uT(r,0,i):dT(t,e,i,r);try{let o;if(o=s(i),null!=o||i&Ue.Optional)return o;Lm()}finally{JS()}}else if("number"==typeof s){let o=null,a=cT(n,t),l=-1,c=i&Ue.Host?t[15][5]:null;for((-1===a||i&Ue.SkipSelf)&&(l=-1===a?Lf(n,t):t[a+8],-1!==l&&gT(i,!1)?(o=t[1],a=kc(l),t=Oc(l,t)):a=-1);-1!==a;){const u=t[1];if(pT(s,a,u.data)){const d=IU(a,t,e,o,i,c);if(d!==Or)return d}l=t[a+8],-1!==l&&gT(i,t[1].data[a+8]===c)&&pT(s,a,t)?(o=u,a=kc(l),t=Oc(l,t)):a=-1}}return r}function IU(n,t,e,i,r,s){const o=t[1],a=o.data[n+8],u=Ff(a,o,e,null==i?dr(a)&&I0:i!=o&&!!(3&a.type),r&Ue.Host&&s===a);return null!==u?Nc(t,o,u,a,r):Or}function Ff(n,t,e,i,r){const s=n.providerIndexes,o=t.data,a=1048575&s,l=n.directiveStart,u=s>>20,f=r?a+u:n.directiveEnd;for(let h=i?a:a+u;h<f;h++){const p=o[h];if(h<l&&e===p||h>=l&&p.type===e)return h}if(r){const h=o[l];if(h&&Si(h)&&h.type===e)return l}return null}function Nc(n,t,e,i,r){let s=n[e];const o=t.data;if(s instanceof Rc){const a=s;a.resolving&&hS(function nt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():xe(n)}(o[e]));const l=Nf(a.canSeeViewProviders);a.resolving=!0;const u=a.injectImpl?ei(a.injectImpl):null;YS(n,i,Ue.Default);try{s=n[e]=a.factory(void 0,r,o,n,i),t.firstCreatePass&&e>=i.directiveStart&&function mU(n,t,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(i){const o=LS(t);(e.preOrderHooks??=[]).push(n,o),(e.preOrderCheckHooks??=[]).push(n,o)}r&&(e.preOrderHooks??=[]).push(0-n,r),s&&((e.preOrderHooks??=[]).push(n,s),(e.preOrderCheckHooks??=[]).push(n,s))}(e,o[e],t)}finally{null!==u&&ei(u),Nf(l),a.resolving=!1,JS()}}return s}function pT(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function gT(n,t){return!(n&Ue.Self||n&Ue.Host&&t)}class zt{_tNode;_lView;constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return fT(this._tNode,this._lView,t,gf(i),e)}}function xU(){return new zt(je(),L())}function xt(n){return cs(()=>{const t=n.prototype.constructor,e=t[us]||A0(t),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[us]||A0(r);if(s&&s!==e)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function A0(n){return lf(n)?()=>{const t=A0(De(n));return t&&t()}:ko(n)}function mT(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[5]:null}function ET(n,t=null,e=null,i){const r=ST(n,t,e,i);return r.resolveInjectorInitializers(),r}function ST(n,t=null,e=null,i,r=new Set){const s=[e||Xe,CB(n)];return i=i||("object"==typeof n?void 0:dn(n)),new Po(s,t||Ef(),i||null,r)}class ht{static THROW_IF_NOT_FOUND=Ro;static NULL=new vf;static create(t,e){if(Array.isArray(t))return ET({name:""},e,t,"");{const i=t.name??"";return ET({name:i},t.parent,t.providers,i)}}static \u0275prov=z({token:ht,providedIn:"any",factory:()=>pe(SS)});static __NG_ELEMENT_ID__=-1}new W("").__NG_ELEMENT_ID__=n=>{const t=je();if(null===t)throw new V(204,!1);if(2&t.type)return t.value;if(n&Ue.Optional)return null;throw new V(204,!1)};const TT=!1;let Gn=(()=>class n{static __NG_ELEMENT_ID__=BU;static __NG_ENV_ID__=e=>e})();class DT extends Gn{_lView;constructor(t){super(),this._lView=t}onDestroy(t){const e=this._lView;return hs(e)?(t(),()=>{}):(xf(e,t),()=>function l0(n,t){if(null===n[21])return;const e=n[21].indexOf(t);-1!==e&&n[21].splice(e,1)}(e,t))}}function BU(){return new DT(L())}class _s{}const Pc=new W("",{providedIn:"root",factory:()=>!1}),CT=new W(""),R0=new W("");let qs=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new en(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=z({token:n,providedIn:"root",factory:()=>new n})}return n})();const ve=class UU extends ke{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,Zm()&&(this.destroyRef=w(Gn,{optional:!0})??void 0,this.pendingTasks=w(qs,{optional:!0})??void 0)}emit(t){const e=we(null);try{super.next(t)}finally{we(e)}}subscribe(t,e,i){let r=t,s=e||(()=>null),o=i;if(t&&"object"==typeof t){const l=t;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));const a=super.subscribe({next:r,error:s,complete:o});return t instanceof Pn&&t.add(a),a}wrapInTimeout(t){return e=>{const i=this.pendingTasks?.add();setTimeout(()=>{try{t(e)}finally{void 0!==i&&this.pendingTasks?.remove(i)}})}}};function Lc(...n){}function wT(n){let t,e;function i(){n=Lc;try{void 0!==e&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(e),void 0!==t&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{n(),i()}),"function"==typeof requestAnimationFrame&&(e=requestAnimationFrame(()=>{n(),i()})),()=>i()}function xT(n){return queueMicrotask(()=>n()),()=>{n=Lc}}const k0="isAngularZone",Uf=k0+"_ID";let $U=0;class $e{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ve(!1);onMicrotaskEmpty=new ve(!1);onStable=new ve(!1);onError=new ve(!1);constructor(t){const{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=TT}=t;if(typeof Zone>"u")throw new V(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&i,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,function HU(n){const t=()=>{!function jU(n){function t(){wT(()=>{n.callbackScheduled=!1,N0(n),n.isCheckStableRunning=!0,O0(n),n.isCheckStableRunning=!1})}n.isCheckStableRunning||n.callbackScheduled||(n.callbackScheduled=!0,n.scheduleInRootZone?Zone.root.run(()=>{t()}):n._outer.run(()=>{t()}),N0(n))}(n)},e=$U++;n._inner=n._inner.fork({name:"angular",properties:{[k0]:!0,[Uf]:e,[Uf+e]:!0},onInvokeTask:(i,r,s,o,a,l)=>{if(function GU(n){return RT(n,"__ignore_ng_zone__")}(l))return i.invokeTask(s,o,a,l);try{return AT(n),i.invokeTask(s,o,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&t(),MT(n)}},onInvoke:(i,r,s,o,a,l,c)=>{try{return AT(n),i.invoke(s,o,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!function zU(n){return RT(n,"__scheduler_tick__")}(l)&&t(),MT(n)}},onHasTask:(i,r,s,o)=>{i.hasTask(s,o),r===s&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,N0(n),O0(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(i,r,s,o)=>(i.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(k0)}static assertInAngularZone(){if(!$e.isInAngularZone())throw new V(909,!1)}static assertNotInAngularZone(){if($e.isInAngularZone())throw new V(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,t,VU,Lc,Lc);try{return s.runTask(o,e,i)}finally{s.cancelTask(o)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const VU={};function O0(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function N0(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&!0===n.callbackScheduled)}function AT(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function MT(n){n._nesting--,O0(n)}class P0{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ve;onMicrotaskEmpty=new ve;onStable=new ve;onError=new ve;run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}}function RT(n,t){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0]?.data?.[t]}class hr{_console=console;handleError(t){this._console.error("ERROR",t)}}const KU=new W("",{providedIn:"root",factory:()=>{const n=w($e),t=w(hr);return e=>n.runOutsideAngular(()=>t.handleError(e))}});function OT(n,t){return oS(n,t)}const YU=(OT.required=function qU(n){return oS(af,n)},OT);function QU(){return Qa(je(),L())}function Qa(n,t){return new lt(Vn(n,t))}let lt=(()=>class n{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=QU})();function NT(n){return n instanceof lt?n.nativeElement:n}function Nr(n,t){const e=function P2(n,t){const e=Object.create(_m);e.value=n,void 0!==t&&(e.equal=t);const i=()=>(Co(e),e.value);return i[un]=e,i}(n,t?.equal),i=e[un];return e.set=r=>Jd(i,r),e.update=r=>function qE(n,t){ka()||bc(n),Jd(n,t(n.value))}(i,r),e.asReadonly=$f.bind(e),e}function $f(){const n=this[un];if(void 0===n.readonlyFn){const t=()=>this();t[un]=n,n.readonlyFn=t}return n.readonlyFn}function LT(n){return function PT(n){return"function"==typeof n&&void 0!==n[un]}(n)&&"function"==typeof n.set}function ZU(){return this._results[Symbol.iterator]()}class XU{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new ke}constructor(t=!1){this._emitDistinctChangesOnly=t}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){this.dirty=!1;const i=function ti(n){return n.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function TB(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=t[i];if(e&&(r=e(r),s=e(s)),s!==r)return!1}return!0}(this._results,i,e))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=ZU}function Bc(n){return!(128&~n.flags)}var Vf=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Vf||{});const jf=new Map;let e$=0;function F0(n){jf.delete(n[19])}const U0="__ngContext__";function ii(n,t){Gt(t)?(n[U0]=t[19],function n$(n){jf.set(n[19],n)}(t)):n[U0]=t}function zT(n){return KT(n[12])}function WT(n){return KT(n[4])}function KT(n){for(;null!==n&&!hn(n);)n=n[4];return n}let V0;const vs=new W("",{providedIn:"root",factory:()=>E$}),E$="ng",j0=new W(""),H0=new W("",{providedIn:"platform",factory:()=>"unknown"}),eD=new W("",{providedIn:"root",factory:()=>function Pr(){if(void 0!==V0)return V0;if(typeof document<"u")return document;throw new V(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),rD=new W("",{providedIn:"root",factory:()=>!1});var e_=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(e_||{});const Xa=new W(""),lD=new Set;function ri(n){lD.has(n)||(lD.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}let qf=(()=>class n{view;node;constructor(e,i){this.view=e,this.node=i}static __NG_ELEMENT_ID__=I$})();function I$(){return new qf(L(),je())}var Ja=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Ja||{});let t_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=z({token:n,providedIn:"root",factory:()=>new n})}return n})();const cD=[Ja.EarlyRead,Ja.Write,Ja.MixedReadWrite,Ja.Read];let uD=(()=>{class n{ngZone=w($e);scheduler=w(_s);errorHandler=w(hr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){w(Xa,{optional:!0})}execute(){this.executing=!0;for(const i of cD)for(const r of this.sequences)if(!r.erroredOrDestroyed&&r.hooks[i])try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>(0,r.hooks[i])(r.pipelinedValue),r.snapshot))}catch(s){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(s)}this.executing=!1;for(const i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(const i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){const{view:i}=e;void 0!==i?((i[25]??=[]).push(e),Ka(i),i[2]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,i){return i?i.run(e_.AFTER_NEXT_RENDER,e):e()}static \u0275prov=z({token:n,providedIn:"root",factory:()=>new n})}return n})();class dD{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(t,e,i,r,s,o=null){this.impl=t,this.hooks=e,this.view=i,this.once=r,this.snapshot=o,this.unregisterOnDestroy=s?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();const t=this.view?.[25];t&&(this.view[25]=t.filter(e=>e!==this))}}function Wo(n,t){!t?.injector&&Lo();const e=t?.injector??w(ht);return ri("NgAfterNextRender"),fD(n,e,t,!0)}function fD(n,t,e,i){const r=t.get(t_);r.impl??=t.get(uD);const s=t.get(Xa,null,{optional:!0}),o=e?.phase??Ja.MixedReadWrite,a=!0!==e?.manualCleanup?t.get(Gn):null,l=t.get(qf,null,{optional:!0}),c=new dD(r.impl,function w$(n,t){if(n instanceof Function){const e=[void 0,void 0,void 0,void 0];return e[t]=n,e}return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}(n,o),l?.view,i,a,s?.snapshot(null));return r.impl.register(c),c}function BD(n,t){const e=n.contentQueries;if(null!==e){const i=we(null);try{for(let r=0;r<e.length;r+=2){const o=e[r+1];if(-1!==o){const a=n.data[o];Rf(e[r]),a.contentQueries(2,t[o],o)}}}finally{we(i)}}}function g_(n,t,e){Rf(0);const i=we(null);try{t(n,e)}finally{we(i)}}function m_(n,t,e){if(e0(t)){const i=we(null);try{const s=t.directiveEnd;for(let o=t.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,e[o],o)}}finally{we(i)}}}var Vi=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Vi||{});let sh;function jD(n){return function __(){if(void 0===sh&&(sh=null,Ht.trustedTypes))try{sh=Ht.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return sh}()?.createScriptURL(n)||n}class HD{changingThisBreaksApplicationSecurity;constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${rS})`}}function Qs(n){return n instanceof HD?n.changingThisBreaksApplicationSecurity:n}function Zc(n,t){const e=function _V(n){return n instanceof HD&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${rS})`)}return e===t}const EV=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var ll=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(ll||{});function cl(n){const t=Jc();return t?t.sanitize(ll.URL,n)||"":Zc(n,"URL")?Qs(n):function v_(n){return(n=String(n)).match(EV)?n:"unsafe:"+n}(xe(n))}function XD(n){const t=Jc();if(t)return jD(t.sanitize(ll.RESOURCE_URL,n)||"");if(Zc(n,"ResourceURL"))return jD(Qs(n));throw new V(904,!1)}function Jc(){const n=L();return n&&n[10].sanitizer}function Lr(n){return n instanceof Function?n():n}function QV(n,t,e){let i=n.length;for(;;){const r=n.indexOf(t,e);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=t.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}e=r+1}}const lC="ng-template";function ZV(n,t,e,i){let r=0;if(i){for(;r<t.length&&"string"==typeof t[r];r+=2)if("class"===t[r]&&-1!==QV(t[r+1].toLowerCase(),e,0))return!0}else if(D_(n))return!1;if(r=t.indexOf(1,r),r>-1){let s;for(;++r<t.length&&"string"==typeof(s=t[r]);)if(s.toLowerCase()===e)return!0}return!1}function D_(n){return 4===n.type&&n.value!==lC}function XV(n,t,e){return t===(4!==n.type||e?n.value:lC)}function JV(n,t,e){let i=4;const r=n.attrs,s=null!==r?function n3(n){for(let t=0;t<n.length;t++)if(rT(n[t]))return t;return n.length}(r):0;let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!XV(n,l,e)||""===l&&1===t.length){if(pr(i))return!1;o=!0}}else if(8&i){if(null===r||!ZV(n,r,l,e)){if(pr(i))return!1;o=!0}}else{const c=t[++a],u=e3(l,r,D_(n),e);if(-1===u){if(pr(i))return!1;o=!0;continue}if(""!==c){let d;if(d=u>s?"":r[u+1].toLowerCase(),2&i&&c!==d){if(pr(i))return!1;o=!0}}}}else{if(!o&&!pr(i)&&!pr(l))return!1;if(o&&pr(l))continue;o=!1,i=l|1&i}}return pr(i)||o}function pr(n){return!(1&n)}function e3(n,t,e,i){if(null===t)return-1;let r=0;if(i||!e){let s=!1;for(;r<t.length;){const o=t[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=t[++r];for(;"string"==typeof a;)a=t[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function i3(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function cC(n,t,e=!1){for(let i=0;i<t.length;i++)if(JV(n,t[i],e))return!0;return!1}function r3(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function uC(n,t){return n?":not("+t.trim()+")":t}function s3(n){let t=n[0],e=1,i=2,r="",s=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&i){const a=n[++e];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!pr(o)&&(t+=uC(s,r),r=""),i=o,s=s||!pr(i);e++}return""!==r&&(t+=uC(s,r)),t}const Ae={};function ch(n,t,e){return n.createElement(t,e)}function qo(n,t,e,i,r){n.insertBefore(t,e,i,r)}function fC(n,t,e){n.appendChild(t,e)}function hC(n,t,e,i,r){null!==i?qo(n,t,e,i,r):fC(n,t,e)}function gC(n,t,e){const{mergedAttrs:i,classes:r,styles:s}=e;null!==i&&function EU(n,t,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const s=e[i++],o=e[i++],a=e[i++];n.setAttribute(t,o,a,s)}else{const s=r,o=e[++i];sT(s)?n.setProperty(t,s,o):n.setAttribute(t,s,o),i++}}}(n,t,i),null!==r&&function c3(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}(n,t,r),null!==s&&function l3(n,t,e){n.setAttribute(t,"style",e)}(n,t,s)}function w_(n,t,e,i,r,s,o,a,l,c,u){const d=26+i,f=d+r,h=function u3(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:Ae);return e}(d,f),p="function"==typeof c?c():c;return h[1]={type:n,blueprint:h,template:e,queries:null,viewQuery:a,declTNode:t,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}function uh(n,t,e,i,r,s,o,a,l,c,u){const d=t.blueprint.slice();return d[0]=r,d[2]=1228|i,(null!==c||n&&2048&n[2])&&(d[2]|=2048),VS(d),d[3]=d[14]=n,d[8]=e,d[10]=o||n&&n[10],d[11]=a||n&&n[11],d[9]=l||n&&n[9]||null,d[5]=s,d[19]=function t$(){return e$++}(),d[6]=u,d[20]=c,d[15]=2==t.type?n[15]:d,d}function x_(n){let t=16;return n.signals?t=4096:n.onPush&&(t=64),t}function tu(n,t,e,i){if(0===e)return-1;const r=t.length;for(let s=0;s<e;s++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function A_(n,t){return n[12]?n[13][4]=t:n[12]=t,n[13]=t,t}function E(n=1){_C(Ee(),L(),Mn()+n,!1)}function _C(n,t,e,i){if(!i)if(3&~t[2]){const s=n.preOrderHooks;null!==s&&Of(t,s,0,e)}else{const s=n.preOrderCheckHooks;null!==s&&kf(t,s,e)}Ho(e)}var dh=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(dh||{});function M_(n,t,e,i){const r=we(null);try{const[s,o,a]=n.inputs[e];let l=null;!!(o&dh.SignalBased)&&(l=t[s][un]),null!==l&&void 0!==l.transformFn?i=l.transformFn(i):null!==a&&(i=a.call(t,i)),null!==n.setInput?n.setInput(t,l,i,e,s):PS(t,l,s,i)}finally{we(r)}}function vC(n,t,e,i,r){const s=Mn(),o=2&i;try{Ho(-1),o&&t.length>26&&_C(n,t,26,!1),e(i,r)}finally{Ho(s)}}function fh(n,t,e){(function v3(n,t,e){const i=e.directiveStart,r=e.directiveEnd;dr(e)&&function d3(n,t,e){const i=Vn(t,n),r=function mC(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=w_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):t}(e),s=n[10].rendererFactory,o=A_(n,uh(n,r,null,x_(e),i,t,null,s.createRenderer(i,e),null,null,null));n[t.index]=o}(t,e,n.data[i+e.componentOffset]),n.firstCreatePass||Pf(e,t);const s=e.initialInputs;for(let o=i;o<r;o++){const a=n.data[o],l=Nc(t,n,o,e);ii(l,t),null!==s&&E3(0,o-i,l,a,0,s),Si(a)&&(jn(e.index,t)[8]=Nc(t,n,o,e))}})(n,t,e),!(64&~e.flags)&&function y3(n,t,e){const i=e.directiveStart,r=e.directiveEnd,s=e.index,o=function cU(){return Ce.lFrame.currentDirectiveIndex}();try{Ho(s);for(let a=i;a<r;a++){const l=n.data[a],c=t[a];m0(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&b3(l,c)}}finally{Ho(-1),m0(o)}}(n,t,e)}function R_(n,t,e=Vn){const i=t.localNames;if(null!==i){let r=t.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?e(t,n):n[o];n[r++]=a}}}let yC=()=>null;function si(n,t,e,i,r,s,o,a){if(a||!P_(t,n,e,i,r)){if(3&t.type){const l=Vn(t,e);i=function m3(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,t.value||"",i):r,s.setProperty(l,i,r)}}else dr(t)&&function _3(n,t){const e=jn(t,n);16&e[2]||(e[2]|=64)}(e,t.index)}function b3(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function k_(n,t){const e=n.directiveRegistry;let i=null;if(e)for(let r=0;r<e.length;r++){const s=e[r];cC(t,s.selectors,!1)&&(i??=[],Si(s)?i.unshift(s):i.push(s))}return i}function Fr(n,t,e,i,r,s){const o=Vn(n,t);!function O_(n,t,e,i,r,s,o){if(null==s)n.removeAttribute(t,r,e);else{const a=null==o?xe(s):o(s,i||"",r);n.setAttribute(t,r,a,e)}}(t[11],o,s,n.value,e,i,r)}function E3(n,t,e,i,r,s){const o=s[t];if(null!==o)for(let a=0;a<o.length;a+=2)M_(i,e,o[a],o[a+1])}function P_(n,t,e,i,r){const s=n.inputs?.[i],o=n.hostDirectiveInputs?.[i];let a=!1;if(o)for(let l=0;l<o.length;l+=2){const c=o[l];M_(t.data[c],e[c],o[l+1],r),a=!0}if(s)for(const l of s)M_(t.data[l],e[l],i,r),a=!0;return a}function S3(n,t){const e=jn(t,n),i=e[1];!function T3(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])}(i,e);const r=e[0];null!==r&&null===e[6]&&(e[6]=null),hh(i,e,e[8])}function hh(n,t,e){y0(t);try{const i=n.viewQuery;null!==i&&g_(1,i,e);const r=n.template;null!==r&&vC(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),t[18]?.finishViewCreation(n),n.staticContentQueries&&BD(n,t),n.staticViewQueries&&g_(2,n.viewQuery,e);const s=n.components;null!==s&&function D3(n,t){for(let e=0;e<t.length;e++)S3(n,t[e])}(t,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[2]&=-5,b0()}}function dl(n,t,e,i){const r=we(null);try{const s=t.tView,l=uh(n,s,e,4096&n[2]?4096:16,null,t,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);l[16]=n[t.index];const u=n[18];return null!==u&&(l[18]=u.createEmbeddedView(s)),hh(s,l,e),l}finally{we(r)}}function Yo(n,t){return!t||null===t.firstChild||Bc(n)}function F_(n,t){return undefined(n,t)}var Zs=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Zs||{});function Xs(n){return!(32&~n.flags)}function fl(n,t,e,i,r){if(null!=i){let s,o=!1;hn(i)?s=i:Gt(i)&&(o=!0,i=i[0]);const a=Ye(i);0===n&&null!==e?null==r?fC(t,e,a):qo(t,e,a,r||null,!0):1===n&&null!==e?qo(t,e,a,r||null,!0):2===n?function eu(n,t,e){n.removeChild(null,t,e)}(t,a,o):3===n&&t.destroyNode(a),null!=s&&function R3(n,t,e,i,r){const s=e[7];s!==Ye(e)&&fl(t,n,i,s,r);for(let a=10;a<e.length;a++){const l=e[a];gh(l[1],l,n,t,i,s)}}(t,n,s,e,r)}}function TC(n,t){t[10].changeDetectionScheduler?.notify(9),gh(n,t,t[11],2,null,null)}function B_(n,t){const e=n[9],i=e.indexOf(t);e.splice(i,1)}function nu(n,t){if(hs(t))return;const e=t[11];e.destroyNode&&gh(n,t,e,3,null,null),function w3(n){let t=n[12];if(!t)return U_(n[1],n);for(;t;){let e=null;if(Gt(t))e=t[12];else{const i=t[10];i&&(e=i)}if(!e){for(;t&&!t[4]&&t!==n;)Gt(t)&&U_(t[1],t),t=t[3];null===t&&(t=n),Gt(t)&&U_(t[1],t),e=t&&t[4]}t=e}}(t)}function U_(n,t){if(hs(t))return;const e=we(null);try{t[2]&=-129,t[2]|=256,t[24]&&Ve(t[24]),function A3(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const r=t[e[i]];if(!(r instanceof Rc)){const s=e[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,t),function x3(n,t){const e=n.cleanup,i=t[7];if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const a=e[o+3];a>=0?i[a]():i[-a].unsubscribe(),o+=2}else e[o].call(i[e[o+1]]);null!==i&&(t[7]=null);const r=t[21];if(null!==r){t[21]=null;for(let o=0;o<r.length;o++)(0,r[o])()}const s=t[23];if(null!==s){t[23]=null;for(const o of s)o.destroy()}}(n,t),1===t[1].type&&t[11].destroy();const i=t[16];if(null!==i&&hn(t[3])){i!==t[3]&&B_(i,t);const r=t[18];null!==r&&r.detachView(n)}F0(t)}finally{we(e)}}function $_(n,t,e){return function DC(n,t,e){let i=t;for(;null!==i&&168&i.type;)i=(t=i).parent;if(null===i)return e[0];if(dr(i)){const{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Vi.None||r===Vi.Emulated)return null}return Vn(i,e)}(n,t.parent,e)}function CC(n,t,e){return wC(n,t,e)}let wC=function IC(n,t,e){return 40&n.type?Vn(n,e):null};function ph(n,t,e,i){const r=$_(n,i,t),s=t[11],a=CC(i.parent||t[5],i,t);if(null!=r)if(Array.isArray(e))for(let l=0;l<e.length;l++)hC(s,r,e[l],a,!1);else hC(s,r,e,a,!1)}function Qo(n,t){if(null!==t){const e=t.type;if(3&e)return Vn(t,n);if(4&e)return j_(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return Qo(n,i);{const r=n[t.index];return hn(r)?j_(-1,r):Ye(r)}}if(128&e)return Qo(n,t.next);if(32&e)return F_(t,n)()||Ye(n[t.index]);{const i=AC(n,t);return null!==i?Array.isArray(i)?i[0]:Qo(ps(n[15]),i):Qo(n,t.next)}}return null}function AC(n,t){return null!==t?n[15][5].projection[t.projection]:null}function j_(n,t){const e=10+n+1;if(e<t.length){const i=t[e],r=i[1].firstChild;if(null!==r)return Qo(i,r)}return t[7]}function H_(n,t,e,i,r,s,o){for(;null!=e;){if(128===e.type){e=e.next;continue}const a=i[e.index],l=e.type;if(o&&0===t&&(a&&ii(Ye(a),i),e.flags|=2),!Xs(e))if(8&l)H_(n,t,e.child,i,r,s,!1),fl(t,n,r,a,s);else if(32&l){const c=F_(e,i);let u;for(;u=c();)fl(t,n,r,u,s);fl(t,n,r,a,s)}else 16&l?MC(n,t,i,e,r,s):fl(t,n,r,a,s);e=o?e.projectionNext:e.next}}function gh(n,t,e,i,r,s){H_(e,i,n.firstChild,t,r,s,!1)}function MC(n,t,e,i,r,s){const o=e[15],l=o[5].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)fl(t,n,r,l[c],s);else{let c=l;const u=o[3];Bc(i)&&(c.flags|=128),H_(n,t,c,u,r,s,!0)}}function hl(n,t,e,i,r=!1){for(;null!==e;){if(128===e.type){e=r?e.projectionNext:e.next;continue}const s=t[e.index];null!==s&&i.push(Ye(s)),hn(s)&&G_(s,i);const o=e.type;if(8&o)hl(n,t,e.child,i);else if(32&o){const a=F_(e,t);let l;for(;l=a();)i.push(l)}else if(16&o){const a=AC(t,e);if(Array.isArray(a))i.push(...a);else{const l=ps(t[15]);hl(l[1],l,a,i,!0)}}e=r?e.projectionNext:e.next}return i}function G_(n,t){for(let e=10;e<n.length;e++){const i=n[e],r=i[1].firstChild;null!==r&&hl(i[1],i,r,t)}n[7]!==n[0]&&t.push(n[7])}function RC(n){if(null!==n[25]){for(const t of n[25])t.impl.addSequence(t);n[25].length=0}}let kC=[];const L3={...Vs,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Ka(n.lView)},consumerOnSignalRead(){this.lView[24]=this}},B3={...Vs,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let t=ps(n.lView);for(;t&&!OC(t[1]);)t=ps(t);t&&o0(t)},consumerOnSignalRead(){this.lView[24]=this}};function OC(n){return 2!==n.type}function NC(n){if(null===n[23])return;let t=!0;for(;t;){let e=!1;for(const i of n[23])i.dirty&&(e=!0,null===i.zone||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));t=e&&!!(8192&n[2])}}function mh(n,t=!0,e=0){const r=n[10].rendererFactory;r.begin?.();try{!function $3(n,t){const e=WS();try{Mf(!0),z_(n,t);let i=0;for(;xc(n);){if(100===i)throw new V(103,!1);i++,z_(n,1)}}finally{Mf(e)}}(n,e)}catch(o){throw t&&function N_(n,t){const e=n[9],i=e?e.get(hr,null):null;i&&i.handleError(t)}(n,o),o}finally{r.end?.()}}function LC(n,t,e,i){if(hs(t))return;const r=t[2];y0(t);let a=!0,l=null,c=null;OC(n)?(c=function O3(n){return n[24]??function N3(n){const t=kC.pop()??Object.create(L3);return t.lView=n,t}(n)}(t),l=Q(c)):null===function Ra(){return Ft}()?(a=!1,c=function F3(n){const t=n[24]??Object.create(B3);return t.lView=n,t}(t),l=Q(c)):t[24]&&(Ve(t[24]),t[24]=null);try{VS(t),function KS(n){return Ce.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&vC(n,t,e,2,i);const u=!(3&~r);if(u){const h=n.preOrderCheckHooks;null!==h&&kf(t,h,null)}else{const h=n.preOrderHooks;null!==h&&Of(t,h,0,null),S0(t,0)}if(function V3(n){for(let t=zT(n);null!==t;t=WT(t)){if(!(2&t[2]))continue;const e=t[9];for(let i=0;i<e.length;i++)o0(e[i])}}(t),NC(t),FC(t,0),null!==n.contentQueries&&BD(n,t),u){const h=n.contentCheckHooks;null!==h&&kf(t,h)}else{const h=n.contentHooks;null!==h&&Of(t,h,1),S0(t,1)}!function H3(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Ho(~r);else{const s=r,o=e[++i],a=e[++i];lU(o,s);const l=t[s];a(2,l)}}}finally{Ho(-1)}}(n,t);const d=n.components;null!==d&&UC(t,d,0);const f=n.viewQuery;if(null!==f&&g_(2,f,i),u){const h=n.viewCheckHooks;null!==h&&kf(t,h)}else{const h=n.viewHooks;null!==h&&Of(t,h,2),S0(t,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[22]){for(const h of t[22])h();t[22]=null}RC(t),t[2]&=-73}catch(u){throw Ka(t),u}finally{null!==c&&(he(c,l),a&&function P3(n){n.lView[24]!==n&&(n.lView=null,kC.push(n))}(c)),b0()}}function FC(n,t){for(let e=zT(n);null!==e;e=WT(e))for(let i=10;i<e.length;i++)BC(e[i],t)}function j3(n,t,e){const i=jn(t,n);BC(i,e)}function BC(n,t){s0(n)&&z_(n,t)}function z_(n,t){const i=n[1],r=n[2],s=n[24];let o=!!(0===t&&16&r);if(o||=!!(64&r&&0===t),o||=!!(1024&r),o||=!(!s?.dirty||!ue(s)),o||=!1,s&&(s.dirty=!1),n[2]&=-9217,o)LC(i,n,i.template,n[8]);else if(8192&r){NC(n),FC(n,1);const a=i.components;null!==a&&UC(n,a,1),RC(n)}}function UC(n,t,e){for(let i=0;i<t.length;i++)j3(n,t[i],e)}function iu(n,t){const e=WS()?64:1088;for(n[10].changeDetectionScheduler?.notify(t);n;){n[2]|=e;const i=ps(n);if(fs(n)&&!i)return n;n=i}return null}function $C(n,t,e,i){return[n,!0,0,t,null,i,null,e,null,null]}function pl(n,t,e,i=!0){const r=t[1];if(function G3(n,t,e,i){const r=10+i,s=e.length;i>0&&(e[r-1][4]=t),i<s-10?(t[4]=e[r],yS(e,10+i,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[16];null!==o&&e!==o&&jC(o,t);const a=t[18];null!==a&&a.insertView(n),a0(t),t[2]|=128}(r,t,n,e),i){const o=j_(e,n),a=t[11],l=a.parentNode(n[7]);null!==l&&function I3(n,t,e,i,r,s){i[0]=r,i[5]=t,gh(n,i,e,1,r,s)}(r,n[5],a,t,l,o)}const s=t[6];null!==s&&null!==s.firstChild&&(s.firstChild=null)}function ru(n,t){if(n.length<=10)return;const e=10+t,i=n[e];if(i){const r=i[16];null!==r&&r!==n&&B_(r,i),t>0&&(n[e-1][4]=i[4]);const s=mf(n,10+t);!function SC(n,t){TC(n,t),t[0]=null,t[5]=null}(i[1],i);const o=s[18];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function jC(n,t){const e=n[9],i=t[3];(Gt(i)||t[15]!==i[3][15])&&(n[2]|=2),null===e?n[9]=[t]:e.push(t)}let su=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){const t=this._lView,e=t[1];return hl(e,t,e.firstChild,[])}constructor(t,e,i=!0){this._lView=t,this._cdRefInjectingView=e,this.notifyErrorHandler=i}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return hs(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(hn(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(ru(t,i),mf(e,i))}this._attachedToViewContainer=!1}nu(this._lView[1],this._lView)}onDestroy(t){xf(this._lView,t)}markForCheck(){iu(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[2]&=-129}reattach(){a0(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,mh(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new V(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const t=fs(this._lView),e=this._lView[16];null!==e&&!t&&B_(e,this._lView),TC(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new V(902,!1);this._appRef=t;const e=fs(this._lView),i=this._lView[16];null!==i&&!e&&jC(i,this._lView),a0(this._lView)}},tn=(()=>class n{static __NG_ELEMENT_ID__=K3})();const z3=tn,W3=class extends z3{_declarationLView;_declarationTContainer;elementRef;constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,e){return this.createEmbeddedViewImpl(t,e)}createEmbeddedViewImpl(t,e,i){const r=dl(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:e,dehydratedView:i});return new su(r)}};function K3(){return _h(je(),L())}function _h(n,t){return 4&n.type?new W3(t,n,Qa(n,t)):null}function gl(n,t,e,i,r){let s=n.data[t];if(null===s)s=function Q_(n,t,e,i,r){const s=HS(),o=p0(),l=n.data[t]=function ij(n,t,e,i,r,s){let o=t?t.injectorIndex:-1,a=0;return jo()&&(a|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,e,t,i,r);return function nj(n,t,e,i){null===n.firstChild&&(n.firstChild=t),null!==e&&(i?null==e.child&&null!==t.parent&&(e.child=t):null===e.next&&(e.next=t,t.prev=e))}(n,l,s,o),l}(n,t,e,i,r),function aU(){return Ce.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=e,s.value=i,s.attrs=r;const o=function Ac(){const n=Ce.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return fr(s,!0),s}let Hj=class{},dI=class{};class Gj{resolveComponentFactory(t){throw Error(`No component factory found for ${dn(t)}.`)}}let Dh=class{static NULL=new Gj};class rv{}let Ss=(()=>class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>function zj(){const n=L(),e=jn(je().index,n);return(Gt(e)?e:n)[11]}()})(),Wj=(()=>{class n{static \u0275prov=z({token:n,providedIn:"root",factory:()=>null})}return n})();const ov={};class vl{injector;parentInjector;constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){i=gf(i);const r=this.injector.get(t,ov,i);return r!==ov||e===ov?r:this.parentInjector.get(t,e,i)}}function av(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?s=a:1==s?r=Am(r,a):2==s&&(i=Am(i,a+": "+t[++o]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}function F(n,t=Ue.Default){const e=L();return null===e?pe(n,t):fT(je(),e,De(n),t)}function lv(n,t,e,i,r){const s=null===i?null:{"":-1},o=r(n,e);if(null!==o){let a,l=null,c=null;const u=function Zj(n){let t=null,e=!1;for(let o=0;o<n.length;o++){const a=n[o];if(0===o&&Si(a)&&(t=a),null!==a.findHostDirectiveDefs){e=!0;break}}if(!e)return null;let i=null,r=null,s=null;for(const o of n)null!==o.findHostDirectiveDefs&&(i??=[],r??=new Map,s??=new Map,Xj(o,i,s,r)),o===t&&(i??=[],i.push(o));return null!==i?(i.push(...null===t?n:n.slice(1)),[i,r,s]):null}(o);null===u?a=o:[a,l,c]=u,function e8(n,t,e,i,r,s,o){const a=i.length;let l=!1;for(let f=0;f<a;f++){const h=i[f];!l&&Si(h)&&(l=!0,Jj(n,e,f)),x0(Pf(e,t),n,h.type)}!function o8(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}(e,n.data.length,a);for(let f=0;f<a;f++){const h=i[f];h.providersResolver&&h.providersResolver(h)}let c=!1,u=!1,d=tu(n,t,a,null);a>0&&(e.directiveToIndex=new Map);for(let f=0;f<a;f++){const h=i[f];if(e.mergedAttrs=Ya(e.mergedAttrs,h.hostAttrs),n8(n,e,t,d,h),s8(d,h,r),null!==o&&o.has(h)){const[g,m]=o.get(h);e.directiveToIndex.set(h.type,[d,g+e.directiveStart,m+e.directiveStart])}else(null===s||!s.has(h))&&e.directiveToIndex.set(h.type,d);null!==h.contentQueries&&(e.flags|=4),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(e.flags|=64);const p=h.type.prototype;!c&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),c=!0),!u&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),u=!0),d++}!function t8(n,t,e){for(let i=t.directiveStart;i<t.directiveEnd;i++){const r=n.data[i];if(null!==e&&e.has(r)){const s=e.get(r);gI(0,t,s,i),gI(1,t,s,i),_I(t,i,!0)}else pI(0,t,r,i),pI(1,t,r,i),_I(t,i,!1)}}(n,e,s)}(n,t,e,a,s,l,c)}null!==s&&null!==i&&function Qj(n,t,e){const i=n.localNames=[];for(let r=0;r<t.length;r+=2){const s=e[t[r+1]];if(null==s)throw new V(-301,!1);i.push(t[r],s)}}(e,i,s)}function Xj(n,t,e,i){const r=t.length;n.findHostDirectiveDefs(n,t,i),e.set(n,[r,t.length-1])}function Jj(n,t,e){t.componentOffset=e,(n.components??=[]).push(t.index)}function pI(n,t,e,i){const r=0===n?e.inputs:e.outputs;for(const s in r)if(r.hasOwnProperty(s)){let o;o=0===n?t.inputs??={}:t.outputs??={},o[s]??=[],o[s].push(i),mI(t,s)}}function gI(n,t,e,i){const r=0===n?e.inputs:e.outputs;for(const s in r)if(r.hasOwnProperty(s)){const o=r[s];let a;a=0===n?t.hostDirectiveInputs??={}:t.hostDirectiveOutputs??={},a[o]??=[],a[o].push(i,s),mI(t,o)}}function mI(n,t){"class"===t?n.flags|=8:"style"===t&&(n.flags|=16)}function _I(n,t,e){const{attrs:i,inputs:r,hostDirectiveInputs:s}=n;if(null===i||!e&&null===r||e&&null===s||D_(n))return n.initialInputs??=[],void n.initialInputs.push(null);let o=null,a=0;for(;a<i.length;){const l=i[a];if(0!==l)if(5!==l){if("number"==typeof l)break;if(!e&&r.hasOwnProperty(l)){const c=r[l];for(const u of c)if(u===t){o??=[],o.push(l,i[a+1]);break}}else if(e&&s.hasOwnProperty(l)){const c=s[l];for(let u=0;u<c.length;u+=2)if(c[u]===t){o??=[],o.push(c[u+1],i[a+1]);break}}a+=2}else a+=2;else a+=4}n.initialInputs??=[],n.initialInputs.push(o)}function n8(n,t,e,i,r){n.data[i]=r;const s=r.factory||(r.factory=ko(r.type)),o=new Rc(s,Si(r),F);n.blueprint[i]=o,e[i]=o,function i8(n,t,e,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~t.index;(function r8(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(o)!=a&&o.push(a),o.push(e,i,s)}}(n,t,i,tu(n,e,r.hostVars,Ae),r)}function s8(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;Si(t)&&(e[""]=n)}}function vI(n,t,e,i,r,s,o,a){const l=t.consts,u=gl(t,n,2,i,Ui(l,o));return s&&lv(t,e,u,Ui(l,a),r),u.mergedAttrs=Ya(u.mergedAttrs,u.attrs),null!==u.attrs&&av(u,u.attrs,!1),null!==u.mergedAttrs&&av(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}function yI(n,t){E0(n,t),e0(t)&&n.queries.elementEnd(t)}class bI extends Dh{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=Ge(t);return new gu(e,this.ngModule)}}class gu extends dI{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=function a8(n){return Object.keys(n).map(t=>{const[e,i,r]=n[t],s={propName:e,templateName:t,isSignal:!!(i&dh.SignalBased)};return r&&(s.transform=r),s})}(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=function l8(n){return Object.keys(n).map(t=>({propName:n[t],templateName:t}))}(this.componentDef.outputs),this.cachedOutputs}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function o3(n){return n.map(s3).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!e}create(t,e,i,r){const s=we(null);try{const o=this.componentDef,a=i?["ng-version","19.2.15"]:function a3(n){const t=[],e=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&t.push(s,n[++i]):8===r&&e.push(s);else{if(!pr(r))break;r=s}i++}return e.length&&t.push(1,...e),t}(this.componentDef.selectors[0]),l=w_(0,null,null,1,0,null,null,null,null,[a],null),c=function c8(n,t,e){let i=t instanceof An?t:t?.injector;return i&&null!==n.getStandaloneInjector&&(i=n.getStandaloneInjector(i)||i),i?new vl(e,i):e}(o,r||this.ngModule,t),u=function u8(n){const t=n.get(rv,null);if(null===t)throw new V(407,!1);return{rendererFactory:t,sanitizer:n.get(Wj,null),changeDetectionScheduler:n.get(_s,null)}}(c),d=u.rendererFactory.createRenderer(null,o),f=i?function f3(n,t,e,i){const s=i.get(rD,!1)||e===Vi.ShadowDom,o=n.selectRootElement(t,s);return function h3(n){yC(n)}(o),o}(d,i,o.encapsulation,c):function d8(n,t){const e=(n.selectors[0][0]||"div").toLowerCase();return ch(t,e,"svg"===e?"svg":"math"===e?"math":null)}(o,d),h=uh(null,l,null,512|x_(o),null,null,u,d,c,null,null);h[26]=f,y0(h);let p=null;try{const g=vI(26,l,h,"#host",()=>[this.componentDef],!0,0);f&&(gC(d,f,g),ii(f,h)),fh(l,h,g),m_(l,g,h),yI(l,g),void 0!==e&&function h8(n,t,e){const i=n.projection=[];for(let r=0;r<t.length;r++){const s=e[r];i.push(null!=s&&s.length?Array.from(s):null)}}(g,this.ngContentSelectors,e),p=jn(g.index,h),h[8]=p[8],hh(l,h,null)}catch(g){throw null!==p&&F0(p),F0(h),g}finally{b0()}return new f8(this.componentType,h)}finally{we(s)}}}class f8 extends Hj{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,e){super(),this._rootLView=e,this._tNode=$o(e[1],26),this.location=Qa(this._tNode,e),this.instance=jn(this._tNode.index,e)[8],this.hostView=this.changeDetectorRef=new su(e,void 0,!1),this.componentType=t}setInput(t,e){const i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;const r=this._rootLView;P_(i,r[1],r,t,e),this.previousInputValues.set(t,e),iu(jn(i.index,r),1)}get injector(){return new zt(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}let Ti=(()=>class n{static __NG_ELEMENT_ID__=p8})();function p8(){return TI(je(),L())}const g8=Ti,EI=class extends g8{_lContainer;_hostTNode;_hostLView;constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return Qa(this._hostTNode,this._hostLView)}get injector(){return new zt(this._hostTNode,this._hostLView)}get parentInjector(){const t=Lf(this._hostTNode,this._hostLView);if(C0(t)){const e=Oc(t,this._hostLView),i=kc(t);return new zt(e[1].data[i+8],e)}return new zt(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=SI(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=t.createEmbeddedViewImpl(e||{},s,null);return this.insertImpl(a,r,Yo(this._hostTNode,null)),a}createComponent(t,e,i,r,s){const o=t&&!function Ic(n){return"function"==typeof n}(t);let a;if(o)a=e;else{const p=e||{};a=p.index,i=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}const l=o?t:new gu(Ge(t)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const g=(o?c:this.parentInjector).get(An,null);g&&(s=g)}Ge(l.componentType??{});const h=l.create(c,r,null,s);return this.insertImpl(h.hostView,a,Yo(this._hostTNode,null)),h}insert(t,e){return this.insertImpl(t,e,!0)}insertImpl(t,e,i){const r=t._lView;if(function ZB(n){return hn(n[3])}(r)){const a=this.indexOf(t);if(-1!==a)this.detach(a);else{const l=r[3],c=new EI(l,l[5],l[3]);c.detach(c.indexOf(t))}}const s=this._adjustIndex(e),o=this._lContainer;return pl(o,r,s,i),t.attachToViewContainerRef(),yS(cv(o),s,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=SI(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=ru(this._lContainer,e);i&&(mf(cv(this._lContainer),e),nu(i[1],i))}detach(t){const e=this._adjustIndex(t,-1),i=ru(this._lContainer,e);return i&&null!=mf(cv(this._lContainer),e)?new su(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function SI(n){return n[8]}function cv(n){return n[8]||(n[8]=[])}function TI(n,t){let e;const i=t[n.index];return hn(i)?e=i:(e=$C(i,t,null,n),t[n.index]=e,A_(t,e)),DI(e,t,n,i),new EI(e,n,t)}let DI=function II(n,t,e,i){if(n[7])return;let r;r=8&e.type?Ye(i):function m8(n,t){const e=n[11],i=e.createComment(""),r=Vn(t,n),s=e.parentNode(r);return qo(e,s,i,e.nextSibling(r),!1),i}(t,e),n[7]=r};class dv{queryList;matches=null;constructor(t){this.queryList=t}clone(){return new dv(this.queryList)}setDirty(){this.queryList.setDirty()}}class fv{queries;constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let s=0;s<i;s++){const o=e.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new fv(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==_v(t,e).matches&&this.queries[e].setDirty()}}class wI{flags;read;predicate;constructor(t,e,i=null){this.flags=e,this.read=i,this.predicate="string"==typeof t?function D8(n){return n.split(",").map(t=>t.trim())}(t):t}}class hv{queries;constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,s=this.getByIndex(i).embeddedTView(t,r);s&&(s.indexInDeclarationView=i,null!==e?e.push(s):e=[s])}return null!==e?new hv(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class pv{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(t,e=-1){this.metadata=t,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new pv(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1&~this.metadata.flags){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(t,e,b8(e,s)),this.matchTNodeWithReadOption(t,e,Ff(e,t,s,!1,!1))}else i===tn?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Ff(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===lt||r===Ti||r===tn&&4&e.type)this.addMatch(e.index,-2);else{const s=Ff(e,t,r,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function b8(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function S8(n,t,e,i){return-1===e?function E8(n,t){return 11&n.type?Qa(n,t):4&n.type?_h(n,t):null}(t,n):-2===e?function T8(n,t,e){return e===lt?Qa(t,n):e===tn?_h(t,n):e===Ti?TI(t,n):void 0}(n,t,i):Nc(n,n[1],e,t)}function xI(n,t,e,i){const r=t[18].queries[i];if(null===r.matches){const s=n.data,o=e.matches,a=[];for(let l=0;null!==o&&l<o.length;l+=2){const c=o[l];a.push(c<0?null:S8(t,s[c],o[l+1],e.metadata.read))}r.matches=a}return r.matches}function gv(n,t,e,i){const r=n.queries.getByIndex(e),s=r.matches;if(null!==s){const o=xI(n,t,r,e);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=t[-l];for(let d=10;d<u.length;d++){const f=u[d];f[16]===f[3]&&gv(f[1],f,c,i)}if(null!==u[9]){const d=u[9];for(let f=0;f<d.length;f++){const h=d[f];gv(h[1],h,c,i)}}}}}return i}function AI(n,t,e){const i=new XU(!(4&~e));return function XB(n,t,e,i){const r=c0(t);r.push(e),n.firstCreatePass&&u0(n).push(i,r.length-1)}(n,t,i,i.destroy),(t[18]??=new fv).queries.push(new dv(i))-1}function kI(n,t,e){null===n.queries&&(n.queries=new hv),n.queries.track(new pv(t,e))}function _v(n,t){return n.queries.getByIndex(t)}function OI(n,t){const e=n[1],i=_v(e,t);return i.crossesNgTemplate?gv(e,n,t,[]):xI(e,n,i,t)}let Jo=class{},GI=class{};class bv extends Jo{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new bI(this);constructor(t,e,i,r=!0){super(),this.ngModuleType=t,this._parent=e;const s=yi(t);this._bootstrapComponents=Lr(s.bootstrap),this._r3Injector=ST(t,e,[{provide:Jo,useValue:this},{provide:Dh,useValue:this.componentFactoryResolver},...i],dn(t),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Ev extends GI{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new bv(this.moduleType,t,[])}}class zI extends Jo{injector;componentFactoryResolver=new bI(this);instance=null;constructor(t){super();const e=new Po([...t.providers,{provide:Jo,useValue:this},{provide:Dh,useValue:this.componentFactoryResolver}],t.parent||Ef(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function Ih(n,t,e=null){return new zI({providers:n,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}let F8=(()=>{class n{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const i=Gm(0,e.type),r=i.length>0?Ih([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,r)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=z({token:n,providedIn:"environment",factory:()=>new n(pe(An))})}return n})();function Rt(n){return cs(()=>{const t=WI(n),e={...t,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Vf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:t.standalone?r=>r.get(F8).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Vi.Emulated,styles:n.styles||Xe,_:null,schemas:n.schemas||null,tView:null,id:""};t.standalone&&ri("NgStandalone"),KI(e);const i=n.dependencies;return e.directiveDefs=wh(i,!1),e.pipeDefs=wh(i,!0),e.id=function H8(n){let t=0;const i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,"function"==typeof n.consts?"":n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(const s of i.join("|"))t=Math.imul(31,t)+s.charCodeAt(0)|0;return t+=2147483648,"c"+t}(e),e})}function B8(n){return Ge(n)||function xn(n){return n[Nm]||null}(n)}function U8(n){return null!==n}function bt(n){return cs(()=>({type:n.type,bootstrap:n.bootstrap||Xe,declarations:n.declarations||Xe,imports:n.imports||Xe,exports:n.exports||Xe,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function $8(n,t){if(null==n)return cr;const e={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];let s,o,a,l;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s,l=r[3]||null):(s=r,o=r,a=dh.None,l=null),e[s]=[i,a,l],t[s]=o}return e}function V8(n){if(null==n)return cr;const t={};for(const e in n)n.hasOwnProperty(e)&&(t[n[e]]=e);return t}function ne(n){return cs(()=>{const t=WI(n);return KI(t),t})}function oi(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function WI(n){const t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputConfig:n.inputs||cr,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:!0===n.signals,selectors:n.selectors||Xe,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:$8(n.inputs,t),outputs:V8(n.outputs),debugInfo:null}}function KI(n){n.features?.forEach(t=>t(n))}function wh(n,t){if(!n)return null;const e=t?bi:B8;return()=>("function"==typeof n?n():n).map(i=>e(i)).filter(U8)}function Je(n){let t=function qI(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let r;if(Si(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new V(903,!1);r=t.\u0275dir}if(r){if(e){i.push(r);const o=n;o.inputs=Sv(n.inputs),o.declaredInputs=Sv(n.declaredInputs),o.outputs=Sv(n.outputs);const a=r.hostBindings;a&&q8(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&W8(n,l),c&&K8(n,c),G8(n,r),nB(n.outputs,r.outputs),Si(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Je&&(e=!1)}}t=Object.getPrototypeOf(t)}!function z8(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=Ya(r.hostAttrs,e=Ya(e,r.hostAttrs))}}(i)}function G8(n,t){for(const e in t.inputs){if(!t.inputs.hasOwnProperty(e)||n.inputs.hasOwnProperty(e))continue;const i=t.inputs[e];void 0!==i&&(n.inputs[e]=i,n.declaredInputs[e]=t.declaredInputs[e])}}function Sv(n){return n===cr?{}:n===Xe?[]:n}function W8(n,t){const e=n.viewQuery;n.viewQuery=e?(i,r)=>{t(i,r),e(i,r)}:t}function K8(n,t){const e=n.contentQueries;n.contentQueries=e?(i,r,s)=>{t(i,r,s),e(i,r,s)}:t}function q8(n,t){const e=n.hostBindings;n.hostBindings=e?(i,r)=>{t(i,r),e(i,r)}:t}function xh(n){return!!function Cv(n){return null!==n&&("function"==typeof n||"object"==typeof n)}(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function Br(n,t,e){return n[t]=e}function Wt(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function ea(n,t,e,i){const r=Wt(n,t,e);return Wt(n,t+1,i)||r}function vu(n,t,e,i,r,s,o,a,l,c){const u=e+26,d=t.firstCreatePass?function nH(n,t,e,i,r,s,o,a,l){const c=t.consts,u=gl(t,n,4,o||null,a||null);h0()&&lv(t,e,u,Ui(c,l),k_),u.mergedAttrs=Ya(u.mergedAttrs,u.attrs),E0(t,u);const d=u.tView=w_(2,u,i,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c,null);return null!==t.queries&&(t.queries.template(t,u),d.queries=t.queries.embeddedTView(u)),u}(u,t,n,i,r,s,o,a,l):t.data[u];fr(d,!1);const f=JI(t,n,d,e);Mc()&&ph(t,n,f,d),ii(f,n);const h=$C(f,n,f,d);return n[u]=h,A_(n,h),If(d)&&fh(t,n,d),null!=l&&R_(n,d,c),d}function Y(n,t,e,i,r,s,o,a){const l=L(),c=Ee();return vu(l,c,n,t,e,i,r,Ui(c.consts,s),o,a),Y}let JI=function ew(n,t,e,i){return kr(!0),t[11].createComment("")};let xv=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const hw=new W(""),Oh=new W("");let Nv,kv=(()=>{class n{_ngZone;registry;_isZoneStable=!0;_callbacks=[];_taskTrackingZone=null;_destroyRef;constructor(e,i,r){this._ngZone=e,this.registry=i,Zm()&&(this._destroyRef=w(Gn,{optional:!0})??void 0),Nv||(function e5(n){Nv=n}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this._taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){const e=this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),i=this._ngZone.runOutsideAngular(()=>this._ngZone.onStable.subscribe({next:()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}}));this._destroyRef?.onDestroy(()=>{e.unsubscribe(),i.unsubscribe()})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this._taskTrackingZone?this._taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),e()},i)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,i,r){if(r&&!this._taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}static \u0275fac=function(i){return new(i||n)(pe($e),pe(Ov),pe(Oh))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})(),Ov=(()=>{class n{_applications=new Map;registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return Nv?.findTestabilityInTree(this,e,i)??null}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),pw=(()=>{class n{static \u0275prov=z({token:n,providedIn:"root",factory:()=>new t5})}return n})();class t5{queuedEffectCount=0;queues=new Map;schedule(t){this.enqueue(t)}remove(t){const i=this.queues.get(t.zone);i.has(t)&&(i.delete(t),this.queuedEffectCount--)}enqueue(t){const e=t.zone;this.queues.has(e)||this.queues.set(e,new Set);const i=this.queues.get(e);i.has(t)||(this.queuedEffectCount++,i.add(t))}flush(){for(;this.queuedEffectCount>0;)for(const[t,e]of this.queues)null===t?this.flushQueue(e):t.run(()=>this.flushQueue(e))}flushQueue(t){for(const e of t)t.delete(e),this.queuedEffectCount--,e.run()}}function bu(n){return!!n&&"function"==typeof n.then}function gw(n){return!!n&&"function"==typeof n.subscribe}const mw=new W("");function _w(n){return Gs([{provide:mw,multi:!0,useValue:n}])}let vw=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i});appInits=w(mw,{optional:!0})??[];injector=w(ht);constructor(){}runInitializers(){if(this.initialized)return;const e=[];for(const r of this.appInits){const s=Bi(this.injector,r);if(bu(s))e.push(s);else if(gw(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});e.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Eu=new W("");function bw(n,t){return Array.isArray(t)?t.reduce(bw,n):{...n,...t}}let ai=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=w(KU);afterRenderManager=w(t_);zonelessEnabled=w(Pc);rootEffectScheduler=w(pw);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new ke;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=w(qs).hasPendingTasks.pipe(Ne(e=>!e));constructor(){w(Xa,{optional:!0})}whenStable(){let e;return new Promise(i=>{e=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{e.unsubscribe()})}_injector=w(An);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,i){return this.bootstrapImpl(e,i)}bootstrapImpl(e,i,r=ht.NULL){const s=e instanceof dI;if(!this._injector.get(vw).done)throw new V(405,"");let a;a=s?e:this._injector.get(Dh).resolveComponentFactory(e),this.componentTypes.push(a.componentType);const l=function n5(n){return n.isBoundToModule}(a)?void 0:this._injector.get(Jo),u=a.create(r,[],i||a.selector,l),d=u.location.nativeElement,f=u.injector.get(hw,null);return f?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),Nh(this.components,u),f?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){null!==this.tracingSnapshot?this.tracingSnapshot.run(e_.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new V(101,!1);const e=we(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,we(e),this.afterTick.next()}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(rv,null,{optional:!0}));let e=0;for(;0!==this.dirtyFlags&&e++<10;)this.synchronizeOnce()}synchronizeOnce(){if(16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),7&this.dirtyFlags){const e=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i,notifyErrorHandler:r}of this.allViews)r5(i,r,e,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:e})=>xc(e))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;Nh(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Eu,[]).forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>Nh(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new V(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Nh(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function r5(n,t,e,i){(e||xc(n))&&mh(n,t,e&&!i?0:1)}function Et(n,t,e,i){const r=L();return Wt(r,$i(),t)&&(Ee(),Fr(ft(),r,n,t,e,i)),Et}function Cl(n,t,e,i,r,s,o,a){const c=function Ah(n,t,e,i,r){const s=ea(n,t,e,i);return Wt(n,t+2,r)||s}(n,gs(),e,r,o);return ms(3),c?t+xe(e)+i+xe(r)+s+xe(o)+a:Ae}function Il(n,t,e,i,r,s,o,a,l,c){const d=function ji(n,t,e,i,r,s){const o=ea(n,t,e,i);return ea(n,t+2,r,s)||o}(n,gs(),e,r,o,l);return ms(4),d?t+xe(e)+i+xe(r)+s+xe(o)+a+xe(l)+c:Ae}function Ph(n,t){return n<<17|t<<2}function na(n){return n>>17&32767}function Uv(n){return 2|n}function Rl(n){return(131068&n)>>2}function $v(n,t){return-131069&n|t<<2}function Vv(n){return 1|n}function Bw(n,t,e,i){const r=n[e+1],s=null===t;let o=i?na(r):Rl(r),a=!1;for(;0!==o&&(!1===a||s);){const c=n[o+1];G5(n[o],t)&&(a=!0,n[o+1]=i?Vv(c):Uv(c)),o=i?na(c):Rl(c)}a&&(n[e+1]=i?Uv(r):Vv(r))}function G5(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&Dc(n,t)>=0}const pn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Uw(n){return n.substring(pn.key,pn.keyEnd)}function $w(n,t){const e=pn.textEnd;return e===t?-1:(t=pn.keyEnd=function q5(n,t,e){for(;t<e&&n.charCodeAt(t)>32;)t++;return t}(n,pn.key=t,e),kl(n,t,e))}function kl(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function R(n,t,e){const i=L();return Wt(i,$i(),t)&&si(Ee(),ft(),i,n,t,i[11],e,!1),R}function jv(n,t,e,i,r){P_(t,n,e,r?"class":"style",i)}function Pe(n,t){return function gr(n,t,e,i){const r=L(),s=Ee(),o=ms(2);s.firstUpdatePass&&Kw(s,n,o,i),t!==Ae&&Wt(r,o,t)&&Yw(s,s.data[Mn()],r,r[11],n,r[o+1]=function sG(n,t){return null==n||""===n||("string"==typeof t?n+=t:"object"==typeof n&&(n=dn(Qs(n)))),n}(t,e),i,o)}(n,t,null,!0),Pe}function Tu(n){!function mr(n,t,e,i){const r=Ee(),s=ms(2);r.firstUpdatePass&&Kw(r,null,s,i);const o=L();if(e!==Ae&&Wt(o,s,e)){const a=r.data[Mn()];if(Zw(a,i)&&!Ww(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(e=Am(l,e||"")),jv(r,a,o,e,i)}else!function rG(n,t,e,i,r,s,o,a){r===Ae&&(r=Xe);let l=0,c=0,u=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==u||null!==d;){const f=l<r.length?r[l+1]:void 0,h=c<s.length?s[c+1]:void 0;let g,p=null;u===d?(l+=2,c+=2,f!==h&&(p=d,g=h)):null===d||null!==u&&u<d?(l+=2,p=u):(c+=2,p=d,g=h),null!==p&&Yw(n,t,e,i,p,g,o,a),u=l<r.length?r[l]:null,d=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function nG(n,t,e){if(null==e||""===e)return Xe;const i=[],r=Qs(e);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&t(i,r);return i}(n,t,e),i,s)}}(iG,$r,n,!0)}function $r(n,t){for(let e=function W5(n){return function jw(n){pn.key=0,pn.keyEnd=0,pn.value=0,pn.valueEnd=0,pn.textEnd=n.length}(n),$w(n,kl(n,0,pn.textEnd))}(t);e>=0;e=$w(t,e))vi(n,Uw(t),!0)}function Ww(n,t){return t>=n.expandoStartIndex}function Kw(n,t,e,i){const r=n.data;if(null===r[e+1]){const s=r[Mn()],o=Ww(n,e);Zw(s,i)&&null===t&&!o&&(t=!1),t=function X5(n,t,e,i){const r=function _0(n){const t=Ce.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let s=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(e=Du(e=Hv(null,n,t,e,i),t.attrs,i),s=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==r)if(e=Hv(r,n,t,e,i),null===s){let l=function J5(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==Rl(i))return n[na(i)]}(n,t,i);void 0!==l&&Array.isArray(l)&&(l=Hv(null,n,t,l[1],i),l=Du(l,t.attrs,i),function eG(n,t,e,i){n[na(e?t.classBindings:t.styleBindings)]=i}(n,t,i,l))}else s=function tG(n,t,e){let i;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)i=Du(i,n[s].hostAttrs,e);return Du(i,t.attrs,e)}(n,t,i)}return void 0!==s&&(i?t.residualClasses=s:t.residualStyles=s),e}(r,s,t,i),function j5(n,t,e,i,r,s){let o=s?t.classBindings:t.styleBindings,a=na(o),l=Rl(o);n[i]=e;let u,c=!1;if(Array.isArray(e)?(u=e[1],(null===u||Dc(e,u)>0)&&(c=!0)):u=e,r)if(0!==l){const f=na(n[a+1]);n[i+1]=Ph(f,a),0!==f&&(n[f+1]=$v(n[f+1],i)),n[a+1]=function $5(n,t){return 131071&n|t<<17}(n[a+1],i)}else n[i+1]=Ph(a,0),0!==a&&(n[a+1]=$v(n[a+1],i)),a=i;else n[i+1]=Ph(l,0),0===a?a=i:n[l+1]=$v(n[l+1],i),l=i;c&&(n[i+1]=Uv(n[i+1])),Bw(n,u,i,!0),Bw(n,u,i,!1),function H5(n,t,e,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof t&&Dc(s,t)>=0&&(e[i+1]=Vv(e[i+1]))}(t,u,n,i,s),o=Ph(a,l),s?t.classBindings=o:t.styleBindings=o}(r,s,t,e,o,i)}}function Hv(n,t,e,i,r){let s=null;const o=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<o&&(s=t[a],i=Du(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(e.directiveStylingLast=a),i}function Du(n,t,e){const i=e?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),vi(n,o,!!e||t[++s]))}return void 0===n?null:n}function iG(n,t,e){const i=String(t);""!==i&&!i.includes(" ")&&vi(n,i,e)}function Yw(n,t,e,i,r,s,o,a){if(!(3&t.type))return;const l=n.data,c=l[a+1],u=function V5(n){return!(1&~n)}(c)?Qw(l,t,e,r,Rl(c),o):void 0;Lh(u)||(Lh(s)||function U5(n){return!(2&~n)}(c)&&(s=Qw(l,null,e,r,a,o)),function k3(n,t,e,i,r){if(t)r?n.addClass(e,i):n.removeClass(e,i);else{let s=-1===i.indexOf("-")?void 0:Zs.DashCase;null==r?n.removeStyle(e,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Zs.Important),n.setStyle(e,i,r,s))}}(i,o,Wa(Mn(),e),r,s))}function Qw(n,t,e,i,r,s){const o=null===t;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let f=e[r+1];f===Ae&&(f=d?Xe:void 0);let h=d?jm(f,i):u===i?f:void 0;if(c&&!Lh(h)&&(h=jm(l,i)),Lh(h)&&(a=h,o))return a;const p=n[r+1];r=o?na(p):Rl(p)}if(null!==t){let l=s?t.residualClasses:t.residualStyles;null!=l&&(a=jm(l,i))}return a}function Lh(n){return void 0!==n}function Zw(n,t){return!!(n.flags&(t?8:16))}function D(n,t,e,i){const r=L(),s=Ee(),o=26+n,a=r[11],l=s.firstCreatePass?vI(o,s,r,t,k_,h0(),e,i):s.data[o],c=tx(s,r,l,a,t,n);r[o]=c;const u=If(l);return fr(l,!0),gC(a,c,l),!Xs(l)&&Mc()&&ph(s,r,c,l),(0===function JB(){return Ce.lFrame.elementDepthCount}()||u)&&ii(c,r),function eU(){Ce.lFrame.elementDepthCount++}(),u&&(fh(s,r,l),m_(s,l,r)),null!==i&&R_(r,l),D}function T(){let n=je();p0()?g0():(n=n.parent,fr(n,!1));const t=n;(function nU(n){return Ce.skipHydrationRootTNode===n})(t)&&function oU(){Ce.skipHydrationRootTNode=null}(),function tU(){Ce.lFrame.elementDepthCount--}();const e=Ee();return e.firstCreatePass&&yI(e,t),null!=t.classesWithoutHost&&function yU(n){return!!(8&n.flags)}(t)&&jv(e,t,L(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function bU(n){return!!(16&n.flags)}(t)&&jv(e,t,L(),t.stylesWithoutHost,!1),T}function U(n,t,e,i){return D(n,t,e,i),T(),U}let tx=(n,t,e,i,r,s)=>(kr(!0),ch(i,r,function eT(){return Ce.lFrame.currentNamespace}()));function Se(){return L()}function Hi(n,t,e){const i=L();return Wt(i,$i(),t)&&si(Ee(),ft(),i,n,t,i[11],e,!0),Hi}const ia=void 0;var AG=["en",[["a","p"],["AM","PM"],ia],[["AM","PM"],ia,ia],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ia,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ia,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ia,"{1} 'at' {0}",ia],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function xG(n){const t=Math.floor(Math.abs(n)),e=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===e?1:5}];let Ol={};function Wn(n){const t=function MG(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=sx(t);if(e)return e;const i=t.split("-")[0];if(e=sx(i),e)return e;if("en"===i)return AG;throw new V(701,!1)}function sx(n){return n in Ol||(Ol[n]=Ht.ng&&Ht.ng.common&&Ht.ng.common.locales&&Ht.ng.common.locales[n]),Ol[n]}var At=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(At||{});const Bh="en-US";let ox=Bh;function Dx(n,t,e){return function i(r){if(r===Function)return e;iu(dr(n)?jn(n.index,t):t,5);const o=t[8];let a=Cx(t,o,e,r),l=i.__ngNextListenerFn__;for(;l;)a=Cx(t,o,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function Cx(n,t,e,i){const r=we(null);try{return!1!==e(i)}catch(s){return function _4(n,t){const e=n[9],i=e?e.get(hr,null):null;i&&i.handleError(t)}(n,s),!1}finally{we(r)}}function Ix(n,t,e,i,r,s){const a=t[1],u=t[e][a.data[e].outputs[i]],d=a.firstCreatePass?u0(a):null,f=c0(t),h=u.subscribe(s),p=f.length;f.push(s,h),d&&d.push(r,n.index,p,-(p+1))}function j(n,t,e,i){const r=L(),s=Ee(),o=je();return Jv(s,r,r[11],o,n,t,i),j}function Jv(n,t,e,i,r,s,o){const a=If(i),c=n.firstCreatePass?u0(n):null,u=c0(t);let d=!0;if(3&i.type||o){const f=Vn(i,t),h=o?o(f):f,p=u.length,g=o?_=>o(Ye(_[i.index])):i.index;let m=null;if(!o&&a&&(m=function v4(n,t,e,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===e&&r[s+1]===i){const a=t[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,t,r,i.index)),null!==m)(m.__ngLastListenerFn__||m).__ngNextListenerFn__=s,m.__ngLastListenerFn__=s,d=!1;else{s=Dx(i,t,s);const _=e.listen(h,r,s);u.push(s,_),c&&c.push(r,g,p,p+1)}}else s=Dx(i,t,s);if(d){const f=i.outputs?.[r],h=i.hostDirectiveOutputs?.[r];if(h&&h.length)for(let p=0;p<h.length;p+=2)Ix(i,t,h[p],h[p+1],r,s);if(f&&f.length)for(const p of f)Ix(i,t,p,r,r,s)}}function A(n=1){return function dU(n){return(Ce.lFrame.contextLView=function jS(n,t){for(;n>0;)t=t[14],n--;return t}(n,Ce.lFrame.contextLView))[8]}(n)}function y4(n,t){let e=null;const i=function t3(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(!(1&e))return t[e+1]}return null}(n);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===i?cC(n,s,!0):r3(i,s))return r}else e=r}return e}function jh(n){const t=L()[15][5];if(!t.projection){const i=t.projection=function _f(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}(n?n.length:1,null),r=i.slice();let s=t.child;for(;null!==s;){if(128!==s.type){const o=n?y4(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s)}s=s.next}}}function Hh(n,t=0,e,i,r,s){const o=L(),a=Ee(),l=i?n+1:null;null!==l&&vu(o,a,l,i,r,s,null,e);const c=gl(a,26+n,16,null,e||null);null===c.projection&&(c.projection=t),g0();const d=!o[6]||jo();null===o[15][5].projection[c.projection]&&null!==l?function b4(n,t,e){const i=26+e,r=t.data[i],s=n[i];pl(s,dl(n,r,void 0,{dehydratedView:null}),0,Yo(r,null))}(o,a,l):d&&!Xs(c)&&function M3(n,t,e){MC(t[11],0,t,e,$_(n,e,t),CC(e.parent||t[5],e,t))}(a,o,c)}function gn(n,t,e,i){!function RI(n,t,e,i){const r=Ee();if(r.firstCreatePass){const s=je();kI(r,new wI(t,e,i),s.index),function C8(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(r,n),!(2&~e)&&(r.staticContentQueries=!0)}return AI(r,L(),e)}(n,t,e,i)}function Hr(n,t,e){!function MI(n,t,e){const i=Ee();return i.firstCreatePass&&(kI(i,new wI(n,t,e),-1),!(2&~t)&&(i.staticViewQueries=!0)),AI(i,L(),t)}(n,t,e)}function gt(n){const t=L(),e=Ee(),i=v0();Rf(i+1);const r=_v(e,i);if(n.dirty&&function QB(n){return!(4&~n[2])}(t)===!(2&~r.metadata.flags)){if(null===r.matches)n.reset([]);else{const s=OI(t,i);n.reset(s,NT),n.notifyOnChanges()}return!0}return!1}function mt(){return function mv(n,t){return n[18].queries[t].queryList}(L(),v0())}function P(n,t=""){const e=L(),i=Ee(),r=n+26,s=i.firstCreatePass?gl(i,r,1,t,null):i.data[r],o=Wx(i,e,s,t,n);e[r]=o,Mc()&&ph(i,e,o,s),fr(s,!1)}let Wx=(n,t,e,i,r)=>(kr(!0),function C_(n,t){return n.createText(t)}(t[11],i));function Le(n){return de("",n,""),Le}function de(n,t,e){const i=L(),r=function Tl(n,t,e,i){return Wt(n,$i(),e)?t+xe(e)+i:Ae}(i,n,t,e);return r!==Ae&&Cs(i,Mn(),r),de}function Ds(n,t,e,i,r){const s=L(),o=function Dl(n,t,e,i,r,s){const a=ea(n,gs(),e,r);return ms(2),a?t+xe(e)+i+xe(r)+s:Ae}(s,n,t,e,i,r);return o!==Ae&&Cs(s,Mn(),o),Ds}function ty(n,t,e,i,r,s,o){const a=L(),l=Cl(a,n,t,e,i,r,s,o);return l!==Ae&&Cs(a,Mn(),l),ty}function ny(n,t,e,i,r,s,o,a,l){const c=L(),u=Il(c,n,t,e,i,r,s,o,a,l);return u!==Ae&&Cs(c,Mn(),u),ny}function Cs(n,t,e){const i=Wa(t,n);!function dC(n,t,e){n.setValue(t,e)}(n[11],i,e)}function Di(n,t,e){LT(t)&&(t=t());const i=L();return Wt(i,$i(),t)&&si(Ee(),ft(),i,n,t,i[11],e,!1),Di}function Gi(n,t){const e=LT(n);return e&&n.set(t),e}function Ci(n,t){const e=L(),i=Ee(),r=je();return Jv(i,e,e[11],r,n,t),Ci}function iy(n,t,e,i,r){if(n=De(n),Array.isArray(n))for(let s=0;s<n.length;s++)iy(n[s],t,e,i,r);else{const s=Ee(),o=L(),a=je();let l=No(n)?n:De(n.provide);const c=wS(n),u=1048575&a.providerIndexes,d=a.directiveStart,f=a.providerIndexes>>20;if(No(n)||!n.multi){const h=new Rc(c,r,F),p=sy(l,t,r?u:u+f,d);-1===p?(x0(Pf(a,o),s,l),ry(s,n,t.length),t.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(h),o.push(h)):(e[p]=h,o[p]=h)}else{const h=sy(l,t,u+f,d),p=sy(l,t,u,u+f),m=p>=0&&e[p];if(r&&!m||!r&&!(h>=0&&e[h])){x0(Pf(a,o),s,l);const _=function V4(n,t,e,i,r){const s=new Rc(n,e,F);return s.multi=[],s.index=t,s.componentProviders=0,eA(s,r,i&&!e),s}(r?$4:U4,e.length,r,i,c);!r&&m&&(e[p].providerFactory=_),ry(s,n,t.length,0),t.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(_),o.push(_)}else ry(s,n,h>-1?h:p,eA(e[r?p:h],c,!r&&i));!r&&i&&m&&e[p].componentProviders++}}}function ry(n,t,e,i){const r=No(t),s=function wB(n){return!!n.useClass}(t);if(r||s){const l=(s?De(t.useClass):t).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&t.multi){const u=c.indexOf(e);-1===u?c.push(e,[i,l]):c[u+1].push(i,l)}else c.push(e,l)}}}function eA(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function sy(n,t,e,i){for(let r=e;r<i;r++)if(t[r]===n)return r;return-1}function U4(n,t,e,i,r){return oy(this.multi,[])}function $4(n,t,e,i,r){const s=this.multi;let o;if(this.providerFactory){const a=this.providerFactory.componentProviders,l=Nc(i,i[1],this.providerFactory.index,r);o=l.slice(0,a),oy(s,o);for(let c=a;c<l.length;c++)o.push(l[c])}else o=[],oy(s,o);return o}function oy(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function St(n,t=[]){return e=>{e.providersResolver=(i,r)=>function B4(n,t,e){const i=Ee();if(i.firstCreatePass){const r=Si(n);iy(e,i.data,i.blueprint,r,!0),iy(t,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,t)}}function ku(n,t){const e=n[t];return e===Ae?void 0:e}function Wh(n,t){const e=Ee();let i;const r=n+26;e.firstCreatePass?(i=function X4(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??=[]).push(r,i.onDestroy)):i=e.data[r];const s=i.factory||(i.factory=ko(i.type)),a=ei(F);try{const l=Nf(!1),c=s();return Nf(l),function r0(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,L(),r,c),c}finally{ei(a)}}function aA(n,t,e){const i=n+26,r=L(),s=Vo(r,i);return Ou(r,i)?function nA(n,t,e,i,r,s){const o=t+e;return Wt(n,o,r)?Br(n,o+1,s?i.call(s,r):i(r)):ku(n,o+1)}(r,Hn(),t,s.transform,e,s):s.transform(e)}function ly(n,t,e,i){const r=n+26,s=L(),o=Vo(s,r);return Ou(s,r)?function iA(n,t,e,i,r,s,o){const a=t+e;return ea(n,a,r,s)?Br(n,a+2,o?i.call(o,r,s):i(r,s)):ku(n,a+2)}(s,Hn(),t,o.transform,e,i,o):o.transform(e,i)}function Ou(n,t){return n[1].data[t].pure}class A6{ngModuleFactory;componentFactories;constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let M6=(()=>{class n{compileModuleSync(e){return new Ev(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const i=this.compileModuleSync(e),s=Lr(yi(e).declarations).reduce((o,a)=>{const l=Ge(a);return l&&o.push(new gu(l)),o},[]);return new A6(i,s)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),O6=(()=>{class n{zone=w($e);changeDetectionScheduler=w(_s);applicationRef=w(ai);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function hy({ngZoneFactory:n,ignoreChangesOutsideZone:t,scheduleInRootZone:e}){return n??=()=>new $e({...py(),scheduleInRootZone:e}),[{provide:$e,useFactory:n},{provide:Fi,multi:!0,useFactory:()=>{const i=w(O6,{optional:!0});return()=>i.initialize()}},{provide:Fi,multi:!0,useFactory:()=>{const i=w(P6);return()=>{i.initialize()}}},!0===t?{provide:CT,useValue:!0}:[],{provide:R0,useValue:e??TT}]}function py(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}let P6=(()=>{class n{subscription=new Pn;initialized=!1;zone=w($e);pendingTasks=w(qs);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{null!==e&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{$e.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Pu=(()=>{class n{appRef=w(ai);taskService=w(qs);ngZone=w($e);zonelessEnabled=w(Pc);tracing=w(Xa,{optional:!0});disableScheduling=w(CT,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Pn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Uf):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(w(R0,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof P0||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&5===e)return;let i=!1;switch(e){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 6:case 13:this.appRef.dirtyFlags|=2,i=!0;break;case 12:this.appRef.dirtyFlags|=16,i=!0;break;case 11:i=!0;break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;const r=this.useMicrotaskScheduler?xT:wT;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>r(()=>this.tick())):this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(e){return!(this.disableScheduling&&!e||this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Uf+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(e),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,xT(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Is=new W("",{providedIn:"root",factory:()=>w(Is,Ue.Optional|Ue.SkipSelf)||function L6(){return typeof $localize<"u"&&$localize.locale||Bh}()}),Qh=new W(""),j6=new W("");function Lu(n){return!n.moduleRef}let MA=(()=>{class n{_injector;_modules=[];_destroyListeners=[];_destroyed=!1;constructor(e){this._injector=e}bootstrapModuleFactory(e,i){const r=i?.scheduleInRootZone,o=i?.ignoreChangesOutsideZone,a=[hy({ngZoneFactory:()=>function WU(n="zone.js",t){return"noop"===n?new P0:"zone.js"===n?new $e(t):n}(i?.ngZone,{...py({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}),scheduleInRootZone:r}),ignoreChangesOutsideZone:o}),{provide:_s,useExisting:Pu}],l=function L8(n,t,e){return new bv(n,t,e,!1)}(e.moduleType,this.injector,a);return function AA(n){const t=Lu(n)?n.r3Injector:n.moduleRef.injector,e=t.get($e);return e.run(()=>{Lu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();const i=t.get(hr,null);let r;if(e.runOutsideAngular(()=>{r=e.onError.subscribe({next:s=>{i.handleError(s)}})}),Lu(n)){const s=()=>t.destroy(),o=n.platformInjector.get(Qh);o.add(s),t.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else{const s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(Qh);o.add(s),n.moduleRef.onDestroy(()=>{Nh(n.allPlatformModules,n.moduleRef),r.unsubscribe(),o.delete(s)})}return function G6(n,t,e){try{const i=e();return bu(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(i,e,()=>{const s=t.get(vw);return s.runInitializers(),s.donePromise.then(()=>{if(function NG(n){"string"==typeof n&&(ox=n.toLowerCase().replace(/_/g,"-"))}(t.get(Is,Bh)||Bh),!t.get(j6,!0))return Lu(n)?t.get(ai):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Lu(n)){const l=t.get(ai);return void 0!==n.rootComponent&&l.bootstrap(n.rootComponent),l}return function H6(n,t){const e=n.injector.get(ai);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>e.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new V(-403,!1);n.instance.ngDoBootstrap(e)}t.push(n)}(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}({moduleRef:l,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(e,i=[]){const r=bw({},i);return function k6(n,t,e){const i=new Ev(e);return Promise.resolve(i)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new V(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(Qh,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static \u0275fac=function(i){return new(i||n)(pe(ht))};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Pl=null;function RA(n,t,e=[]){const i=`Platform: ${t}`,r=new W(i);return(s=[])=>{let o=Zh();if(!o){const a=[...e,...s,{provide:r,useValue:!0}];o=n?.(a)??function z6(n){if(Zh())throw new V(400,!1);(function yw(){!function N2(n){js=n}(()=>{throw new V(600,!1)})})(),Pl=n;const t=n.get(MA);return function OA(n){const t=n.get(j0,null);Bi(n,()=>{t?.forEach(e=>e())})}(n),t}(function kA(n=[],t){return ht.create({name:t,providers:[{provide:Km,useValue:"platform"},{provide:Qh,useValue:new Set([()=>Pl=null])},...n]})}(a,i))}return function W6(){const t=Zh();if(!t)throw new V(401,!1);return t}()}}function Zh(){return Pl?.get(MA)??null}let zi=(()=>class n{static __NG_ELEMENT_ID__=q6})();function q6(n){return function Y6(n,t,e){if(dr(n)&&!e){const i=jn(n.index,t);return new su(i,i)}return 175&n.type?new su(t[15],t):null}(je(),L(),!(16&~n))}class BA{constructor(){}supports(t){return xh(t)}create(t){return new ez(t)}}const J6=(n,t)=>t;class ez{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(t){this._trackByFn=t||J6}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,s=null;for(;e||i;){const o=!i||e&&e.currentIndex<$A(i,r,s)?e:i,a=$A(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let f=0;f<c;f++){const h=f<s.length?s[f]:s[f]=0,p=h+f;u<=p&&p<c&&(s[f]=h+1)}s[o.previousIndex]=u-c}}a!==l&&t(o,a,l)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!xh(t))throw new V(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,s,o,e=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)s=t[a],o=this._trackByFn(a,s),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,s,o,a)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,o,a),i=!0),e=e._next}else r=0,function eH(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Symbol.iterator]();let i;for(;!(i=e.next()).done;)t(i.value)}}(t,a=>{o=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,a,o,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,o,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,r)):t=this._addAfter(new tz(e,i),s,r),t}_verifyReinsertion(t,e,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new UA),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new UA),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class tz{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(t,e){this.item=t,this.trackById=e}}class nz{_head=null;_tail=null;add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class UA{map=new Map;put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new nz,this.map.set(e,i)),i.add(t)}get(t,e){const r=this.map.get(t);return r?r.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $A(n,t,e){const i=n.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}function jA(){return new yy([new BA])}let yy=(()=>{class n{factories;static \u0275prov=z({token:n,providedIn:"root",factory:jA});constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||jA()),deps:[[n,new Vm,new $m]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new V(901,!1)}}return n})();const az=RA(null,"core",[]);let lz=(()=>{class n{constructor(e){}static \u0275fac=function(i){return new(i||n)(pe(ai))};static \u0275mod=bt({type:n});static \u0275inj=dt({})}return n})();function Ll(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function nn(n){return function $2(n){const t=we(null);try{return n()}finally{we(t)}}(n)}function ws(n,t){return function Qd(n,t){const e=Object.create(lr);e.computation=n,void 0!==t&&(e.equal=t);const i=()=>{if(Io(e),Co(e),e.value===Ar)throw e.error;return e.value};return i[un]=e,i}(n,t?.equal)}function Ty(n,t){const e=Ge(n),i=t.elementInjector||Ef();return new gu(e).create(i,t.projectableNodes,t.hostElement,t.environmentInjector)}const rn=new W("");let cM=null;function ro(){return cM}class Xz{}let Dy=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:()=>w(eW),providedIn:"platform"})}return n})();const Jz=new W("");let eW=(()=>{class n extends Dy{_location;_history;_doc=w(rn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ro().getBaseHref(this._doc)}onPopState(e){const i=ro().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=ro().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,r){this._history.pushState(e,i,r)}replaceState(e,i,r){this._history.replaceState(e,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Cy(n,t){return n?t?n.endsWith("/")?t.startsWith("/")?n+t.slice(1):n+t:t.startsWith("/")?n+t:`${n}/${t}`:n:t}function uM(n){const t=n.search(/#|\?|$/);return"/"===n[t-1]?n.slice(0,t-1)+n.slice(t):n}function xs(n){return n&&"?"!==n[0]?`?${n}`:n}let sa=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:()=>w(fM),providedIn:"root"})}return n})();const dM=new W("");let fM=(()=>{class n extends sa{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,i){super(),this._platformLocation=e,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??w(rn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return Cy(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+xs(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${i}${r}`:i}pushState(e,i,r,s){const o=this.prepareExternalUrl(r+xs(s));this._platformLocation.pushState(e,i,o)}replaceState(e,i,r,s){const o=this.prepareExternalUrl(r+xs(s));this._platformLocation.replaceState(e,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(i){return new(i||n)(pe(Dy),pe(dM,8))};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Bu=(()=>{class n{_subject=new ke;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;const i=this._locationStrategy.getBaseHref();this._basePath=function iW(n){if(new RegExp("^(https?:)?//").test(n)){const[,e]=n.split(/\/\/[^\/]+/);return e}return n}(uM(hM(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+xs(i))}normalize(e){return n.stripTrailingSlash(function nW(n,t){if(!n||!t.startsWith(n))return t;const e=t.substring(n.length);return""===e||["/",";","?","#"].includes(e[0])?e:t}(this._basePath,hM(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",r=null){this._locationStrategy.pushState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+xs(i)),r)}replaceState(e,i="",r=null){this._locationStrategy.replaceState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+xs(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(r=>r(e,i))}subscribe(e,i,r){return this._subject.subscribe({next:e,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=xs;static joinWithSlash=Cy;static stripTrailingSlash=uM;static \u0275fac=function(i){return new(i||n)(pe(sa))};static \u0275prov=z({token:n,factory:()=>function tW(){return new Bu(pe(sa))}(),providedIn:"root"})}return n})();function hM(n){return n.replace(/\/index.html$/,"")}function pM(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,s]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(s)}return null}function mM(n){return"server"===n}class _M{}let sW=(()=>{class n extends sa{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,i){super(),this._platformLocation=e,null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){const i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=Cy(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,r,s){const o=this.prepareExternalUrl(r+xs(s))||this._platformLocation.pathname;this._platformLocation.pushState(e,i,o)}replaceState(e,i,r,s){const o=this.prepareExternalUrl(r+xs(s))||this._platformLocation.pathname;this._platformLocation.replaceState(e,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(i){return new(i||n)(pe(Dy),pe(dM,8))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();var qn=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(qn||{}),Tt=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(Tt||{}),Ii=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Ii||{});function op(n,t){return Ki(Wn(n)[At.DateFormat],t)}function ap(n,t){return Ki(Wn(n)[At.TimeFormat],t)}function lp(n,t){return Ki(Wn(n)[At.DateTimeFormat],t)}function Wi(n,t){const e=Wn(n),i=e[At.NumberSymbols][t];if(typeof i>"u"){if(12===t)return e[At.NumberSymbols][0];if(13===t)return e[At.NumberSymbols][1]}return i}function yM(n){if(!n[At.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[At.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ki(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function wy(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const yW=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,cp={},bW=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function bM(n,t,e,i){let r=function AW(n){if(TM(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,s=1,o=1]=n.split("-").map(a=>+a);return up(r,s-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let i;if(i=n.match(yW))return function MW(n){const t=new Date(0);let e=0,i=0;const r=n[8]?t.setUTCFullYear:t.setFullYear,s=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,a=Number(n[5]||0)-i,l=Number(n[6]||0),c=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return s.call(t,o,a,l,c),t}(i)}const t=new Date(n);if(!TM(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=As(e,t)||t;let a,o=[];for(;t;){if(a=bW.exec(t),!a){o.push(t);break}{o=o.concat(a.slice(1));const u=o.pop();if(!u)break;t=u}}let l=r.getTimezoneOffset();i&&(l=SM(i,l),r=function xW(n,t){const r=n.getTimezoneOffset();return function wW(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,-1*(SM(t,r)-r))}(r,i));let c="";return o.forEach(u=>{const d=function IW(n){if(Ay[n])return Ay[n];let t;switch(n){case"G":case"GG":case"GGG":t=Mt(3,Tt.Abbreviated);break;case"GGGG":t=Mt(3,Tt.Wide);break;case"GGGGG":t=Mt(3,Tt.Narrow);break;case"y":t=on(0,1,0,!1,!0);break;case"yy":t=on(0,2,0,!0,!0);break;case"yyy":t=on(0,3,0,!1,!0);break;case"yyyy":t=on(0,4,0,!1,!0);break;case"Y":t=pp(1);break;case"YY":t=pp(2,!0);break;case"YYY":t=pp(3);break;case"YYYY":t=pp(4);break;case"M":case"L":t=on(1,1,1);break;case"MM":case"LL":t=on(1,2,1);break;case"MMM":t=Mt(2,Tt.Abbreviated);break;case"MMMM":t=Mt(2,Tt.Wide);break;case"MMMMM":t=Mt(2,Tt.Narrow);break;case"LLL":t=Mt(2,Tt.Abbreviated,qn.Standalone);break;case"LLLL":t=Mt(2,Tt.Wide,qn.Standalone);break;case"LLLLL":t=Mt(2,Tt.Narrow,qn.Standalone);break;case"w":t=xy(1);break;case"ww":t=xy(2);break;case"W":t=xy(1,!0);break;case"d":t=on(2,1);break;case"dd":t=on(2,2);break;case"c":case"cc":t=on(7,1);break;case"ccc":t=Mt(1,Tt.Abbreviated,qn.Standalone);break;case"cccc":t=Mt(1,Tt.Wide,qn.Standalone);break;case"ccccc":t=Mt(1,Tt.Narrow,qn.Standalone);break;case"cccccc":t=Mt(1,Tt.Short,qn.Standalone);break;case"E":case"EE":case"EEE":t=Mt(1,Tt.Abbreviated);break;case"EEEE":t=Mt(1,Tt.Wide);break;case"EEEEE":t=Mt(1,Tt.Narrow);break;case"EEEEEE":t=Mt(1,Tt.Short);break;case"a":case"aa":case"aaa":t=Mt(0,Tt.Abbreviated);break;case"aaaa":t=Mt(0,Tt.Wide);break;case"aaaaa":t=Mt(0,Tt.Narrow);break;case"b":case"bb":case"bbb":t=Mt(0,Tt.Abbreviated,qn.Standalone,!0);break;case"bbbb":t=Mt(0,Tt.Wide,qn.Standalone,!0);break;case"bbbbb":t=Mt(0,Tt.Narrow,qn.Standalone,!0);break;case"B":case"BB":case"BBB":t=Mt(0,Tt.Abbreviated,qn.Format,!0);break;case"BBBB":t=Mt(0,Tt.Wide,qn.Format,!0);break;case"BBBBB":t=Mt(0,Tt.Narrow,qn.Format,!0);break;case"h":t=on(3,1,-12);break;case"hh":t=on(3,2,-12);break;case"H":t=on(3,1);break;case"HH":t=on(3,2);break;case"m":t=on(4,1);break;case"mm":t=on(4,2);break;case"s":t=on(5,1);break;case"ss":t=on(5,2);break;case"S":t=on(6,1);break;case"SS":t=on(6,2);break;case"SSS":t=on(6,3);break;case"Z":case"ZZ":case"ZZZ":t=fp(0);break;case"ZZZZZ":t=fp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=fp(1);break;case"OOOO":case"ZZZZ":case"zzzz":t=fp(2);break;default:return null}return Ay[n]=t,t}(u);c+=d?d(r,e,l):"''"===u?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function up(n,t,e){const i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function As(n,t){const e=function aW(n){return Wn(n)[At.LocaleId]}(n);if(cp[e]??={},cp[e][t])return cp[e][t];let i="";switch(t){case"shortDate":i=op(n,Ii.Short);break;case"mediumDate":i=op(n,Ii.Medium);break;case"longDate":i=op(n,Ii.Long);break;case"fullDate":i=op(n,Ii.Full);break;case"shortTime":i=ap(n,Ii.Short);break;case"mediumTime":i=ap(n,Ii.Medium);break;case"longTime":i=ap(n,Ii.Long);break;case"fullTime":i=ap(n,Ii.Full);break;case"short":const r=As(n,"shortTime"),s=As(n,"shortDate");i=dp(lp(n,Ii.Short),[r,s]);break;case"medium":const o=As(n,"mediumTime"),a=As(n,"mediumDate");i=dp(lp(n,Ii.Medium),[o,a]);break;case"long":const l=As(n,"longTime"),c=As(n,"longDate");i=dp(lp(n,Ii.Long),[l,c]);break;case"full":const u=As(n,"fullTime"),d=As(n,"fullDate");i=dp(lp(n,Ii.Full),[u,d])}return i&&(cp[e][t]=i),i}function dp(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return null!=t&&i in t?t[i]:e})),n}function _r(n,t,e="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,s=e));let o=String(n);for(;o.length<t;)o="0"+o;return i&&(o=o.slice(o.length-t)),s+o}function on(n,t,e=0,i=!1,r=!1){return function(s,o){let a=function SW(n,t){switch(n){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();case 3:return t.getHours();case 4:return t.getMinutes();case 5:return t.getSeconds();case 6:return t.getMilliseconds();case 7:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,s);if((e>0||a>-e)&&(a+=e),3===n)0===a&&-12===e&&(a=12);else if(6===n)return function EW(n,t){return _r(n,3).substring(0,t)}(a,t);const l=Wi(o,5);return _r(a,t,l,i,r)}}function Mt(n,t,e=qn.Format,i=!1){return function(r,s){return function TW(n,t,e,i,r,s){switch(e){case 2:return function uW(n,t,e){const i=Wn(n),s=Ki([i[At.MonthsFormat],i[At.MonthsStandalone]],t);return Ki(s,e)}(t,r,i)[n.getMonth()];case 1:return function cW(n,t,e){const i=Wn(n),s=Ki([i[At.DaysFormat],i[At.DaysStandalone]],t);return Ki(s,e)}(t,r,i)[n.getDay()];case 0:const o=n.getHours(),a=n.getMinutes();if(s){const c=function pW(n){const t=Wn(n);return yM(t),(t[At.ExtraData][2]||[]).map(i=>"string"==typeof i?wy(i):[wy(i[0]),wy(i[1])])}(t),u=function gW(n,t,e){const i=Wn(n);yM(i);const s=Ki([i[At.ExtraData][0],i[At.ExtraData][1]],t)||[];return Ki(s,e)||[]}(t,r,i),d=c.findIndex(f=>{if(Array.isArray(f)){const[h,p]=f,g=o>=h.hours&&a>=h.minutes,m=o<p.hours||o===p.hours&&a<p.minutes;if(h.hours<p.hours){if(g&&m)return!0}else if(g||m)return!0}else if(f.hours===o&&f.minutes===a)return!0;return!1});if(-1!==d)return u[d]}return function lW(n,t,e){const i=Wn(n),s=Ki([i[At.DayPeriodsFormat],i[At.DayPeriodsStandalone]],t);return Ki(s,e)}(t,r,i)[o<12?0:1];case 3:return function dW(n,t){return Ki(Wn(n)[At.Eras],t)}(t,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,s,n,t,e,i)}}function fp(n){return function(t,e,i){const r=-1*i,s=Wi(e,5),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+_r(o,2,s)+_r(Math.abs(r%60),2,s);case 1:return"GMT"+(r>=0?"+":"")+_r(o,1,s);case 2:return"GMT"+(r>=0?"+":"")+_r(o,2,s)+":"+_r(Math.abs(r%60),2,s);case 3:return 0===i?"Z":(r>=0?"+":"")+_r(o,2,s)+":"+_r(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}const DW=0,hp=4;function EM(n){const t=n.getDay(),e=0===t?-3:hp-t;return up(n.getFullYear(),n.getMonth(),n.getDate()+e)}function xy(n,t=!1){return function(e,i){let r;if(t){const s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();r=1+Math.floor((o+s)/7)}else{const s=EM(e),o=function CW(n){const t=up(n,DW,1).getDay();return up(n,0,1+(t<=hp?hp:hp+7)-t)}(s.getFullYear()),a=s.getTime()-o.getTime();r=1+Math.round(a/6048e5)}return _r(r,n,Wi(i,5))}}function pp(n,t=!1){return function(e,i){return _r(EM(e).getFullYear(),n,Wi(i,5),t)}}const Ay={};function SM(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function TM(n){return n instanceof Date&&!isNaN(n.valueOf())}class GW{$implicit;ngForOf;index;count;constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let vr=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new GW(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),AM(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{AM(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}static \u0275fac=function(i){return new(i||n)(F(Ti),F(tn),F(yy))};static \u0275dir=ne({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function AM(n,t){n.context.$implicit=t.item}let ci=(()=>{class n{_viewContainer;_context=new zW;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(e,i){this._viewContainer=e,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){MM(e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){MM(e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(e,i){return!0}static \u0275fac=function(i){return new(i||n)(F(Ti),F(tn))};static \u0275dir=ne({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})();class zW{$implicit=null;ngIf=null}function MM(n,t){if(n&&!n.createEmbeddedView)throw new V(2020,!1)}function yr(n,t){return new V(2100,!1)}const nK=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g;let kM=(()=>{class n{transform(e){if(null==e)return null;if("string"!=typeof e)throw yr();return e.replace(nK,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=oi({name:"titlecase",type:n,pure:!0})}return n})();const sK=new W(""),oK=new W("");let By=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,s){if(null==e||""===e||e!=e)return null;try{return bM(e,i??this.defaultOptions?.dateFormat??"mediumDate",s||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(o){throw yr()}}static \u0275fac=function(i){return new(i||n)(F(Is,16),F(sK,24),F(oK,24))};static \u0275pipe=oi({name:"date",type:n,pure:!0})}return n})(),NM=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=bt({type:n});static \u0275inj=dt({})}return n})();const Vy=new W("");let PM=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,i){this._zone=i,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r,s){return this._findPluginFor(i).addEventListener(e,i,r,s)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(s=>s.supports(e)),!i)throw new V(5101,!1);return this._eventNameToPlugin.set(e,i),i}static \u0275fac=function(i){return new(i||n)(pe(Vy),pe($e))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();class LM{_doc;constructor(t){this._doc=t}manager}const mp="ng-app-id";function FM(n){for(const t of n)t.remove()}function BM(n,t){const e=t.createElement("style");return e.textContent=n,e}function jy(n,t){const e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",n),e}let UM=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(e,i,r,s={}){this.doc=e,this.appId=i,this.nonce=r,this.isServer=mM(s),function mK(n,t,e,i){const r=n.head?.querySelectorAll(`style[${mp}="${t}"],link[${mp}="${t}"]`);if(r)for(const s of r)s.removeAttribute(mp),s instanceof HTMLLinkElement?i.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&e.set(s.textContent,{usage:0,elements:[s]})}(e,i,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,i){for(const r of e)this.addUsage(r,this.inline,BM);i?.forEach(r=>this.addUsage(r,this.external,jy))}removeStyles(e,i){for(const r of e)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(e,i,r){const s=i.get(e);s?s.usage++:i.set(e,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,r(e,this.doc)))})}removeUsage(e,i){const r=i.get(e);r&&(r.usage--,r.usage<=0&&(FM(r.elements),i.delete(e)))}ngOnDestroy(){for(const[,{elements:e}]of[...this.inline,...this.external])FM(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(const[i,{elements:r}]of this.inline)r.push(this.addElement(e,BM(i,this.doc)));for(const[i,{elements:r}]of this.external)r.push(this.addElement(e,jy(i,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,i){return this.nonce&&i.setAttribute("nonce",this.nonce),this.isServer&&i.setAttribute(mp,this.appId),e.appendChild(i)}static \u0275fac=function(i){return new(i||n)(pe(rn),pe(vs),pe(eD,8),pe(H0))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();const Hy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Gy=/%COMP%/g,SK=new W("",{providedIn:"root",factory:()=>!0});function VM(n,t){return t.map(e=>e.replace(Gy,n))}let jM=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,i,r,s,o,a,l,c=null,u=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.tracingService=u,this.platformIsServer=mM(a),this.defaultRenderer=new zy(e,o,l,this.platformIsServer,this.tracingService)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Vi.ShadowDom&&(i={...i,encapsulation:Vi.Emulated});const r=this.getOrCreateRenderer(e,i);return r instanceof GM?r.applyToHost(e):r instanceof Wy&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,f=this.tracingService;switch(i.encapsulation){case Vi.Emulated:s=new GM(l,c,i,this.appId,u,o,a,d,f);break;case Vi.ShadowDom:return new IK(l,c,e,i,o,a,this.nonce,d,f);default:s=new Wy(l,c,i,u,o,a,d,f)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(i){return new(i||n)(pe(PM),pe(UM),pe(vs),pe(SK),pe(rn),pe(H0),pe($e),pe(eD),pe(Xa,8))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();class zy{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,i,r,s){this.eventManager=t,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.tracingService=s}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(Hy[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(HM(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(HM(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){e.remove()}selectRootElement(t,e){let i="string"==typeof t?this.doc.querySelector(t):t;if(!i)throw new V(-5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const s=Hy[r];s?t.setAttributeNS(s,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=Hy[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(Zs.DashCase|Zs.Important)?t.style.setProperty(e,i,r&Zs.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&Zs.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){null!=t&&(t[e]=i)}setValue(t,e){t.nodeValue=e}listen(t,e,i,r){if("string"==typeof t&&!(t=ro().getGlobalEventTarget(this.doc,t)))throw new V(5102,!1);let s=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(t,e,s)),this.eventManager.addEventListener(t,e,s,r)}decoratePreventDefault(t){return e=>{if("__ngUnwrap__"===e)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))&&e.preventDefault()}}}function HM(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class IK extends zy{sharedStylesHost;hostEl;shadowRoot;constructor(t,e,i,r,s,o,a,l,c){super(t,s,o,l,c),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=r.styles;u=VM(r.id,u);for(const f of u){const h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=f,this.shadowRoot.appendChild(h)}const d=r.getExternalStyles?.();if(d)for(const f of d){const h=jy(f,s);a&&h.setAttribute("nonce",a),this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Wy extends zy{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,i,r,s,o,a,l,c){super(t,s,o,a,l),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r;let u=i.styles;this.styles=c?VM(c,u):u,this.styleUrls=i.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class GM extends Wy{contentAttr;hostAttr;constructor(t,e,i,r,s,o,a,l,c){const u=r+"-"+i.id;super(t,e,i,s,o,a,l,c,u),this.contentAttr=function TK(n){return"_ngcontent-%COMP%".replace(Gy,n)}(u),this.hostAttr=function DK(n){return"_nghost-%COMP%".replace(Gy,n)}(u)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class Ky extends Xz{supportsDOMEvents=!0;static makeCurrent(){!function Zz(n){cM??=n}(new Ky)}onAndCancel(t,e,i,r){return t.addEventListener(e,i,r),()=>{t.removeEventListener(e,i,r)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function wK(){return Vu=Vu||document.head.querySelector("base"),Vu?Vu.getAttribute("href"):null}();return null==e?null:function xK(n){return new URL(n,document.baseURI).pathname}(e)}resetBaseElement(){Vu=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return pM(document.cookie,t)}}let Vu=null,MK=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})(),RK=(()=>{class n extends LM{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r,s){return e.addEventListener(i,r,s),()=>this.removeEventListener(e,i,r,s)}removeEventListener(e,i,r,s){return e.removeEventListener(i,r,s)}static \u0275fac=function(i){return new(i||n)(pe(rn))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();const zM=["alt","control","meta","shift"],kK={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},OK={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let NK=(()=>{class n extends LM{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r,s){const o=n.parseEventName(i),a=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ro().onAndCancel(e,o.domEventName,a,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),zM.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(e,i){let r=kK[e.key]||e.key,s="";return i.indexOf("code.")>-1&&(r=e.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),zM.forEach(o=>{o!==r&&(0,OK[o])(e)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(e,i,r){return s=>{n.matchEventFullKeyCode(s,e)&&r.runGuarded(()=>i(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}static \u0275fac=function(i){return new(i||n)(pe(rn))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();const KM=[{provide:H0,useValue:"browser"},{provide:j0,useValue:function PK(){Ky.makeCurrent()},multi:!0},{provide:rn,useFactory:function FK(){return function b$(n){V0=n}(document),document}}],BK=RA(az,"browser",KM),qM=[{provide:Oh,useClass:class AK{addToWindow(t){Ht.getAngularTestability=(i,r=!0)=>{const s=t.findTestabilityInTree(i,r);if(null==s)throw new V(5103,!1);return s},Ht.getAllAngularTestabilities=()=>t.getAllTestabilities(),Ht.getAllAngularRootElements=()=>t.getAllRootElements(),Ht.frameworkStabilizers||(Ht.frameworkStabilizers=[]),Ht.frameworkStabilizers.push(i=>{const r=Ht.getAllAngularTestabilities();let s=r.length;const o=function(){s--,0==s&&i()};r.forEach(a=>{a.whenStable(o)})})}findTestabilityInTree(t,e,i){return null==e?null:t.getTestability(e)??(i?ro().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}}},{provide:hw,useClass:kv,deps:[$e,Ov,Oh]},{provide:kv,useClass:kv,deps:[$e,Ov,Oh]}],YM=[{provide:Km,useValue:"root"},{provide:hr,useFactory:function LK(){return new hr}},{provide:Vy,useClass:RK,multi:!0,deps:[rn]},{provide:Vy,useClass:NK,multi:!0,deps:[rn]},jM,UM,PM,{provide:rv,useExisting:jM},{provide:_M,useClass:MK},[]];let UK=(()=>{class n{constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275mod=bt({type:n});static \u0275inj=dt({providers:[...YM,...qM],imports:[NM,lz]})}return n})();function so(n){return this instanceof so?(this.v=n,this):new so(n)}function JM(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function Zy(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(s){e[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const Jy=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function eR(n){return Ze(n?.then)}function tR(n){return Ze(n[wm])}function nR(n){return Symbol.asyncIterator&&Ze(n?.[Symbol.asyncIterator])}function iR(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const rR=function fq(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function sR(n){return Ze(n?.[rR])}function oR(n){return function XM(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(n,t||[]),s=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function o(h){return function(p){return Promise.resolve(p).then(h,d)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(h,p){i[h]&&(r[h]=function(g){return new Promise(function(m,_){s.push([h,g,m,_])>1||l(h,g)})},p&&(r[h]=p(r[h])))}function l(h,p){try{!function c(h){h.value instanceof so?Promise.resolve(h.value.v).then(u,d):f(s[0][2],h)}(i[h](p))}catch(g){f(s[0][3],g)}}function u(h){l("next",h)}function d(h){l("throw",h)}function f(h,p){h(p),s.shift(),s.length&&l(s[0][0],s[0][1])}}(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:r}=yield so(e.read());if(r)return yield so(void 0);yield yield so(i)}}finally{e.releaseLock()}})}function aR(n){return Ze(n?.getReader)}function Dn(n){if(n instanceof wt)return n;if(null!=n){if(tR(n))return function hq(n){return new wt(t=>{const e=n[wm]();if(Ze(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Jy(n))return function pq(n){return new wt(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(eR(n))return function gq(n){return new wt(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,JE)})}(n);if(nR(n))return lR(n);if(sR(n))return function mq(n){return new wt(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(aR(n))return function _q(n){return lR(oR(n))}(n)}throw iR(n)}function lR(n){return new wt(t=>{(function vq(n,t){var e,i,r,s;return function QM(n,t,e,i){return new(e||(e=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof e?s:new e(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=JM(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Oe(n){return Qt((t,e)=>{Dn(n).subscribe(yt(e,()=>e.complete(),Ec)),!e.closed&&t.subscribe(e)})}function et(n,t,e){const i=Ze(n)||t||e?{next:n,error:t,complete:e}:n;return i?Qt((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(yt(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):as}var qi_app={menuSearch:{en:"Search",es:"Buscar",de:"Suche",fr:"Rechercher",ru:"\u041f\u043e\u0438\u0441\u043a",pt:"Pesquisar",it:"Cerca",pl:"Szukaj",ua:"\u041f\u043e\u0448\u0443\u043a",nl:"Zoeken",ja:"\u691c\u7d22",ko:"\uac80\uc0c9",zh:"\u641c\u7d22",tr:"Ara",id:"Cari",vi:"T\xecm ki\u1ebfm"},menuSubscriptions:{en:"Subscriptions",es:"Suscripciones",de:"Abonnements",fr:"Abonnements",ru:"\u041f\u043e\u0434\u043f\u0438\u0441\u043a\u0438",pt:"Inscri\xe7\xf5es",it:"Iscrizioni",pl:"Subskrypcje",ua:"\u041f\u0456\u0434\u043f\u0438\u0441\u043a\u0438",nl:"Abonnementen",ja:"\u767b\u9332\u30c1\u30e3\u30f3\u30cd\u30eb",ko:"\uad6c\ub3c5",zh:"\u8ba2\u9605",tr:"Abonelikler",id:"Langganan",vi:"\u0110\u0103ng k\xfd"},menuStarred:{en:"Starred",es:"Favoritos",de:"Mit Stern",fr:"Favoris",ru:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435",pt:"Favoritos",it:"Preferiti",pl:"Oznaczone gwiazdk\u0105",ua:"\u041e\u0431\u0440\u0430\u043d\u0435",nl:"Met ster",ja:"\u30b9\u30bf\u30fc\u4ed8\u304d",ko:"\ubcc4\ud45c",zh:"\u5df2\u52a0\u661f\u6807",tr:"Y\u0131ld\u0131zl\u0131",id:"Berbintang",vi:"\u0110\xe1nh d\u1ea5u sao"},menuWatchLater:{en:"Watch Later",es:"Ver m\xe1s tarde",de:"Sp\xe4ter ansehen",fr:"\xc0 regarder plus tard",ru:"\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043f\u043e\u0437\u0436\u0435",pt:"Assistir mais tarde",it:"Guarda pi\xf9 tardi",pl:"Obejrzyj p\xf3\u017aniej",ua:"\u041f\u0435\u0440\u0435\u0433\u043b\u044f\u043d\u0443\u0442\u0438 \u043f\u0456\u0437\u043d\u0456\u0448\u0435",nl:"Later bekijken",ja:"\u5f8c\u3067\u898b\u308b",ko:"\ub098\uc911\uc5d0 \ubcfc \ub3d9\uc601\uc0c1",zh:"\u7a0d\u540e\u89c2\u770b",tr:"Daha Sonra \u0130zle",id:"Tonton Nanti",vi:"Xem sau"},menuSettings:{en:"Settings",es:"Configuraci\xf3n",de:"Einstellungen",fr:"Param\xe8tres",ru:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",pt:"Configura\xe7\xf5es",it:"Impostazioni",pl:"Ustawienia",ua:"\u041d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f",nl:"Instellingen",ja:"\u8a2d\u5b9a",ko:"\uc124\uc815",zh:"\u8bbe\u7f6e",tr:"Ayarlar",id:"Pengaturan",vi:"C\xe0i \u0111\u1eb7t"},menuManage:{en:"Manage",es:"Administrar",de:"Verwalten",fr:"G\xe9rer",ru:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435",pt:"Gerenciar",it:"Gestisci",pl:"Zarz\u0105dzaj",ua:"\u041a\u0435\u0440\u0443\u0432\u0430\u0442\u0438",nl:"Beheren",ja:"\u7ba1\u7406",ko:"\uad00\ub9ac",zh:"\u7ba1\u7406",tr:"Y\xf6net",id:"Kelola",vi:"Qu\u1ea3n l\xfd"},playerPause:{en:"Pause",es:"Pausar",de:"Pausieren",fr:"Pause",ru:"\u041f\u0430\u0443\u0437\u0430",pt:"Pausar",it:"Pausa",pl:"Wstrzymaj",ua:"\u041f\u0430\u0443\u0437\u0430",nl:"Pauzeren",ja:"\u4e00\u6642\u505c\u6b62",ko:"\uc77c\uc2dc\uc911\uc9c0",zh:"\u6682\u505c",tr:"Duraklat",id:"Jeda",vi:"T\u1ea1m d\u1eebng"},playerPlay:{en:"Play",es:"Reproducir",de:"Abspielen",fr:"Lecture",ru:"\u0412\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438",pt:"Reproduzir",it:"Riproduci",pl:"Odtw\xf3rz",ua:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438",nl:"Afspelen",ja:"\u518d\u751f",ko:"\uc7ac\uc0dd",zh:"\u64ad\u653e",tr:"Oynat",id:"Putar",vi:"Ph\xe1t"},playerShow:{en:"Show Player",es:"Mostrar reproductor",de:"Player anzeigen",fr:"Afficher le lecteur",ru:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u043b\u0435\u0435\u0440",pt:"Mostrar player",it:"Mostra player",pl:"Poka\u017c odtwarzacz",ua:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u0438 \u043f\u043b\u0435\u0454\u0440",nl:"Speler tonen",ja:"\u30d7\u30ec\u30fc\u30e4\u30fc\u3092\u8868\u793a",ko:"\ud50c\ub808\uc774\uc5b4 \ud45c\uc2dc",zh:"\u663e\u793a\u64ad\u653e\u5668",tr:"Oynat\u0131c\u0131y\u0131 G\xf6ster",id:"Tampilkan Pemutar",vi:"Hi\u1ec7n tr\xecnh ph\xe1t"}},qi_channel={tabVideos:{en:"Videos",es:"V\xeddeos",de:"Videos",fr:"Vid\xe9os",ru:"\u0412\u0438\u0434\u0435\u043e",pt:"V\xeddeos",it:"Video",pl:"Filmy",ua:"\u0412\u0456\u0434\u0435\u043e",nl:"Video's",ja:"\u52d5\u753b",ko:"\ub3d9\uc601\uc0c1",zh:"\u89c6\u9891",tr:"Videolar",id:"Video",vi:"Video"},tabPlaylists:{en:"Playlists",es:"Listas de reproducci\xf3n",de:"Playlists",fr:"Listes de lecture",ru:"\u041f\u043b\u0435\u0439\u043b\u0438\u0441\u0442\u044b",pt:"Playlists",it:"Playlist",pl:"Playlisty",ua:"\u041f\u043b\u0435\u0439\u043b\u0438\u0441\u0442\u0438",nl:"Afspeellijsten",ja:"\u518d\u751f\u30ea\u30b9\u30c8",ko:"\uc7ac\uc0dd\ubaa9\ub85d",zh:"\u64ad\u653e\u5217\u8868",tr:"Oynatma Listeleri",id:"Daftar Putar",vi:"Danh s\xe1ch ph\xe1t"},videosCount:{en:"videos",es:"v\xeddeos",de:"Videos",fr:"vid\xe9os",ru:"\u0432\u0438\u0434\u0435\u043e",pt:"v\xeddeos",it:"video",pl:"filmy",ua:"\u0432\u0456\u0434\u0435\u043e",nl:"video's",ja:"\u52d5\u753b",ko:"\ub3d9\uc601\uc0c1",zh:"\u89c6\u9891",tr:"video",id:"video",vi:"video"},playAll:{en:"Play All",es:"Reproducir todo",de:"Alle abspielen",fr:"Tout lire",ru:"\u0412\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0451",pt:"Reproduzir tudo",it:"Riproduci tutto",pl:"Odtw\xf3rz wszystko",ua:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0432\u0441\u0435",nl:"Alles afspelen",ja:"\u3059\u3079\u3066\u518d\u751f",ko:"\ubaa8\ub450 \uc7ac\uc0dd",zh:"\u64ad\u653e\u5168\u90e8",tr:"T\xfcm\xfcn\xfc Oynat",id:"Putar Semua",vi:"Ph\xe1t t\u1ea5t c\u1ea3"},noVideos:{en:"No videos found for this channel.",es:"No se encontraron v\xeddeos para este canal.",de:"Keine Videos f\xfcr diesen Kanal gefunden.",fr:"Aucune vid\xe9o trouv\xe9e pour cette cha\xeene.",ru:"\u0412\u0438\u0434\u0435\u043e \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043a\u0430\u043d\u0430\u043b\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b.",pt:"Nenhum v\xeddeo encontrado para este canal.",it:"Nessun video trovato per questo canale.",pl:"Nie znaleziono film\xf3w dla tego kana\u0142u.",ua:"\u0412\u0456\u0434\u0435\u043e \u0434\u043b\u044f \u0446\u044c\u043e\u0433\u043e \u043a\u0430\u043d\u0430\u043b\u0443 \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u043e.",nl:"Geen video's gevonden voor dit kanaal.",ja:"\u3053\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u306e\u52d5\u753b\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002",ko:"\uc774 \ucc44\ub110\uc758 \ub3d9\uc601\uc0c1\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",zh:"\u672a\u627e\u5230\u6b64\u9891\u9053\u7684\u89c6\u9891\u3002",tr:"Bu kanal i\xe7in video bulunamad\u0131.",id:"Tidak ada video yang ditemukan untuk saluran ini.",vi:"Kh\xf4ng t\xecm th\u1ea5y video n\xe0o cho k\xeanh n\xe0y."},loadMore:{en:"Load More",es:"Cargar m\xe1s",de:"Mehr laden",fr:"Charger plus",ru:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0451",pt:"Carregar mais",it:"Carica altro",pl:"Za\u0142aduj wi\u0119cej",ua:"Load More",nl:"Meer laden",ja:"\u3082\u3063\u3068\u8aad\u307f\u8fbc\u3080",ko:"\ub354 \ubcf4\uae30",zh:"\u52a0\u8f7d\u66f4\u591a",tr:"Daha Fazla Y\xfckle",id:"Muat Lebih Banyak",vi:"T\u1ea3i th\xeam"},loading:{en:"Loading...",es:"Cargando...",de:"Laden...",fr:"Chargement...",ru:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",pt:"Carregando...",it:"Caricamento...",pl:"\u0141adowanie...",ua:"Loading...",nl:"Laden...",ja:"\u8aad\u307f\u8fbc\u307f\u4e2d...",ko:"\ub85c\ub529 \uc911...",zh:"\u52a0\u8f7d\u4e2d...",tr:"Y\xfckleniyor...",id:"Memuat...",vi:"\u0110ang t\u1ea3i..."},noPlaylists:{en:"No playlists found for this channel.",es:"No se encontraron listas de reproducci\xf3n para este canal.",de:"Keine Playlists f\xfcr diesen Kanal gefunden.",fr:"Aucune liste de lecture trouv\xe9e pour cette cha\xeene.",ru:"\u041f\u043b\u0435\u0439\u043b\u0438\u0441\u0442\u044b \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043a\u0430\u043d\u0430\u043b\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b.",pt:"Nenhuma playlist encontrada para este canal.",it:"Nessuna playlist trovata per questo canale.",pl:"Nie znaleziono playlist dla tego kana\u0142u.",ua:"No playlists found for this channel.",nl:"Geen afspeellijsten gevonden voor dit kanaal.",ja:"\u3053\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u306e\u518d\u751f\u30ea\u30b9\u30c8\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002",ko:"\uc774 \ucc44\ub110\uc758 \uc7ac\uc0dd\ubaa9\ub85d\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",zh:"\u672a\u627e\u5230\u6b64\u9891\u9053\u7684\u64ad\u653e\u5217\u8868\u3002",tr:"Bu kanal i\xe7in oynatma listesi bulunamad\u0131.",id:"Tidak ada daftar putar yang ditemukan untuk saluran ini.",vi:"Kh\xf4ng t\xecm th\u1ea5y danh s\xe1ch ph\xe1t n\xe0o cho k\xeanh n\xe0y."}},qi_search={pageTitle:{en:"Search Videos",es:"Buscar v\xeddeos",de:"Videos suchen",fr:"Rechercher des vid\xe9os",ru:"\u041f\u043e\u0438\u0441\u043a \u0432\u0438\u0434\u0435\u043e",pt:"Pesquisar v\xeddeos",it:"Cerca video",pl:"Szukaj film\xf3w",ua:"Search Videos",nl:"Video's zoeken",ja:"\u52d5\u753b\u3092\u691c\u7d22",ko:"\ub3d9\uc601\uc0c1 \uac80\uc0c9",zh:"\u641c\u7d22\u89c6\u9891",tr:"Video Ara",id:"Cari Video",vi:"T\xecm ki\u1ebfm video"},inputPlaceholder:{en:"Search for videos...",es:"Buscar v\xeddeos...",de:"Nach Videos suchen...",fr:"Rechercher des vid\xe9os...",ru:"\u0418\u0441\u043a\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e...",pt:"Pesquisar v\xeddeos...",it:"Cerca video...",pl:"Szukaj film\xf3w...",ua:"Search for videos...",nl:"Zoek video's...",ja:"\u52d5\u753b\u3092\u691c\u7d22...",ko:"\ub3d9\uc601\uc0c1 \uac80\uc0c9...",zh:"\u641c\u7d22\u89c6\u9891...",tr:"Video ara...",id:"Cari video...",vi:"T\xecm ki\u1ebfm video..."},btnSearch:{en:"Search",es:"Buscar",de:"Suchen",fr:"Rechercher",ru:"\u0418\u0441\u043a\u0430\u0442\u044c",pt:"Pesquisar",it:"Cerca",pl:"Szukaj",ua:"\u041f\u043e\u0448\u0443\u043a",nl:"Zoeken",ja:"\u691c\u7d22",ko:"\uac80\uc0c9",zh:"\u641c\u7d22",tr:"Ara",id:"Cari",vi:"T\xecm ki\u1ebfm"},searching:{en:"Searching...",es:"Buscando...",de:"Suche l\xe4uft...",fr:"Recherche en cours...",ru:"\u041f\u043e\u0438\u0441\u043a...",pt:"Pesquisando...",it:"Ricerca in corso...",pl:"Wyszukiwanie...",ua:"Searching...",nl:"Zoeken...",ja:"\u691c\u7d22\u4e2d...",ko:"\uac80\uc0c9 \uc911...",zh:"\u641c\u7d22\u4e2d...",tr:"Aran\u0131yor...",id:"Mencari...",vi:"\u0110ang t\xecm ki\u1ebfm..."},noResults:{en:"No videos found for",es:"No se encontraron v\xeddeos para",de:"Keine Videos gefunden f\xfcr",fr:"Aucune vid\xe9o trouv\xe9e pour",ru:"\u0412\u0438\u0434\u0435\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b \u0434\u043b\u044f",pt:"Nenhum v\xeddeo encontrado para",it:"Nessun video trovato per",pl:"Nie znaleziono film\xf3w dla",ua:"No videos found for",nl:"Geen video's gevonden voor",ja:"\u52d5\u753b\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\uff1a",ko:"\ub3d9\uc601\uc0c1\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4\uff1a",zh:"\u672a\u627e\u5230\u89c6\u9891\uff1a",tr:"Video bulunamad\u0131:",id:"Tidak ada video yang ditemukan untuk",vi:"Kh\xf4ng t\xecm th\u1ea5y video cho"},tryDifferent:{en:"Try a different search term.",es:"Prueba con otro t\xe9rmino de b\xfasqueda.",de:"Versuchen Sie einen anderen Suchbegriff.",fr:"Essayez un autre terme de recherche.",ru:"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441.",pt:"Tente um termo de pesquisa diferente.",it:"Prova con un termine di ricerca diverso.",pl:"Spr\xf3buj innego wyszukiwanego has\u0142a.",ua:"Try a different search term.",nl:"Probeer een andere zoekterm.",ja:"\u5225\u306e\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002",ko:"\ub2e4\ub978 \uac80\uc0c9\uc5b4\ub97c \uc2dc\ub3c4\ud574 \ubcf4\uc138\uc694.",zh:"\u5c1d\u8bd5\u4e0d\u540c\u7684\u641c\u7d22\u8bcd\u3002",tr:"Farkl\u0131 bir arama terimi deneyin.",id:"Coba istilah pencarian yang berbeda.",vi:"Th\u1eed t\u1eeb kh\xf3a t\xecm ki\u1ebfm kh\xe1c."},foundVideos:{en:"Found",es:"Se encontraron",de:"Gefunden",fr:"Trouv\xe9",ru:"\u041d\u0430\u0439\u0434\u0435\u043d\u043e",pt:"Encontrado",it:"Trovato",pl:"Znaleziono",ua:"Found",nl:"Gevonden",ja:"\u898b\u3064\u304b\u308a\u307e\u3057\u305f",ko:"\ucc3e\uc74c",zh:"\u627e\u5230",tr:"Bulundu",id:"Ditemukan",vi:"T\xecm th\u1ea5y"},videosFor:{en:"videos for",es:"v\xeddeos para",de:"Videos f\xfcr",fr:"vid\xe9os pour",ru:"\u0432\u0438\u0434\u0435\u043e \u0434\u043b\u044f",pt:"v\xeddeos para",it:"video per",pl:"filmy dla",ua:"videos for",nl:"video's voor",ja:"\u4ef6\u306e\u52d5\u753b\uff1a",ko:"\uac1c\uc758 \ub3d9\uc601\uc0c1\uff1a",zh:"\u4e2a\u89c6\u9891\uff1a",tr:"video:",id:"video untuk",vi:"video cho"},playAll:{en:"Play All",es:"Reproducir todo",de:"Alle abspielen",fr:"Tout lire",ru:"\u0412\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0451",pt:"Reproduzir tudo",it:"Riproduci tutto",pl:"Odtw\xf3rz wszystko",ua:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0432\u0441\u0435",nl:"Alles afspelen",ja:"\u3059\u3079\u3066\u518d\u751f",ko:"\ubaa8\ub450 \uc7ac\uc0dd",zh:"\u64ad\u653e\u5168\u90e8",tr:"T\xfcm\xfcn\xfc Oynat",id:"Putar Semua",vi:"Ph\xe1t t\u1ea5t c\u1ea3"},loadMore:{en:"Load More",es:"Cargar m\xe1s",de:"Mehr laden",fr:"Charger plus",ru:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0451",pt:"Carregar mais",it:"Carica altro",pl:"Za\u0142aduj wi\u0119cej",ua:"Load More",nl:"Meer laden",ja:"\u3082\u3063\u3068\u8aad\u307f\u8fbc\u3080",ko:"\ub354 \ubcf4\uae30",zh:"\u52a0\u8f7d\u66f4\u591a",tr:"Daha Fazla Y\xfckle",id:"Muat Lebih Banyak",vi:"T\u1ea3i th\xeam"},loading:{en:"Loading...",es:"Cargando...",de:"Laden...",fr:"Chargement...",ru:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",pt:"Carregando...",it:"Caricamento...",pl:"\u0141adowanie...",ua:"Loading...",nl:"Laden...",ja:"\u8aad\u307f\u8fbc\u307f\u4e2d...",ko:"\ub85c\ub529 \uc911...",zh:"\u52a0\u8f7d\u4e2d...",tr:"Y\xfckleniyor...",id:"Memuat...",vi:"\u0110ang t\u1ea3i..."}},qi_subscriptions={pageTitle:{en:"Subscriptions",es:"Suscripciones",de:"Abonnements",fr:"Abonnements",ru:"\u041f\u043e\u0434\u043f\u0438\u0441\u043a\u0438",pt:"Inscri\xe7\xf5es",it:"Iscrizioni",pl:"Subskrypcje",ua:"\u041f\u0456\u0434\u043f\u0438\u0441\u043a\u0438",nl:"Abonnementen",ja:"\u767b\u9332\u30c1\u30e3\u30f3\u30cd\u30eb",ko:"\uad6c\ub3c5",zh:"\u8ba2\u9605",tr:"Abonelikler",id:"Langganan",vi:"\u0110\u0103ng k\xfd"},searchPlaceholder:{en:"Search channels...",es:"Buscar canales...",de:"Kan\xe4le suchen...",fr:"Rechercher des cha\xeenes...",ru:"\u0418\u0441\u043a\u0430\u0442\u044c \u043a\u0430\u043d\u0430\u043b\u044b...",pt:"Pesquisar canais...",it:"Cerca canali...",pl:"Szukaj kana\u0142\xf3w...",ua:"Search channels...",nl:"Zoek kanalen...",ja:"\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u691c\u7d22...",ko:"\ucc44\ub110 \uac80\uc0c9...",zh:"\u641c\u7d22\u9891\u9053...",tr:"Kanal ara...",id:"Cari saluran...",vi:"T\xecm ki\u1ebfm k\xeanh..."},btnSearch:{en:"Search",es:"Buscar",de:"Suchen",fr:"Rechercher",ru:"\u0418\u0441\u043a\u0430\u0442\u044c",pt:"Pesquisar",it:"Cerca",pl:"Szukaj",ua:"\u041f\u043e\u0448\u0443\u043a",nl:"Zoeken",ja:"\u691c\u7d22",ko:"\uac80\uc0c9",zh:"\u641c\u7d22",tr:"Ara",id:"Cari",vi:"T\xecm ki\u1ebfm"},configureWarning:{en:"Please configure your server settings first. Go to",es:"Por favor, configure primero los ajustes del servidor. Vaya a",de:"Bitte konfigurieren Sie zuerst Ihre Servereinstellungen. Gehen Sie zu",fr:"Veuillez d'abord configurer les param\xe8tres de votre serveur. Aller \xe0",ru:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u0432",pt:"Por favor, configure as configura\xe7\xf5es do servidor primeiro. V\xe1 para",it:"Si prega di configurare prima le impostazioni del server. Vai a",pl:"Najpierw skonfiguruj ustawienia serwera. Przejd\u017a do",ua:"Please configure your server settings first. Go to",nl:"Configureer eerst uw serverinstellingen. Ga naar",ja:"\u307e\u305a\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u3092\u69cb\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002",ko:"\uba3c\uc800 \uc11c\ubc84 \uc124\uc815\uc744 \uad6c\uc131\ud558\uc138\uc694.",zh:"\u8bf7\u5148\u914d\u7f6e\u670d\u52a1\u5668\u8bbe\u7f6e\u3002\u8f6c\u5230",tr:"L\xfctfen \xf6nce sunucu ayarlar\u0131n\u0131z\u0131 yap\u0131land\u0131r\u0131n.",id:"Silakan konfigurasikan pengaturan server terlebih dahulu. Pergi ke",vi:"Vui l\xf2ng c\u1ea5u h\xecnh c\xe0i \u0111\u1eb7t m\xe1y ch\u1ee7 tr\u01b0\u1edbc. \u0110i t\u1edbi"},linkSettings:{en:"Settings",es:"Configuraci\xf3n",de:"Einstellungen",fr:"Param\xe8tres",ru:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",pt:"Configura\xe7\xf5es",it:"Impostazioni",pl:"Ustawienia",ua:"\u041d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f",nl:"Instellingen",ja:"\u8a2d\u5b9a",ko:"\uc124\uc815",zh:"\u8bbe\u7f6e",tr:"Ayarlar",id:"Pengaturan",vi:"C\xe0i \u0111\u1eb7t"},noSubscriptions:{en:"No subscriptions yet. Search for channels to subscribe!",es:"A\xfan no hay suscripciones. \xa1Busca canales para suscribirte!",de:"Noch keine Abonnements. Suche nach Kan\xe4len zum Abonnieren!",fr:"Pas encore d'abonnements. Recherchez des cha\xeenes \xe0 vous abonner!",ru:"\u041f\u043e\u0434\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043a\u0430 \u043d\u0435\u0442. \u041d\u0430\u0439\u0434\u0438\u0442\u0435 \u043a\u0430\u043d\u0430\u043b\u044b \u0434\u043b\u044f \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438!",pt:"Ainda sem inscri\xe7\xf5es. Pesquise canais para se inscrever!",it:"Nessuna iscrizione ancora. Cerca canali a cui iscriverti!",pl:"Jeszcze \u017cadnych subskrypcji. Wyszukaj kana\u0142y do subskrypcji!",ua:"No subscriptions yet. Search for channels to subscribe!",nl:"Nog geen abonnementen. Zoek naar kanalen om je te abonneren!",ja:"\u307e\u3060\u767b\u9332\u30c1\u30e3\u30f3\u30cd\u30eb\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u691c\u7d22\u3057\u3066\u767b\u9332\u3057\u307e\u3057\u3087\u3046\uff01",ko:"\uc544\uc9c1 \uad6c\ub3c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uad6c\ub3c5\ud560 \ucc44\ub110\uc744 \uac80\uc0c9\ud558\uc138\uc694!",zh:"\u8fd8\u6ca1\u6709\u8ba2\u9605\u3002\u641c\u7d22\u9891\u9053\u8fdb\u884c\u8ba2\u9605\uff01",tr:"Hen\xfcz abonelik yok. Abone olmak i\xe7in kanal aray\u0131n!",id:"Belum ada langganan. Cari saluran untuk berlangganan!",vi:"Ch\u01b0a c\xf3 \u0111\u0103ng k\xfd n\xe0o. T\xecm ki\u1ebfm k\xeanh \u0111\u1ec3 \u0111\u0103ng k\xfd!"},channelDefault:{en:"Channel",es:"Canal",de:"Kanal",fr:"Cha\xeene",ru:"\u041a\u0430\u043d\u0430\u043b",pt:"Canal",it:"Canale",pl:"Kana\u0142",ua:"Channel",nl:"Kanaal",ja:"\u30c1\u30e3\u30f3\u30cd\u30eb",ko:"\ucc44\ub110",zh:"\u9891\u9053",tr:"Kanal",id:"Saluran",vi:"K\xeanh"},subscribedLabel:{en:"Subscribed:",es:"Suscrito:",de:"Abonniert:",fr:"Abonn\xe9:",ru:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u043d:",pt:"Inscrito:",it:"Iscritto:",pl:"Subskrybowany:",ua:"Subscribed:",nl:"Geabonneerd:",ja:"\u767b\u9332\u65e5:",ko:"\uad6c\ub3c5\uc77c:",zh:"\u8ba2\u9605\u65f6\u95f4:",tr:"Abone olundu:",id:"Berlangganan:",vi:"\u0110\xe3 \u0111\u0103ng k\xfd:"},btnUnsubscribe:{en:"Unsubscribe",es:"Cancelar suscripci\xf3n",de:"Abbestellen",fr:"Se d\xe9sabonner",ru:"\u041e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f",pt:"Cancelar inscri\xe7\xe3o",it:"Disiscriviti",pl:"Anuluj subskrypcj\u0119",ua:"\u0412\u0456\u0434\u043f\u0438\u0441\u0430\u0442\u0438\u0441\u044f",nl:"Uitschrijven",ja:"\u767b\u9332\u89e3\u9664",ko:"\uad6c\ub3c5 \ucde8\uc18c",zh:"\u53d6\u6d88\u8ba2\u9605",tr:"Abonelikten \xc7\u0131k",id:"Berhenti Berlangganan",vi:"H\u1ee7y \u0111\u0103ng k\xfd"},searchResultsTitle:{en:"Search Results",es:"Resultados de b\xfasqueda",de:"Suchergebnisse",fr:"R\xe9sultats de recherche",ru:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u0438\u0441\u043a\u0430",pt:"Resultados da pesquisa",it:"Risultati della ricerca",pl:"Wyniki wyszukiwania",ua:"Search Results",nl:"Zoekresultaten",ja:"\u691c\u7d22\u7d50\u679c",ko:"\uac80\uc0c9 \uacb0\uacfc",zh:"\u641c\u7d22\u7ed3\u679c",tr:"Arama Sonu\xe7lar\u0131",id:"Hasil Pencarian",vi:"K\u1ebft qu\u1ea3 t\xecm ki\u1ebfm"},noChannelsFound:{en:"No channels found for",es:"No se encontraron canales para",de:"Keine Kan\xe4le gefunden f\xfcr",fr:"Aucune cha\xeene trouv\xe9e pour",ru:"\u041a\u0430\u043d\u0430\u043b\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b \u0434\u043b\u044f",pt:"Nenhum canal encontrado para",it:"Nessun canale trovato per",pl:"Nie znaleziono kana\u0142\xf3w dla",ua:"No channels found for",nl:"Geen kanalen gevonden voor",ja:"\u30c1\u30e3\u30f3\u30cd\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f:",ko:"\ucc44\ub110\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4:",zh:"\u672a\u627e\u5230\u9891\u9053:",tr:"Kanal bulunamad\u0131:",id:"Tidak ada saluran yang ditemukan untuk",vi:"Kh\xf4ng t\xecm th\u1ea5y k\xeanh cho"},btnSubscribed:{en:"Subscribed",es:"Suscrito",de:"Abonniert",fr:"Abonn\xe9",ru:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u043d",pt:"Inscrito",it:"Iscritto",pl:"Subskrybowany",ua:"\u041f\u0456\u0434\u043f\u0438\u0441\u0430\u043d\u043e",nl:"Geabonneerd",ja:"\u767b\u9332\u6e08\u307f",ko:"\uad6c\ub3c5\ub428",zh:"\u5df2\u8ba2\u9605",tr:"Abone olundu",id:"Berlangganan",vi:"\u0110\xe3 \u0111\u0103ng k\xfd"},btnSubscribe:{en:"Subscribe",es:"Suscribirse",de:"Abonnieren",fr:"S'abonner",ru:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f",pt:"Inscrever-se",it:"Iscriviti",pl:"Subskrybuj",ua:"\u041f\u0456\u0434\u043f\u0438\u0441\u0430\u0442\u0438\u0441\u044f",nl:"Abonneren",ja:"\u767b\u9332",ko:"\uad6c\ub3c5",zh:"\u8ba2\u9605",tr:"Abone Ol",id:"Berlangganan",vi:"\u0110\u0103ng k\xfd"},toastSubscribed:{en:"Subscribed successfully",es:"Suscrito exitosamente",de:"Erfolgreich abonniert",fr:"Abonnement r\xe9ussi",ru:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u044b",pt:"Inscrito com sucesso",it:"Iscrizione riuscita",pl:"Pomy\u015blnie zasubskrybowano",ua:"Subscribed successfully",nl:"Succesvol geabonneerd",ja:"\u767b\u9332\u3057\u307e\u3057\u305f",ko:"\uad6c\ub3c5\ud588\uc2b5\ub2c8\ub2e4",zh:"\u8ba2\u9605\u6210\u529f",tr:"Ba\u015far\u0131yla abone olundu",id:"Berhasil berlangganan",vi:"\u0110\u0103ng k\xfd th\xe0nh c\xf4ng"},toastUnsubscribed:{en:"Unsubscribed successfully",es:"Cancelada la suscripci\xf3n exitosamente",de:"Erfolgreich abgemeldet",fr:"D\xe9sabonnement r\xe9ussi",ru:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0438\u0441\u0430\u043d\u044b",pt:"Inscri\xe7\xe3o cancelada com sucesso",it:"Disiscrizione riuscita",pl:"Pomy\u015blnie anulowano subskrypcj\u0119",ua:"Unsubscribed successfully",nl:"Succesvol uitgeschreven",ja:"\u767b\u9332\u89e3\u9664\u3057\u307e\u3057\u305f",ko:"\uad6c\ub3c5 \ucde8\uc18c\ud588\uc2b5\ub2c8\ub2e4",zh:"\u53d6\u6d88\u8ba2\u9605\u6210\u529f",tr:"Ba\u015far\u0131yla abonelikten \xe7\u0131k\u0131ld\u0131",id:"Berhasil berhenti berlangganan",vi:"H\u1ee7y \u0111\u0103ng k\xfd th\xe0nh c\xf4ng"}},qi_playlist={defaultTitle:{en:"Playlist",es:"Lista de reproducci\xf3n",de:"Playlist",fr:"Liste de lecture",ru:"\u041f\u043b\u0435\u0439\u043b\u0438\u0441\u0442",pt:"Playlist",it:"Playlist",pl:"Playlista",ua:"Playlist",nl:"Afspeellijst",ja:"\u518d\u751f\u30ea\u30b9\u30c8",ko:"\uc7ac\uc0dd\ubaa9\ub85d",zh:"\u64ad\u653e\u5217\u8868",tr:"Oynatma Listesi",id:"Daftar Putar",vi:"Danh s\xe1ch ph\xe1t"},playAll:{en:"Play All",es:"Reproducir todo",de:"Alle abspielen",fr:"Tout lire",ru:"\u0412\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0451",pt:"Reproduzir tudo",it:"Riproduci tutto",pl:"Odtw\xf3rz wszystko",ua:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0432\u0441\u0435",nl:"Alles afspelen",ja:"\u3059\u3079\u3066\u518d\u751f",ko:"\ubaa8\ub450 \uc7ac\uc0dd",zh:"\u64ad\u653e\u5168\u90e8",tr:"T\xfcm\xfcn\xfc Oynat",id:"Putar Semua",vi:"Ph\xe1t t\u1ea5t c\u1ea3"},noVideos:{en:"No videos found in this playlist.",es:"No se encontraron v\xeddeos en esta lista de reproducci\xf3n.",de:"Keine Videos in dieser Playlist gefunden.",fr:"Aucune vid\xe9o trouv\xe9e dans cette liste de lecture.",ru:"\u0412\u0438\u0434\u0435\u043e \u0432 \u044d\u0442\u043e\u043c \u043f\u043b\u0435\u0439\u043b\u0438\u0441\u0442\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b.",pt:"Nenhum v\xeddeo encontrado nesta playlist.",it:"Nessun video trovato in questa playlist.",pl:"Nie znaleziono film\xf3w na tej playli\u015bcie.",ua:"No videos found in this playlist.",nl:"Geen video's gevonden in deze afspeellijst.",ja:"\u3053\u306e\u518d\u751f\u30ea\u30b9\u30c8\u306b\u52d5\u753b\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002",ko:"\uc774 \uc7ac\uc0dd\ubaa9\ub85d\uc5d0 \ub3d9\uc601\uc0c1\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",zh:"\u6b64\u64ad\u653e\u5217\u8868\u4e2d\u672a\u627e\u5230\u89c6\u9891\u3002",tr:"Bu oynatma listesinde video bulunamad\u0131.",id:"Tidak ada video yang ditemukan di daftar putar ini.",vi:"Kh\xf4ng t\xecm th\u1ea5y video n\xe0o trong danh s\xe1ch ph\xe1t n\xe0y."},loadMore:{en:"Load More",es:"Cargar m\xe1s",de:"Mehr laden",fr:"Charger plus",ru:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0451",pt:"Carregar mais",it:"Carica altro",pl:"Za\u0142aduj wi\u0119cej",ua:"Load More",nl:"Meer laden",ja:"\u3082\u3063\u3068\u8aad\u307f\u8fbc\u3080",ko:"\ub354 \ubcf4\uae30",zh:"\u52a0\u8f7d\u66f4\u591a",tr:"Daha Fazla Y\xfckle",id:"Muat Lebih Banyak",vi:"T\u1ea3i th\xeam"},loading:{en:"Loading...",es:"Cargando...",de:"Laden...",fr:"Chargement...",ru:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",pt:"Carregando...",it:"Caricamento...",pl:"\u0141adowanie...",ua:"Loading...",nl:"Laden...",ja:"\u8aad\u307f\u8fbc\u307f\u4e2d...",ko:"\ub85c\ub529 \uc911...",zh:"\u52a0\u8f7d\u4e2d...",tr:"Y\xfckleniyor...",id:"Memuat...",vi:"\u0110ang t\u1ea3i..."}},qi_starred={pageTitle:{en:"Starred Videos",es:"V\xeddeos favoritos",de:"Mit Stern versehene Videos",fr:"Vid\xe9os favorites",ru:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0432\u0438\u0434\u0435\u043e",pt:"V\xeddeos favoritos",it:"Video preferiti",pl:"Oznaczone gwiazdk\u0105",ua:"Starred Videos",nl:"Video's met ster",ja:"\u30b9\u30bf\u30fc\u4ed8\u304d\u52d5\u753b",ko:"\ubcc4\ud45c\ud55c \ub3d9\uc601\uc0c1",zh:"\u5df2\u52a0\u661f\u6807\u7684\u89c6\u9891",tr:"Y\u0131ld\u0131zl\u0131 Videolar",id:"Video Berbintang",vi:"Video \u0111\xe3 \u0111\xe1nh d\u1ea5u sao"},playAll:{en:"Play All",es:"Reproducir todo",de:"Alle abspielen",fr:"Tout lire",ru:"\u0412\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0451",pt:"Reproduzir tudo",it:"Riproduci tutto",pl:"Odtw\xf3rz wszystko",ua:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0432\u0441\u0435",nl:"Alles afspelen",ja:"\u3059\u3079\u3066\u518d\u751f",ko:"\ubaa8\ub450 \uc7ac\uc0dd",zh:"\u64ad\u653e\u5168\u90e8",tr:"T\xfcm\xfcn\xfc Oynat",id:"Putar Semua",vi:"Ph\xe1t t\u1ea5t c\u1ea3"},noStarred:{en:"No starred videos yet. Click the star icon on any video to add it here!",es:"A\xfan no hay v\xeddeos favoritos. \xa1Haz clic en el \xedcono de estrella en cualquier v\xeddeo para agregarlo aqu\xed!",de:"Noch keine Videos mit Stern. Klicken Sie auf das Sternsymbol bei einem Video, um es hier hinzuzuf\xfcgen!",fr:"Pas encore de vid\xe9os favorites. Cliquez sur l'ic\xf4ne \xe9toile sur n'importe quelle vid\xe9o pour l'ajouter ici!",ru:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0432\u0438\u0434\u0435\u043e \u043f\u043e\u043a\u0430 \u043d\u0435\u0442. \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0437\u043d\u0430\u0447\u043e\u043a \u0437\u0432\u0435\u0437\u0434\u044b \u043d\u0430 \u043b\u044e\u0431\u043e\u043c \u0432\u0438\u0434\u0435\u043e, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0435\u0433\u043e \u0441\u044e\u0434\u0430!",pt:"Ainda sem v\xeddeos favoritos. Clique no \xedcone de estrela em qualquer v\xeddeo para adicion\xe1-lo aqui!",it:"Nessun video preferito ancora. Clicca sull'icona stella su qualsiasi video per aggiungerlo qui!",pl:"Jeszcze \u017cadnych film\xf3w z gwiazdk\u0105. Kliknij ikon\u0119 gwiazdki przy dowolnym filmie, aby doda\u0107 go tutaj!",ua:"No starred videos yet. Click the star icon on any video to add it here!",nl:"Nog geen video's met ster. Klik op het sterpictogram bij een video om deze hier toe te voegen!",ja:"\u307e\u3060\u30b9\u30bf\u30fc\u4ed8\u304d\u52d5\u753b\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u4efb\u610f\u306e\u52d5\u753b\u306e\u30b9\u30bf\u30fc\u30a2\u30a4\u30b3\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3053\u3053\u306b\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\uff01",ko:"\uc544\uc9c1 \ubcc4\ud45c\ud55c \ub3d9\uc601\uc0c1\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \ub3d9\uc601\uc0c1\uc758 \ubcc4\ud45c \uc544\uc774\ucf58\uc744 \ud074\ub9ad\ud558\uc5ec \uc5ec\uae30\uc5d0 \ucd94\uac00\ud558\uc138\uc694!",zh:"\u8fd8\u6ca1\u6709\u52a0\u661f\u6807\u7684\u89c6\u9891\u3002\u70b9\u51fb\u4efb\u4f55\u89c6\u9891\u4e0a\u7684\u661f\u6807\u56fe\u6807\u5c06\u5176\u6dfb\u52a0\u5230\u8fd9\u91cc\uff01",tr:"Hen\xfcz y\u0131ld\u0131zl\u0131 video yok. Buraya eklemek i\xe7in herhangi bir videodaki y\u0131ld\u0131z simgesine t\u0131klay\u0131n!",id:"Belum ada video berbintang. Klik ikon bintang di video mana pun untuk menambahkannya di sini!",vi:"Ch\u01b0a c\xf3 video \u0111\xe1nh d\u1ea5u sao. Nh\u1ea5p v\xe0o bi\u1ec3u t\u01b0\u1ee3ng sao tr\xean b\u1ea5t k\u1ef3 video n\xe0o \u0111\u1ec3 th\xeam v\xe0o \u0111\xe2y!"},btnRemove:{en:"Remove",es:"Eliminar",de:"Entfernen",fr:"Retirer",ru:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",pt:"Remover",it:"Rimuovi",pl:"Usu\u0144",ua:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438",nl:"Verwijderen",ja:"\u524a\u9664",ko:"\uc81c\uac70",zh:"\u79fb\u9664",tr:"Kald\u0131r",id:"Hapus",vi:"X\xf3a"}},qi_watchLater={pageTitle:{en:"Watch Later",es:"Ver m\xe1s tarde",de:"Sp\xe4ter ansehen",fr:"\xc0 regarder plus tard",ru:"\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043f\u043e\u0437\u0436\u0435",pt:"Assistir mais tarde",it:"Guarda pi\xf9 tardi",pl:"Obejrzyj p\xf3\u017aniej",ua:"\u041f\u0435\u0440\u0435\u0433\u043b\u044f\u043d\u0443\u0442\u0438 \u043f\u0456\u0437\u043d\u0456\u0448\u0435",nl:"Later bekijken",ja:"\u5f8c\u3067\u898b\u308b",ko:"\ub098\uc911\uc5d0 \ubcfc \ub3d9\uc601\uc0c1",zh:"\u7a0d\u540e\u89c2\u770b",tr:"Daha Sonra \u0130zle",id:"Tonton Nanti",vi:"Xem sau"},playAll:{en:"Play All",es:"Reproducir todo",de:"Alle abspielen",fr:"Tout lire",ru:"\u0412\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0451",pt:"Reproduzir tudo",it:"Riproduci tutto",pl:"Odtw\xf3rz wszystko",ua:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0432\u0441\u0435",nl:"Alles afspelen",ja:"\u3059\u3079\u3066\u518d\u751f",ko:"\ubaa8\ub450 \uc7ac\uc0dd",zh:"\u64ad\u653e\u5168\u90e8",tr:"T\xfcm\xfcn\xfc Oynat",id:"Putar Semua",vi:"Ph\xe1t t\u1ea5t c\u1ea3"},noVideos:{en:"No videos in Watch Later yet. Click the clock icon on any video to add it here!",es:"A\xfan no hay v\xeddeos en Ver m\xe1s tarde. \xa1Haz clic en el \xedcono de reloj en cualquier v\xeddeo para agregarlo aqu\xed!",de:"Noch keine Videos in Sp\xe4ter ansehen. Klicken Sie auf das Uhrensymbol bei einem Video, um es hier hinzuzuf\xfcgen!",fr:"Pas encore de vid\xe9os dans \xc0 regarder plus tard. Cliquez sur l'ic\xf4ne horloge sur n'importe quelle vid\xe9o pour l'ajouter ici!",ru:"\u0412\u0438\u0434\u0435\u043e \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u043f\u043e\u0437\u0436\u0435 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442. \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0437\u043d\u0430\u0447\u043e\u043a \u0447\u0430\u0441\u043e\u0432 \u043d\u0430 \u043b\u044e\u0431\u043e\u043c \u0432\u0438\u0434\u0435\u043e, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0435\u0433\u043e \u0441\u044e\u0434\u0430!",pt:"Ainda sem v\xeddeos em Assistir mais tarde. Clique no \xedcone de rel\xf3gio em qualquer v\xeddeo para adicion\xe1-lo aqui!",it:"Nessun video in Guarda pi\xf9 tardi ancora. Clicca sull'icona orologio su qualsiasi video per aggiungerlo qui!",pl:"Jeszcze \u017cadnych film\xf3w w Obejrzyj p\xf3\u017aniej. Kliknij ikon\u0119 zegara przy dowolnym filmie, aby doda\u0107 go tutaj!",ua:"\u041d\u0435\u043c\u0430\u0454 \u0432\u0456\u0434\u0435\u043e \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0433\u043b\u044f\u0434\u0443 \u043f\u0456\u0437\u043d\u0456\u0448\u0435. \u041d\u0430\u0442\u0438\u0441\u043d\u0456\u0442\u044c \u043d\u0430 \u0437\u043d\u0430\u0447\u043e\u043a \u0433\u043e\u0434\u0438\u043d\u043d\u0438\u043a\u0430 \u043d\u0430 \u0431\u0443\u0434\u044c-\u044f\u043a\u043e\u043c\u0443 \u0432\u0456\u0434\u0435\u043e, \u0449\u043e\u0431 \u0434\u043e\u0434\u0430\u0442\u0438 \u0439\u043e\u0433\u043e \u0441\u044e\u0434\u0438!",nl:"Nog geen video's in Later bekijken. Klik op het klokpictogram bij een video om deze hier toe te voegen!",ja:"\u307e\u3060\u5f8c\u3067\u898b\u308b\u52d5\u753b\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u4efb\u610f\u306e\u52d5\u753b\u306e\u6642\u8a08\u30a2\u30a4\u30b3\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3053\u3053\u306b\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\uff01",ko:"\uc544\uc9c1 \ub098\uc911\uc5d0 \ubcfc \ub3d9\uc601\uc0c1\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \ub3d9\uc601\uc0c1\uc758 \uc2dc\uacc4 \uc544\uc774\ucf58\uc744 \ud074\ub9ad\ud558\uc5ec \uc5ec\uae30\uc5d0 \ucd94\uac00\ud558\uc138\uc694!",zh:"\u7a0d\u540e\u89c2\u770b\u4e2d\u8fd8\u6ca1\u6709\u89c6\u9891\u3002\u70b9\u51fb\u4efb\u4f55\u89c6\u9891\u4e0a\u7684\u65f6\u949f\u56fe\u6807\u5c06\u5176\u6dfb\u52a0\u5230\u8fd9\u91cc\uff01",tr:"Daha Sonra \u0130zle'de hen\xfcz video yok. Buraya eklemek i\xe7in herhangi bir videodaki saat simgesine t\u0131klay\u0131n!",id:"Belum ada video di Tonton Nanti. Klik ikon jam di video mana pun untuk menambahkannya di sini!",vi:"Ch\u01b0a c\xf3 video trong Xem sau. Nh\u1ea5p v\xe0o bi\u1ec3u t\u01b0\u1ee3ng \u0111\u1ed3ng h\u1ed3 tr\xean b\u1ea5t k\u1ef3 video n\xe0o \u0111\u1ec3 th\xeam v\xe0o \u0111\xe2y!"},btnRemove:{en:"Remove",es:"Eliminar",de:"Entfernen",fr:"Retirer",ru:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",pt:"Remover",it:"Rimuovi",pl:"Usu\u0144",ua:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438",nl:"Verwijderen",ja:"\u524a\u9664",ko:"\uc81c\uac70",zh:"\u79fb\u9664",tr:"Kald\u0131r",id:"Hapus",vi:"X\xf3a"}},qi_player={btnAddToQueue:{en:"Add to Queue",es:"A\xf1adir a la cola",de:"Zur Warteschlange hinzuf\xfcgen",fr:"Ajouter \xe0 la file",ru:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c",pt:"Adicionar \xe0 fila",it:"Aggiungi alla coda",pl:"Dodaj do kolejki",ua:"\u0414\u043e\u0434\u0430\u0442\u0438 \u0432 \u0447\u0435\u0440\u0433\u0443",nl:"Toevoegen aan wachtrij",ja:"\u30ad\u30e5\u30fc\u306b\u8ffd\u52a0",ko:"\ub300\uae30\uc5f4\uc5d0 \ucd94\uac00",zh:"\u6dfb\u52a0\u5230\u961f\u5217",tr:"S\u0131raya Ekle",id:"Tambahkan ke Antrean",vi:"Th\xeam v\xe0o h\xe0ng \u0111\u1ee3i"},btnAddToWatchLater:{en:"Add to Watch Later",es:"A\xf1adir a Ver m\xe1s tarde",de:"Zu Sp\xe4ter ansehen hinzuf\xfcgen",fr:"Ajouter \xe0 Regarder plus tard",ru:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043f\u043e\u0437\u0436\u0435",pt:"Adicionar a Assistir mais tarde",it:"Aggiungi a Guarda pi\xf9 tardi",pl:"Dodaj do Obejrzyj p\xf3\u017aniej",ua:"\u0414\u043e\u0434\u0430\u0442\u0438 \u0432 \u041f\u0435\u0440\u0435\u0433\u043b\u044f\u043d\u0443\u0442\u0438 \u043f\u0456\u0437\u043d\u0456\u0448\u0435",nl:"Toevoegen aan Later bekijken",ja:"\u5f8c\u3067\u898b\u308b\u306b\u8ffd\u52a0",ko:"\ub098\uc911\uc5d0 \ubcfc \ub3d9\uc601\uc0c1\uc5d0 \ucd94\uac00",zh:"\u6dfb\u52a0\u5230\u7a0d\u540e\u89c2\u770b",tr:"Daha Sonra \u0130zle'ye Ekle",id:"Tambahkan ke Tonton Nanti",vi:"Th\xeam v\xe0o Xem sau"},dateToday:{en:"Today",es:"Hoy",de:"Heute",fr:"Aujourd'hui",ru:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",pt:"Hoje",it:"Oggi",pl:"Dzisiaj",ua:"\u0421\u044c\u043e\u0433\u043e\u0434\u043d\u0456",nl:"Vandaag",ja:"\u4eca\u65e5",ko:"\uc624\ub298",zh:"\u4eca\u5929",tr:"Bug\xfcn",id:"Hari ini",vi:"H\xf4m nay"},dateYesterday:{en:"Yesterday",es:"Ayer",de:"Gestern",fr:"Hier",ru:"\u0412\u0447\u0435\u0440\u0430",pt:"Ontem",it:"Ieri",pl:"Wczoraj",ua:"\u0412\u0447\u043e\u0440\u0430",nl:"Gisteren",ja:"\u6628\u65e5",ko:"\uc5b4\uc81c",zh:"\u6628\u5929",tr:"D\xfcn",id:"Kemarin",vi:"H\xf4m qua"},dateDaysAgo:{en:"days ago",es:"hace d\xedas",de:"vor Tagen",fr:"il y a jours",ru:"\u0434\u043d\u0435\u0439 \u043d\u0430\u0437\u0430\u0434",pt:"dias atr\xe1s",it:"giorni fa",pl:"dni temu",ua:"\u0434\u043d\u0456\u0432 \u0442\u043e\u043c\u0443",nl:"dagen geleden",ja:"\u65e5\u524d",ko:"\uc77c \uc804",zh:"\u5929\u524d",tr:"g\xfcn \xf6nce",id:"hari yang lalu",vi:"ng\xe0y tr\u01b0\u1edbc"},dateWeeksAgo:{en:"weeks ago",es:"hace semanas",de:"vor Wochen",fr:"il y a semaines",ru:"\u043d\u0435\u0434\u0435\u043b\u044c \u043d\u0430\u0437\u0430\u0434",pt:"semanas atr\xe1s",it:"settimane fa",pl:"tygodni temu",ua:"\u0442\u0438\u0436\u043d\u0456\u0432 \u0442\u043e\u043c\u0443",nl:"weken geleden",ja:"\u9031\u9593\u524d",ko:"\uc8fc \uc804",zh:"\u5468\u524d",tr:"hafta \xf6nce",id:"minggu yang lalu",vi:"tu\u1ea7n tr\u01b0\u1edbc"},dateMonthsAgo:{en:"months ago",es:"hace meses",de:"vor Monaten",fr:"il y a mois",ru:"\u043c\u0435\u0441\u044f\u0446\u0435\u0432 \u043d\u0430\u0437\u0430\u0434",pt:"meses atr\xe1s",it:"mesi fa",pl:"miesi\u0119cy temu",ua:"\u043c\u0456\u0441\u044f\u0446\u0456\u0432 \u0442\u043e\u043c\u0443",nl:"maanden geleden",ja:"\u30f6\u6708\u524d",ko:"\uac1c\uc6d4 \uc804",zh:"\u4e2a\u6708\u524d",tr:"ay \xf6nce",id:"bulan yang lalu",vi:"th\xe1ng tr\u01b0\u1edbc"},dateYearsAgo:{en:"years ago",es:"hace a\xf1os",de:"vor Jahren",fr:"il y a ans",ru:"\u043b\u0435\u0442 \u043d\u0430\u0437\u0430\u0434",pt:"anos atr\xe1s",it:"anni fa",pl:"lat temu",ua:"\u0440\u043e\u043a\u0456\u0432 \u0442\u043e\u043c\u0443",nl:"jaar geleden",ja:"\u5e74\u524d",ko:"\ub144 \uc804",zh:"\u5e74\u524d",tr:"y\u0131l \xf6nce",id:"tahun yang lalu",vi:"n\u0103m tr\u01b0\u1edbc"},queueTitle:{en:"Queue",es:"Cola",de:"Warteschlange",fr:"File d'attente",ru:"\u041e\u0447\u0435\u0440\u0435\u0434\u044c",pt:"Fila",it:"Coda",pl:"Kolejka",ua:"\u0427\u0435\u0440\u0433\u0430",nl:"Wachtrij",ja:"\u30ad\u30e5\u30fc",ko:"\ub300\uae30\uc5f4",zh:"\u961f\u5217",tr:"S\u0131ra",id:"Antrean",vi:"H\xe0ng \u0111\u1ee3i"},btnClearQueue:{en:"Clear Queue",es:"Limpiar cola",de:"Warteschlange leeren",fr:"Vider la file",ru:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u044c",pt:"Limpar fila",it:"Svuota coda",pl:"Wyczy\u015b\u0107 kolejk\u0119",ua:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u0438 \u0447\u0435\u0440\u0433\u0443",nl:"Wachtrij wissen",ja:"\u30ad\u30e5\u30fc\u3092\u30af\u30ea\u30a2",ko:"\ub300\uae30\uc5f4 \uc9c0\uc6b0\uae30",zh:"\u6e05\u7a7a\u961f\u5217",tr:"S\u0131ray\u0131 Temizle",id:"Hapus Antrean",vi:"X\xf3a h\xe0ng \u0111\u1ee3i"},btnRemove:{en:"Remove",es:"Eliminar",de:"Entfernen",fr:"Retirer",ru:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",pt:"Remover",it:"Rimuovi",pl:"Usu\u0144",ua:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438",nl:"Verwijderen",ja:"\u524a\u9664",ko:"\uc81c\uac70",zh:"\u79fb\u9664",tr:"Kald\u0131r",id:"Hapus",vi:"X\xf3a"},queueEmpty:{en:"Queue is empty",es:"La cola est\xe1 vac\xeda",de:"Warteschlange ist leer",fr:"La file est vide",ru:"\u041e\u0447\u0435\u0440\u0435\u0434\u044c \u043f\u0443\u0441\u0442\u0430",pt:"A fila est\xe1 vazia",it:"La coda \xe8 vuota",pl:"Kolejka jest pusta",ua:"\u0427\u0435\u0440\u0433\u0430 \u043f\u043e\u0440\u043e\u0436\u043d\u044f",nl:"Wachtrij is leeg",ja:"\u30ad\u30e5\u30fc\u306f\u7a7a\u3067\u3059",ko:"\ub300\uae30\uc5f4\uc774 \ube44\uc5b4 \uc788\uc2b5\ub2c8\ub2e4",zh:"\u961f\u5217\u4e3a\u7a7a",tr:"S\u0131ra bo\u015f",id:"Antrean kosong",vi:"H\xe0ng \u0111\u1ee3i tr\u1ed1ng"},queueEmptyHint:{en:"Add videos to start playing",es:"A\xf1ade v\xeddeos para empezar a reproducir",de:"F\xfcge Videos hinzu, um abzuspielen",fr:"Ajoutez des vid\xe9os pour commencer \xe0 lire",ru:"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0432\u0438\u0434\u0435\u043e, \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0447\u0430\u0442\u044c \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u0435",pt:"Adicione v\xeddeos para come\xe7ar a reproduzir",it:"Aggiungi video per iniziare la riproduzione",pl:"Dodaj filmy, aby rozpocz\u0105\u0107 odtwarzanie",ua:"\u0414\u043e\u0434\u0430\u0439\u0442\u0435 \u0432\u0456\u0434\u0435\u043e, \u0449\u043e\u0431 \u043f\u043e\u0447\u0430\u0442\u0438 \u0432\u0456\u0434\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u044f",nl:"Voeg video's toe om af te spelen",ja:"\u52d5\u753b\u3092\u8ffd\u52a0\u3057\u3066\u518d\u751f\u3092\u958b\u59cb",ko:"\uc7ac\uc0dd\uc744 \uc2dc\uc791\ud558\ub824\uba74 \ub3d9\uc601\uc0c1\uc744 \ucd94\uac00\ud558\uc138\uc694",zh:"\u6dfb\u52a0\u89c6\u9891\u4ee5\u5f00\u59cb\u64ad\u653e",tr:"Oynatmaya ba\u015flamak i\xe7in video ekleyin",id:"Tambahkan video untuk mulai memutar",vi:"Th\xeam video \u0111\u1ec3 b\u1eaft \u0111\u1ea7u ph\xe1t"},confirmClearQueue:{en:"Clear all videos from queue?",es:"\xbfEliminar todos los v\xeddeos de la cola?",de:"Alle Videos aus der Warteschlange entfernen?",fr:"Supprimer toutes les vid\xe9os de la file?",ru:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u0432\u0438\u0434\u0435\u043e \u0438\u0437 \u043e\u0447\u0435\u0440\u0435\u0434\u0438?",pt:"Limpar todos os v\xeddeos da fila?",it:"Rimuovere tutti i video dalla coda?",pl:"Usun\u0105\u0107 wszystkie filmy z kolejki?",ua:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u0438 \u0432\u0441\u0456 \u0432\u0456\u0434\u0435\u043e \u0437 \u0447\u0435\u0440\u0433\u0438?",nl:"Alle video's uit wachtrij verwijderen?",ja:"\u30ad\u30e5\u30fc\u304b\u3089\u3059\u3079\u3066\u306e\u52d5\u753b\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",ko:"\ub300\uae30\uc5f4\uc5d0\uc11c \ubaa8\ub4e0 \ub3d9\uc601\uc0c1\uc744 \uc9c0\uc6b0\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",zh:"\u6e05\u7a7a\u961f\u5217\u4e2d\u7684\u6240\u6709\u89c6\u9891\uff1f",tr:"S\u0131radaki t\xfcm videolar\u0131 temizle?",id:"Hapus semua video dari antrean?",vi:"X\xf3a t\u1ea5t c\u1ea3 video kh\u1ecfi h\xe0ng \u0111\u1ee3i?"},chapters:{en:"Chapters",es:"Cap\xedtulos",de:"Kapitel",fr:"Chapitres",ru:"\u0413\u043b\u0430\u0432\u044b",pt:"Cap\xedtulos",it:"Capitoli",pl:"Rozdzia\u0142y",ua:"\u0420\u043e\u0437\u0434\u0456\u043b\u0438",nl:"Hoofdstukken",ja:"\u30c1\u30e3\u30d7\u30bf\u30fc",ko:"\ucc55\ud130",zh:"\u7ae0\u8282",tr:"B\xf6l\xfcmler",id:"Bab",vi:"Ch\u01b0\u01a1ng"},nowPlaying:{en:"Now Playing",es:"Reproduciendo ahora",de:"Jetzt l\xe4uft",fr:"En cours de lecture",ru:"\u0421\u0435\u0439\u0447\u0430\u0441 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0441\u044f",pt:"Tocando agora",it:"In riproduzione",pl:"Teraz odtwarzane",ua:"\u0417\u0430\u0440\u0430\u0437 \u0432\u0456\u0434\u0442\u0432\u043e\u0440\u044e\u0454\u0442\u044c\u0441\u044f",nl:"Nu aan het spelen",ja:"\u518d\u751f\u4e2d",ko:"\uc7ac\uc0dd \uc911",zh:"\u6b63\u5728\u64ad\u653e",tr:"\u015eimdi Oynat\u0131l\u0131yor",id:"Sedang Diputar",vi:"\u0110ang ph\xe1t"},btnPrevious:{en:"Previous",es:"Anterior",de:"Zur\xfcck",fr:"Pr\xe9c\xe9dent",ru:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435",pt:"Anterior",it:"Precedente",pl:"Poprzedni",ua:"\u041f\u043e\u043f\u0435\u0440\u0435\u0434\u043d\u0454",nl:"Vorige",ja:"\u524d\u3078",ko:"\uc774\uc804",zh:"\u4e0a\u4e00\u4e2a",tr:"\xd6nceki",id:"Sebelumnya",vi:"Tr\u01b0\u1edbc"},btnPause:{en:"Pause",es:"Pausar",de:"Pausieren",fr:"Pause",ru:"\u041f\u0430\u0443\u0437\u0430",pt:"Pausar",it:"Pausa",pl:"Wstrzymaj",ua:"\u041f\u0430\u0443\u0437\u0430",nl:"Pauzeren",ja:"\u4e00\u6642\u505c\u6b62",ko:"\uc77c\uc2dc\uc911\uc9c0",zh:"\u6682\u505c",tr:"Duraklat",id:"Jeda",vi:"T\u1ea1m d\u1eebng"},btnPlay:{en:"Play",es:"Reproducir",de:"Abspielen",fr:"Lecture",ru:"\u0412\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438",pt:"Reproduzir",it:"Riproduci",pl:"Odtw\xf3rz",ua:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438",nl:"Afspelen",ja:"\u518d\u751f",ko:"\uc7ac\uc0dd",zh:"\u64ad\u653e",tr:"Oynat",id:"Putar",vi:"Ph\xe1t"},btnNext:{en:"Next",es:"Siguiente",de:"Weiter",fr:"Suivant",ru:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435",pt:"Pr\xf3ximo",it:"Successivo",pl:"Nast\u0119pny",ua:"\u041d\u0430\u0441\u0442\u0443\u043f\u043d\u0435",nl:"Volgende",ja:"\u6b21\u3078",ko:"\ub2e4\uc74c",zh:"\u4e0b\u4e00\u4e2a",tr:"Sonraki",id:"Selanjutnya",vi:"Ti\u1ebfp theo"},btnToggleQueue:{en:"Toggle Queue",es:"Alternar cola",de:"Warteschlange umschalten",fr:"Basculer la file",ru:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c/\u0441\u043a\u0440\u044b\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u044c",pt:"Alternar fila",it:"Mostra/nascondi coda",pl:"Prze\u0142\u0105cz kolejk\u0119",ua:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u0438/\u0441\u0445\u043e\u0432\u0430\u0442\u0438 \u0447\u0435\u0440\u0433\u0443",nl:"Wachtrij weergeven",ja:"\u30ad\u30e5\u30fc\u3092\u5207\u308a\u66ff\u3048",ko:"\ub300\uae30\uc5f4 \uc804\ud658",zh:"\u5207\u6362\u961f\u5217",tr:"S\u0131ray\u0131 A\xe7/Kapat",id:"Tampilkan/Sembunyikan Antrean",vi:"B\u1eadt/t\u1eaft h\xe0ng \u0111\u1ee3i"},btnMinimize:{en:"Minimize",es:"Minimizar",de:"Minimieren",fr:"R\xe9duire",ru:"\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c",pt:"Minimizar",it:"Riduci a icona",pl:"Minimalizuj",ua:"\u0417\u0433\u043e\u0440\u043d\u0443\u0442\u0438",nl:"Minimaliseren",ja:"\u6700\u5c0f\u5316",ko:"\ucd5c\uc18c\ud654",zh:"\u6700\u5c0f\u5316",tr:"K\xfc\xe7\xfclt",id:"Minimalkan",vi:"Thu nh\u1ecf"},btnHideToSidebar:{en:"Hide to Sidebar",es:"Ocultar en la barra lateral",de:"In Seitenleiste ausblenden",fr:"Masquer dans la barre lat\xe9rale",ru:"\u0421\u043a\u0440\u044b\u0442\u044c \u0432 \u0431\u043e\u043a\u043e\u0432\u0443\u044e \u043f\u0430\u043d\u0435\u043b\u044c",pt:"Ocultar na barra lateral",it:"Nascondi nella barra laterale",pl:"Ukryj na pasku bocznym",ua:"\u0421\u0445\u043e\u0432\u0430\u0442\u0438 \u0432 \u0431\u0456\u0447\u043d\u0443 \u043f\u0430\u043d\u0435\u043b\u044c",nl:"Verbergen in zijbalk",ja:"\u30b5\u30a4\u30c9\u30d0\u30fc\u306b\u96a0\u3059",ko:"\uc0ac\uc774\ub4dc\ubc14\ub85c \uc228\uae30\uae30",zh:"\u9690\u85cf\u5230\u4fa7\u8fb9\u680f",tr:"Kenar \xc7ubu\u011funa Gizle",id:"Sembunyikan ke Sidebar",vi:"\u1ea8n v\xe0o thanh b\xean"},btnRestore:{en:"Restore",es:"Restaurar",de:"Wiederherstellen",fr:"Restaurer",ru:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c",pt:"Restaurar",it:"Ripristina",pl:"Przywr\xf3\u0107",ua:"\u0412\u0456\u0434\u043d\u043e\u0432\u0438\u0442\u0438",nl:"Herstellen",ja:"\u5fa9\u5143",ko:"\ubcf5\uc6d0",zh:"\u6062\u590d",tr:"Geri Y\xfckle",id:"Pulihkan",vi:"Kh\xf4i ph\u1ee5c"},btnClose:{en:"Close",es:"Cerrar",de:"Schlie\xdfen",fr:"Fermer",ru:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",pt:"Fechar",it:"Chiudi",pl:"Zamknij",ua:"\u0417\u0430\u043a\u0440\u0438\u0442\u0438",nl:"Sluiten",ja:"\u9589\u3058\u308b",ko:"\ub2eb\uae30",zh:"\u5173\u95ed",tr:"Kapat",id:"Tutup",vi:"\u0110\xf3ng"},loadingVideo:{en:"Loading video...",es:"Cargando v\xeddeo...",de:"Video wird geladen...",fr:"Chargement de la vid\xe9o...",ru:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0432\u0438\u0434\u0435\u043e...",pt:"Carregando v\xeddeo...",it:"Caricamento video...",pl:"\u0141adowanie filmu...",ua:"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0432\u0456\u0434\u0435\u043e...",nl:"Video laden...",ja:"\u52d5\u753b\u3092\u8aad\u307f\u8fbc\u307f\u4e2d...",ko:"\ub3d9\uc601\uc0c1 \ub85c\ub529 \uc911...",zh:"\u52a0\u8f7d\u89c6\u9891\u4e2d...",tr:"Video y\xfckleniyor...",id:"Memuat video...",vi:"\u0110ang t\u1ea3i video..."}},qi_settings={pageTitle:{en:"Settings",es:"Configuraci\xf3n",de:"Einstellungen",fr:"Param\xe8tres",ru:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",pt:"Configura\xe7\xf5es",it:"Impostazioni",pl:"Ustawienia",ua:"\u041d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f",nl:"Instellingen",ja:"\u8a2d\u5b9a",ko:"\uc124\uc815",zh:"\u8bbe\u7f6e",tr:"Ayarlar",id:"Pengaturan",vi:"C\xe0i \u0111\u1eb7t"},serverConfig:{en:"Server Configuration",es:"Configuraci\xf3n del servidor",de:"Serverkonfiguration",fr:"Configuration du serveur",ru:"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430",pt:"Configura\xe7\xe3o do servidor",it:"Configurazione server",pl:"Konfiguracja serwera",ua:"\u041a\u043e\u043d\u0444\u0456\u0433\u0443\u0440\u0430\u0446\u0456\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430",nl:"Serverconfiguratie",ja:"\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a",ko:"\uc11c\ubc84 \uad6c\uc131",zh:"\u670d\u52a1\u5668\u914d\u7f6e",tr:"Sunucu Yap\u0131land\u0131rmas\u0131",id:"Konfigurasi Server",vi:"C\u1ea5u h\xecnh m\xe1y ch\u1ee7"},serverUrl:{en:"Server URL",es:"URL del servidor",de:"Server-URL",fr:"URL du serveur",ru:"URL \u0441\u0435\u0440\u0432\u0435\u0440\u0430",pt:"URL do servidor",it:"URL del server",pl:"Adres URL serwera",ua:"URL \u0441\u0435\u0440\u0432\u0435\u0440\u0430",nl:"Server-URL",ja:"\u30b5\u30fc\u30d0\u30fcURL",ko:"\uc11c\ubc84 URL",zh:"\u670d\u52a1\u5668URL",tr:"Sunucu URL'si",id:"URL Server",vi:"URL m\xe1y ch\u1ee7"},serverUrlHint:{en:"Ekydum server URL",es:"URL del servidor Ekydum",de:"Ekydum-Server-URL",fr:"URL du serveur Ekydum",ru:"URL \u0441\u0435\u0440\u0432\u0435\u0440\u0430 Ekydum",pt:"URL do servidor Ekydum",it:"URL del server Ekydum",pl:"Adres URL serwera Ekydum",ua:"URL \u0441\u0435\u0440\u0432\u0435\u0440\u0430 Ekydum",nl:"Ekydum server-URL",ja:"Ekydum\u30b5\u30fc\u30d0\u30fcURL",ko:"Ekydum \uc11c\ubc84 URL",zh:"Ekydum\u670d\u52a1\u5668URL",tr:"Ekydum sunucu URL'si",id:"URL server Ekydum",vi:"URL m\xe1y ch\u1ee7 Ekydum"},accountToken:{en:"Account Token",es:"Token de cuenta",de:"Konto-Token",fr:"Jeton de compte",ru:"\u0422\u043e\u043a\u0435\u043d \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430",pt:"Token da conta",it:"Token account",pl:"Token konta",ua:"\u0422\u043e\u043a\u0435\u043d \u043e\u0431\u043b\u0456\u043a\u043e\u0432\u043e\u0433\u043e \u0437\u0430\u043f\u0438\u0441\u0443",nl:"Account-token",ja:"\u30a2\u30ab\u30a6\u30f3\u30c8\u30c8\u30fc\u30af\u30f3",ko:"\uacc4\uc815 \ud1a0\ud070",zh:"\u8d26\u6237\u4ee4\u724c",tr:"Hesap Jetonu",id:"Token Akun",vi:"Token t\xe0i kho\u1ea3n"},accountTokenPlaceholder:{en:"Enter your account token",es:"Introduce tu token de cuenta",de:"Gib deinen Account-Token ein",fr:"Entrez votre jeton de compte",ru:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u043e\u043a\u0435\u043d \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430",pt:"Insira o token da sua conta",it:"Inserisci il token del tuo account",pl:"Wprowad\u017a token konta",ua:"\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u043e\u0431\u043b\u0456\u043a\u043e\u0432\u043e\u0433\u043e \u0437\u0430\u043f\u0438\u0441\u0443",nl:"Voer je account-token in",ja:"\u30a2\u30ab\u30a6\u30f3\u30c8\u30c8\u30fc\u30af\u30f3\u3092\u5165\u529b",ko:"\uacc4\uc815 \ud1a0\ud070 \uc785\ub825",zh:"\u8f93\u5165\u60a8\u7684\u8d26\u6237\u4ee4\u724c",tr:"Hesap jetonunuzu girin",id:"Masukkan token akun Anda",vi:"Nh\u1eadp token t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n"},accountTokenHint:{en:"Token from server admin",es:"Token del administrador del servidor",de:"Token vom Serveradministrator",fr:"Jeton de l'administrateur du serveur",ru:"\u0422\u043e\u043a\u0435\u043d \u043e\u0442 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430",pt:"Token do administrador do servidor",it:"Token dall'amministratore del server",pl:"Token od administratora serwera",ua:"\u0422\u043e\u043a\u0435\u043d \u0432\u0456\u0434 \u0430\u0434\u043c\u0456\u043d\u0456\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430",nl:"Token van serverbeheerder",ja:"\u30b5\u30fc\u30d0\u30fc\u7ba1\u7406\u8005\u304b\u3089\u306e\u30c8\u30fc\u30af\u30f3",ko:"\uc11c\ubc84 \uad00\ub9ac\uc790\uc758 \ud1a0\ud070",zh:"\u6765\u81ea\u670d\u52a1\u5668\u7ba1\u7406\u5458\u7684\u4ee4\u724c",tr:"Sunucu y\xf6neticisinden jeton",id:"Token dari admin server",vi:"Token t\u1eeb qu\u1ea3n tr\u1ecb vi\xean m\xe1y ch\u1ee7"},btnSaving:{en:"Saving...",es:"Guardando...",de:"Speichern...",fr:"Enregistrement...",ru:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",pt:"Salvando...",it:"Salvataggio...",pl:"Zapisywanie...",ua:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u044f...",nl:"Opslaan...",ja:"\u4fdd\u5b58\u4e2d...",ko:"\uc800\uc7a5 \uc911...",zh:"\u4fdd\u5b58\u4e2d...",tr:"Kaydediliyor...",id:"Menyimpan...",vi:"\u0110ang l\u01b0u..."},btnSaveConnect:{en:"Save & Connect",es:"Guardar y conectar",de:"Speichern & Verbinden",fr:"Enregistrer et connecter",ru:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f",pt:"Salvar e conectar",it:"Salva e connetti",pl:"Zapisz i po\u0142\u0105cz",ua:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0442\u0430 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0438\u0441\u044f",nl:"Opslaan en verbinden",ja:"\u4fdd\u5b58\u3057\u3066\u63a5\u7d9a",ko:"\uc800\uc7a5 \ubc0f \uc5f0\uacb0",zh:"\u4fdd\u5b58\u5e76\u8fde\u63a5",tr:"Kaydet ve Ba\u011flan",id:"Simpan & Hubungkan",vi:"L\u01b0u v\xe0 k\u1ebft n\u1ed1i"},btnDisconnect:{en:"Disconnect",es:"Desconectar",de:"Trennen",fr:"D\xe9connecter",ru:"\u041e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f",pt:"Desconectar",it:"Disconnetti",pl:"Roz\u0142\u0105cz",ua:"\u0412\u0456\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0438\u0441\u044f",nl:"Verbinding verbreken",ja:"\u5207\u65ad",ko:"\uc5f0\uacb0 \ud574\uc81c",zh:"\u65ad\u5f00\u8fde\u63a5",tr:"Ba\u011flant\u0131y\u0131 Kes",id:"Putuskan",vi:"Ng\u1eaft k\u1ebft n\u1ed1i"},connectedAs:{en:"Connected as:",es:"Conectado como:",de:"Verbunden als:",fr:"Connect\xe9 en tant que:",ru:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u043a\u0430\u043a:",pt:"Conectado como:",it:"Connesso come:",pl:"Po\u0142\u0105czono jako:",ua:"\u041f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u044f\u043a:",nl:"Verbonden als:",ja:"\u63a5\u7d9a\u6e08\u307f:",ko:"\ub2e4\uc74c\uc73c\ub85c \uc5f0\uacb0\ub428:",zh:"\u5df2\u8fde\u63a5\u4e3a:",tr:"Ba\u011fl\u0131:",id:"Terhubung sebagai:",vi:"\u0110\xe3 k\u1ebft n\u1ed1i v\u1edbi t\u01b0 c\xe1ch:"},userPreferences:{en:"User Preferences",es:"Preferencias de usuario",de:"Benutzereinstellungen",fr:"Pr\xe9f\xe9rences utilisateur",ru:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",pt:"Prefer\xeancias do usu\xe1rio",it:"Preferenze utente",pl:"Preferencje u\u017cytkownika",ua:"\u041d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f \u043a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0430",nl:"Gebruikersvoorkeuren",ja:"\u30e6\u30fc\u30b6\u30fc\u8a2d\u5b9a",ko:"\uc0ac\uc6a9\uc790 \uae30\ubcf8 \uc124\uc815",zh:"\u7528\u6237\u504f\u597d",tr:"Kullan\u0131c\u0131 Tercihleri",id:"Preferensi Pengguna",vi:"T\xf9y ch\u1ecdn ng\u01b0\u1eddi d\xf9ng"},defaultQuality:{en:"Default Quality",es:"Calidad predeterminada",de:"Standardqualit\xe4t",fr:"Qualit\xe9 par d\xe9faut",ru:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e",pt:"Qualidade padr\xe3o",it:"Qualit\xe0 predefinita",pl:"Domy\u015blna jako\u015b\u0107",ua:"\u042f\u043a\u0456\u0441\u0442\u044c \u0437\u0430 \u0437\u0430\u043c\u043e\u0432\u0447\u0443\u0432\u0430\u043d\u043d\u044f\u043c",nl:"Standaardkwaliteit",ja:"\u30c7\u30d5\u30a9\u30eb\u30c8\u54c1\u8cea",ko:"\uae30\ubcf8 \ud654\uc9c8",zh:"\u9ed8\u8ba4\u8d28\u91cf",tr:"Varsay\u0131lan Kalite",id:"Kualitas Default",vi:"Ch\u1ea5t l\u01b0\u1ee3ng m\u1eb7c \u0111\u1ecbnh"},qualityMinimum:{en:"Minimum",es:"M\xednimo",de:"Minimum",fr:"Minimum",ru:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435",pt:"M\xednimo",it:"Minimo",pl:"Minimalna",ua:"\u041c\u0456\u043d\u0456\u043c\u0430\u043b\u044c\u043d\u0430",nl:"Minimum",ja:"\u6700\u4f4e",ko:"\ucd5c\uc18c",zh:"\u6700\u4f4e",tr:"Minimum",id:"Minimum",vi:"T\u1ed1i thi\u1ec3u"},qualityRecommended:{en:"720p (Recommended)",es:"720p (Recomendado)",de:"720p (Empfohlen)",fr:"720p (Recommand\xe9)",ru:"720p (\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f)",pt:"720p (Recomendado)",it:"720p (Consigliato)",pl:"720p (Zalecane)",ua:"720p (\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u043d\u043e)",nl:"720p (Aanbevolen)",ja:"720p\uff08\u63a8\u5968\uff09",ko:"720p (\uad8c\uc7a5)",zh:"720p\uff08\u63a8\u8350\uff09",tr:"720p (\xd6nerilen)",id:"720p (Direkomendasikan)",vi:"720p (\u0110\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t)"},qualityMaximum:{en:"Maximum",es:"M\xe1ximo",de:"Maximum",fr:"Maximum",ru:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435",pt:"M\xe1ximo",it:"Massimo",pl:"Maksymalna",ua:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430",nl:"Maximum",ja:"\u6700\u9ad8",ko:"\ucd5c\ub300",zh:"\u6700\u9ad8",tr:"Maksimum",id:"Maksimum",vi:"T\u1ed1i \u0111a"},pageSize:{en:"Page Size",es:"Tama\xf1o de p\xe1gina",de:"Seitengr\xf6\xdfe",fr:"Taille de la page",ru:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b",pt:"Tamanho da p\xe1gina",it:"Dimensione pagina",pl:"Rozmiar strony",ua:"\u0420\u043e\u0437\u043c\u0456\u0440 \u0441\u0442\u043e\u0440\u0456\u043d\u043a\u0438",nl:"Paginagrootte",ja:"\u30da\u30fc\u30b8\u30b5\u30a4\u30ba",ko:"\ud398\uc774\uc9c0 \ud06c\uae30",zh:"\u9875\u9762\u5927\u5c0f",tr:"Sayfa Boyutu",id:"Ukuran Halaman",vi:"K\xedch th\u01b0\u1edbc trang"},pageSizeHint:{en:"Number of videos per page",es:"N\xfamero de v\xeddeos por p\xe1gina",de:"Anzahl der Videos pro Seite",fr:"Nombre de vid\xe9os par page",ru:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0438\u0434\u0435\u043e \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435",pt:"N\xfamero de v\xeddeos por p\xe1gina",it:"Numero di video per pagina",pl:"Liczba film\xf3w na stronie",ua:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c \u0432\u0456\u0434\u0435\u043e \u043d\u0430 \u0441\u0442\u043e\u0440\u0456\u043d\u0446\u0456",nl:"Aantal video's per pagina",ja:"\u30da\u30fc\u30b8\u3042\u305f\u308a\u306e\u52d5\u753b\u6570",ko:"\ud398\uc774\uc9c0\ub2f9 \ub3d9\uc601\uc0c1 \uc218",zh:"\u6bcf\u9875\u89c6\u9891\u6570",tr:"Sayfa ba\u015f\u0131na video say\u0131s\u0131",id:"Jumlah video per halaman",vi:"S\u1ed1 l\u01b0\u1ee3ng video m\u1ed7i trang"},autoPlay:{en:"Play video automatically",es:"Reproducir v\xeddeo autom\xe1ticamente",de:"Video automatisch abspielen",fr:"Lire la vid\xe9o automatiquement",ru:"\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u044c \u0432\u0438\u0434\u0435\u043e",pt:"Reproduzir v\xeddeo automaticamente",it:"Riproduci video automaticamente",pl:"Odtw\xf3rz film automatycznie",ua:"\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u043d\u043e \u0432\u0456\u0434\u0442\u0432\u043e\u0440\u044e\u0432\u0430\u0442\u0438 \u0432\u0456\u0434\u0435\u043e",nl:"Video automatisch afspelen",ja:"\u52d5\u753b\u3092\u81ea\u52d5\u518d\u751f",ko:"\ub3d9\uc601\uc0c1 \uc790\ub3d9 \uc7ac\uc0dd",zh:"\u81ea\u52a8\u64ad\u653e\u89c6\u9891",tr:"Videoyu otomatik oynat",id:"Putar video secara otomatis",vi:"T\u1ef1 \u0111\u1ed9ng ph\xe1t video"},yes:{en:"Yes",es:"S\xed",de:"Ja",fr:"Oui",ru:"\u0414\u0430",pt:"Sim",it:"S\xec",pl:"Tak",ua:"\u0422\u0430\u043a",nl:"Ja",ja:"\u306f\u3044",ko:"\uc608",zh:"\u662f",tr:"Evet",id:"Ya",vi:"C\xf3"},no:{en:"No",es:"No",de:"Nein",fr:"Non",ru:"\u041d\u0435\u0442",pt:"N\xe3o",it:"No",pl:"Nie",ua:"\u041d\u0456",nl:"Nee",ja:"\u3044\u3044\u3048",ko:"\uc544\ub2c8\uc694",zh:"\u5426",tr:"Hay\u0131r",id:"Tidak",vi:"Kh\xf4ng"},toastFillFields:{en:"Please fill in all fields",es:"Por favor completa todos los campos",de:"Bitte alle Felder ausf\xfcllen",fr:"Veuillez remplir tous les champs",ru:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f",pt:"Por favor, preencha todos os campos",it:"Compila tutti i campi",pl:"Prosz\u0119 wype\u0142ni\u0107 wszystkie pola",ua:"\u0411\u0443\u0434\u044c \u043b\u0430\u0441\u043a\u0430, \u0437\u0430\u043f\u043e\u0432\u043d\u0456\u0442\u044c \u0443\u0441\u0456 \u043f\u043e\u043b\u044f",nl:"Vul alle velden in",ja:"\u3059\u3079\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",ko:"\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694",zh:"\u8bf7\u586b\u5199\u6240\u6709\u5b57\u6bb5",tr:"L\xfctfen t\xfcm alanlar\u0131 doldurun",id:"Harap isi semua bidang",vi:"Vui l\xf2ng \u0111i\u1ec1n t\u1ea5t c\u1ea3 c\xe1c tr\u01b0\u1eddng"},toastConnectedSuccess:{en:"Connected successfully",es:"Conectado exitosamente",de:"Erfolgreich verbunden",fr:"Connect\xe9 avec succ\xe8s",ru:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043e",pt:"Conectado com sucesso",it:"Connesso con successo",pl:"Pomy\u015blnie po\u0142\u0105czono",ua:"\u0423\u0441\u043f\u0456\u0448\u043d\u043e \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043e",nl:"Succesvol verbonden",ja:"\u63a5\u7d9a\u306b\u6210\u529f\u3057\u307e\u3057\u305f",ko:"\uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4",zh:"\u8fde\u63a5\u6210\u529f",tr:"Ba\u015far\u0131yla ba\u011fland\u0131",id:"Berhasil terhubung",vi:"K\u1ebft n\u1ed1i th\xe0nh c\xf4ng"},toastDisconnected:{en:"Disconnected",es:"Desconectado",de:"Getrennt",fr:"D\xe9connect\xe9",ru:"\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043e",pt:"Desconectado",it:"Disconnesso",pl:"Roz\u0142\u0105czono",ua:"\u0412\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043e",nl:"Verbinding verbroken",ja:"\u5207\u65ad\u3055\u308c\u307e\u3057\u305f",ko:"\uc5f0\uacb0 \ud574\uc81c\ub428",zh:"\u5df2\u65ad\u5f00\u8fde\u63a5",tr:"Ba\u011flant\u0131 kesildi",id:"Terputus",vi:"\u0110\xe3 ng\u1eaft k\u1ebft n\u1ed1i"},toastQualityUpdated:{en:"Quality updated",es:"Calidad actualizada",de:"Qualit\xe4t aktualisiert",fr:"Qualit\xe9 mise \xe0 jour",ru:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e",pt:"Qualidade atualizada",it:"Qualit\xe0 aggiornata",pl:"Zaktualizowano jako\u015b\u0107",ua:"\u042f\u043a\u0456\u0441\u0442\u044c \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",nl:"Kwaliteit bijgewerkt",ja:"\u54c1\u8cea\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f",ko:"\ud654\uc9c8\uc774 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4",zh:"\u8d28\u91cf\u5df2\u66f4\u65b0",tr:"Kalite g\xfcncellendi",id:"Kualitas diperbarui",vi:"Ch\u1ea5t l\u01b0\u1ee3ng \u0111\xe3 c\u1eadp nh\u1eadt"},toastPageSizeUpdated:{en:"Page size updated",es:"Tama\xf1o de p\xe1gina actualizado",de:"Seitengr\xf6\xdfe aktualisiert",fr:"Taille de page mise \xe0 jour",ru:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d",pt:"Tamanho da p\xe1gina atualizado",it:"Dimensione pagina aggiornata",pl:"Zaktualizowano rozmiar strony",ua:"\u0420\u043e\u0437\u043c\u0456\u0440 \u0441\u0442\u043e\u0440\u0456\u043d\u043a\u0438 \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",nl:"Paginagrootte bijgewerkt",ja:"\u30da\u30fc\u30b8\u30b5\u30a4\u30ba\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f",ko:"\ud398\uc774\uc9c0 \ud06c\uae30\uac00 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4",zh:"\u9875\u9762\u5927\u5c0f\u5df2\u66f4\u65b0",tr:"Sayfa boyutu g\xfcncellendi",id:"Ukuran halaman diperbarui",vi:"K\xedch th\u01b0\u1edbc trang \u0111\xe3 c\u1eadp nh\u1eadt"},toastLanguageUpdated:{en:"Language updated",es:"Idioma actualizado",de:"Sprache aktualisiert",fr:"Langue mise \xe0 jour",ru:"\u042f\u0437\u044b\u043a \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d",pt:"Idioma atualizado",it:"Lingua aggiornata",pl:"Zaktualizowano j\u0119zyk",ua:"\u041c\u043e\u0432\u0443 \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",nl:"Taal bijgewerkt",ja:"\u8a00\u8a9e\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f",ko:"\uc5b8\uc5b4\uac00 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4",zh:"\u8bed\u8a00\u5df2\u66f4\u65b0",tr:"Dil g\xfcncellendi",id:"Bahasa diperbarui",vi:"Ng\xf4n ng\u1eef \u0111\xe3 c\u1eadp nh\u1eadt"},toastAutoPlayUpdated:{en:"Auto-play updated",es:"Reproducci\xf3n autom\xe1tica actualizada",de:"Autoplay aktualisiert",fr:"Lecture automatique mise \xe0 jour",ru:"\u0410\u0432\u0442\u043e\u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e",pt:"Reprodu\xe7\xe3o autom\xe1tica atualizada",it:"Riproduzione automatica aggiornata",pl:"Automatyczne odtwarzanie zaktualizowane",ua:"\u0410\u0432\u0442\u043e\u0432\u0456\u0434\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u044f \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",nl:"Automatisch afspelen bijgewerkt",ja:"\u81ea\u52d5\u518d\u751f\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f",ko:"\uc790\ub3d9 \uc7ac\uc0dd\uc774 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4",zh:"\u81ea\u52a8\u64ad\u653e\u5df2\u66f4\u65b0",tr:"Otomatik oynatma g\xfcncellendi",id:"Putar otomatis diperbarui",vi:"T\u1ef1 \u0111\u1ed9ng ph\xe1t \u0111\xe3 c\u1eadp nh\u1eadt"}};let ju=(()=>{class n{constructor(){this.toasts=[],this.toastId=0,this.toasts$=new ke}show(e,i="info"){var r={id:this.toastId++,message:e,type:i};this.toasts.push(r),this.toasts$.next([...this.toasts]),setTimeout(()=>{this.remove(r.id)},5e3)}success(e){this.show(e,"success")}error(e){this.show(e,"error")}warning(e){this.show(e,"warning")}info(e){this.show(e,"info")}remove(e){this.toasts=this.toasts.filter(i=>i.id!==e),this.toasts$.next([...this.toasts])}clear(){this.toasts=[],this.toasts$.next([])}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Bn=function(n){return n.MODE_INACTIVE="inactive",n.MODE_FLOATING="floating",n.MODE_MINIMIZED="minimized",n.MODE_HIDDEN="hidden",n}(Bn||{});function Ms(n,t,e,i=0,r=!1){const s=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function cR(n,t=0){return Qt((e,i)=>{e.subscribe(yt(i,r=>Ms(i,n,()=>i.next(r),t),()=>Ms(i,n,()=>i.complete(),t),r=>Ms(i,n,()=>i.error(r),t)))})}function uR(n,t=0){return Qt((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function dR(n,t){if(!n)throw new Error("Iterable cannot be null");return new wt(e=>{Ms(e,t,()=>{const i=n[Symbol.asyncIterator]();Ms(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function an(n,t){return t?function Cq(n,t){if(null!=n){if(tR(n))return function bq(n,t){return Dn(n).pipe(uR(t),cR(t))}(n,t);if(Jy(n))return function Sq(n,t){return new wt(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(eR(n))return function Eq(n,t){return Dn(n).pipe(uR(t),cR(t))}(n,t);if(nR(n))return dR(n,t);if(sR(n))return function Tq(n,t){return new wt(e=>{let i;return Ms(e,t,()=>{i=n[rR](),Ms(e,t,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void e.error(o)}s?e.complete():e.next(r)},0,!0)}),()=>Ze(i?.return)&&i.return()})}(n,t);if(aR(n))return function Dq(n,t){return dR(oR(n),t)}(n,t)}throw iR(n)}(n,t):Dn(n)}function fR(n){return n&&Ze(n.schedule)}function eb(n){return n[n.length-1]}function _p(n){return Ze(eb(n))?n.pop():void 0}function Hu(n){return fR(eb(n))?n.pop():void 0}function be(...n){return an(n,Hu(n))}const{isArray:wq}=Array,{getPrototypeOf:xq,prototype:Aq,keys:Mq}=Object;function hR(n){if(1===n.length){const t=n[0];if(wq(t))return{args:t,keys:null};if(function Rq(n){return n&&"object"==typeof n&&xq(n)===Aq}(t)){const e=Mq(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}const{isArray:kq}=Array;function tb(n){return Ne(t=>function Oq(n,t){return kq(t)?n(...t):n(t)}(n,t))}function pR(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}function nb(...n){const t=Hu(n),e=_p(n),{args:i,keys:r}=hR(n);if(0===i.length)return an([],t);const s=new wt(function Nq(n,t,e=as){return i=>{gR(t,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)gR(t,()=>{const c=an(n[l],t);let u=!1;c.subscribe(yt(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(e(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,t,r?o=>pR(r,o):as));return e?s.pipe(tb(e)):s}function gR(n,t,e){n?Ms(e,n,t):t()}const vp=bm(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Cn(n,t,e=1/0){return Ze(t)?Cn((i,r)=>Ne((s,o)=>t(i,s,r,o))(Dn(n(i,r))),e):("number"==typeof t&&(e=t),Qt((i,r)=>function Pq(n,t,e,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const f=()=>{d&&!l.length&&!c&&t.complete()},h=g=>c<i?p(g):l.push(g),p=g=>{s&&t.next(g),c++;let m=!1;Dn(e(g,u++)).subscribe(yt(t,_=>{r?.(_),s?h(_):t.next(_)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;l.length&&c<i;){const _=l.shift();o?Ms(t,o,()=>p(_)):p(_)}f()}catch(_){t.error(_)}}))};return n.subscribe(yt(t,h,()=>{d=!0,f()})),()=>{a?.()}}(i,r,n,e)))}function Bl(n=1/0){return Cn(as,n)}function Gu(...n){return function Lq(){return Bl(1)}()(an(n,Hu(n)))}function mR(n){return new wt(t=>{Dn(n()).subscribe(t)})}function zu(n,t){const e=Ze(n)?n:()=>n,i=r=>r.error(e());return new wt(t?r=>t.schedule(i,0,r):i)}const ui=new wt(n=>n.complete());function ib(){return Qt((n,t)=>{let e=null;n._refCount++;const i=yt(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const r=n._connection,s=e;e=null,r&&(!s||r===s)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}class _R extends wt{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,iS(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Pn;const e=this.getSubject();t.add(this.source.subscribe(yt(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Pn.EMPTY)}return t}refCount(){return ib()(this)}}function Yi(n,t){return Qt((e,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();e.subscribe(yt(i,l=>{r?.unsubscribe();let c=0;const u=s++;Dn(n(l,u)).subscribe(r=yt(i,d=>i.next(t?t(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Qi(n){return n<=0?()=>ui:Qt((t,e)=>{let i=0;t.subscribe(yt(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function mn(n,t){return Qt((e,i)=>{let r=0;e.subscribe(yt(i,s=>n.call(t,s,r++)&&i.next(s)))})}function yp(n){return Qt((t,e)=>{let i=!1;t.subscribe(yt(e,r=>{i=!0,e.next(r)},()=>{i||e.next(n),e.complete()}))})}function yR(n=Bq){return Qt((t,e)=>{let i=!1;t.subscribe(yt(e,r=>{i=!0,e.next(r)},()=>i?e.complete():e.error(n())))})}function Bq(){return new vp}function oa(n,t){const e=arguments.length>=2;return i=>i.pipe(n?mn((r,s)=>n(r,s,i)):as,Qi(1),e?yp(t):yR(()=>new vp))}function Ul(n,t){return Ze(t)?Cn(n,t,1):Cn(n,1)}function Qe(n){return Qt((t,e)=>{let s,i=null,r=!1;i=t.subscribe(yt(e,void 0,void 0,o=>{s=Dn(n(o,Qe(n)(t))),i?(i.unsubscribe(),i=null,s.subscribe(e)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(e))})}function rb(n){return n<=0?()=>ui:Qt((t,e)=>{let i=[];t.subscribe(yt(e,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)e.next(r);e.complete()},void 0,()=>{i=null}))})}function bp(n){return Qt((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}let jq=(()=>{class n{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(i){return new(i||n)(pe(rn))};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Fe="primary",Ku=Symbol("RouteTitle");class Wq{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function $l(n){return new Wq(n)}function Kq(n,t,e){const i=e.path.split("/");if(i.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(":"===o[0])r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function zr(n,t){const e=n?sb(n):void 0,i=t?sb(t):void 0;if(!e||!i||e.length!=i.length)return!1;let r;for(let s=0;s<e.length;s++)if(r=e[s],!SR(n[r],t[r]))return!1;return!0}function sb(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function SR(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),i=[...t].sort();return e.every((r,s)=>i[s]===r)}return n===t}function TR(n){return n.length>0?n[n.length-1]:null}function ao(n){return function yq(n){return!!n&&(n instanceof wt||Ze(n.lift)&&Ze(n.subscribe))}(n)?n:bu(n)?an(Promise.resolve(n)):be(n)}const Yq={exact:function IR(n,t,e){if(!la(n.segments,t.segments)||!Ep(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!n.children[i]||!IR(n.children[i],t.children[i],e))return!1;return!0},subset:wR},DR={exact:function Qq(n,t){return zr(n,t)},subset:function Zq(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>SR(n[e],t[e]))},ignored:()=>!0};function CR(n,t,e){return Yq[e.paths](n.root,t.root,e.matrixParams)&&DR[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function wR(n,t,e){return xR(n,t,t.segments,e)}function xR(n,t,e,i){if(n.segments.length>e.length){const r=n.segments.slice(0,e.length);return!(!la(r,e)||t.hasChildren()||!Ep(r,e,i))}if(n.segments.length===e.length){if(!la(n.segments,e)||!Ep(n.segments,e,i))return!1;for(const r in t.children)if(!n.children[r]||!wR(n.children[r],t.children[r],i))return!1;return!0}{const r=e.slice(0,n.segments.length),s=e.slice(n.segments.length);return!!(la(n.segments,r)&&Ep(n.segments,r,i)&&n.children[Fe])&&xR(n.children[Fe],t,s,i)}}function Ep(n,t,e){return t.every((i,r)=>DR[e](n[r].parameters,i.parameters))}class aa{root;queryParams;fragment;_queryParamMap;constructor(t=new _t([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap??=$l(this.queryParams),this._queryParamMap}toString(){return e9.serialize(this)}}class _t{segments;children;parent=null;constructor(t,e){this.segments=t,this.children=e,Object.values(e).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Tp(this)}}class qu{path;parameters;_parameterMap;constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=$l(this.parameters),this._parameterMap}toString(){return RR(this)}}function la(n,t){return n.length===t.length&&n.every((e,i)=>e.path===t[i].path)}let Yu=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:()=>new Sp,providedIn:"root"})}return n})();class Sp{parse(t){const e=new d9(t);return new aa(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${Qu(t.root,!0)}`,i=function i9(n){const t=Object.entries(n).map(([e,i])=>Array.isArray(i)?i.map(r=>`${Dp(e)}=${Dp(r)}`).join("&"):`${Dp(e)}=${Dp(i)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${i}${"string"==typeof t.fragment?`#${function t9(n){return encodeURI(n)}(t.fragment)}`:""}`}}const e9=new Sp;function Tp(n){return n.segments.map(t=>RR(t)).join("/")}function Qu(n,t){if(!n.hasChildren())return Tp(n);if(t){const e=n.children[Fe]?Qu(n.children[Fe],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Fe&&i.push(`${r}:${Qu(s,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function Jq(n,t){let e=[];return Object.entries(n.children).forEach(([i,r])=>{i===Fe&&(e=e.concat(t(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Fe&&(e=e.concat(t(r,i)))}),e}(n,(i,r)=>r===Fe?[Qu(n.children[Fe],!1)]:[`${r}:${Qu(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Fe]?`${Tp(n)}/${e[0]}`:`${Tp(n)}/(${e.join("//")})`}}function AR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Dp(n){return AR(n).replace(/%3B/gi,";")}function ob(n){return AR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Cp(n){return decodeURIComponent(n)}function MR(n){return Cp(n.replace(/\+/g,"%20"))}function RR(n){return`${ob(n.path)}${function n9(n){return Object.entries(n).map(([t,e])=>`;${ob(t)}=${ob(e)}`).join("")}(n.parameters)}`}const r9=/^[^\/()?;#]+/;function ab(n){const t=n.match(r9);return t?t[0]:""}const s9=/^[^\/()?;=#]+/,a9=/^[^=?&#]+/,c9=/^[^&#]+/;class d9{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new _t([],{}):new _t([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[Fe]=new _t(t,e)),i}parseSegment(){const t=ab(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new V(4009,!1);return this.capture(t),new qu(Cp(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=function o9(n){const t=n.match(s9);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const r=ab(this.remaining);r&&(i=r,this.capture(i))}t[Cp(e)]=Cp(i)}parseQueryParam(t){const e=function l9(n){const t=n.match(a9);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const o=function u9(n){const t=n.match(c9);return t?t[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=MR(e),s=MR(i);if(t.hasOwnProperty(r)){let o=t[r];Array.isArray(o)||(o=[o],t[r]=o),o.push(s)}else t[r]=s}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=ab(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new V(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=Fe);const o=this.parseChildren();e[s]=1===Object.keys(o).length?o[Fe]:new _t([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new V(4011,!1)}}function kR(n){return n.segments.length>0?new _t([],{[Fe]:n}):n}function OR(n){const t={};for(const[i,r]of Object.entries(n.children)){const s=OR(r);if(i===Fe&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))t[o]=a;else(s.segments.length>0||s.hasChildren())&&(t[i]=s)}return function f9(n){if(1===n.numberOfChildren&&n.children[Fe]){const t=n.children[Fe];return new _t(n.segments.concat(t.segments),t.children)}return n}(new _t(n.segments,t))}function ca(n){return n instanceof aa}function NR(n){let t;const r=kR(function e(s){const o={};for(const l of s.children){const c=e(l);o[l.outlet]=c}const a=new _t(s.url,o);return s===n&&(t=a),a}(n.root));return t??r}function PR(n,t,e,i){let r=n;for(;r.parent;)r=r.parent;if(0===t.length)return lb(r,r,r,e,i);const s=function p9(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new FR(!0,0,n);let t=0,e=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?e=!0:".."===a?t++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new FR(e,t,i)}(t);if(s.toRoot())return lb(r,r,new _t([],{}),e,i);const o=function g9(n,t,e){if(n.isAbsolute)return new wp(t,!0,0);if(!e)return new wp(t,!1,NaN);if(null===e.parent)return new wp(e,!0,0);const i=Ip(n.commands[0])?0:1;return function m9(n,t,e){let i=n,r=t,s=e;for(;s>r;){if(s-=r,i=i.parent,!i)throw new V(4005,!1);r=i.segments.length}return new wp(i,!1,r-s)}(e,e.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?Xu(o.segmentGroup,o.index,s.commands):BR(o.segmentGroup,o.index,s.commands);return lb(r,o.segmentGroup,a,e,i)}function Ip(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Zu(n){return"object"==typeof n&&null!=n&&n.outlets}function lb(n,t,e,i,r){let o,s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`}),o=n===t?e:LR(n,t,e);const a=kR(OR(o));return new aa(a,s,r)}function LR(n,t,e){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===t?e:LR(s,t,e)}),new _t(n.segments,i)}class FR{isAbsolute;numberOfDoubleDots;commands;constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&Ip(i[0]))throw new V(4003,!1);const r=i.find(Zu);if(r&&r!==TR(i))throw new V(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class wp{segmentGroup;processChildren;index;constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function BR(n,t,e){if(n??=new _t([],{}),0===n.segments.length&&n.hasChildren())return Xu(n,t,e);const i=function v9(n,t,e){let i=0,r=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=e.length)return s;const o=n.segments[r],a=e[i];if(Zu(a))break;const l=`${a}`,c=i<e.length-1?e[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!$R(l,c,o))return s;i+=2}else{if(!$R(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,t,e),r=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new _t(n.segments.slice(0,i.pathIndex),{});return s.children[Fe]=new _t(n.segments.slice(i.pathIndex),n.children),Xu(s,0,r)}return i.match&&0===r.length?new _t(n.segments,{}):i.match&&!n.hasChildren()?cb(n,t,e):i.match?Xu(n,0,r):cb(n,t,e)}function Xu(n,t,e){if(0===e.length)return new _t(n.segments,{});{const i=function _9(n){return Zu(n[0])?n[0].outlets:{[Fe]:n}}(e),r={};if(Object.keys(i).some(s=>s!==Fe)&&n.children[Fe]&&1===n.numberOfChildren&&0===n.children[Fe].segments.length){const s=Xu(n.children[Fe],t,e);return new _t(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=BR(n.children[s],t,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new _t(n.segments,r)}}function cb(n,t,e){const i=n.segments.slice(0,t);let r=0;for(;r<e.length;){const s=e[r];if(Zu(s)){const l=y9(s.outlets);return new _t(i,l)}if(0===r&&Ip(e[0])){i.push(new qu(n.segments[t].path,UR(e[0]))),r++;continue}const o=Zu(s)?s.outlets[Fe]:`${s}`,a=r<e.length-1?e[r+1]:null;o&&a&&Ip(a)?(i.push(new qu(o,UR(a))),r+=2):(i.push(new qu(o,{})),r++)}return new _t(i,{})}function y9(n){const t={};return Object.entries(n).forEach(([e,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(t[e]=cb(new _t([],{}),0,i))}),t}function UR(n){const t={};return Object.entries(n).forEach(([e,i])=>t[e]=`${i}`),t}function $R(n,t,e){return n==e.path&&zr(t,e.parameters)}const xp="imperative";var Ke=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Ke||{});class Wr{id;url;constructor(t,e){this.id=t,this.url=e}}class Ap extends Wr{type=Ke.NavigationStart;navigationTrigger;restoredState;constructor(t,e,i="imperative",r=null){super(t,e),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Rs extends Wr{urlAfterRedirects;type=Ke.NavigationEnd;constructor(t,e,i){super(t,e),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var wi=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(wi||{}),Mp=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Mp||{});class ua extends Wr{reason;code;type=Ke.NavigationCancel;constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Vl extends Wr{reason;code;type=Ke.NavigationSkipped;constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r}}class ub extends Wr{error;target;type=Ke.NavigationError;constructor(t,e,i,r){super(t,e),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class VR extends Wr{urlAfterRedirects;state;type=Ke.RoutesRecognized;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class b9 extends Wr{urlAfterRedirects;state;type=Ke.GuardsCheckStart;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class E9 extends Wr{urlAfterRedirects;state;shouldActivate;type=Ke.GuardsCheckEnd;constructor(t,e,i,r,s){super(t,e),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class S9 extends Wr{urlAfterRedirects;state;type=Ke.ResolveStart;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class T9 extends Wr{urlAfterRedirects;state;type=Ke.ResolveEnd;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class D9{route;type=Ke.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class C9{route;type=Ke.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class I9{snapshot;type=Ke.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class w9{snapshot;type=Ke.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class x9{snapshot;type=Ke.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class A9{snapshot;type=Ke.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class jR{routerEvent;position;anchor;type=Ke.Scroll;constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class db{}class Rp{url;navigationBehaviorOptions;constructor(t,e){this.url=t,this.navigationBehaviorOptions=e}}function br(n){return n.outlet||Fe}function Ju(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class P9{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Ju(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new ed(this.rootInjector)}}let ed=(()=>{class n{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,i){const r=this.getOrCreateContext(e);r.outlet=i,this.contexts.set(e,r)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new P9(this.rootInjector),this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(i){return new(i||n)(pe(An))};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class HR{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=fb(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){const e=fb(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=hb(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return hb(t,this._root).map(e=>e.value)}}function fb(n,t){if(n===t.value)return t;for(const e of t.children){const i=fb(n,e);if(i)return i}return null}function hb(n,t){if(n===t.value)return[t];for(const e of t.children){const i=hb(n,e);if(i.length)return i.unshift(t),i}return[]}class Er{value;children;constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function jl(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class GR extends HR{snapshot;constructor(t,e){super(t),this.snapshot=e,pb(this,t)}toString(){return this.snapshot.toString()}}function zR(n){const t=function L9(n){const s=new Op([],{},{},"",{},Fe,n,null,{});return new WR("",new Er(s,[]))}(n),e=new en([new qu("",{})]),i=new en({}),r=new en({}),s=new en({}),o=new en(""),a=new da(e,i,s,o,r,Fe,n,t.root);return a.snapshot=t.root,new GR(new Er(a,[]),t)}class da{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,e,i,r,s,o,a,l){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Ne(c=>c[Ku]))??be(void 0),this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ne(t=>$l(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ne(t=>$l(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function kp(n,t,e="emptyOnly"){let i;const{routeConfig:r}=n;return i=null===t||"always"!==e&&""!==r?.path&&(t.component||t.routeConfig?.loadComponent)?{params:{...n.params},data:{...n.data},resolve:{...n.data,...n._resolvedData??{}}}:{params:{...t.params,...n.params},data:{...t.data,...n.data},resolve:{...n.data,...t.data,...r?.data,...n._resolvedData}},r&&qR(r)&&(i.resolve[Ku]=r.title),i}class Op{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Ku]}constructor(t,e,i,r,s,o,a,l,c){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=$l(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=$l(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class WR extends HR{url;constructor(t,e){super(e),this.url=t,pb(this,e)}toString(){return KR(this._root)}}function pb(n,t){t.value._routerState=n,t.children.forEach(e=>pb(n,e))}function KR(n){const t=n.children.length>0?` { ${n.children.map(KR).join(", ")} } `:"";return`${n.value}${t}`}function gb(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,zr(t.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),zr(t.params,e.params)||n.paramsSubject.next(e.params),function qq(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!zr(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.urlSubject.next(e.url),zr(t.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function mb(n,t){const e=zr(n.params,t.params)&&function Xq(n,t){return la(n,t)&&n.every((e,i)=>zr(e.parameters,t[i].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||mb(n.parent,t.parent))}function qR(n){return"string"==typeof n.title||null===n.title}const F9=new W("");let _b=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Fe;activateEvents=new ve;deactivateEvents=new ve;attachEvents=new ve;detachEvents=new ve;routerOutletData=YU(void 0);parentContexts=w(ed);location=w(Ti);changeDetector=w(zi);inputBinder=w(Np,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){const{firstChange:i,previousValue:r}=e.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new V(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new V(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new V(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new V(4013,!1);this._activatedRoute=e;const r=this.location,o=e.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new B9(e,a,r.injector,this.routerOutletData);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ne({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Fn]})}return n})();class B9{route;childContexts;parent;outletData;constructor(t,e,i,r){this.route=t,this.childContexts=e,this.parent=i,this.outletData=r}get(t,e){return t===da?this.route:t===ed?this.childContexts:t===F9?this.outletData:this.parent.get(t,e)}}const Np=new W("");let YR=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:i}=e,r=nb([i.queryParams,i.params,i.data]).pipe(Yi(([s,o,a],l)=>(a={...s,...o,...a},0===l?be(a):Promise.resolve(a)))).subscribe(s=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(e);const o=function Qz(n){const t=Ge(n);if(!t)return null;const e=new gu(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)e.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,r)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})(),QR=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Rt({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){1&i&&U(0,"router-outlet")},dependencies:[_b],encapsulation:2})}return n})();function vb(n){const t=n.children&&n.children.map(vb),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Fe&&(e.component=QR),e}function td(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=t.value;const r=function $9(n,t,e){return t.children.map(i=>{for(const r of e.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return td(n,i,r);return td(n,i)})}(n,t,e);return new Er(i,r)}{if(n.shouldAttach(t.value)){const s=n.retrieve(t.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(a=>td(n,a)),o}}const i=function V9(n){return new da(new en(n.url),new en(n.params),new en(n.queryParams),new en(n.fragment),new en(n.data),n.outlet,n.component,n)}(t.value),r=t.children.map(s=>td(n,s));return new Er(i,r)}}class yb{redirectTo;navigationBehaviorOptions;constructor(t,e){this.redirectTo=t,this.navigationBehaviorOptions=e}}const ZR="ngNavigationCancelingError";function Pp(n,t){const{redirectTo:e,navigationBehaviorOptions:i}=ca(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=XR(!1,wi.Redirect);return r.url=e,r.navigationBehaviorOptions=i,r}function XR(n,t){const e=new Error(`NavigationCancelingError: ${n||""}`);return e[ZR]=!0,e.cancellationCode=t,e}function JR(n){return!!n&&n[ZR]}class G9{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,e,i,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),gb(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const r=jl(e);t.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(t,e,i){const r=t.value,s=e?e.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,i);else s&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,s=jl(t);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:a})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,s=jl(t);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(t,e,i){const r=jl(e);t.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new A9(s.value.snapshot))}),t.children.length&&this.forwardEvent(new w9(t.value.snapshot))}activateRoutes(t,e,i){const r=t.value,s=e?e.value:null;if(gb(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),gb(a.route.value),this.activateChildRoutes(t,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(t,null,o.children)}else this.activateChildRoutes(t,null,i)}}class ek{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Lp{component;route;constructor(t,e){this.component=t,this.route=e}}function z9(n,t,e){const i=n._root;return nd(i,t?t._root:null,e,[i.value])}function Hl(n,t){const e=Symbol(),i=t.get(n,e);return i===e?"function"!=typeof n||function aB(n){return null!==cf(n)}(n)?t.get(n):n:i}function nd(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=jl(t);return n.children.forEach(o=>{(function K9(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=t?t.value:null,a=e?e.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function q9(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!la(n.url,t.url);case"pathParamsOrQueryParamsChange":return!la(n.url,t.url)||!zr(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!mb(n,t)||!zr(n.queryParams,t.queryParams);default:return!mb(n,t)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new ek(i)):(s.data=o.data,s._resolvedData=o._resolvedData),nd(n,t,s.component?a?a.children:null:e,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Lp(a.outlet.component,o))}else o&&id(t,a,r),r.canActivateChecks.push(new ek(i)),nd(n,null,s.component?a?a.children:null:e,i,r)})(o,s[o.value.outlet],e,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>id(a,e.getContext(o),r)),r}function id(n,t,e){const i=jl(n),r=n.value;Object.entries(i).forEach(([s,o])=>{id(o,r.component?t?t.children.getContext(s):null:t,e)}),e.canDeactivateChecks.push(new Lp(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function rd(n){return"function"==typeof n}function tk(n){return n instanceof vp||"EmptyError"===n?.name}const Fp=Symbol("INITIAL_VALUE");function Gl(){return Yi(n=>nb(n.map(t=>t.pipe(Qi(1),function vR(...n){const t=Hu(n);return Qt((e,i)=>{(t?Gu(n,e,t):Gu(n,e)).subscribe(i)})}(Fp)))).pipe(Ne(t=>{for(const e of t)if(!0!==e){if(e===Fp)return Fp;if(!1===e||tY(e))return e}return!0}),mn(t=>t!==Fp),Qi(1)))}function tY(n){return ca(n)||n instanceof yb}function nk(n){return function Q2(...n){return eS(n)}(et(t=>{if("boolean"!=typeof t)throw Pp(0,t)}),Ne(t=>!0===t))}class bb{segmentGroup;constructor(t){this.segmentGroup=t||null}}class Eb extends Error{urlTree;constructor(t){super(),this.urlTree=t}}function zl(n){return zu(new bb(n))}class pY{urlSerializer;urlTree;constructor(t,e){this.urlSerializer=t,this.urlTree=e}lineralizeSegments(t,e){let i=[],r=e.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return be(i);if(r.numberOfChildren>1||!r.children[Fe])return zu(new V(4e3,!1));r=r.children[Fe]}}applyRedirectCommands(t,e,i,r,s){if("string"!=typeof e){const a=e,{queryParams:l,fragment:c,routeConfig:u,url:d,outlet:f,params:h,data:p,title:g}=r,m=Bi(s,()=>a({params:h,data:p,queryParams:l,fragment:c,routeConfig:u,url:d,outlet:f,title:g}));if(m instanceof aa)throw new Eb(m);e=m}const o=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,i);if("/"===e[0])throw new Eb(o);return o}applyRedirectCreateUrlTree(t,e,i,r){const s=this.createSegmentGroup(t,e.root,i,r);return new aa(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return Object.entries(t).forEach(([r,s])=>{if("string"==typeof s&&":"===s[0]){const a=s.substring(1);i[r]=e[a]}else i[r]=s}),i}createSegmentGroup(t,e,i,r){const s=this.createSegments(t,e.segments,i,r);let o={};return Object.entries(e.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(t,l,i,r)}),new _t(s,o)}createSegments(t,e,i,r){return e.map(s=>":"===s.path[0]?this.findPosParam(t,s,r):this.findOrReturn(s,i))}findPosParam(t,e,i){const r=i[e.path.substring(1)];if(!r)throw new V(4001,!1);return r}findOrReturn(t,e){let i=0;for(const r of e){if(r.path===t.path)return e.splice(i),r;i++}return t}}const Sb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function gY(n,t,e,i,r){const s=ik(n,t,e);return s.matched?(i=function M9(n,t){return n.providers&&!n._injector&&(n._injector=Ih(n.providers,t,`Route: ${n.path}`)),n._injector??t}(t,i),function dY(n,t,e,i){const r=t.canMatch;return r&&0!==r.length?be(r.map(o=>{const a=Hl(o,n);return ao(function eY(n){return n&&rd(n.canMatch)}(a)?a.canMatch(t,e):Bi(n,()=>a(t,e)))})).pipe(Gl(),nk()):be(!0)}(i,t,e).pipe(Ne(o=>!0===o?s:{...Sb}))):be(s)}function ik(n,t,e){if("**"===t.path)return function mY(n){return{matched:!0,parameters:n.length>0?TR(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}(e);if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...Sb}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(t.matcher||Kq)(e,n,t);if(!r)return{...Sb};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function rk(n,t,e,i){return e.length>0&&function yY(n,t,e){return e.some(i=>Bp(n,t,i)&&br(i)!==Fe)}(n,e,i)?{segmentGroup:new _t(t,vY(i,new _t(e,n.children))),slicedSegments:[]}:0===e.length&&function bY(n,t,e){return e.some(i=>Bp(n,t,i))}(n,e,i)?{segmentGroup:new _t(n.segments,_Y(n,e,i,n.children)),slicedSegments:e}:{segmentGroup:new _t(n.segments,n.children),slicedSegments:e}}function _Y(n,t,e,i){const r={};for(const s of e)if(Bp(n,t,s)&&!i[br(s)]){const o=new _t([],{});r[br(s)]=o}return{...i,...r}}function vY(n,t){const e={};e[Fe]=t;for(const i of n)if(""===i.path&&br(i)!==Fe){const r=new _t([],{});e[br(i)]=r}return e}function Bp(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}class SY{}class CY{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,e,i,r,s,o,a){this.injector=t,this.configLoader=e,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new pY(this.urlSerializer,this.urlTree)}noMatchError(t){return new V(4002,`'${t.segmentGroup}'`)}recognize(){const t=rk(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(Ne(({children:e,rootSnapshot:i})=>{const r=new Er(i,e),s=new WR("",r),o=function h9(n,t,e=null,i=null){return PR(NR(n),t,e,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(t){const e=new Op([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Object.freeze({}),Fe,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,Fe,e).pipe(Ne(i=>({children:i,rootSnapshot:e})),Qe(i=>{if(i instanceof Eb)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof bb?this.noMatchError(i):i}))}processSegmentGroup(t,e,i,r,s){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,e,i,s):this.processSegment(t,e,i,i.segments,r,!0,s).pipe(Ne(o=>o instanceof Er?[o]:[]))}processChildren(t,e,i,r){const s=[];for(const o of Object.keys(i.children))"primary"===o?s.unshift(o):s.push(o);return an(s).pipe(Ul(o=>{const a=i.children[o],l=function N9(n,t){const e=n.filter(i=>br(i)===t);return e.push(...n.filter(i=>br(i)!==t)),e}(e,o);return this.processSegmentGroup(t,l,a,o,r)}),function $q(n,t){return Qt(function Uq(n,t,e,i,r){return(s,o)=>{let a=e,l=t,c=0;s.subscribe(yt(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,t,arguments.length>=2,!0))}((o,a)=>(o.push(...a),o)),yp(null),function Vq(n,t){const e=arguments.length>=2;return i=>i.pipe(n?mn((r,s)=>n(r,s,i)):as,rb(1),e?yp(t):yR(()=>new vp))}(),Cn(o=>{if(null===o)return zl(i);const a=sk(o);return function IY(n){n.sort((t,e)=>t.value.outlet===Fe?-1:e.value.outlet===Fe?1:t.value.outlet.localeCompare(e.value.outlet))}(a),be(a)}))}processSegment(t,e,i,r,s,o,a){return an(e).pipe(Ul(l=>this.processSegmentAgainstRoute(l._injector??t,e,l,i,r,s,o,a).pipe(Qe(c=>{if(c instanceof bb)return be(null);throw c}))),oa(l=>!!l),Qe(l=>{if(tk(l))return function EY(n,t,e){return 0===t.length&&!n.children[e]}(i,r,s)?be(new SY):zl(i);throw l}))}processSegmentAgainstRoute(t,e,i,r,s,o,a,l){return br(i)===o||o!==Fe&&Bp(r,s,i)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,r,i,s,o,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(t,r,e,i,s,o,l):zl(r):zl(r)}expandSegmentAgainstRouteUsingRedirect(t,e,i,r,s,o,a){const{matched:l,parameters:c,consumedSegments:u,positionalParamSegments:d,remainingSegments:f}=ik(e,r,s);if(!l)return zl(e);"string"==typeof r.redirectTo&&"/"===r.redirectTo[0]&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const h=new Op(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ok(r),br(r),r.component??r._loadedComponent??null,r,ak(r)),p=kp(h,a,this.paramsInheritanceStrategy);h.params=Object.freeze(p.params),h.data=Object.freeze(p.data);const g=this.applyRedirects.applyRedirectCommands(u,r.redirectTo,d,h,t);return this.applyRedirects.lineralizeSegments(r,g).pipe(Cn(m=>this.processSegment(t,i,e,m.concat(f),o,!1,a)))}matchSegmentAgainstRoute(t,e,i,r,s,o){const a=gY(e,i,r,t);return"**"===i.path&&(e.children={}),a.pipe(Yi(l=>l.matched?this.getChildConfig(t=i._injector??t,i,r).pipe(Yi(({routes:c})=>{const u=i._loadedInjector??t,{parameters:d,consumedSegments:f,remainingSegments:h}=l,p=new Op(f,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ok(i),br(i),i.component??i._loadedComponent??null,i,ak(i)),g=kp(p,o,this.paramsInheritanceStrategy);p.params=Object.freeze(g.params),p.data=Object.freeze(g.data);const{segmentGroup:m,slicedSegments:_}=rk(e,f,h,c);if(0===_.length&&m.hasChildren())return this.processChildren(u,c,m,p).pipe(Ne(b=>new Er(p,b)));if(0===c.length&&0===_.length)return be(new Er(p,[]));const y=br(i)===s;return this.processSegment(u,c,m,_,y?Fe:s,!0,p).pipe(Ne(b=>new Er(p,b instanceof Er?[b]:[])))})):zl(e)))}getChildConfig(t,e,i){return e.children?be({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?be({routes:e._loadedRoutes,injector:e._loadedInjector}):function uY(n,t,e,i){const r=t.canLoad;return void 0===r||0===r.length?be(!0):be(r.map(o=>{const a=Hl(o,n);return ao(function Q9(n){return n&&rd(n.canLoad)}(a)?a.canLoad(t,e):Bi(n,()=>a(t,e)))})).pipe(Gl(),nk())}(t,e,i).pipe(Cn(r=>r?this.configLoader.loadChildren(t,e).pipe(et(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):function hY(){return zu(XR(!1,wi.GuardRejected))}())):be({routes:[],injector:t})}}function wY(n){const t=n.value.routeConfig;return t&&""===t.path}function sk(n){const t=[],e=new Set;for(const i of n){if(!wY(i)){t.push(i);continue}const r=t.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),e.add(r)):t.push(i)}for(const i of e){const r=sk(i.children);t.push(new Er(i.value,r))}return t.filter(i=>!e.has(i))}function ok(n){return n.data||{}}function ak(n){return n.resolve||{}}function lk(n){const t=n.children.map(e=>lk(e)).flat();return[n,...t]}function Tb(n){return Yi(t=>{const e=n(t);return e?an(e).pipe(Ne(()=>t)):be(t)})}let ck=(()=>{class n{buildTitle(e){let i,r=e.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Fe);return i}getResolvedTitleForRoute(e){return e.data[Ku]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:()=>w(OY),providedIn:"root"})}return n})(),OY=(()=>{class n extends ck{title;constructor(e){super(),this.title=e}updateTitle(e){const i=this.buildTitle(e);void 0!==i&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(pe(jq))};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const sd=new W("",{providedIn:"root",factory:()=>({})}),Up=new W("");let Db=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=w(M6);loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return be(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const i=ao(e.loadComponent()).pipe(Ne(uk),et(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),bp(()=>{this.componentLoaders.delete(e)})),r=new _R(i,()=>new ke).pipe(ib());return this.componentLoaders.set(e,r),r}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return be({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function NY(n,t,e,i){return ao(n.loadChildren()).pipe(Ne(uk),Cn(r=>r instanceof GI||Array.isArray(r)?be(r):an(t.compileModuleAsync(r))),Ne(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(e).injector,o=s.get(Up,[],{optional:!0,self:!0}).flat()),{routes:o.map(vb),injector:s}}))}(i,this.compiler,e,this.onLoadEndListener).pipe(bp(()=>{this.childrenLoaders.delete(i)})),o=new _R(s,()=>new ke).pipe(ib());return this.childrenLoaders.set(i,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function uk(n){return function PY(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Cb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:()=>w(LY),providedIn:"root"})}return n})(),LY=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const dk=new W(""),fk=new W("");function FY(n,t,e){const i=n.get(fk),r=n.get(rn);return n.get($e).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s;const o=new Promise(c=>{s=c}),a=r.startViewTransition(()=>(s(),function BY(n){return new Promise(t=>{Wo({read:()=>setTimeout(t)},{injector:n})})}(n))),{onViewTransitionCreated:l}=i;return l&&Bi(n,()=>l({transition:a,from:t,to:e})),o})}const hk=new W("");let Ib=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new ke;transitionAbortSubject=new ke;configLoader=w(Db);environmentInjector=w(An);destroyRef=w(Gn);urlSerializer=w(Yu);rootContexts=w(ed);location=w(Bu);inputBindingEnabled=null!==w(Np,{optional:!0});titleStrategy=w(ck);options=w(sd,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=w(Cb);createViewTransition=w(dk,{optional:!0});navigationErrorHandler=w(hk,{optional:!0});navigationId=0;get hasRequestedNavigation(){return 0!==this.navigationId}transitions;afterPreactivation=()=>be(void 0);rootComponentType=null;destroyed=!1;constructor(){this.configLoader.onLoadEndListener=r=>this.events.next(new C9(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new D9(r)),this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){const i=++this.navigationId;this.transitions?.next({...e,extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i})}setupNavigations(e){return this.transitions=new en(null),this.transitions.pipe(mn(i=>null!==i),Yi(i=>{let r=!1,s=!1;return be(i).pipe(Yi(o=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",wi.SupersededByNewNavigation),ui;this.currentTransition=i,this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:"string"==typeof o.extras.browserUrl?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const a=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!a&&"reload"!==(o.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const c="";return this.events.next(new Vl(o.id,this.urlSerializer.serialize(o.rawUrl),c,Mp.IgnoredSameUrlNavigation)),o.resolve(!1),ui}if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return be(o).pipe(Yi(c=>(this.events.next(new Ap(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?ui:Promise.resolve(c))),function xY(n,t,e,i,r,s){return Cn(o=>function TY(n,t,e,i,r,s,o="emptyOnly"){return new CY(n,t,e,i,r,o,s).recognize()}(n,t,e,i,o.extractedUrl,r,s).pipe(Ne(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),et(c=>{i.targetSnapshot=c.targetSnapshot,i.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:c.urlAfterRedirects};const u=new VR(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){const{id:c,extractedUrl:u,source:d,restoredState:f,extras:h}=o,p=new Ap(c,this.urlSerializer.serialize(u),d,f);this.events.next(p);const g=zR(this.rootComponentType).snapshot;return this.currentTransition=i={...o,targetSnapshot:g,urlAfterRedirects:u,extras:{...h,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=u,be(i)}{const c="";return this.events.next(new Vl(o.id,this.urlSerializer.serialize(o.extractedUrl),c,Mp.IgnoredByUrlHandlingStrategy)),o.resolve(!1),ui}}),et(o=>{const a=new b9(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),Ne(o=>(this.currentTransition=i={...o,guards:z9(o.targetSnapshot,o.currentSnapshot,this.rootContexts)},i)),function nY(n,t){return Cn(e=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=e;return 0===o.length&&0===s.length?be({...e,guardsResult:!0}):function iY(n,t,e,i){return an(n).pipe(Cn(r=>function cY(n,t,e,i,r){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?be(s.map(a=>{const l=Ju(t)??r,c=Hl(a,l);return ao(function J9(n){return n&&rd(n.canDeactivate)}(c)?c.canDeactivate(n,t,e,i):Bi(l,()=>c(n,t,e,i))).pipe(oa())})).pipe(Gl()):be(!0)}(r.component,r.route,e,t,i)),oa(r=>!0!==r,!0))}(o,i,r,n).pipe(Cn(a=>a&&function Y9(n){return"boolean"==typeof n}(a)?function rY(n,t,e,i){return an(t).pipe(Ul(r=>Gu(function oY(n,t){return null!==n&&t&&t(new I9(n)),be(!0)}(r.route.parent,i),function sY(n,t){return null!==n&&t&&t(new x9(n)),be(!0)}(r.route,i),function lY(n,t,e){const i=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(o=>function W9(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>mR(()=>be(o.guards.map(l=>{const c=Ju(o.node)??e,u=Hl(l,c);return ao(function X9(n){return n&&rd(n.canActivateChild)}(u)?u.canActivateChild(i,n):Bi(c,()=>u(i,n))).pipe(oa())})).pipe(Gl())));return be(s).pipe(Gl())}(n,r.path,e),function aY(n,t,e){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return be(!0);const r=i.map(s=>mR(()=>{const o=Ju(t)??e,a=Hl(s,o);return ao(function Z9(n){return n&&rd(n.canActivate)}(a)?a.canActivate(t,n):Bi(o,()=>a(t,n))).pipe(oa())}));return be(r).pipe(Gl())}(n,r.route,e))),oa(r=>!0!==r,!0))}(i,s,n,t):be(a)),Ne(a=>({...e,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),et(o=>{if(i.guardsResult=o.guardsResult,o.guardsResult&&"boolean"!=typeof o.guardsResult)throw Pp(0,o.guardsResult);const a=new E9(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),mn(o=>!!o.guardsResult||(this.cancelNavigationTransition(o,"",wi.GuardRejected),!1)),Tb(o=>{if(0!==o.guards.canActivateChecks.length)return be(o).pipe(et(a=>{const l=new S9(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),Yi(a=>{let l=!1;return be(a).pipe(function AY(n,t){return Cn(e=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=e;if(!r.length)return be(e);const s=new Set(r.map(l=>l.route)),o=new Set;for(const l of s)if(!o.has(l))for(const c of lk(l))o.add(c);let a=0;return an(o).pipe(Ul(l=>s.has(l)?function MY(n,t,e,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!qR(r)&&(s[Ku]=r.title),function RY(n,t,e,i){const r=sb(n);if(0===r.length)return be({});const s={};return an(r).pipe(Cn(o=>function kY(n,t,e,i){const r=Ju(t)??i,s=Hl(n,r);return ao(s.resolve?s.resolve(t,e):Bi(r,()=>s(t,e)))}(n[o],t,e,i).pipe(oa(),et(a=>{if(a instanceof yb)throw Pp(new Sp,a);s[o]=a}))),rb(1),Ne(()=>s),Qe(o=>tk(o)?ui:zu(o)))}(s,n,t,i).pipe(Ne(o=>(n._resolvedData=o,n.data=kp(n,n.parent,e).resolve,null)))}(l,i,n,t):(l.data=kp(l,l.parent,n).resolve,be(void 0))),et(()=>a++),rb(1),Cn(l=>a===o.size?be(e):ui))})}(this.paramsInheritanceStrategy,this.environmentInjector),et({next:()=>l=!0,complete:()=>{l||this.cancelNavigationTransition(a,"",wi.NoDataFromResolver)}}))}),et(a=>{const l=new T9(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),Tb(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(et(u=>{l.component=u}),Ne(()=>{})));for(const u of l.children)c.push(...a(u));return c};return nb(a(o.targetSnapshot.root)).pipe(yp(null),Qi(1))}),Tb(()=>this.afterPreactivation()),Yi(()=>{const{currentSnapshot:o,targetSnapshot:a}=i,l=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return l?an(l).pipe(Ne(()=>i)):be(i)}),Ne(o=>{const a=function U9(n,t,e){const i=td(n,t._root,e?e._root:void 0);return new GR(i,t)}(e.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=i={...o,targetRouterState:a},this.currentNavigation.targetRouterState=a,i}),et(()=>{this.events.next(new db)}),((n,t,e,i)=>Ne(r=>(new G9(t,r.targetRouterState,r.currentRouterState,e,i).activate(n),r)))(this.rootContexts,e.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Qi(1),et({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Rs(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Oe(this.transitionAbortSubject.pipe(et(o=>{throw o}))),bp(()=>{!r&&!s&&this.cancelNavigationTransition(i,"",wi.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation=null,this.currentTransition=null)}),Qe(o=>{if(this.destroyed)return i.resolve(!1),ui;if(s=!0,JR(o))this.events.next(new ua(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode)),function j9(n){return JR(n)&&ca(n.url)}(o)?this.events.next(new Rp(o.url,o.navigationBehaviorOptions)):i.resolve(!1);else{const a=new ub(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);try{const l=Bi(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(!(l instanceof yb))throw this.events.next(a),o;{const{message:c,cancellationCode:u}=Pp(0,l);this.events.next(new ua(i.id,this.urlSerializer.serialize(i.extractedUrl),c,u)),this.events.next(new Rp(l.redirectTo,l.navigationBehaviorOptions))}}catch(l){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(l)}}return ui}))}))}cancelNavigationTransition(e,i,r){const s=new ua(e.id,this.urlSerializer.serialize(e.extractedUrl),i,r);this.events.next(s),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function UY(n){return n!==xp}let $Y=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:()=>w(jY),providedIn:"root"})}return n})();class VY{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let jY=(()=>{class n extends VY{static \u0275fac=(()=>{let e;return function(r){return(e||(e=xt(n)))(r||n)}})();static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pk=(()=>{class n{urlSerializer=w(Yu);options=w(sd,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=w(Bu);urlHandlingStrategy=w(Cb);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new aa;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:i,targetBrowserUrl:r}){const s=void 0!==e?this.urlHandlingStrategy.merge(e,i):i,o=r??s;return o instanceof aa?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:e,finalUrl:i,initialUrl:r}){i&&e?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=e):this.rawUrlTree=r}routerState=zR(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:()=>w(HY),providedIn:"root"})}return n})(),HY=(()=>{class n extends pk{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(i=>{"popstate"===i.type&&setTimeout(()=>{e(i.url,i.state,"popstate")})})}handleRouterEvent(e,i){e instanceof Ap?this.updateStateMemento():e instanceof Vl?this.commitTransition(i):e instanceof VR?"eager"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):e instanceof db?(this.commitTransition(i),"deferred"===this.urlUpdateStrategy&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):e instanceof ua&&(e.code===wi.GuardRejected||e.code===wi.NoDataFromResolver)?this.restoreHistory(i):e instanceof ub?this.restoreHistory(i,!0):e instanceof Rs&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:i,id:r}){const{replaceUrl:s,state:o}=i;if(this.location.isCurrentPathEqualTo(e)||s){const a=this.browserPageId,l={...o,...this.generateNgRouterState(r,a)};this.location.replaceState(e,"",l)}else{const a={...o,...this.generateNgRouterState(r,this.browserPageId+1)};this.location.go(e,"",a)}}restoreHistory(e,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.getCurrentUrlTree()===e.finalUrl&&0===s&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xt(n)))(r||n)}})();static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gk(n,t){n.events.pipe(mn(e=>e instanceof Rs||e instanceof ua||e instanceof ub||e instanceof Vl),Ne(e=>e instanceof Rs||e instanceof Vl?0:e instanceof ua&&(e.code===wi.Redirect||e.code===wi.SupersededByNewNavigation)?2:1),mn(e=>2!==e),Qi(1)).subscribe(()=>{t()})}const GY={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},zY={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Yn=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=w(xv);stateManager=w(pk);options=w(sd,{optional:!0})||{};pendingTasks=w(qs);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=w(Ib);urlSerializer=w(Yu);location=w(Bu);urlHandlingStrategy=w(Cb);_events=new ke;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=w($Y);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=w(Up,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!w(Np,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Pn;subscribeToNavigationEvents(){const e=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==r&&null!==s)if(this.stateManager.handleRouterEvent(i,s),i instanceof ua&&i.code!==wi.Redirect&&i.code!==wi.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Rs)this.navigated=!0;else if(i instanceof Rp){const o=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l={browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||"eager"===this.urlUpdateStrategy||UY(r.source),...o};this.scheduleNavigation(a,xp,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function KY(n){return!(n instanceof db||n instanceof Rp)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),xp,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,i,r)=>{this.navigateToSyncWithBrowser(e,r,i)})}navigateToSyncWithBrowser(e,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(e);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(vb),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let d,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}null!==u&&(u=this.removeEmptyProps(u));try{d=NR(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||"/"!==e[0][0])&&(e=[]),d=this.currentUrlTree.root}return PR(d,e,u,c??null)}navigateByUrl(e,i={skipLocationChange:!1}){const r=ca(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,xp,null,i)}navigate(e,i={skipLocationChange:!1}){return function WY(n){for(let t=0;t<n.length;t++)if(null==n[t])throw new V(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,i){let r;if(r=!0===i?{...GY}:!1===i?{...zY}:i,ca(e))return CR(this.currentUrlTree,e,r);const s=this.parseUrl(e);return CR(this.currentUrlTree,s,r)}removeEmptyProps(e){return Object.entries(e).reduce((i,[r,s])=>(null!=s&&(i[r]=s),i),{})}scheduleNavigation(e,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,f)=>{a=d,l=f});const u=this.pendingTasks.add();return gk(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lo=(()=>{class n{get queue(){return this.queueSubject$.value}get currentIndex(){return this.currentIndexSubject$.value}get currentVideo(){return this.currentVideoSubject$.value}get duration(){return this.durationSubject$.value}get currentTime(){return this.currentTimeSubject$.value}get isPlaying(){return this.isPlayingSubject$.value}get displayMode(){return this.displayModeSubject$.value}constructor(e){this.router=e,this.queueSubject$=new en([]),this.currentIndexSubject$=new en(-1),this.currentVideoSubject$=new en(null),this.durationSubject$=new en(0),this.currentTimeSubject$=new en(0),this.isPlayingSubject$=new en(!1),this.displayModeSubject$=new en(Bn.MODE_INACTIVE),this.queue$=this.queueSubject$.asObservable(),this.currentIndex$=this.currentIndexSubject$.asObservable(),this.currentVideo$=this.currentVideoSubject$.asObservable(),this.duration$=this.durationSubject$.asObservable(),this.currentTime$=this.currentTimeSubject$.asObservable(),this.isPlaying$=this.isPlayingSubject$.asObservable(),this.displayMode$=this.displayModeSubject$.asObservable(),this.sync$=new ke}queueAdd(e){var i=this.queueSubject$.value,r=0===i.length;i.push(e),this.queueSubject$.next([...i]),r&&(this.currentIndexSubject$.next(0),this.currentVideoSubject$.next(e),this.isPlayingSubject$.next(!0),this.displayModeSubject$.next(Bn.MODE_MINIMIZED))}queueSet(e){this.queueSubject$.next([...e]),e.length>0&&this.playVideoAtIndex(0)}queueRemove(e){var i=this.queueSubject$.value.filter(s=>s.yt_video_id!==e),r=this.currentIndexSubject$.value;r>=i.length&&this.currentIndexSubject$.next(r=i.length-1),this.queueSubject$.next(i)}queueClear(){this.queueSubject$.next([]),this.currentIndexSubject$.next(-1),this.currentVideoSubject$.next(null),this.durationSubject$.next(0),this.currentTimeSubject$.next(0),this.isPlayingSubject$.next(!1),this.displayModeSubject$.next(Bn.MODE_INACTIVE)}playVideo(e){this.queueSubject$.next([e]),this.currentIndexSubject$.next(0),this.currentVideoSubject$.next(e),this.isPlayingSubject$.next(!0),this.displayModeSubject$.next(Bn.MODE_FLOATING)}playVideoAtIndex(e){var i=this.queueSubject$.value;e>=0&&e<i.length&&(this.currentIndexSubject$.next(e),this.currentVideoSubject$.next(i[e]),this.isPlayingSubject$.next(!0),this.displayModeSubject$.value===Bn.MODE_INACTIVE&&this.displayModeSubject$.next(Bn.MODE_FLOATING))}play(){this.queueSubject$.value.length>0&&-1===this.currentIndex?this.playVideoAtIndex(0):this.isPlayingSubject$.next(!0)}pause(){this.isPlayingSubject$.next(!1)}stop(){this.currentVideoSubject$.next(null),this.isPlayingSubject$.next(!1),this.currentTimeSubject$.next(0),this.durationSubject$.next(0),this.displayModeSubject$.next(Bn.MODE_INACTIVE)}next(){var e=this.currentIndexSubject$.value;e<this.queueSubject$.value.length-1?this.playVideoAtIndex(e+1):this.stop()}previous(){var e=this.currentIndexSubject$.value;e>0&&this.playVideoAtIndex(e-1)}togglePlayPause(){this.isPlayingSubject$.value?this.pause():this.play()}uiMinimize(){this.displayModeSubject$.next(Bn.MODE_MINIMIZED)}uiMaximize(){this.displayModeSubject$.next(Bn.MODE_FLOATING)}uiHide(){this.displayModeSubject$.next(Bn.MODE_HIDDEN)}uiUnhide(){this.displayModeSubject$.next(Bn.MODE_FLOATING)}closeFloatingPlayer(){this.displayModeSubject$.next(Bn.MODE_INACTIVE)}openFloatingPlayer(){this.displayModeSubject$.next(Bn.MODE_FLOATING)}expandToFullPage(){var e=this.currentVideoSubject$.value;e&&(this.router.navigate(["/watch",e.yt_video_id]),this.displayModeSubject$.next(Bn.MODE_INACTIVE))}updateTime(e,i){this.currentTimeSubject$.next(e),this.durationSubject$.next(i)}seekTo(e){this.currentTimeSubject$.next(e)}onVideoEnded(){this.next()}get hasNext(){return this.currentIndexSubject$.value<this.queueSubject$.value.length-1}get hasPrevious(){return this.currentIndexSubject$.value>0}static{this.\u0275fac=function(i){return new(i||n)(pe(Yn))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var co=function(n){return n.en="en",n.es="es",n.de="de",n.fr="fr",n.ru="ru",n.pt="pt",n.it="it",n.pl="pl",n.ua="ua",n.nl="nl",n.ja="ja",n.ko="ko",n.zh="zh",n.tr="tr",n.id="id",n.vi="vi",n}(co||{});class $p{}class Vp{}class Zi{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(t){t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(e=>{const i=e.indexOf(":");if(i>0){const r=e.slice(0,i),s=e.slice(i+1).trim();this.addHeaderEntry(r,s)}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,i)=>{this.addHeaderEntry(i,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{this.setHeaderEntries(e,i)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Zi?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Zi;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Zi?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...i),this.headers.set(e,r);break;case"d":const s=t.value;if(s){let o=this.headers.get(e);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}addHeaderEntry(t,e){const i=t.toLowerCase();this.maybeSetNormalizedName(t,i),this.headers.has(i)?this.headers.get(i).push(e):this.headers.set(i,[e])}setHeaderEntries(t,e){const i=(Array.isArray(e)?e:[e]).map(s=>s.toString()),r=t.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(t,r)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class qY{encodeKey(t){return mk(t)}encodeValue(t){return mk(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const QY=/%(\d[a-f0-9])/gi,ZY={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function mk(n){return encodeURIComponent(n).replace(QY,(t,e)=>ZY[e]??t)}function jp(n){return`${n}`}class Xi{map;encoder;updates=null;cloneFrom=null;constructor(t={}){if(this.encoder=t.encoder||new qY,t.fromString){if(t.fromObject)throw new V(2805,!1);this.map=function YY(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,s)),t.decodeValue(r.slice(s+1))],l=e.get(o)||[];l.push(a),e.set(o,l)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e],r=Array.isArray(i)?i.map(jp):[jp(i)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(s=>{e.push({param:i,value:s,op:"a"})}):e.push({param:i,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Xi({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(jp(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(jp(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class XY{map=new Map;set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function _k(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function vk(n){return typeof Blob<"u"&&n instanceof Blob}function yk(n){return typeof FormData<"u"&&n instanceof FormData}const od="Content-Type",wb="X-Request-URL",bk="text/plain",Ek="application/json",Sk=`${Ek}, ${bk}, */*`;class ad{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(t,e,i,r){let s;if(this.url=e,this.method=t.toUpperCase(),function JY(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Zi,this.context??=new XY,this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const a=e.indexOf("?");this.urlWithParams=e+(-1===a?"?":a<e.length-1?"&":"")+o}}else this.params=new Xi,this.urlWithParams=e}serializeBody(){return null===this.body?null:"string"==typeof this.body||_k(this.body)||vk(this.body)||yk(this.body)||function e7(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)?this.body:this.body instanceof Xi?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||yk(this.body)?null:vk(this.body)?this.body.type||null:_k(this.body)?null:"string"==typeof this.body?bk:this.body instanceof Xi?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?Ek:null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,s=t.transferCache??this.transferCache,o=void 0!==t.body?t.body:this.body,a=t.withCredentials??this.withCredentials,l=t.reportProgress??this.reportProgress;let c=t.headers||this.headers,u=t.params||this.params;const d=t.context??this.context;return void 0!==t.setHeaders&&(c=Object.keys(t.setHeaders).reduce((f,h)=>f.set(h,t.setHeaders[h]),c)),t.setParams&&(u=Object.keys(t.setParams).reduce((f,h)=>f.set(h,t.setParams[h]),u)),new ad(e,i,o,{params:u,headers:c,context:d,reportProgress:l,responseType:r,withCredentials:a,transferCache:s})}}var uo=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(uo||{});class xb{headers;status;statusText;url;ok;type;constructor(t,e=200,i="OK"){this.headers=t.headers||new Zi,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class Gp extends xb{constructor(t={}){super(t)}type=uo.ResponseHeader;clone(t={}){return new Gp({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class ld extends xb{body;constructor(t={}){super(t),this.body=void 0!==t.body?t.body:null}type=uo.Response;clone(t={}){return new ld({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Wl extends xb{name="HttpErrorResponse";message;error;ok=!1;constructor(t){super(t,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function Ab(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let Dk=(()=>{class n{handler;constructor(e){this.handler=e}request(e,i,r={}){let s;if(e instanceof ad)s=e;else{let l,c;l=r.headers instanceof Zi?r.headers:new Zi(r.headers),r.params&&(c=r.params instanceof Xi?r.params:new Xi({fromObject:r.params})),s=new ad(e,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const o=be(s).pipe(Ul(l=>this.handler.handle(l)));if(e instanceof ad||"events"===r.observe)return o;const a=o.pipe(mn(l=>l instanceof ld));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(Ne(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new V(2806,!1);return l.body}));case"blob":return a.pipe(Ne(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new V(2807,!1);return l.body}));case"text":return a.pipe(Ne(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new V(2808,!1);return l.body}));default:return a.pipe(Ne(l=>l.body))}case"response":return a;default:throw new V(2809,!1)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:(new Xi).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,r={}){return this.request("PATCH",e,Ab(r,i))}post(e,i,r={}){return this.request("POST",e,Ab(r,i))}put(e,i,r={}){return this.request("PUT",e,Ab(r,i))}static \u0275fac=function(i){return new(i||n)(pe($p))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();const Ik=new W("");function wk(n,t){return t(n)}const cd=new W(""),c7=new W(""),xk=new W("",{providedIn:"root",factory:()=>!0});let Ak=(()=>{class n extends $p{backend;injector;chain=null;pendingTasks=w(qs);contributeToStability=w(xk);constructor(e,i){super(),this.backend=e,this.injector=i}handle(e){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(cd),...this.injector.get(c7,[])]));this.chain=i.reduceRight((r,s)=>function a7(n,t,e){return(i,r)=>Bi(e,()=>t(i,s=>n(s,r)))}(r,s,this.injector),wk)}if(this.contributeToStability){const i=this.pendingTasks.add();return this.chain(e,r=>this.backend.handle(r)).pipe(bp(()=>this.pendingTasks.remove(i)))}return this.chain(e,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(pe(Vp),pe(An))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();const p7=/^\)\]\}',?\n/,g7=RegExp(`^${wb}:`,"m");let Rk=(()=>{class n{xhrFactory;constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new V(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?an(i.\u0275loadImpl()):be(null)).pipe(Yi(()=>new wt(s=>{const o=i.build();if(o.open(e.method,e.urlWithParams),e.withCredentials&&(o.withCredentials=!0),e.headers.forEach((g,m)=>o.setRequestHeader(g,m.join(","))),e.headers.has("Accept")||o.setRequestHeader("Accept",Sk),!e.headers.has(od)){const g=e.detectContentTypeHeader();null!==g&&o.setRequestHeader(od,g)}if(e.responseType){const g=e.responseType.toLowerCase();o.responseType="json"!==g?g:"text"}const a=e.serializeBody();let l=null;const c=()=>{if(null!==l)return l;const g=o.statusText||"OK",m=new Zi(o.getAllResponseHeaders()),_=function m7(n){return"responseURL"in n&&n.responseURL?n.responseURL:g7.test(n.getAllResponseHeaders())?n.getResponseHeader(wb):null}(o)||e.url;return l=new Gp({headers:m,status:o.status,statusText:g,url:_}),l},u=()=>{let{headers:g,status:m,statusText:_,url:y}=c(),b=null;204!==m&&(b=typeof o.response>"u"?o.responseText:o.response),0===m&&(m=b?200:0);let S=m>=200&&m<300;if("json"===e.responseType&&"string"==typeof b){const C=b;b=b.replace(p7,"");try{b=""!==b?JSON.parse(b):null}catch(k){b=C,S&&(S=!1,b={error:k,text:b})}}S?(s.next(new ld({body:b,headers:g,status:m,statusText:_,url:y||void 0})),s.complete()):s.error(new Wl({error:b,headers:g,status:m,statusText:_,url:y||void 0}))},d=g=>{const{url:m}=c(),_=new Wl({error:g,status:o.status||0,statusText:o.statusText||"Unknown Error",url:m||void 0});s.error(_)};let f=!1;const h=g=>{f||(s.next(c()),f=!0);let m={type:uo.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),"text"===e.responseType&&o.responseText&&(m.partialText=o.responseText),s.next(m)},p=g=>{let m={type:uo.UploadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),s.next(m)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),e.reportProgress&&(o.addEventListener("progress",h),null!==a&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:uo.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),e.reportProgress&&(o.removeEventListener("progress",h),null!==a&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(i){return new(i||n)(pe(_M))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();const kb=new W(""),kk=new W("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Ok=new W("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Nk{}let y7=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(e,i){this.doc=e,this.cookieName=i}getToken(){const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=pM(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(i){return new(i||n)(pe(rn),pe(kk))};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();function b7(n,t){const e=n.url.toLowerCase();if(!w(kb)||"GET"===n.method||"HEAD"===n.method||e.startsWith("http://")||e.startsWith("https://"))return t(n);const i=w(Nk).getToken(),r=w(Ok);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),t(n)}function E7(...n){const t=[Dk,Rk,Ak,{provide:$p,useExisting:Ak},{provide:Vp,useFactory:()=>w(Ik,{optional:!0})??w(Rk)},{provide:cd,useValue:b7,multi:!0},{provide:kb,useValue:!0},{provide:Nk,useClass:y7}];for(const e of n)t.push(...e.\u0275providers);return Gs(t)}let ud=(()=>{class n{constructor(){this.SERVER_URL_KEY="ekydum_server_url",this.ACCOUNT_TOKEN_KEY="ekydum_account_token",this.ADMIN_TOKEN_KEY="ekydum_admin_token"}getServerUrl(){return localStorage.getItem(this.SERVER_URL_KEY)}setServerUrl(e){localStorage.setItem(this.SERVER_URL_KEY,e)}getAccountToken(){return localStorage.getItem(this.ACCOUNT_TOKEN_KEY)}setAccountToken(e){localStorage.setItem(this.ACCOUNT_TOKEN_KEY,e)}clearAccountToken(){localStorage.removeItem(this.ACCOUNT_TOKEN_KEY)}getAdminToken(){return localStorage.getItem(this.ADMIN_TOKEN_KEY)}setAdminToken(e){localStorage.setItem(this.ADMIN_TOKEN_KEY,e)}clearAdminToken(){localStorage.removeItem(this.ADMIN_TOKEN_KEY)}isAuthenticated(){return!(!this.getServerUrl()||!this.getAccountToken())}isAdmin(){return!!this.getAdminToken()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Kr=(()=>{class n{constructor(e,i,r){this.http=e,this.auth=i,this.toast=r}getHeaders(e=!1){var i=new Zi({"Content-Type":"application/json"});if(e){var r=this.auth.getAdminToken();r&&(i=i.set("x-admin-token",r))}else{var s=this.auth.getAccountToken();s&&(i=i.set("x-account-token",s))}return i}getUrl(e){return`${this.auth.getServerUrl()||"http://localhost:3000"}${e}`}handleError(e){return this.toast.error(e.error?.error||e.message||"An error occurred"),zu(()=>e)}getMe(){return this.http.get(this.getUrl("/me"),{headers:this.getHeaders()}).pipe(Qe(e=>this.handleError(e)))}searchChannels(e){return this.http.post(this.getUrl("/channels/search"),{q:e},{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}searchVideos(e,i=0,r=20){return this.http.post(this.getUrl("/search/videos"),{q:e,offset:i,limit:r},{headers:this.getHeaders()}).pipe(Qe(s=>this.handleError(s)))}getChannel(e){return this.http.get(this.getUrl(`/channels/${e}`),{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}getChannelVideos(e,i=1,r){var s=(new Xi).set("page",i.toString());return r&&(s=s.set("page_size",r.toString())),this.http.get(this.getUrl(`/channels/${e}/videos`),{headers:this.getHeaders(),params:s}).pipe(Qe(o=>this.handleError(o)))}getChannelPlaylists(e){return this.http.get(this.getUrl(`/channels/${e}/playlists`),{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}getPlaylistVideos(e,i=1,r){var s=(new Xi).set("page",i.toString());return r&&(s=s.set("page_size",r.toString())),this.http.get(this.getUrl(`/playlists/${e}/videos`),{headers:this.getHeaders(),params:s}).pipe(Qe(o=>this.handleError(o)))}getVideo(e){return this.http.get(this.getUrl(`/videos/${e}`),{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}getVideoStream(e,i){var r=i?(new Xi).set("quality",i):new Xi;return this.http.get(this.getUrl(`/videos/${e}/stream`),{headers:this.getHeaders(),params:r}).pipe(Qe(s=>this.handleError(s)))}getSubscriptions(){return this.http.get(this.getUrl("/subscriptions"),{headers:this.getHeaders()}).pipe(Qe(e=>this.handleError(e)))}subscribe(e){return this.http.post(this.getUrl("/subscriptions"),{yt_channel_id:e},{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}unsubscribe(e){return this.http.delete(this.getUrl(`/subscriptions/${e}`),{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}getStarred(){return this.http.get(this.getUrl("/starred/starred"),{headers:this.getHeaders()}).pipe(Qe(e=>this.handleError(e)))}addStarred(e,i,r,s,o,a){return this.http.post(this.getUrl("/starred/starred"),{yt_video_id:e,title:i,thumbnail:r,duration:s||null,yt_channel_id:o||null,channel_name:a||null},{headers:this.getHeaders()}).pipe(Qe(l=>this.handleError(l)))}removeStarred(e){return this.http.delete(this.getUrl(`/starred/starred/${e}`),{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}checkStarred(e){return this.http.get(this.getUrl(`/starred/starred/${e}`),{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}getSettings(){return this.http.get(this.getUrl("/settings"),{headers:this.getHeaders()}).pipe(Qe(e=>this.handleError(e)))}updateSetting(e,i){return this.http.put(this.getUrl(`/settings/${e}`),{value:i},{headers:this.getHeaders()}).pipe(Qe(r=>this.handleError(r)))}getAccounts(){return this.http.get(this.getUrl("/admin/accounts"),{headers:this.getHeaders(!0)}).pipe(Qe(e=>this.handleError(e)))}getAccount(e){return this.http.get(this.getUrl(`/admin/accounts/${e}`),{headers:this.getHeaders(!0)}).pipe(Qe(i=>this.handleError(i)))}createAccount(e){return this.http.post(this.getUrl("/admin/accounts"),{name:e},{headers:this.getHeaders(!0)}).pipe(Qe(i=>this.handleError(i)))}updateAccount(e,i){return this.http.put(this.getUrl(`/admin/accounts/${e}`),{name:i},{headers:this.getHeaders(!0)}).pipe(Qe(r=>this.handleError(r)))}deleteAccount(e){return this.http.delete(this.getUrl(`/admin/accounts/${e}`),{headers:this.getHeaders(!0)}).pipe(Qe(i=>this.handleError(i)))}getWatchLater(){return this.http.get(this.getUrl("/watch-later"),{headers:this.getHeaders()}).pipe(Qe(e=>this.handleError(e)))}addWatchLater(e,i,r,s,o,a){return this.http.post(this.getUrl("/watch-later"),{yt_video_id:e,title:i,thumbnail:r,duration:s||null,yt_channel_id:o||null,channel_name:a||null},{headers:this.getHeaders()}).pipe(Qe(l=>this.handleError(l)))}removeWatchLater(e){return this.http.delete(this.getUrl(`/watch-later/${e}`),{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}checkWatchLater(e){return this.http.get(this.getUrl(`/watch-later/check/${e}`),{headers:this.getHeaders()}).pipe(Qe(i=>this.handleError(i)))}static{this.\u0275fac=function(i){return new(i||n)(pe(Dk),pe(ud),pe(ju))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ji=(()=>{class n{get lang(){return this.lang$.value}constructor(e){this.apiService=e,this.lang$=new en(co.en),this.alive$=new ke,this.loadLangFromSettings()}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}loadLangFromSettings(){this.apiService.getSettings().pipe(Oe(this.alive$),Ne(e=>e.settings||[]),et(e=>{var i=e.find(r=>"LANG"===r.key);i&&Object.values(co).includes(i.value)&&this.lang$.next(i.value)})).subscribe()}setLang(e){this.lang$.next(e)}translate(e){return this.lang$.pipe(Oe(this.alive$),Ne(i=>{var r={};return Object.keys(e).forEach(s=>{r[s]=e[s][i]||e[s][co.en]}),r}))}static{this.\u0275fac=function(i){return new(i||n)(pe(Kr))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),S7=(()=>{class n{static \u0275prov=z({token:n,providedIn:"root",factory:()=>new T7(w(rn),window)})}return n})();class T7{document;window;offset=()=>[0,0];constructor(t,e){this.document=t,this.window=e}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t){this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){const e=function D7(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){this.window.history.scrollRestoration=t}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}}let pd=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new ke;constructor(e,i,r,s,o,a){this.router=e,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=a;const l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=e.events.subscribe(c=>{c instanceof Rs&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(e){null==e?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=ca(e)||Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,i,r,s,o){const a=this.urlTree;return!!(null===a||this.isAnchorElement&&(0!==e||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(a,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const e=this.urlTree;this.href=null!==e&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e)):null;const i=null===this.href?null:function JD(n,t,e){return function LV(n,t){return"src"===t&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===t&&("base"===n||"link"===n)?XD:cl}(t,e)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(e,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,e,i):r.removeAttribute(s,e)}get urlTree(){return null===this.routerLinkInput?null:ca(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(F(Yn),F(da),function Ks(n){return function CU(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const i=e.length;let r=0;for(;r<i;){const s=e[r];if(rT(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof e[r];)r++;else{if(s===t)return e[r+1];r+=2}}}return null}(je(),n)}("tabindex"),F(Ss),F(lt),F(sa))};static \u0275dir=ne({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&j("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&i&&Et("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Ll],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Ll],replaceUrl:[2,"replaceUrl","replaceUrl",Ll],routerLink:"routerLink"},features:[Fn]})}return n})(),Wk=(()=>{class n{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new ve;constructor(e,i,r,s,o){this.router=e,this.element=i,this.renderer=r,this.cdr=s,this.link=o,this.routerEventsSubscription=e.events.subscribe(a=>{a instanceof Rs&&this.update()})}ngAfterContentInit(){be(this.links.changes,be(null)).pipe(Bl()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=an(e).pipe(Bl()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(e){const i=Array.isArray(e)?e:e.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const e=this.hasActiveLinks();this.classes.forEach(i=>{e?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.isActiveChange.emit(e))})}isLinkActive(e){const i=function X7(n){return!!n.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{const s=r.urlTree;return!!s&&e.isActive(s,i)}}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}static \u0275fac=function(i){return new(i||n)(F(Yn),F(lt),F(Ss),F(zi),F(pd,8))};static \u0275dir=ne({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(i,r,s){if(1&i&&gn(s,pd,5),2&i){let o;gt(o=mt())&&(r.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Fn]})}return n})();class Kk{}let J7=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(e,i,r,s){this.router=e,this.injector=i,this.preloadingStrategy=r,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(mn(e=>e instanceof Rs),Ul(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=Ih(s.providers,e,`Route: ${s.path}`));const o=s._injector??e,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return an(r).pipe(Bl())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(e,i):be(null);const s=r.pipe(Cn(o=>null===o?be(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return i.loadComponent&&!i._loadedComponent?an([s,this.loader.loadComponent(i)]).pipe(Bl()):s})}static \u0275fac=function(i){return new(i||n)(pe(Yn),pe(An),pe(Kk),pe(Db))};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Lb=new W("");let qk=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(e,i,r,s,o={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Ap?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Rs?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof Vl&&e.code===Mp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof jR&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new jR(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(i){!function hI(){throw new Error("invalid")}()};static \u0275prov=z({token:n,factory:n.\u0275fac})}return n})();function qr(n,t){return{\u0275kind:n,\u0275providers:t}}function Qk(){const n=w(ht);return t=>{const e=n.get(ai);if(t!==e.components[0])return;const i=n.get(Yn),r=n.get(Zk);1===n.get(Fb)&&i.initialNavigation(),n.get(Xk,null,Ue.Optional)?.setUpPreloading(),n.get(Lb,null,Ue.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const Zk=new W("",{factory:()=>new ke}),Fb=new W("",{providedIn:"root",factory:()=>1}),Xk=new W("");function iQ(n){return qr(0,[{provide:Xk,useExisting:J7},{provide:Kk,useExisting:n}])}function sQ(n){return ri("NgRouterViewTransitions"),qr(9,[{provide:dk,useValue:FY},{provide:fk,useValue:{skipNextTransition:!!n?.skipInitialTransition,...n}}])}const oQ=[Bu,{provide:Yu,useClass:Sp},Yn,ed,{provide:da,useFactory:function Yk(n){return n.routerState.root},deps:[Yn]},Db,[]];let aQ=(()=>{class n{constructor(){}static forRoot(e,i){return{ngModule:n,providers:[oQ,[],{provide:Up,multi:!0,useValue:e},[],i?.errorHandler?{provide:hk,useValue:i.errorHandler}:[],{provide:sd,useValue:i||{}},i?.useHash?{provide:sa,useClass:sW}:{provide:sa,useClass:fM},{provide:Lb,useFactory:()=>{const n=w(S7),t=w($e),e=w(sd),i=w(Ib),r=w(Yu);return e.scrollOffset&&n.setOffset(e.scrollOffset),new qk(r,i,n,t,e)}},i?.preloadingStrategy?iQ(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?dQ(i):[],i?.bindToComponentInputs?qr(8,[YR,{provide:Np,useExisting:YR}]).\u0275providers:[],i?.enableViewTransitions?sQ().\u0275providers:[],[{provide:Jk,useFactory:Qk},{provide:Eu,multi:!0,useExisting:Jk}]]}}static forChild(e){return{ngModule:n,providers:[{provide:Up,multi:!0,useValue:e}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=bt({type:n});static \u0275inj=dt({})}return n})();function dQ(n){return["disabled"===n.initialNavigation?qr(3,[_w(()=>{w(Yn).setUpLocationChangeListener()}),{provide:Fb,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?qr(2,[{provide:Fb,useValue:0},_w(()=>{const t=w(ht);return t.get(Jz,Promise.resolve()).then(()=>new Promise(i=>{const r=t.get(Yn),s=t.get(Zk);gk(r,()=>{i(!0)}),t.get(Ib).afterPreactivation=()=>(i(!0),s.closed?be(void 0):s),r.initialNavigation()}))})]).\u0275providers:[]]}const Jk=new W(""),re=Number.isFinite||function(n){return"number"==typeof n&&isFinite(n)},hQ=Number.isSafeInteger||function(n){return"number"==typeof n&&Math.abs(n)<=pQ},pQ=Number.MAX_SAFE_INTEGER||9007199254740991;let fe=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),N=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",n.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",n.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.ASSET_LIST_LOAD_ERROR="assetListLoadError",n.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",n.ASSET_LIST_PARSING_ERROR="assetListParsingError",n.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.ATTACH_MEDIA_ERROR="attachMediaError",n.UNKNOWN="unknown",n}({}),v=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.MEDIA_ENDED="hlsMediaEnded",n.STALL_RESOLVED="hlsStallResolved",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFERED_TO_END="hlsBufferedToEnd",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n.ASSET_LIST_LOADING="hlsAssetListLoading",n.ASSET_LIST_LOADED="hlsAssetListLoaded",n.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",n.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",n.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",n.INTERSTITIAL_STARTED="hlsInterstitialStarted",n.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",n.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",n.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",n.INTERSTITIAL_ENDED="hlsInterstitialEnded",n.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",n.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",n.EVENT_CUE_ENTER="hlsEventCueEnter",n}({});var ce_MAIN="main";class Kl{constructor(t,e=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}sample(t,e){const i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class gQ{constructor(t,e,i,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Kl(t),this.fast_=new Kl(e),this.defaultTTFB_=r,this.ttfb_=new Kl(t)}update(t,e){const{slow_:i,fast_:r,ttfb_:s}=this;i.halfLife!==t&&(this.slow_=new Kl(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.fast_=new Kl(e,r.getEstimate(),r.getTotalWeight())),s.halfLife!==t&&(this.ttfb_=new Kl(t,s.getEstimate(),s.getTotalWeight()))}sample(t,e){const r=(t=Math.max(t,this.minDelayMs_))/1e3,s=8*e/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(t){const e=t/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(i,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function mQ(n,t,e){return(t=function vQ(n){var t=function _Q(n,t){if("object"!=typeof n||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var i=e.call(n,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==typeof t?t:t+""}(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function vt(){return vt=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)({}).hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},vt.apply(null,arguments)}function eO(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),e.push.apply(e,i)}return e}function ct(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?eO(Object(e),!0).forEach(function(i){mQ(n,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):eO(Object(e)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(e,i))})}return n}class er{constructor(t,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${t}]:`;this.trace=ho,this.debug=e.debug.bind(null,i),this.log=e.log.bind(null,i),this.warn=e.warn.bind(null,i),this.info=e.info.bind(null,i),this.error=e.error.bind(null,i)}}const ho=function(){},yQ={trace:ho,debug:ho,log:ho,warn:ho,info:ho,error:ho};function Bb(){return vt({},yQ)}function tO(n,t,e){return t[n]?t[n].bind(t):function bQ(n,t){const e=self.console[n];return e?e.bind(self.console,`${t?"["+t+"] ":""}[${n}] >`):ho}(n,e)}const Ub=Bb(),ut=Ub;function po(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function nO(n,t){const e=Object.keys(n),i=Object.keys(t),r=e.length,s=i.length;return!r||!s||r===s&&!e.some(o=>-1===i.indexOf(o))}function xi(n,t=!1){if(typeof TextDecoder<"u"){const c=new TextDecoder("utf-8").decode(n);if(t){const u=c.indexOf("\0");return-1!==u?c.substring(0,u):c}return c.replace(/\0/g,"")}const e=n.length;let i,r,s,o="",a=0;for(;a<e;){if(i=n[a++],0===i&&t)return o;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:r=n[a++],o+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=n[a++],s=n[a++],o+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&s)}}return o}function Qn(n){let t="";for(let e=0;e<n.length;e++){let i=n[e].toString(16);i.length<2&&(i="0"+i),t+=i}return t}function iO(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function TQ(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var rO,$b={exports:{}},Vb=function DQ(){return rO||(rO=1,i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,$b.exports=a={buildAbsoluteURL:function(l,c,u){if(u=u||{},l=l.trim(),!(c=c.trim())){if(!u.alwaysNormalize)return l;var d=a.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=a.normalizePath(d.path),a.buildURLFromParts(d)}var f=a.parseURL(c);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=a.normalizePath(f.path),a.buildURLFromParts(f)):c;var h=a.parseURL(l);if(!h)throw new Error("Error trying to parse base URL.");if(!h.netLoc&&h.path&&"/"!==h.path[0]){var p=r.exec(h.path);h.netLoc=p[1],h.path=p[2]}h.netLoc&&!h.path&&(h.path="/");var g={scheme:h.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(g.netLoc=h.netLoc,"/"!==f.path[0]))if(f.path){var m=h.path,_=m.substring(0,m.lastIndexOf("/")+1)+f.path;g.path=a.normalizePath(_)}else g.path=h.path,f.params||(g.params=h.params,f.query||(g.query=h.query));return null===g.path&&(g.path=u.alwaysNormalize?a.normalizePath(f.path):f.path),a.buildURLFromParts(g)},parseURL:function(l){var c=i.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}}),$b.exports;var i,r,s,o,a}();class jb{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Ct_AUDIO="audio",Ct_VIDEO="video",Ct_AUDIOVIDEO="audiovideo";class sO{constructor(t){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"==typeof t&&(t={url:t}),this.base=t,function IQ(n,t){const e=oO(n,t);e&&(e.enumerable=!0,Object.defineProperty(n,t,e))}(this,"stats")}setByteRange(t,e){const i=t.split("@",2);let r;r=1===i.length?e?.byteRangeEndOffset||0:parseInt(i[1]),this._byteRange=[r,parseInt(i[0])+r]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[Ct_AUDIO]:null,[Ct_VIDEO]:null,[Ct_AUDIOVIDEO]:null}),this._streams}set elementaryStreams(t){this._streams=t}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new jb),this._stats}set stats(t){this._stats=t}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Vb.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t.audio=null,t.video=null,t.audiovideo=null}}function ln(n){return"initSegment"!==n.sn}class Hb extends sO{constructor(t,e){super(e),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get byteLength(){if(this.hasStats){const t=this.stats.total;if(t)return t}if(this.byteRange.length){const t=this.byteRange[0],e=this.byteRange[1];if(re(t)&&re(e))return e-t}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(t){this._bitrate=t}get decryptdata(){var t;const{levelkeys:e}=this;if(!e||e.NONE)return null;if(e.identity)this._decryptdata||(this._decryptdata=e.identity.getDecryptData(this.sn));else if(null==(t=this._decryptdata)||!t.keyId){const i=Object.keys(e);if(1===i.length){const r=this._decryptdata=e[i[0]]||null;r&&(this._decryptdata=r.getDecryptData(this.sn,e))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const t=re(this.duration)?this.duration:0;return this.programDateTime+1e3*t}get encrypted(){var t;if(null!=(t=this._decryptdata)&&t.encrypted)return!0;if(this.levelkeys){var e;const i=Object.keys(this.levelkeys),r=i.length;if(r>1||1===r&&null!=(e=this.levelkeys[i[0]])&&e.encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(t){this._programDateTime=re(t)?t:this.rawProgramDateTime=null}get ref(){return ln(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(t){this.setStart(this.start+t)}setStart(t){this.start=t,this._ref&&(this._ref.start=t)}setDuration(t){this.duration=t,this._ref&&(this._ref.duration=t)}setKeyFormat(t){const e=this.levelkeys;if(e){var i;const r=e[t];r&&(null==(i=this._decryptdata)||!i.keyId)&&(this._decryptdata=r.getDecryptData(this.sn,e))}}abortRequests(){var t,e;null==(t=this.loader)||t.abort(),null==(e=this.keyLoader)||e.abort()}setElementaryStreamInfo(t,e,i,r,s,o=!1){const{elementaryStreams:a}=this,l=a[t];l?(l.startPTS=Math.min(l.startPTS,e),l.endPTS=Math.max(l.endPTS,i),l.startDTS=Math.min(l.startDTS,r),l.endDTS=Math.max(l.endDTS,s)):a[t]={startPTS:e,endPTS:i,startDTS:r,endDTS:s,partial:o}}}class CQ extends sO{constructor(t,e,i,r,s){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=r;const o=t.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}function oO(n,t){const e=Object.getPrototypeOf(n);if(e)return Object.getOwnPropertyDescriptor(e,t)||oO(e,t)}const aO=Math.pow(2,32)-1,wQ=[].push,lO={video:1,audio:2,id3:3,text:4};function _n(n){return String.fromCharCode.apply(null,n)}function cO(n,t){const e=n[t]<<8|n[t+1];return e<0?65536+e:e}function Ie(n,t){const e=dO(n,t);return e<0?4294967296+e:e}function uO(n,t){let e=Ie(n,t);return e*=Math.pow(2,32),e+=Ie(n,t+4),e}function dO(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}function He(n,t){const e=[];if(!t.length)return e;const i=n.byteLength;for(let r=0;r<i;){const s=Ie(n,r),a=s>1?r+s:i;if(_n(n.subarray(r+4,r+8))===t[0])if(1===t.length)e.push(n.subarray(r+8,a));else{const l=He(n.subarray(r+8,a),t.slice(1));l.length&&wQ.apply(e,l)}r=a}return e}function AQ(n){const t=[],e=n[0];let i=8;const r=Ie(n,i);i+=4;let s=0,o=0;0===e?(s=Ie(n,i),o=Ie(n,i+4),i+=8):(s=uO(n,i),o=uO(n,i+8),i+=16),i+=2;let a=n.length+o;const l=cO(n,i);i+=2;for(let c=0;c<l;c++){let u=i;const d=Ie(n,u);u+=4;const f=2147483647&d;if((2147483648&d)>>>31==1)return ut.warn("SIDX has hierarchical references (not supported)"),null;const p=Ie(n,u);u+=4,t.push({referenceSize:f,subsegmentDuration:p,info:{duration:p/r,start:a,end:a+f-1}}),a+=f,u+=4,i=u}return{earliestPresentationTime:s,timescale:r,version:e,referencesCount:l,references:t}}function fO(n){const t=[],e=He(n,["moov","trak"]);for(let r=0;r<e.length;r++){const s=e[r],o=He(s,["tkhd"])[0];if(o){let a=o[0];const l=Ie(o,0===a?12:20),c=He(s,["mdia","mdhd"])[0];if(c){a=c[0];const u=Ie(c,0===a?12:20),d=He(s,["mdia","hdlr"])[0];if(d){const f=_n(d.subarray(8,12)),h={soun:"audio",vide:"video"}[f],g=MQ(He(s,["mdia","minf","stbl","stsd"])[0]);h?(t[l]={timescale:u,type:h,stsd:g},t[h]=ct({timescale:u,id:l},g)):t[l]={timescale:u,type:f,stsd:g}}}}}return He(n,["moov","mvex","trex"]).forEach(r=>{const s=Ie(r,4),o=t[s];o&&(o.default={duration:Ie(r,12),flags:Ie(r,20)})}),t}function MQ(n){const t=n.subarray(8),e=t.subarray(86),i=_n(t.subarray(4,8));let s,r=i;const o="enca"===i||"encv"===i;if(o){const c=He(t,[i])[0].subarray("enca"===i?28:78);He(c,["sinf"]).forEach(d=>{const f=He(d,["schm"])[0];if(f){const h=_n(f.subarray(4,8));if("cbcs"===h||"cenc"===h){const p=He(d,["frma"])[0];p&&(r=_n(p))}}})}const a=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const l=He(e,["avcC"])[0];l&&l.length>3&&(r+="."+Yp(l[1])+Yp(l[2])+Yp(l[3]),s=qp("avc1"===a?"dva1":"dvav",e));break}case"mp4a":{const l=He(t,[i])[0],c=He(l.subarray(28),["esds"])[0];if(c&&c.length>7){let u=4;if(3!==c[u++])break;u=Gb(c,u),u+=2;const d=c[u++];if(128&d&&(u+=2),64&d&&(u+=c[u++]),4!==c[u++])break;u=Gb(c,u);const f=c[u++];if(64!==f)break;if(r+="."+Yp(f),u+=12,5!==c[u++])break;u=Gb(c,u);const h=c[u++];let p=(248&h)>>3;31===p&&(p+=1+((7&h)<<3)+((224&c[u])>>5)),r+="."+p}break}case"hvc1":case"hev1":{const l=He(e,["hvcC"])[0];if(l&&l.length>12){const c=l[1],u=["","A","B","C"][c>>6],d=31&c,f=Ie(l,2),h=(32&c)>>5?"H":"L",p=l[12],g=l.subarray(6,12);r+="."+u+d,r+="."+function RQ(n){let t=0;for(let e=0;e<32;e++)t|=(n>>e&1)<<31-e;return t>>>0}(f).toString(16).toUpperCase(),r+="."+h+p;let m="";for(let _=g.length;_--;){const y=g[_];(y||m)&&(m="."+y.toString(16).toUpperCase()+m)}r+=m}s=qp("hev1"==a?"dvhe":"dvh1",e);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":r=qp(r,e)||r;break;case"vp09":{const l=He(e,["vpcC"])[0];if(l&&l.length>6){const u=l[5],d=l[6]>>4&15;r+="."+Yr(l[4])+"."+Yr(u)+"."+Yr(d)}break}case"av01":{const l=He(e,["av1C"])[0];if(l&&l.length>2){const c=l[1]>>>5,d=l[2]>>>7?"H":"M",f=(64&l[2])>>6,p=2===c&&f?(32&l[2])>>5?12:10:f?10:8,g=(16&l[2])>>4,m=(8&l[2])>>3,_=(4&l[2])>>2,y=3&l[2];r+="."+c+"."+Yr(31&l[1])+d+"."+Yr(p)+"."+g+"."+m+_+y+"."+Yr(1)+"."+Yr(1)+"."+Yr(1)+".0",s=qp("dav1",e)}break}}return{codec:r,encrypted:o,supplemental:s}}function qp(n,t){const e=He(t,["dvvC"]),i=e.length?e[0]:He(t,["dvcC"])[0];if(i){const s=i[2]<<5&32|i[3]>>3&31;return n+"."+Yr(i[2]>>1&127)+"."+Yr(s)}}function Gb(n,t){const e=t+5;for(;128&n[t++]&&t<e;);return t}function Yp(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function Yr(n){return(n<10?"0":"")+n}function hO(n,t){He(n,["moov","trak"]).forEach(i=>{const r=He(i,["mdia","minf","stbl","stsd"])[0];if(!r)return;const s=r.subarray(8);let o=He(s,["enca"]);const a=o.length>0;a||(o=He(s,["encv"])),o.forEach(l=>{He(l.subarray(a?28:78),["sinf"]).forEach(d=>{const f=pO(d);f&&t(f,a)})})})}function pO(n){const t=He(n,["schm"])[0];if(t){const e=_n(t.subarray(4,8));if("cbcs"===e||"cenc"===e){const i=He(n,["schi","tenc"])[0];if(i)return i}}}function tr(n,t){const e=new Uint8Array(n.length+t.length);return e.set(n),e.set(t,n.length),e}function gO(n,t){const e=[],i=t.samples,r=t.timescale,s=t.id;let o=!1;return He(i,["moof"]).map(l=>{const c=l.byteOffset-8;He(l,["traf"]).map(d=>{const f=He(d,["tfdt"]).map(h=>{const p=h[0];let g=Ie(h,4);return 1===p&&(g*=Math.pow(2,32),g+=Ie(h,8)),g/r})[0];return void 0!==f&&(n=f),He(d,["tfhd"]).map(h=>{const p=Ie(h,4),g=16777215&Ie(h,0);let b=0;const S=!!(16&g);let C=0;const k=!!(32&g);let I=8;p===s&&(!!(1&g)&&(I+=8),!!(2&g)&&(I+=4),!!(8&g)&&(b=Ie(h,I),I+=4),S&&(C=Ie(h,I),I+=4),k&&(I+=4),"video"===t.type&&(o=Qp(t.codec)),He(d,["trun"]).map(M=>{const O=M[0],x=16777215&Ie(M,0),B=!!(1&x);let K=0;const ee=!!(4&x),oe=!!(256&x);let se=0;const G=!!(512&x);let ie=0;const te=!!(1024&x),ae=!!(2048&x);let ge=0;const Z=Ie(M,4);let q=8;B&&(K=Ie(M,q),q+=4),ee&&(q+=4);let Re=K+c;for(let We=0;We<Z;We++){if(oe?(se=Ie(M,q),q+=4):se=b,G?(ie=Ie(M,q),q+=4):ie=C,te&&(q+=4),ae&&(ge=0===O?Ie(M,q):dO(M,q),q+=4),"video"===t.type){let Te=0;for(;Te<ie;){const Be=Ie(i,Re);Re+=4,LQ(o,i[Re])&&zb(i.subarray(Re,Re+Be),o?2:1,n+ge/r,e),Re+=Be,Te+=Be+4}}n+=se/r}}))})})}),e}function Qp(n){if(!n)return!1;const t=n.substring(0,4);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function LQ(n,t){if(n){const e=t>>1&63;return 39===e||40===e}return 6==(31&t)}function zb(n,t,e,i){const r=mO(n);let s=0;s+=t;let o=0,a=0,l=0;for(;s<r.length;){o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(255===l);a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(255===l);const c=r.length-s;let u=s;if(a<c)s+=a;else if(a>c){ut.error(`Malformed SEI payload. ${a} is too small, only ${c} bytes left to parse.`);break}if(4===o){if(181===r[u++]){const f=cO(r,u);if(u+=2,49===f){const h=Ie(r,u);if(u+=4,1195456820===h){const p=r[u++];if(3===p){const g=r[u++],_=64&g,y=_?2+3*(31&g):0,b=new Uint8Array(y);if(_){b[0]=g;for(let S=1;S<y;S++)b[S]=r[u++]}i.push({type:p,payloadType:o,pts:e,bytes:b})}}}}}else if(5===o&&a>16){const d=[];for(let p=0;p<16;p++){const g=r[u++].toString(16);d.push(1==g.length?"0"+g:g),(3===p||5===p||7===p||9===p)&&d.push("-")}const f=a-16,h=new Uint8Array(f);for(let p=0;p<f;p++)h[p]=r[u++];i.push({payloadType:o,pts:e,uuid:d.join(""),userData:xi(h),userDataBytes:h})}}}function mO(n){const t=n.byteLength,e=[];let i=1;for(;i<t-2;)0===n[i]&&0===n[i+1]&&3===n[i+2]?(e.push(i+2),i+=2):i++;if(0===e.length)return n;const r=t-e.length,s=new Uint8Array(r);let o=0;for(i=0;i<r;o++,i++)o===e[0]&&(o++,e.shift()),s[i]=n[o];return s}function VQ(n){const t=n.getUint32(0),e=n.byteOffset,i=n.byteLength;if(i<t)return{offset:e,size:i};if(1886614376!==n.getUint32(4))return{offset:e,size:t};const s=n.getUint32(8)>>>24;if(0!==s&&1!==s)return{offset:e,size:t};const o=n.buffer,a=Qn(new Uint8Array(o,e+12,16));let l=null,c=null,u=0;if(0===s)u=28;else{const f=n.getUint32(28);if(!f||i<32+16*f)return{offset:e,size:t};l=[];for(let h=0;h<f;h++)l.push(new Uint8Array(o,e+32+16*h,16));u=32+16*f}if(!u)return{offset:e,size:t};const d=n.getUint32(u);return t-32<d?{offset:e,size:t}:(c=new Uint8Array(o,e+u+4,d),{version:s,systemId:a,kids:l,data:c,offset:e,size:t})}const _O=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),ql={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Wb(n,t){const e=ql[t];return!!e&&!!e[n.slice(0,4)]}function gd(n,t,e=!0){return!n.split(",").some(i=>!Kb(i,t,e))}function Kb(n,t,e=!0){var i;const r=po(e);return null!=(i=r?.isTypeSupported(md(n,t)))&&i}function md(n,t){return`${t}/mp4;codecs=${n}`}function vO(n){if(n){const t=n.substring(0,4);return ql.video[t]}return 2}function Zp(n){const t=_O();return n.split(",").reduce((e,i)=>{const s=t&&Qp(i)?9:ql.video[i];return s?(2*s+e)/(e?3:2):(ql.audio[i]+e)/(e?2:1)},0)}const qb={},HQ=/flac|opus|mp4a\.40\.34/i;function Xp(n,t=!0){return n.replace(HQ,e=>function jQ(n,t=!0){if(qb[n])return qb[n];const e={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[n];for(let r=0;r<e.length;r++){var i;if(Kb(e[r],"audio",t))return qb[n]=e[r],e[r];if("mp3"===e[r]&&null!=(i=po(t))&&i.isTypeSupported("audio/mpeg"))return""}return n}(e.toLowerCase(),t))}function Jp(n,t){if(n&&(n.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(n))&&(yO(n,"audio")||yO(n,"video")))return n;if(t){const e=t.split(",");if(e.length>1){if(n)for(let i=e.length;i--;)if(e[i].substring(0,4)===n.substring(0,4))return e[i];return e[0]}}return t||n}function yO(n,t){return Wb(n,t)&&Kb(n,t)}function WQ(n){if(n.startsWith("av01.")){const t=n.split("."),e=["0","111","01","01","01","0"];for(let i=t.length;i>4&&i<10;i++)t[i]=e[i-4];return t.join(".")}return n}function bO(n){const t=po(n)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Yb(n){return n.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const qQ={supported:!1,smooth:!1,powerEfficient:!1},EO={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function SO(n,t){return{supported:!1,configurations:t,decodingInfoResults:[qQ],error:n}}function YQ(n,t,e,i,r,s){const o=n.videoCodec,a=n.audioCodec?n.audioGroups:null,l=s?.audioCodec,c=s?.channels,u=c?parseInt(c):l?1/0:2;let d=null;if(null!=a&&a.length)try{d=1===a.length&&a[0]?t.groups[a[0]].channels:a.reduce((f,h)=>{if(h){const p=t.groups[h];if(!p)throw new Error(`Audio track group ${h} not found`);Object.keys(p.channels).forEach(g=>{f[g]=(f[g]||0)+p.channels[g]})}return f},{2:0})}catch{return!0}return void 0!==o&&(o.split(",").some(f=>Qp(f))||n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(i,30)||"SDR"!==n.videoRange&&n.videoRange!==e||n.bitrate>Math.max(r,8e6))||!!d&&re(u)&&Object.keys(d).some(f=>parseInt(f)>u)}function TO(n,t,e,i={}){const r=n.videoCodec;if(!r&&!n.audioCodec||!e)return Promise.resolve(EO);const s=[],o=function QQ(n){var t;const e=null==(t=n.videoCodec)?void 0:t.split(","),i=DO(n),r=n.width||640,s=n.height||480,o=n.frameRate||30,a=n.videoRange.toLowerCase();return e?e.map(l=>{const c={contentType:md(WQ(l),"video"),width:r,height:s,bitrate:i,framerate:o};return"sdr"!==a&&(c.transferFunction=a),c}):[]}(n),a=o.length,l=function ZQ(n,t,e){var i;const r=null==(i=n.audioCodec)?void 0:i.split(","),s=DO(n);return r&&n.audioGroups?n.audioGroups.reduce((o,a)=>{var l;const c=a?null==(l=t.groups[a])?void 0:l.tracks:null;return c?c.reduce((u,d)=>{if(d.groupId===a){const f=parseFloat(d.channels||"");r.forEach(h=>{const p={contentType:md(h,"audio"),bitrate:e?XQ(h,s):s};f&&(p.channels=""+f),u.push(p)})}return u},o):o},[]):[]}(n,t,a>0),c=l.length;for(let u=a||1*c||1;u--;){const d={type:"media-source"};if(a&&(d.video=o[u%a]),c){d.audio=l[u%c];const f=d.audio.bitrate;d.video&&f&&(d.video.bitrate-=f)}s.push(d)}if(r){const u=navigator.userAgent;if(r.split(",").some(d=>Qp(d))&&_O())return Promise.resolve(SO(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${u})`),s))}return Promise.all(s.map(u=>{const d=function JQ(n){let t="";const{audio:e,video:i}=n;return i&&(t+=`${Yb(i.contentType)}_r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${Math.ceil(i.bitrate/1e5)}`),e&&(t+=`${i?"_":""}${Yb(e.contentType)}_c${e.channels}`),t}(u);return i[d]||(i[d]=e.decodingInfo(u))})).then(u=>({supported:!u.some(d=>!d.supported),configurations:s,decodingInfoResults:u})).catch(u=>({supported:!1,configurations:s,decodingInfoResults:[],error:u}))}function XQ(n,t){if(t<=1)return 1;let e=128e3;return"ec-3"===n?e=768e3:"ac-3"===n&&(e=64e4),Math.min(t/2,e)}function DO(n){return 1e3*Math.ceil(Math.max(.9*n.bitrate,n.averageBitrate)/1e3)||1}const Qb=["NONE","TYPE-0","TYPE-1",null],eg=["SDR","PQ","HLG"];function CO(n){const{canSkipUntil:t,canSkipDateRanges:e,age:i}=n;return t&&i<t/2?e?"v2":"YES":""}class IO{constructor(t,e,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=i}addDirectives(t){const e=new self.URL(t);return void 0!==this.msn&&e.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}}class _d{constructor(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;const i=null==(e=t.supplemental)?void 0:e.videoCodec;i&&i!==t.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return wO(this._audioGroups,t)}hasSubtitleGroup(t){return wO(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(e)if("audio"===t){let i=this._audioGroups;i||(i=this._audioGroups=[]),-1===i.indexOf(e)&&i.push(e)}else if("text"===t){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),-1===i.indexOf(e)&&i.push(e)}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return null==(t=this.audioGroups)?void 0:t[0]}get textGroupId(){var t;return null==(t=this.subtitleGroups)?void 0:t[0]}addFallback(){}}function wO(n,t){return!(!t||!n)&&-1!==n.indexOf(t)}const It=(n,t)=>JSON.stringify(n,(n=>{const t=new WeakSet;return(e,i)=>{if(n&&(i=n(e,i)),"object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}})(t));function Qr(n,t){ut.log(`[abr] start candidates with "${n}" ignored because ${t}`)}function xO(n){return n.reduce((t,e)=>{let i=t.groups[e.groupId];i||(i=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(e);const r=e.channels||"2";return i.channels[r]=(i.channels[r]||0)+1,i.hasDefault=i.hasDefault||e.default,i.hasAutoSelect=i.hasAutoSelect||e.autoselect,i.hasDefault&&(t.hasDefaultAudio=!0),i.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function AO(n){if(!n)return n;const{lang:t,assocLang:e,characteristics:i,channels:r,audioCodec:s}=n;return{lang:t,assocLang:e,characteristics:i,channels:r,audioCodec:s}}function Zr(n,t,e){if("attrs"in n){const i=t.indexOf(n);if(-1!==i)return i}for(let i=0;i<t.length;i++)if(ha(n,t[i],e))return i;return-1}function ha(n,t,e){const{groupId:i,name:r,lang:s,assocLang:o,default:a}=n,l=n.forced;return(void 0===i||t.groupId===i)&&(void 0===r||t.name===r)&&(void 0===s||function aZ(n,t="--"){return n.length===t.length?n===t:n.startsWith(t)||t.startsWith(n)}(s,t.lang))&&(void 0===s||t.assocLang===o)&&(void 0===a||t.default===a)&&(void 0===l||t.forced===l)&&(!("characteristics"in n)||function lZ(n,t=""){const e=n.split(","),i=t.split(",");return e.length===i.length&&!e.some(r=>-1===i.indexOf(r))}(n.characteristics||"",t.characteristics))&&(void 0===e||e(n,t))}function pa(n,t){const{audioCodec:e,channels:i}=n;return!(void 0!==e&&(t.audioCodec||"").substring(0,4)!==e.substring(0,4)||void 0!==i&&i!==(t.channels||"2"))}function MO(n,t,e){for(let i=t;i>-1;i--)if(e(n[i]))return i;for(let i=t+1;i<n.length;i++)if(e(n[i]))return i;return-1}function ng(n,t){var e;return!!n&&n!==(null==(e=t.loadLevelObj)?void 0:e.uri)}const RO_search=function(n,t){let e=0,i=n.length-1,r=null,s=null;for(;e<=i;){r=(e+i)/2|0,s=n[r];const o=t(s);if(o>0)e=r+1;else{if(!(o<0))return s;i=r-1}}return null};function ga(n,t,e=0,i=0,r=.005){let s=null;if(n){s=t[1+n.sn-t[0].sn]||null;const a=n.endDTS-e;a>0&&a<15e-7&&(e+=15e-7),s&&n.level!==s.level&&s.end<=n.end&&(s=t[2+n.sn-t[0].sn]||null)}else 0===e&&0===t[0].start&&(s=t[0]);if(s&&((!n||n.level===s.level)&&0===kO(e,i,s)||function fZ(n,t,e){if(t&&0===t.start&&t.level<n.level&&(t.endPTS||0)>0){const i=t.tagList.reduce((r,s)=>("INF"===s[0]&&(r+=parseFloat(s[1])),r),e);return n.start<=i}return!1}(s,n,Math.min(r,i))))return s;const o=RO_search(t,kO.bind(null,e,i));return!o||o===n&&s?s:o}function kO(n=0,t=0,e){if(e.start<=n&&e.start+e.duration>n)return 0;const i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0));return e.start+e.duration-i<=n?1:e.start-i>n&&e.start?-1:0}function hZ(n,t,e){const i=1e3*Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0));return(e.endProgramDateTime||0)-i>n}function OO(n,t,e){if(n&&n.startCC<=t&&n.endCC>=t){let i=n.fragments;const{fragmentHint:r}=n;let s;return r&&(i=i.concat(r)),RO_search(i,o=>o.cc<t?1:o.cc>t?-1:(s=o,o.end<=e?1:o.start>e?-1:0)),s||null}return null}function ig(n){switch(n.details){case N.FRAG_LOAD_TIMEOUT:case N.KEY_LOAD_TIMEOUT:case N.LEVEL_LOAD_TIMEOUT:case N.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function NO(n){return n.details.startsWith("key")}function PO(n){return NO(n)&&!!n.frag&&!n.frag.decryptdata}function LO(n,t){const e=ig(t);return n.default[(e?"timeout":"error")+"Retry"]}function Zb(n,t){const e="linear"===n.backoff?1:Math.pow(2,t);return Math.min(e*n.retryDelayMs,n.maxRetryDelayMs)}function FO(n){return ct(ct({},n),{errorRetry:null,timeoutRetry:null})}function rg(n,t,e,i){if(!n)return!1;const r=i?.code,s=t<n.maxNumRetry&&(function pZ(n){return Xb(n)||!!n&&(n<400||n>499)}(r)||!!e);return n.shouldRetry?n.shouldRetry(n,t,e,i,s):s}function Xb(n){return 0===n&&!1===navigator.onLine}function Yl(n){const t={action:0,flags:0};return n&&(t.resolved=!0),t}class mZ{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t&&(t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.BUFFER_APPENDED,this.onBufferAppended,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this),t.on(v.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.BUFFER_APPENDED,this.onBufferAppended,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this),t.off(v.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){const i=this.activePartLists[e];if(i)for(let r=i.length;r--;){const s=i[r];if(!s)break;if(s.start<=t&&t<=s.end&&s.loaded)return s}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){return this.getFragAtPos(t,e,!0)}getFragAtPos(t,e,i){const{fragments:r}=this,s=Object.keys(r);for(let o=s.length;o--;){const a=r[s[o]];if(a?.body.type===e&&(!i||a.buffered)){const l=a.body;if(l.start<=t&&t<=l.end)return l}}return null}detectEvictedFragments(t,e,i,r,s){this.timeRanges&&(this.timeRanges[t]=e);const o=r?.fragment.sn||-1;Object.keys(this.fragments).forEach(a=>{const l=this.fragments[a];if(!l||o>=l.body.sn)return;if(!l.buffered&&(!l.loaded||s))return void(l.body.type===i&&this.removeFragment(l.body));const c=l.range[t];if(c){if(0===c.time.length)return void this.removeFragment(l.body);c.time.some(u=>{const d=!this.isTimeBuffered(u.startPTS,u.endPTS,e);return d&&this.removeFragment(l.body),d})}})}detectPartialFragments(t){const e=this.timeRanges;if(!e||"initSegment"===t.frag.sn)return;const i=t.frag,r=Ql(i),s=this.fragments[r];if(!s||s.buffered&&i.gap)return;const o=!i.relurl;Object.keys(e).forEach(a=>{const l=i.elementaryStreams[a];l&&(s.range[a]=this.getBufferedTimes(i,t.part,o||!0===l.partial,e[a]))}),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=i.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),sg(s)||this.removeParts(i.sn-1,i.type)):this.removeFragment(s.body)}removeParts(t,e){const i=this.activePartLists[e];i&&(this.activePartLists[e]=BO(i,r=>r.fragment.sn>=t))}fragBuffered(t,e){const i=Ql(t);let r=this.fragments[i];!r&&e&&(r=this.fragments[i]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(t,e,i,r){const s={time:[],partial:i},o=t.start,a=t.end,l=t.minEndPTS||a,c=t.maxStartPTS||o;for(let u=0;u<r.length;u++){const d=r.start(u)-this.bufferPadding,f=r.end(u)+this.bufferPadding;if(c>=d&&l<=f){s.time.push({startPTS:Math.max(o,r.start(u)),endPTS:Math.min(a,r.end(u))});break}if(o<f&&a>d){const h=Math.max(o,r.start(u)),p=Math.min(a,r.end(u));p>h&&(s.partial=!0,s.time.push({startPTS:h,endPTS:p}))}else if(a<=d)break}return s}getPartialFragment(t){let i,r,s,e=null,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(c=>{const u=l[c];u&&sg(u)&&(r=u.body.start-a,s=u.body.end+a,t>=r&&t<=s&&(i=Math.min(t-r,s-t),o<=i&&(e=u.body,o=i)))}),e}isEndListAppended(t){const e=this.endListFragments[t];return void 0!==e&&(e.buffered||sg(e))}getState(t){const e=Ql(t),i=this.fragments[e];return i?i.buffered?sg(i)?"PARTIAL":"OK":"APPENDING":"NOT_LOADED"}isTimeBuffered(t,e,i){let r,s;for(let o=0;o<i.length;o++){if(r=i.start(o)-this.bufferPadding,s=i.end(o)+this.bufferPadding,t>=r&&e<=s)return!0;if(e<=r)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(t,e){if("initSegment"===e.frag.sn||e.frag.bitrateTest)return;const i=e.frag,r=e.part?null:e,s=Ql(i);this.fragments[s]={body:i,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:i,part:r,timeRanges:s,type:o}=e;if("initSegment"===i.sn)return;const a=i.type;if(r){let c=this.activePartLists[a];c||(this.activePartLists[a]=c=[]),c.push(r)}this.timeRanges=s,this.detectEvictedFragments(o,s[o],a,r)}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=Ql(t);return!!this.fragments[e]}hasFragments(t){const{fragments:e}=this,i=Object.keys(e);if(!t)return i.length>0;for(let r=i.length;r--;){const s=e[i[r]];if(s?.body.type===t)return!0}return!1}hasParts(t){var e;return!(null==(e=this.activePartLists[t])||!e.length)}removeFragmentsInRange(t,e,i,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==i||r&&!l.gap||l.start<e&&l.end>t&&(a.buffered||s)&&this.removeFragment(l)})}removeFragment(t){const e=Ql(t);t.clearElementaryStreamInfo();const i=this.activePartLists[t.type];if(i){const r=t.sn;this.activePartLists[t.type]=BO(i,s=>s.fragment.sn!==r)}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){var t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const e=null==(t=this.hls)||null==(t=t.latestLevelDetails)?void 0:t.partList;e&&e.forEach(i=>i.clearElementaryStreamInfo())}}function sg(n){var t,e,i;return n.buffered&&!!(n.body.gap||null!=(t=n.range.video)&&t.partial||null!=(e=n.range.audio)&&e.partial||null!=(i=n.range.audiovideo)&&i.partial)}function Ql(n){return`${n.type}_${n.level}_${n.sn}`}function BO(n,t){return n.filter(e=>{const i=t(e);return i||e.clearElementaryStreamInfo(),i})}class _Z{constructor(t,e,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=e,this.aesMode=i}decrypt(t,e){switch(this.aesMode){case 0:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t);case 1:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},e,t);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}class yZ{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let r=0;r<4;r++)i[r]=e.getUint32(4*r);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,r=i[0],s=i[1],o=i[2],a=i[3],l=this.invSubMix,c=l[0],u=l[1],d=l[2],f=l[3],h=new Uint32Array(256);let p=0,g=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let _=g^g<<1^g<<2^g<<3^g<<4;_=_>>>8^255&_^99,t[p]=_,e[_]=p;const y=h[p],b=h[y],S=h[b];let C=257*h[_]^16843008*_;r[p]=C<<24|C>>>8,s[p]=C<<16|C>>>16,o[p]=C<<8|C>>>24,a[p]=C,C=16843009*S^65537*b^257*y^16843008*p,c[_]=C<<24|C>>>8,u[_]=C<<16|C>>>16,d[_]=C<<8|C>>>24,f[_]=C,p?(p=y^h[h[h[S^y]]],g^=h[h[g]]):p=g=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let i=!0,r=0;for(;r<e.length&&i;)i=e[r]===this.key[r],r++;if(i)return;this.key=e;const s=this.keySize=e.length;if(4!==s&&6!==s&&8!==s)throw new Error("Invalid aes key size="+s);const o=this.ksRows=4*(s+6+1);let a,l;const c=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),d=this.sBox,f=this.rcon,h=this.invSubMix,p=h[0],g=h[1],m=h[2],_=h[3];let y,b;for(a=0;a<o;a++)a<s?y=c[a]=e[a]:(b=y,a%s==0?(b=b<<8|b>>>24,b=d[b>>>24]<<24|d[b>>>16&255]<<16|d[b>>>8&255]<<8|d[255&b],b^=f[a/s|0]<<24):s>6&&a%s==4&&(b=d[b>>>24]<<24|d[b>>>16&255]<<16|d[b>>>8&255]<<8|d[255&b]),c[a]=y=(c[a-s]^b)>>>0);for(l=0;l<o;l++)a=o-l,b=3&l?c[a]:c[a-4],u[l]=l<4||a<=4?b:p[d[b>>>24]]^g[d[b>>>16&255]]^m[d[b>>>8&255]]^_[d[255&b]],u[l]=u[l]>>>0}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}decrypt(t,e,i){const r=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],c=a[1],u=a[2],d=a[3],f=this.uint8ArrayToUint32Array_(i);let h=f[0],p=f[1],g=f[2],m=f[3];const _=new Int32Array(t),y=new Int32Array(_.length);let b,S,C,k,I,M,O,x,B,K,ee,oe,se,G;const ie=this.networkToHostOrderSwap;for(;e<_.length;){for(B=ie(_[e]),K=ie(_[e+1]),ee=ie(_[e+2]),oe=ie(_[e+3]),I=B^s[0],M=oe^s[1],O=ee^s[2],x=K^s[3],se=4,G=1;G<r;G++)b=l[I>>>24]^c[M>>16&255]^u[O>>8&255]^d[255&x]^s[se],S=l[M>>>24]^c[O>>16&255]^u[x>>8&255]^d[255&I]^s[se+1],C=l[O>>>24]^c[x>>16&255]^u[I>>8&255]^d[255&M]^s[se+2],k=l[x>>>24]^c[I>>16&255]^u[M>>8&255]^d[255&O]^s[se+3],I=b,M=S,O=C,x=k,se+=4;b=o[I>>>24]<<24^o[M>>16&255]<<16^o[O>>8&255]<<8^o[255&x]^s[se],S=o[M>>>24]<<24^o[O>>16&255]<<16^o[x>>8&255]<<8^o[255&I]^s[se+1],C=o[O>>>24]<<24^o[x>>16&255]<<16^o[I>>8&255]<<8^o[255&M]^s[se+2],k=o[x>>>24]<<24^o[I>>16&255]<<16^o[M>>8&255]<<8^o[255&O]^s[se+3],y[e]=ie(b^h),y[e+1]=ie(k^p),y[e+2]=ie(C^g),y[e+3]=ie(S^m),h=B,p=K,g=ee,m=oe,e+=4}return y.buffer}}class bZ{constructor(t,e,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=e,this.aesMode=i}expandKey(){const t=function EZ(n){switch(n){case 0:return"AES-CBC";case 1:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${n}`)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:t},!1,["encrypt","decrypt"])}}class Jb{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;const i=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?function vZ(n){const t=n.byteLength,e=t&&new DataView(n.buffer).getUint8(t-1);return e?n.slice(0,t-e):n}(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,i,r){return this.useSoftware?new Promise((s,o)=>{const a=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.softwareDecrypt(a,e,i,r);const l=this.flush();l?s(l.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),e,i,r)}softwareDecrypt(t,e,i,r){const{currentIV:s,currentResult:o,remainderData:a}=this;if(0!==r||16!==e.byteLength)return ut.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(t=tr(a,t),this.remainderData=null);const l=this.getValidChunk(t);if(!l.length)return null;s&&(i=s);let c=this.softwareDecrypter;c||(c=this.softwareDecrypter=new yZ),c.expandKey(e);const u=o;return this.currentResult=c.decrypt(l.buffer,0,i),this.currentIV=l.slice(-16).buffer,u||null}webCryptoDecrypt(t,e,i,r){if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,i,r));this.key=e,this.fastAesKey=new bZ(this.subtle,e,r)}return this.fastAesKey.expandKey().then(s=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new _Z(this.subtle,new Uint8Array(i),r).decrypt(t.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(ut.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(t,e,i,r)))}onWebCryptoError(t,e,i,r){const s=this.enableSoftwareAES;if(s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,i,r);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(s?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(t){let e=t;const i=t.length-t.length%16;return i!==t.length&&(e=t.slice(0,i),this.remainderData=t.slice(i)),e}logOnce(t){this.logEnabled&&(ut.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const UO=Math.pow(2,17);class TZ{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const i=t.url;if(!i)return Promise.reject(new ks({type:fe.NETWORK_ERROR,details:N.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error("Fragment does not have a "+(i?"part list":"url")),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),t.gap){if(t.tagList.some(p=>"GAP"===p[0]))return void l(VO(t));t.gap=!1}const c=this.loader=s?new s(r):new o(r),u=$O(t);t.loader=c;const d=FO(r.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===t.sn?1/0:UO};t.stats=c.stats;const h={onSuccess:(p,g,m,_)=>{this.resetLoader(t,c);let y=p.data;m.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(y.slice(0,16)),y=y.slice(16)),a({frag:t,part:null,payload:y,networkDetails:_})},onError:(p,g,m,_)=>{this.resetLoader(t,c),l(new ks({type:fe.NETWORK_ERROR,details:N.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:ct({url:i,data:void 0},p),error:new Error(`HTTP Error ${p.code} ${p.text}`),networkDetails:m,stats:_}))},onAbort:(p,g,m)=>{this.resetLoader(t,c),l(new ks({type:fe.NETWORK_ERROR,details:N.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:m,stats:p}))},onTimeout:(p,g,m)=>{this.resetLoader(t,c),l(new ks({type:fe.NETWORK_ERROR,details:N.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:m,stats:p}))}};e&&(h.onProgress=(p,g,m,_)=>e({frag:t,part:null,payload:m,networkDetails:_})),c.load(u,f,h)})}loadPart(t,e,i){this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap)return void l(VO(t,e));const c=this.loader=s?new s(r):new o(r),u=$O(t,e);t.loader=c;const d=FO(r.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:UO};e.stats=c.stats,c.load(u,f,{onSuccess:(h,p,g,m)=>{this.resetLoader(t,c),this.updateStatsFromPart(t,e);const _={frag:t,part:e,payload:h.data,networkDetails:m};i(_),a(_)},onError:(h,p,g,m)=>{this.resetLoader(t,c),l(new ks({type:fe.NETWORK_ERROR,details:N.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:ct({url:u.url,data:void 0},h),error:new Error(`HTTP Error ${h.code} ${h.text}`),networkDetails:g,stats:m}))},onAbort:(h,p,g)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,c),l(new ks({type:fe.NETWORK_ERROR,details:N.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:g,stats:h}))},onTimeout:(h,p,g)=>{this.resetLoader(t,c),l(new ks({type:fe.NETWORK_ERROR,details:N.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:g,stats:h}))}})})}updateStatsFromPart(t,e){const i=t.stats,r=e.stats,s=r.total;if(i.loaded+=r.loaded,s){const l=Math.round(t.duration/e.duration),c=Math.min(Math.round(i.loaded/s),l),d=(l-c)*Math.round(i.loaded/c);i.total=i.loaded+d}else i.total=Math.max(i.loaded,i.total);const o=i.loading,a=r.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function $O(n,t=null){const e=t||n,i={frag:n,part:t,responseType:"arraybuffer",url:e.url,headers:{},rangeStart:0,rangeEnd:0},r=e.byteRangeStartOffset,s=e.byteRangeEndOffset;if(re(r)&&re(s)){var o;let a=r,l=s;if("initSegment"===n.sn&&function DZ(n){return"AES-128"===n||"AES-256"===n}(null==(o=n.decryptdata)?void 0:o.method)){const c=s-r;c%16&&(l=s+(16-c%16)),0!==r&&(i.resetIV=!0,a=r-16)}i.rangeStart=a,i.rangeEnd=l}return i}function VO(n,t){const e=new Error(`GAP ${n.gap?"tag":"attribute"} found`),i={type:fe.MEDIA_ERROR,details:N.FRAG_GAP,fatal:!1,frag:n,error:e,networkDetails:null};return t&&(i.part=t),(t||n).stats.aborted=!0,new ks(i)}class ks extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class jO extends er{constructor(t,e){super(t,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class e1{constructor(t,e,i,r=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=e,this.id=i,this.size=r,this.part=s,this.partial=o}}const HO={length:0,start:()=>0,end:()=>0};class Me{static isBuffered(t,e){if(t){const i=Me.getBuffered(t);for(let r=i.length;r--;)if(e>=i.start(r)&&e<=i.end(r))return!0}return!1}static bufferedRanges(t){if(t){const e=Me.getBuffered(t);return Me.timeRangesToArray(e)}return[]}static timeRangesToArray(t){const e=[];for(let i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e}static bufferInfo(t,e,i){if(t){const r=Me.bufferedRanges(t);if(r.length)return Me.bufferedInfo(r,e,i)}return{len:0,start:e,end:e,bufferedIndex:-1}}static bufferedInfo(t,e,i){e=Math.max(0,e),t.length>1&&t.sort((u,d)=>u.start-d.start||d.end-u.end);let r=-1,s=[];if(i)for(let u=0;u<t.length;u++){e>=t[u].start&&e<=t[u].end&&(r=u);const d=s.length;if(d){const f=s[d-1].end;t[u].start-f<i?t[u].end>f&&(s[d-1].end=t[u].end):s.push(t[u])}else s.push(t[u])}else s=t;let a,o=0,l=e,c=e;for(let u=0;u<s.length;u++){const d=s[u].start,f=s[u].end;if(-1===r&&e>=d&&e<=f&&(r=u),e+i>=d&&e<f)l=d,c=f,o=c-e;else if(e+i<d){a=d;break}}return{len:o,start:l||0,end:c||0,nextStart:a,buffered:t,bufferedIndex:r}}static getBuffered(t){try{return t.buffered||HO}catch(e){return ut.log("failed to get media.buffered",e),HO}}}const GO=/\{\$([a-zA-Z0-9-_]+)\}/g;function zO(n){return GO.test(n)}function t1(n,t){if(null!==n.variableList||n.hasVariableRefs){const e=n.variableList;return t.replace(GO,i=>{const r=i.substring(2,i.length-1),s=e?.[r];return void 0===s?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),i):s})}return t}function WO(n,t,e){let r,s,i=n.variableList;if(i||(n.variableList=i={}),"QUERYPARAM"in t){r=t.QUERYPARAM;try{const o=new self.URL(e).searchParams;if(!o.has(r))throw new Error(`"${r}" does not match any query parameter in URI: "${e}"`);s=o.get(r)}catch(o){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else r=t.NAME,s=t.VALUE;r in i?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):i[r]=s||""}function CZ(n,t,e){const i=t.IMPORT;if(e&&i in e){let r=n.variableList;r||(n.variableList=r={}),r[i]=e[i]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const IZ=/^(\d+)x(\d+)$/,KO=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Vt{constructor(t,e){"string"==typeof t&&(t=Vt.parseAttrList(t,e)),vt(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>"X-"===t.substring(0,2))}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;const i=new Uint8Array(e.length/2);for(let r=0;r<e.length/2;r++)i[r]=parseInt(e.slice(2*r,2*r+2),16);return i}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const i=this[t];return i?parseFloat(i):e}enumeratedString(t){return this[t]}enumeratedStringList(t,e){const i=this[t];return(i?i.split(/[ ,]+/):[]).reduce((r,s)=>(r[s.toLowerCase()]=!0,r),e)}bool(t){return"YES"===this[t]}decimalResolution(t){const e=IZ.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t,e){let i;const r={};for(KO.lastIndex=0;null!==(i=KO.exec(t));){const o=i[1].trim();let a=i[2];const l=0===a.indexOf('"')&&a.lastIndexOf('"')===a.length-1;let c=!1;if(l)a=a.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":c=!0}if(e&&(l||c))a=t1(e,a);else if(!c&&!l)switch(o){case"CLOSED-CAPTIONS":if("NONE"===a)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":ut.warn(`${t}: attribute ${o} is missing quotes`)}r[o]=a}return r}}function xZ(n){return"ID"!==n&&"CLASS"!==n&&"CUE"!==n&&"START-DATE"!==n&&"DURATION"!==n&&"END-DATE"!==n&&"END-ON-NEXT"!==n}function AZ(n){return"SCTE35-OUT"===n||"SCTE35-IN"===n||"SCTE35-CMD"===n}class qO{constructor(t,e,i=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=e?.tagAnchor||null,this.tagOrder=null!=(r=e?.tagOrder)?r:i,e){const s=e.attr;for(const o in s)if(Object.prototype.hasOwnProperty.call(t,o)&&t[o]!==s[o]){ut.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=o;break}t=vt(new Vt({}),s,t)}if(this.attr=t,e?(this._startDate=e._startDate,this._cue=e._cue,this._endDate=e._endDate,this._dateAtEnd=e._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const s=e?.endDate||new Date(this.attr["END-DATE"]);re(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const t=this._cue;return void 0===t?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):t}get startTime(){const{tagAnchor:t}=this;return null===t||null===t.programDateTime?(ut.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${t}`),NaN):t.start+(this.startDate.getTime()-t.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const t=this._endDate||this._dateAtEnd;if(t)return t;const e=this.duration;return null!==e?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(re(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return"com.apple.hls.interstitial"===this.class}get isValid(){return!!this.id&&!this._badValueForSameId&&re(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class RZ{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t)return this.advanced=!0,void(this.updated=!0);const e=this.lastPartSn-t.lastPartSn,i=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!i||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||0===e&&i>0,this.misses=this.updated||this.advanced?Math.floor(.6*t.misses):t.misses+1}hasKey(t){return this.encryptedFragments.some(e=>{let i=e.decryptdata;return i||(e.setKeyFormat(t.keyFormat),i=e.decryptdata),!!i&&t.matches(i)})}get hasProgramDateTime(){return!!this.fragments.length&&re(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?1e3*(this.driftEnd-this.driftStart)/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const t=this.partList;if(t){const e=this.lastPartIndex;if(-1!==e){for(let i=t.length;i--;)if(t[i].index>e)return t[i].index;return e}}return 0}get lastPartSn(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){return!!(this.live&&this.age&&this.misses<3)&&this.age>Math.max(this.partEnd-this.fragmentStart,this.totalduration)+this.levelTargetDuration}}function ag(n,t){return n.length===t.length&&!n.some((e,i)=>e!==t[i])}function YO(n,t){return!n&&!t||!(!n||!t)&&ag(n,t)}function Zl(n){return"AES-128"===n||"AES-256"===n||"AES-256-CTR"===n}function n1(n){switch(n){case"AES-128":case"AES-256":return 0;case"AES-256-CTR":return 1;default:throw new Error(`invalid full segment method ${n}`)}}function i1(n){return Uint8Array.from(atob(n),t=>t.charCodeAt(0))}function r1(n){return Uint8Array.from(unescape(encodeURIComponent(n)),t=>t.charCodeAt(0))}function QO(n){const t=function(i,r,s){const o=i[r];i[r]=i[s],i[s]=o};t(n,0,3),t(n,1,2),t(n,4,5),t(n,6,7)}function ZO(n){const t=n.split(":");let e=null;if("data"===t[0]&&2===t.length){const i=t[1].split(";"),r=i[i.length-1].split(",");if(2===r.length){const o=r[1];"base64"===r[0]?(i.splice(-1,1),e=i1(o)):e=function kZ(n){const t=r1(n).subarray(0,16),e=new Uint8Array(16);return e.set(t,16-t.length),e}(o)}}return e}const lg=typeof self<"u"?self:void 0;var jt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Rn_FAIRPLAY="com.apple.streamingkeydelivery",Rn_PLAYREADY="com.microsoft.playready",Rn_WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function cg(n){switch(n){case Rn_FAIRPLAY:return jt.FAIRPLAY;case Rn_PLAYREADY:return jt.PLAYREADY;case Rn_WIDEVINE:return jt.WIDEVINE;case"org.w3.clearkey":return jt.CLEARKEY}}function s1(n){switch(n){case jt.FAIRPLAY:return Rn_FAIRPLAY;case jt.PLAYREADY:return Rn_PLAYREADY;case jt.WIDEVINE:return Rn_WIDEVINE;case jt.CLEARKEY:return"org.w3.clearkey"}}function vd(n){const{drmSystems:t,widevineLicenseUrl:e}=n,i=t?[jt.FAIRPLAY,jt.WIDEVINE,jt.PLAYREADY,jt.CLEARKEY].filter(r=>!!t[r]):[];return!i[jt.WIDEVINE]&&e&&i.push(jt.WIDEVINE),i}const XO=null!=lg&&null!=(n=lg.navigator)&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var n;function JO(n){const t=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),e=String.fromCharCode.apply(null,Array.from(t)),i=e.substring(e.indexOf("<"),e.length),o=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(o){const a=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(a){const l=i1(a).subarray(0,16);return QO(l),l}}return null}let ug={};class ma{static clearKeyUriToKeyIdMap(){ug={}}static setKeyIdForUri(t,e){ug[t]=e}constructor(t,e,i,r=[1],s=null,o){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=i,this.keyFormatVersions=r,this.iv=s,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&!Zl(t),null!=o&&o.startsWith("0x")&&(this.keyId=new Uint8Array(iO(o)))}matches(t){return t.uri===this.uri&&t.method===this.method&&t.encrypted===this.encrypted&&t.keyFormat===this.keyFormat&&ag(t.keyFormatVersions,this.keyFormatVersions)&&YO(t.iv,this.iv)&&YO(t.keyId,this.keyId)}isSupported(){if(this.method){if(Zl(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case Rn_FAIRPLAY:case Rn_WIDEVINE:case Rn_PLAYREADY:case"org.w3.clearkey":return-1!==["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(t,e){if(!this.encrypted||!this.uri)return null;if(Zl(this.method)){let s=this.iv;return s||("number"!=typeof t&&(ut.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0),s=function FZ(n){const t=new Uint8Array(16);for(let e=12;e<16;e++)t[e]=n>>8*(15-e)&255;return t}(t)),new ma(this.method,this.uri,"identity",this.keyFormatVersions,s)}if(this.keyId){const s=ug[this.uri];if(s&&!ag(this.keyId,s)&&ma.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const i=ZO(this.uri);if(i)switch(this.keyFormat){case Rn_WIDEVINE:if(this.pssh=i,!this.keyId){const s=function $Q(n){const t=[];if(n instanceof ArrayBuffer){const e=n.byteLength;let i=0;for(;i+32<e;){const s=VQ(new DataView(n,i));t.push(s),i+=s.size}}return t}(i.buffer);if(s.length){var r;const o=s[0];this.keyId=null!=(r=o.kids)&&r.length?o.kids[0]:null}}this.keyId||(this.keyId=eN(e));break;case Rn_PLAYREADY:{const s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function UQ(n,t,e){if(16!==n.byteLength)throw new RangeError("Invalid system id");let i,r,s;i=0,r=new Uint8Array,s=new Uint8Array;const o=new Uint8Array(4);return e.byteLength>0&&new DataView(o.buffer).setUint32(0,e.byteLength,!1),function BQ(n,...t){const e=t.length;let i=8,r=e;for(;r--;)i+=t[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(n,4),r=0,i=8;r<e;r++)s.set(t[r],i),i+=t[r].byteLength;return s}([112,115,115,104],new Uint8Array([0,0,0,0]),n,s,r,o,e)}(s,0,i),this.keyId=JO(i);break}default:{let s=i.subarray(0,16);if(16!==s.length){const o=new Uint8Array(16);o.set(s,16-s.length),s=o}this.keyId=s;break}}if(!this.keyId||16!==this.keyId.byteLength){let s;s=function LZ(n){const t=n?.[Rn_WIDEVINE];return t?t.keyId:null}(e),s||(s=eN(e),s||(s=ug[this.uri])),s&&(this.keyId=s,ma.setKeyIdForUri(this.uri,s))}return this}}function eN(n){const t=n?.[Rn_PLAYREADY];if(t){const e=ZO(t.uri);if(e)return JO(e)}return null}const tN=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,nN=/#EXT-X-MEDIA:(.*)/g,BZ=/^#EXT(?:INF|-X-TARGETDURATION):/m,o1=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),UZ=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Xr{static findGroup(t,e){for(let i=0;i<t.length;i++){const r=t[i];if(r.id===e)return r}}static resolve(t,e){return Vb.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return BZ.test(t)}static parseMasterPlaylist(t,e){const r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:zO(t)},s=[];if(tN.lastIndex=0,!t.startsWith("#EXTM3U"))return r.playlistParsingError=new Error("no EXTM3U delimiter"),r;let o;for(;null!=(o=tN.exec(t));)if(o[1]){var a;const c=new Vt(o[1],r),u=t1(r,o[2]),d={attrs:c,bitrate:c.decimalInteger("BANDWIDTH")||c.decimalInteger("AVERAGE-BANDWIDTH"),name:c.NAME,url:Xr.resolve(u,e)},f=c.decimalResolution("RESOLUTION");f&&(d.width=f.width,d.height=f.height),oN(c.CODECS,d);const h=c["SUPPLEMENTAL-CODECS"];h&&(d.supplemental={},oN(h,d.supplemental)),null!=(a=d.unknownCodecs)&&a.length||s.push(d),r.levels.push(d)}else if(o[3]){const u=o[4];switch(o[3]){case"SESSION-DATA":{const d=new Vt(u,r),f=d["DATA-ID"];f&&(null===r.sessionData&&(r.sessionData={}),r.sessionData[f]=d);break}case"SESSION-KEY":{const d=rN(u,e,r);d.encrypted&&d.isSupported()?(null===r.sessionKeys&&(r.sessionKeys=[]),r.sessionKeys.push(d)):ut.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${u}"`);break}case"DEFINE":WO(r,new Vt(u,r),e);break;case"CONTENT-STEERING":{const d=new Vt(u,r);r.contentSteering={uri:Xr.resolve(d["SERVER-URI"],e),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":r.startTimeOffset=sN(u)}}return r.levels=s.length>0&&s.length<r.levels.length?s:r.levels,0===r.levels.length&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(t,e,i){let r;const s={},o=i.levels,a={AUDIO:o.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:o.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(nN.lastIndex=0;null!==(r=nN.exec(t));){const c=new Vt(r[1],i),u=c.TYPE;if(u){const d=a[u],f=s[u]||[];s[u]=f;const h=c.LANGUAGE,p=c["ASSOC-LANGUAGE"],g=c.CHANNELS,m=c.CHARACTERISTICS,_=c["INSTREAM-ID"],y={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",name:c.NAME||h||"",type:u,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:h,url:c.URI?Xr.resolve(c.URI,e):""};if(p&&(y.assocLang=p),g&&(y.channels=g),m&&(y.characteristics=m),_&&(y.instreamId=_),null!=d&&d.length){const b=Xr.findGroup(d,y.groupId)||d[0];aN(y,b,"audioCodec"),aN(y,b,"textCodec")}f.push(y)}}return s}static parseLevelPlaylist(t,e,i,r,s,o){var a;const l={url:e},c=new RZ(e),u=c.fragments,d=[];let S,C,k,x,f=null,h=0,p=0,g=0,m=0,_=0,y=null,b=new Hb(r,l),I=-1,M=!1,O=null;if(o1.lastIndex=0,c.m3u8=t,c.hasVariableRefs=zO(t),"#EXTM3U"!==(null==(a=o1.exec(t))?void 0:a[0]))return c.playlistParsingError=new Error("Missing format identifier #EXTM3U"),c;for(;null!==(S=o1.exec(t));){M&&(M=!1,b=new Hb(r,l),b.playlistOffset=g,b.setStart(g),b.sn=h,b.cc=m,_&&(b.bitrate=_),b.level=i,f&&(b.initSegment=f,f.rawProgramDateTime&&(b.rawProgramDateTime=f.rawProgramDateTime,f.rawProgramDateTime=null),O&&(b.setByteRange(O),O=null)));const oe=S[1];if(oe){b.duration=parseFloat(oe);const se=(" "+S[2]).slice(1);b.title=se||null,b.tagList.push(se?["INF",oe,se]:["INF",oe])}else if(S[3]){if(re(b.duration)){b.playlistOffset=g,b.setStart(g),k&&cN(b,k,c),b.sn=h,b.level=i,b.cc=m,u.push(b);const se=(" "+S[3]).slice(1);b.relurl=t1(c,se),a1(b,y,d),y=b,g+=b.duration,h++,p=0,M=!0}}else{if(S=S[0].match(UZ),!S){ut.warn("No matches on slow regex match for level playlist!");continue}for(C=1;C<S.length&&void 0===S[C];C++);const se=(" "+S[C]).slice(1),G=(" "+S[C+1]).slice(1),ie=S[C+2]?(" "+S[C+2]).slice(1):null;switch(se){case"BYTERANGE":y?b.setByteRange(G,y):b.setByteRange(G);break;case"PROGRAM-DATE-TIME":b.rawProgramDateTime=G,b.tagList.push(["PROGRAM-DATE-TIME",G]),-1===I&&(I=u.length);break;case"PLAYLIST-TYPE":c.type&&Os(c,se,S),c.type=G.toUpperCase();break;case"MEDIA-SEQUENCE":0!==c.startSN?Os(c,se,S):u.length>0&&uN(c,se,S),h=c.startSN=parseInt(G);break;case"SKIP":{c.skippedSegments&&Os(c,se,S);const te=new Vt(G,c),ae=te.decimalInteger("SKIPPED-SEGMENTS");if(re(ae)){c.skippedSegments+=ae;for(let Z=ae;Z--;)u.push(null);h+=ae}const ge=te.enumeratedString("RECENTLY-REMOVED-DATERANGES");ge&&(c.recentlyRemovedDateranges=(c.recentlyRemovedDateranges||[]).concat(ge.split("\t")));break}case"TARGETDURATION":0!==c.targetduration&&Os(c,se,S),c.targetduration=Math.max(parseInt(G),1);break;case"VERSION":null!==c.version&&Os(c,se,S),c.version=parseInt(G);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":c.live||Os(c,se,S),c.live=!1;break;case"#":(G||ie)&&b.tagList.push(ie?[G,ie]:[G]);break;case"DISCONTINUITY":m++,b.tagList.push(["DIS"]);break;case"GAP":b.gap=!0,b.tagList.push([se]);break;case"BITRATE":b.tagList.push([se,G]),_=1e3*parseInt(G),re(_)?b.bitrate=_:_=0;break;case"DATERANGE":{const te=new Vt(G,c),ae=new qO(te,c.dateRanges[te.ID],c.dateRangeTagCount);c.dateRangeTagCount++,ae.isValid||c.skippedSegments?c.dateRanges[ae.id]=ae:ut.warn(`Ignoring invalid DATERANGE tag: "${G}"`),b.tagList.push(["EXT-X-DATERANGE",G]);break}case"DEFINE":{const te=new Vt(G,c);"IMPORT"in te?CZ(c,te,o):WO(c,te,e)}break;case"DISCONTINUITY-SEQUENCE":0!==c.startCC?Os(c,se,S):u.length>0&&uN(c,se,S),c.startCC=m=parseInt(G);break;case"KEY":{const te=rN(G,e,c);if(te.isSupported()){if("NONE"===te.method){k=void 0;break}k||(k={});const ae=k[te.keyFormat];null!=ae&&ae.matches(te)||(ae&&(k=vt({},k)),k[te.keyFormat]=te)}else ut.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${G}"`);break}case"START":c.startTimeOffset=sN(G);break;case"MAP":{const te=new Vt(G,c);if(b.duration){const ae=new Hb(r,l);lN(ae,te,i,k),f=ae,b.initSegment=f,f.rawProgramDateTime&&!b.rawProgramDateTime&&(b.rawProgramDateTime=f.rawProgramDateTime)}else{const ae=b.byteRangeEndOffset;if(ae){const ge=b.byteRangeStartOffset;O=`${ae-ge}@${ge}`}else O=null;lN(b,te,i,k),f=b,M=!0}f.cc=m;break}case"SERVER-CONTROL":x&&Os(c,se,S),x=new Vt(G),c.canBlockReload=x.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=x.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&x.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=x.optionalFloat("PART-HOLD-BACK",0),c.holdBack=x.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{c.partTarget&&Os(c,se,S);const te=new Vt(G);c.partTarget=te.decimalFloatingPoint("PART-TARGET");break}case"PART":{let te=c.partList;te||(te=c.partList=[]);const ae=p>0?te[te.length-1]:void 0,ge=p++,Z=new Vt(G,c),q=new CQ(Z,b,l,ge,ae);te.push(q),b.duration+=q.duration;break}case"PRELOAD-HINT":{const te=new Vt(G,c);c.preloadHint=te;break}case"RENDITION-REPORT":{const te=new Vt(G,c);c.renditionReports=c.renditionReports||[],c.renditionReports.push(te);break}default:ut.warn(`line parsed but not handled: ${S}`)}}}y&&!y.relurl?(u.pop(),g-=y.duration,c.partList&&(c.fragmentHint=y)):c.partList&&(a1(b,y,d),b.cc=m,c.fragmentHint=b,k&&cN(b,k,c)),c.targetduration||(c.playlistParsingError=new Error("Missing Target Duration"));const B=u.length,K=u[0],ee=u[B-1];if(g+=c.skippedSegments*c.targetduration,g>0&&B&&ee){c.averagetargetduration=g/B;const oe=ee.sn;c.endSN="initSegment"!==oe?oe:0,c.live||(ee.endList=!0),I>0&&(function VZ(n,t){let e=n[t];for(let i=t;i--;){const r=n[i];if(!r)return;r.programDateTime=e.programDateTime-1e3*r.duration,e=r}}(u,I),K&&d.unshift(K))}return c.fragmentHint&&(g+=c.fragmentHint.duration),c.totalduration=g,d.length&&c.dateRangeTagCount&&K&&iN(d,c),c.endCC=m,c}}function iN(n,t){let e=n.length;if(!e){if(!t.hasProgramDateTime)return;n.push(t.fragments[t.fragments.length-1]),e++}const i=n[e-1],r=t.live?1/0:t.totalduration,s=Object.keys(t.dateRanges);for(let a=s.length;a--;){const l=t.dateRanges[s[a]],c=l.startDate.getTime();l.tagAnchor=i.ref;for(let u=e;u--;){var o;if((null==(o=n[u])?void 0:o.sn)<t.startSN)break;const d=$Z(t,c,n,u,r);if(-1!==d){l.tagAnchor=t.fragments[d].ref;break}}}}function $Z(n,t,e,i,r){const s=e[i];if(s){const a=s.programDateTime;var o;if(t>=a||0===i)if(t<=a+1e3*(((null==(o=e[i+1])?void 0:o.start)||r)-s.start)){const c=e[i].sn-n.startSN;if(c<0)return-1;const u=n.fragments;if(u.length>e.length)for(let h=(e[i+1]||u[u.length-1]).sn-n.startSN;h>c;h--){const p=u[h].programDateTime;if(t>=p&&t<p+1e3*u[h].duration)return h}return c}}return-1}function rN(n,t,e){var i,r;const s=new Vt(n,e),o=null!=(i=s.METHOD)?i:"",a=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,u=null!=(r=s.KEYFORMAT)?r:"identity";a&&s.IV&&!l&&ut.error(`Invalid IV: ${s.IV}`);const d=a?Xr.resolve(a,t):"",f=(c||"1").split("/").map(Number).filter(Number.isFinite);return new ma(o,d,u,f,l,s.KEYID)}function sN(n){const e=new Vt(n).decimalFloatingPoint("TIME-OFFSET");return re(e)?e:null}function oN(n,t){let e=(n||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const r=e.filter(s=>Wb(s,i));r.length&&(t[`${i}Codec`]=r.map(s=>s.split("/")[0]).join(","),e=e.filter(s=>-1===r.indexOf(s)))}),t.unknownCodecs=e}function aN(n,t,e){const i=t[e];i&&(n[e]=i)}function a1(n,t,e){n.rawProgramDateTime?e.push(n):null!=t&&t.programDateTime&&(n.programDateTime=t.endProgramDateTime)}function lN(n,t,e,i){n.relurl=t.URI,t.BYTERANGE&&n.setByteRange(t.BYTERANGE),n.level=e,n.sn="initSegment",i&&(n.levelkeys=i),n.initSegment=null}function cN(n,t,e){n.levelkeys=t;const{encryptedFragments:i}=e;(!i.length||i[i.length-1].levelkeys!==t)&&Object.keys(t).some(r=>t[r].isCommonEncryption)&&i.push(n)}function Os(n,t,e){n.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${e[0]})`)}function uN(n,t,e){n.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${e[0]})`)}function l1(n,t){const e=t.startPTS;if(re(e)){let r,i=0;t.sn>n.sn?(i=e-n.start,r=n):(i=n.start-e,r=t),r.duration!==i&&r.setDuration(i)}else t.setStart(t.sn>n.sn?n.cc===t.cc&&n.minEndPTS?n.start+(n.minEndPTS-n.start):n.start+n.duration:Math.max(n.start-t.duration,0))}function dN(n,t,e,i,r,s,o){i-e<=0&&(o.warn("Fragment should have a positive duration",t),i=e+t.duration,s=r+t.duration);let l=e,c=i;const u=t.startPTS,d=t.endPTS;if(re(u)){const _=Math.abs(u-e);n&&_>n.totalduration?o.warn(`media timestamps and playlist times differ by ${_}s for level ${t.level} ${n.url}`):t.deltaPTS=re(t.deltaPTS)?Math.max(_,t.deltaPTS):_,l=Math.max(e,u),e=Math.min(e,u),r=void 0!==t.startDTS?Math.min(r,t.startDTS):r,c=Math.min(i,d),i=Math.max(i,d),s=void 0!==t.endDTS?Math.max(s,t.endDTS):s}const f=e-t.start;0!==t.start&&t.setStart(e),t.setDuration(i-t.start),t.startPTS=e,t.maxStartPTS=l,t.startDTS=r,t.endPTS=i,t.minEndPTS=c,t.endDTS=s;const h=t.sn;if(!n||h<n.startSN||h>n.endSN)return 0;let p;const g=h-n.startSN,m=n.fragments;for(m[g]=t,p=g;p>0;p--)l1(m[p],m[p-1]);for(p=g;p<m.length-1;p++)l1(m[p],m[p+1]);return n.fragmentHint&&l1(m[m.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,f}function fN(n,t,e,i,r){return new Error(`${n} ${r.url}\nPlaylist starting @${t.startSN}\n${t.m3u8}\n\nPlaylist starting @${e.startSN}\n${e.m3u8}`)}function hN(n,t,e=!0){const i=t.startSN+t.skippedSegments-n.startSN,r=n.fragments,s=i>=0;let o=0;if(s&&i<r.length)o=r[i].start;else if(s&&t.startSN===n.endSN+1)o=n.fragmentEnd;else if(s&&e)o=n.fragmentStart+i*t.levelTargetDuration;else{if(t.skippedSegments||0!==t.fragmentStart)return;o=n.fragmentStart}c1(t,o)}function c1(n,t){if(t){const e=n.fragments;for(let i=n.skippedSegments;i<e.length;i++)e[i].addStart(t);n.fragmentHint&&n.fragmentHint.addStart(t)}}function pN(n,t=1/0){let e=1e3*n.targetduration;if(n.updated){const i=n.fragments;if(i.length&&4*e>t){const s=1e3*i[i.length-1].duration;s<e&&(e=s)}}else e/=2;return Math.round(e)}function gN(n,t,e){if(!n)return null;let i=n.fragments[t-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===t)?i:t<n.startSN&&e&&e.sn===t?e:null}function mN(n,t,e){return n?_N(n.partList,t,e):null}function _N(n,t,e){if(n)for(let i=n.length;i--;){const r=n[i];if(r.index===e&&r.fragment.sn===t)return r}return null}function vN(n){n.forEach((t,e)=>{var i;null==(i=t.details)||i.fragments.forEach(r=>{r.level=e,r.initSegment&&(r.initSegment.level=e)})})}function WZ(n,t){return!(n===t||!t)&&yN(n)!==yN(t)}function yN(n){return n.replace(/\?[^?]*$/,"")}function yd(n,t){for(let i=0,r=n.length;i<r;i++){var e;if((null==(e=n[i])?void 0:e.cc)===t)return n[i]}return null}function bN(n,t){const e=n.start+t;n.startPTS=e,n.setStart(e),n.endPTS=e+n.duration}function EN(n,t){const e=t.fragments;for(let i=0,r=e.length;i<r;i++)bN(e[i],n);t.fragmentHint&&bN(t.fragmentHint,n),t.alignedSliding=!0}function SN(n,t){if(!function KZ(n,t){return!!(n&&t.startCC<n.endCC&&t.endCC>n.startCC)}(t,n))return;const e=Math.min(t.endCC,n.endCC),i=yd(t.fragments,e),r=yd(n.fragments,e);i&&r&&(ut.log(`Aligning playlist at start of dicontinuity sequence ${e}`),EN(i.start-r.start,n))}function dg(n,t){if(!n.hasProgramDateTime||!t.hasProgramDateTime)return;const e=n.fragments,i=t.fragments;if(!e.length||!i.length)return;let r,s;const o=Math.min(t.endCC,n.endCC);t.startCC<o&&n.startCC<o&&(r=yd(i,o),s=yd(e,o)),(!r||!s)&&(r=i[Math.floor(i.length/2)],s=yd(e,r.cc)||e[Math.floor(e.length/2)]);const a=r.programDateTime,l=s.programDateTime;a&&l&&EN((l-a)/1e3-(s.start-r.start),n)}function Zn(n,t,e){di(n,t,e),n.addEventListener(t,e)}function di(n,t,e){n.removeEventListener(t,e)}class u1 extends jO{constructor(t,e,i,r,s){super(r,t.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state="STOPPED",this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:a,media:l,mediaBuffer:c,state:u}=this,d=l?l.currentTime:0,f=Me.bufferInfo(c||l,d,o.maxBufferHole),h=!f.len;if(this.log(`Media seeking to ${re(d)?d.toFixed(3):d}, state: ${u}, ${h?"out of":"in"} buffer`),"ENDED"===this.state)this.resetLoadingState();else if(a){const p=o.maxFragLookUpTolerance,g=a.start-p,m=a.start+a.duration+p;if(h||m<f.start||g>f.end){const _=d>m;(d<g||_)&&(_&&a.loader&&(this.log(`Cancelling fragment load for seek (sn: ${a.sn})`),a.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l&&(this.fragmentTracker.removeFragmentsInRange(d,1/0,this.playlistType,!0),d>this.lastCurrentTime&&(this.lastCurrentTime=d),!this.loadingParts)){const g=Math.max(f.end,d),m=this.shouldLoadParts(this.getLevelDetails(),g);m&&(this.log(`LL-Part loading ON after seeking to ${d.toFixed(2)} with buffer @${g.toFixed(2)}`),this.loadingParts=m)}this.hls.hasEnoughToStart||(this.log(`Setting ${h?"startPosition":"nextLoadPosition"} to ${d} for seek without enough to start`),this.nextLoadPosition=d,h&&(this.startPosition=d)),h&&"IDLE"===this.state&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=t,this.fragmentLoader=new TZ(t.config),this.keyLoader=i,this.fragmentTracker=e,this.config=t.config,this.decrypter=new Jb(t.config)}registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(v.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){if("STOPPED"===this.state)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;null!=t&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state="STOPPED"}get startPositionValue(){const{nextLoadPosition:t,startPosition:e}=this;return-1===e&&t?t:e}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(t,e){if(e.live||!this.media)return!1;const r=this.config.timelineOffset||0;if((t.end||0)<=r)return!1;const s=t.buffered;this.config.maxBufferHole&&s&&s.length>1&&(t=Me.bufferedInfo(s,t.start,0));const o=t.nextStart;if(o&&o>r&&o<e.edge||this.media.currentTime<t.start)return!1;const l=e.partList;if(null!=l&&l.length){const u=l[l.length-1];return Me.isBuffered(this.media,u.start+u.duration/2)}return this.fragmentTracker.isEndListAppended(e.fragments[e.fragments.length-1].type)}getLevelDetails(){if(this.levels&&null!==this.levelLastLoaded)return this.levelLastLoaded.details}get timelineOffset(){const t=this.config.timelineOffset;var e;return t?(null==(e=this.getLevelDetails())?void 0:e.appliedTimelineOffset)||t:0}onMediaAttached(t,e){const i=this.media=this.mediaBuffer=e.media;Zn(i,"seeking",this.onMediaSeeking),Zn(i,"ended",this.onMediaEnded);const r=this.config;this.levels&&r.autoStartLoad&&"STOPPED"===this.state&&this.startLoad(r.startPosition)}onMediaDetaching(t,e){const i=!!e.transferMedia,r=this.media;if(null!==r){if(r.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),di(r,"seeking",this.onMediaSeeking),di(r,"ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(t,e){}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state="STOPPED",this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,i){this.startFragRequested=!0,this._loadFragForPlayback(t,e,i)}_loadFragForPlayback(t,e,i){this._doFragLoad(t,e,i,s=>{const o=s.frag;if(this.fragContextChanged(o))return this.warn(`${o.type} sn: ${o.sn}${s.part?" part: "+s.part.index:""} of ${this.fragInfo(o,!1,s.part)}) was dropped during download.`),void this.fragmentTracker.removeFragment(o);o.stats.chunkCount++,this._handleFragmentLoadProgress(s)}).then(s=>{if(!s)return;const o=this.state,a=s.frag;this.fragContextChanged(a)?("FRAG_LOADING"===o||!this.fragCurrent&&"PARSING"===o)&&(this.fragmentTracker.removeFragment(a),this.state="IDLE"):("payload"in s&&(this.log(`Loaded ${a.type} sn: ${a.sn} of ${this.playlistLabel()} ${a.level}`),this.hls.trigger(v.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s))}).catch(s=>{"STOPPED"===this.state||"ERROR"===this.state||(this.warn(`Frag error: ${s?.message||s}`),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var e;const{fragmentTracker:i}=this;if("APPENDING"===i.getState(t)){const o=this.getFwdBufferInfo(this.mediaBuffer,t.type),a=Math.max(t.duration,o?o.len:this.config.maxBufferLength),l=this.backtrackFragment;(1==(l?t.sn-l.sn:0)||this.reduceMaxBufferLength(a,t.duration))&&i.removeFragment(t)}else 0===(null==(e=this.mediaBuffer)?void 0:e.buffered.length)?i.removeAllFragments():i.hasParts(t.type)&&(i.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),"PARTIAL"===i.getState(t)&&i.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}waitForLive(t){const e=t.details;return e?.live&&"EVENT"!==e.type&&(this.levelLastLoaded!==t||e.expired)}flushMainBuffer(t,e,i=null){t-e&&this.hls.trigger(v.BUFFER_FLUSHING,{startOffset:t,endOffset:e,type:i})}_loadInitSegment(t,e){this._doFragLoad(t,e).then(i=>{const r=i?.frag;if(!r||this.fragContextChanged(r)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:r}=this,{frag:s,payload:o}=i,a=s.decryptdata;if(o&&o.byteLength>0&&null!=a&&a.key&&a.iv&&Zl(a.method)){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),a.key.buffer,a.iv.buffer,n1(a.method)).catch(c=>{throw r.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:s}),c}).then(c=>{const u=self.performance.now();return r.trigger(v.FRAG_DECRYPTED,{frag:s,payload:c,stats:{tstart:l,tdecrypt:u}}),i.payload=c,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{"STOPPED"===this.state||"ERROR"===this.state||(this.warn(i),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){const{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");const i=t.frag.stats;"STOPPED"!==this.state&&(this.state="IDLE"),t.frag.data=new Uint8Array(t.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(t,e){var i,r;const s=t.tracks;if(s&&!e.encrypted&&(null!=(i=s.audio)&&i.encrypted||null!=(r=s.video)&&r.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const o=this.media,a=new Error(`Encrypted track with no key in ${this.fragInfo(e)} (media ${o?"attached mediaKeys: "+o.mediaKeys:"detached"})`);return this.warn(a.message),!(!o||o.mediaKeys||(this.hls.trigger(v.ERROR,{type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_KEYS,fatal:!1,error:a,frag:e}),this.resetTransmuxer(),0))}return!1}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)} > buffer:${i?function(n){let t="";const e=n.length;for(let i=0;i<e;i++)t+=`[${n.start(i).toFixed(3)}-${n.end(i).toFixed(3)}]`;return t}(Me.getBuffered(i)):"(detached)"})`),ln(t)){var r;if("subtitle"!==t.type){const o=t.elementaryStreams;if(!Object.keys(o).some(a=>!!o[a]))return void(this.state="IDLE")}const s=null==(r=this.levels)?void 0:r[t.level];null!=s&&s.fragmentError&&(this.log(`Resetting level fragment error count of ${s.fragmentError} on frag buffered`),s.fragmentError=0)}this.state="IDLE"}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:i,part:r,partsLoaded:s}=t,o=!s||0===s.length||s.some(l=>!l),a=new e1(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!o);e.flush(a)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e,i=null,r){var s;this.fragCurrent=t;const o=e.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(!t.encrypted||null!=(s=t.decryptdata)&&s.key)t.encrypted||(a=this.keyLoader.loadClear(t,o.encryptedFragments,this.startFragRequested),a&&this.log("[eme] blocking frag load until media-keys acquired"));else if(this.log(`Loading key for ${t.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${t.level}`),this.state="KEY_LOADING",this.fragCurrent=t,a=this.keyLoader.load(t).then(f=>{if(!this.fragContextChanged(f.frag))return this.hls.trigger(v.KEY_LOADED,f),"KEY_LOADING"===this.state&&(this.state="IDLE"),f}),this.hls.trigger(v.KEY_LOADING,{frag:t}),null===this.fragCurrent)return this.log("context changed in KEY_LOADING"),Promise.resolve(null);const l=this.fragPrevious;if(ln(t)&&(!l||t.sn!==l.sn)){const f=this.shouldLoadParts(e.details,t.end);f!==this.loadingParts&&(this.log(`LL-Part loading ${f?"ON":"OFF"} loading sn ${l?.sn}->${t.sn}`),this.loadingParts=f)}if(i=Math.max(t.start,i||0),this.loadingParts&&ln(t)){const f=o.partList;if(f&&r){i>o.fragmentEnd&&o.fragmentHint&&(t=o.fragmentHint);const h=this.getNextPart(f,t,i);if(h>-1){const p=f[h];let g;return t=this.fragCurrent=p.fragment,this.log(`Loading ${t.type} sn: ${t.sn} part: ${p.index} (${h}/${f.length-1}) of ${this.fragInfo(t,!1,p)}) cc: ${t.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=p.start+p.duration,this.state="FRAG_LOADING",g=a?a.then(m=>!m||this.fragContextChanged(m.frag)?null:this.doFragPartsLoad(t,p,e,r)).catch(m=>this.handleFragLoadError(m)):this.doFragPartsLoad(t,p,e,r).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(v.FRAG_LOADING,{frag:t,part:p,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):g}if(!t.url||this.loadedEndOfParts(f,i))return Promise.resolve(null)}}var c;if(ln(t)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)} Check buffer at sn: ${t.sn} loaded parts: ${null==(c=o.partList)?void 0:c.filter(f=>f.loaded).map(f=>`[${f.start}-${f.end}]`)}`),this.loadingParts=!1;else if(!t.url)return Promise.resolve(null);this.log(`Loading ${t.type} sn: ${t.sn} of ${this.fragInfo(t,!1)}) cc: ${t.cc} ${"["+o.startSN+"-"+o.endSN+"]"}, target: ${parseFloat(i.toFixed(3))}`),re(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state="FRAG_LOADING";const u=this.config.progressive;let d;return d=u&&a?a.then(f=>!f||this.fragContextChanged(f.frag)?null:this.fragmentLoader.load(t,r)).catch(f=>this.handleFragLoadError(f)):Promise.all([this.fragmentLoader.load(t,u?r:void 0),a]).then(([f])=>(!u&&r&&r(f),f)).catch(f=>this.handleFragLoadError(f)),this.hls.trigger(v.FRAG_LOADING,{frag:t,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d}doFragPartsLoad(t,e,i,r){return new Promise((s,o)=>{var a;const l=[],c=null==(a=i.details)?void 0:a.partList,u=d=>{this.fragmentLoader.loadPart(t,d,r).then(f=>{l[d.index]=f;const h=f.part;this.hls.trigger(v.FRAG_LOADED,f);const p=mN(i.details,t.sn,d.index+1)||_N(c,t.sn,d.index+1);if(!p)return s({frag:t,part:h,partsLoaded:l});u(p)}).catch(o)};u(e)})}handleFragLoadError(t){if("data"in t){const e=t.data;e.frag&&e.details===N.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):e.frag&&e.type===fe.KEY_SYSTEM_ERROR?(e.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(e.frag)):this.hls.trigger(v.ERROR,e)}else this.hls.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||"PARSING"!==this.state)return void(!this.fragCurrent&&"STOPPED"!==this.state&&"ERROR"!==this.state&&(this.state="IDLE"));const{frag:i,part:r,level:s}=e,o=self.performance.now();i.stats.parsing.end=o,r&&(r.stats.parsing.end=o);const a=this.getLevelDetails(),c=a&&i.sn>a.endSN||this.shouldLoadParts(a,i.end);c!==this.loadingParts&&(this.log(`LL-Part loading ${c?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=c),this.updateLevelTiming(i,r,s,t.partial)}shouldLoadParts(t,e){if(this.config.lowLatencyMode){if(!t)return this.loadingParts;if(t.partList){var i;const s=t.partList[0];if("subtitle"===s.fragment.type)return!1;var r;if(e>=s.end+((null==(i=t.fragmentHint)?void 0:i.duration)||0)&&(this.hls.hasEnoughToStart?(null==(r=this.media)?void 0:r.currentTime)||this.lastCurrentTime:this.getLoadPosition())>s.start-s.fragment.duration)return!0}}return!1}getCurrentContext(t){const{levels:e,fragCurrent:i}=this,{level:r,sn:s,part:o}=t;if(null==e||!e[r])return this.warn(`Levels object was unset while buffering fragment ${s} of ${this.playlistLabel()} ${r}. The current chunk will not be buffered.`),null;const a=e[r],l=a.details,c=o>-1?mN(l,s,o):null,u=c?c.fragment:gN(l,s,i);return u?(i&&i!==u&&(u.stats=i.stats),{frag:u,part:c,level:a}):null}bufferFragmentData(t,e,i,r,s){if("PARSING"!==this.state)return;const{data1:o,data2:a}=t;let l=o;if(a&&(l=tr(o,a)),!l.length)return;const c=this.initPTS[e.cc];if(this.hls.trigger(v.BUFFER_APPENDING,{type:t.type,frag:e,part:i,chunkMeta:r,offset:c?-c.baseTime/c.timescale:void 0,parent:e.type,data:l}),t.dropped&&t.independent&&!i){if(s)return;this.flushBufferGap(e)}}flushBufferGap(t){const e=this.media;if(!e)return;if(!Me.isBuffered(e,e.currentTime))return void this.flushMainBuffer(0,t.start);const i=e.currentTime,r=Me.bufferInfo(e,i,0),o=Math.min(2*this.config.maxFragLookUpTolerance,.25*t.duration),a=Math.max(Math.min(t.start-o,r.end-o),i+o);t.start-a>o&&this.flushMainBuffer(a,t.start)}getFwdBufferInfo(t,e){var i;const r=this.getLoadPosition();if(!re(r))return null;const o=this.lastCurrentTime>r||null!=(i=this.media)&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(t,r,e,o)}getFwdBufferInfoAtPos(t,e,i,r){const s=Me.bufferInfo(t,e,r);if(0===s.len&&void 0!==s.nextStart){const o=this.fragmentTracker.getBufferedFrag(e,i);if(o&&(s.nextStart<=o.end||o.gap)){const a=Math.max(Math.min(s.nextStart,o.end)-e,r);return Me.bufferInfo(t,e,a)}}return s}getMaxBufferLength(t){const{config:e}=this;let i;return i=t?Math.max(8*e.maxBufferSize/t,e.maxBufferLength):e.maxBufferLength,Math.min(i,e.maxMaxBufferLength)}reduceMaxBufferLength(t,e){const i=this.config,r=Math.max(Math.min(t-e,i.maxBufferLength),e),s=Math.max(t-3*e,i.maxMaxBufferLength/2,r);return s>=r&&(i.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0)}getAppendedFrag(t,e="main"){const i=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(t,e):null;return i&&"fragment"in i?i.fragment:i}getNextFragment(t,e){const i=e.fragments,r=i.length;if(!r)return null;const{config:s}=this,o=i[0].start,a=s.lowLatencyMode&&!!e.partList;let l=null;if(e.live){const d=s.initialLiveManifestSize;if(r<d)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${d})`),null;if(!e.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||t<o){var c;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(e);const f=this.hls.startPosition,h=this.hls.liveSyncPosition,p=l?(-1!==f&&f>=o?f:h)||l.start:t;this.log(`Setting startPosition to ${p} to match start frag at live edge. mainStart: ${f} liveSyncPosition: ${h} frag.start: ${null==(c=l)?void 0:c.start}`),this.startPosition=this.nextLoadPosition=p}}else t<=o&&(l=i[0]);l||(l=this.getFragmentAtPosition(t,this.loadingParts?e.partEnd:e.fragmentEnd,e));let u=this.filterReplacedPrimary(l,e);return!u&&l&&(u=this.filterReplacedPrimary(i[l.sn-e.startSN+1]||null,e)),this.mapToInitFragWhenRequired(u)}isLoopLoading(t,e){const i=this.fragmentTracker.getState(t);return("OK"===i||"PARTIAL"===i&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,i,r,s){let o=null;if(t.gap&&(o=this.getNextFragment(this.nextLoadPosition,e),o&&!o.gap&&i.nextStart)){const a=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,r,0);if(null!==a&&i.len+a.len>=s){const l=o.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,o}get primaryPrefetch(){var t;return!(!TN(this.config)||!(null==(t=this.hls.interstitialsManager)||null==(t=t.playingItem)?void 0:t.event))}filterReplacedPrimary(t,e){if(!t)return t;if(TN(this.config)&&"subtitle"!==t.type){const i=this.hls.interstitialsManager,r=i?.bufferingItem;if(r){const o=r.event;if(o){if(o.appendInPlace||Math.abs(t.start-r.start)>1||0===r.start)return null}else if(t.end<=r.start&&!1===e?.live||t.start>r.end&&r.nextEvent&&(r.nextEvent.appendInPlace||t.start-r.end>1))return null}const s=i?.playerQueue;if(s)for(let o=s.length;o--;){const a=s[o].interstitial;if(a.appendInPlace&&t.start>=a.startTime&&t.end<=a.resumeTime)return null}}return t}mapToInitFragWhenRequired(t){return null==t||!t.initSegment||t.initSegment.data||this.bitrateTest?t:t.initSegment}getNextPart(t,e,i){let r=-1,s=!1,o=!0;for(let a=0,l=t.length;a<l;a++){const c=t[a];if(o=o&&!c.independent,r>-1&&i<c.start)break;const u=c.loaded;u?r=-1:(s||(c.independent||o)&&c.fragment===e)&&(c.fragment!==e&&this.warn(`Need buffer at ${i} but next unloaded part starts at ${c.start}`),r=a),s=u}return r}loadedEndOfParts(t,e){let i;for(let r=t.length;r--;){if(i=t[r],!i.loaded)return!1;if(e>i.start)return!0}return!1}getInitialLiveFragment(t){const e=t.fragments,i=this.fragPrevious;let r=null;if(i){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),r=function dZ(n,t,e){if(null===t||!Array.isArray(n)||!n.length||!re(t))return null;if(t<(n[0].programDateTime||0))return null;if(t>=(n[n.length-1].endProgramDateTime||0))return null;for(let s=0;s<n.length;++s){const o=n[s];if(hZ(t,e,o))return o}return null}(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=i.sn+1;if(s>=t.startSN&&s<=t.endSN){const o=e[s-t.startSN];i.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=OO(t,i.cc,i.end),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;null!==s&&(r=this.getFragmentAtPosition(s,this.bitrateTest?t.fragmentEnd:t.edge,t))}return r}getFragmentAtPosition(t,e,i){const{config:r}=this;let{fragPrevious:s}=this,{fragments:o,endSN:a}=i;const{fragmentHint:l}=i,{maxFragLookUpTolerance:c}=r,u=i.partList,d=!!(this.loadingParts&&null!=u&&u.length&&l);let f;var h;(d&&!this.bitrateTest&&u[u.length-1].fragment.sn===l.sn&&(o=o.concat(l),a=l.sn),t<e)?f=ga(s,o,t,t<this.lastCurrentTime||t>e-c||null!=(h=this.media)&&h.paused||!this.startFragRequested?0:c):f=o[o.length-1];if(f){const p=f.sn-i.startSN,g=this.fragmentTracker.getState(f);if(("OK"===g||"PARTIAL"===g&&f.gap)&&(s=f),s&&f.sn===s.sn&&(!d||u[0].fragment.sn>f.sn||!i.live)&&f.level===s.level){const _=o[p+1];f=f.sn<a&&"OK"!==this.fragmentTracker.getState(_)?_:null}}return f}alignPlaylists(t,e,i){const r=t.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=t.fragmentStart,o=!e,a=t.alignedSliding&&re(s);if(o||!a&&!s){!function qZ(n,t){n&&(SN(t,n),t.alignedSliding||dg(t,n),!t.alignedSliding&&!t.skippedSegments&&hN(n,t,!1))}(i,t);const l=t.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} fragments: ${r}`),l}return s}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)}setStartPosition(t,e){let i=this.startPosition;i<e&&(i=-1);const r=this.timelineOffset;if(-1===i){const s=null!==this.startTimeOffset,o=s?this.startTimeOffset:t.startTimeOffset;null!==o&&re(o)?(i=e+o,o<0&&(i+=t.edge),i=Math.min(Math.max(e,i),e+t.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${o} found in ${s?"multivariant":"media"} playlist`),this.startPosition=i):t.live?(i=this.hls.liveSyncPosition||e,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+r}this.nextLoadPosition=i+r}getLoadPosition(){var t;const{media:e}=this;let i=0;return null!=(t=this.hls)&&t.hasEnoughToStart&&e?i=e.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(t,e){this.transmuxer&&t.type===this.playlistType&&ln(t)&&t.stats.aborted&&(this.log(`Fragment ${t.sn}${e?" part "+e.index:""} of ${this.playlistLabel()} ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&"FRAG_LOADING_WAITING_RETRY"!==this.state)&&(this.state="IDLE")}onFragmentOrKeyLoadError(t,e){var i;if(e.chunkMeta&&!e.frag){const _=this.getCurrentContext(e.chunkMeta);_&&(e.frag=_.frag)}const r=e.frag;if(!r||r.type!==t||!this.levels)return;var s;if(this.fragContextChanged(r))return void this.warn(`Frag load error must match current frag to retry ${r.url} > ${null==(s=this.fragCurrent)?void 0:s.url}`);const o=e.details===N.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(r,!0);const a=e.errorAction;if(!a)return void(this.state="ERROR");const{action:l,flags:c,retryCount:u=0,retryConfig:d}=a,f=!!d,h=f&&5===l,p=f&&!a.resolved&&1===c,g=null==(i=this.hls.latestLevelDetails)?void 0:i.live;if(!h&&p&&ln(r)&&!r.endList&&g&&!PO(e))this.resetFragmentErrors(t),this.treatAsGap(r),a.resolved=!0;else if((h||p)&&u<d.maxNumRetry){var m;const _=Xb(null==(m=e.response)?void 0:m.code),y=Zb(d,u);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+y,this.state="FRAG_LOADING_WAITING_RETRY",a.resolved=!0,_)return this.log("Waiting for connection (offline)"),this.retryDate=1/0,void(e.reason="offline");this.warn(`Fragment ${r.sn} of ${t} ${r.level} errored with ${e.details}, retrying loading ${u+1}/${d.maxNumRetry} in ${y}ms`)}else if(d){if(this.resetFragmentErrors(t),!(u<d.maxNumRetry))return void this.warn(`${e.details} reached or exceeded max retry (${u})`);!o&&3!==l&&(a.resolved=!0)}else this.state=2===l?"WAITING_LEVEL":"ERROR";this.tickImmediate()}checkRetryDate(){const t=self.performance.now(),e=this.retryDate,i=e===1/0;(!e||t>=e||i&&!Xb(0))&&(i&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state="IDLE")}reduceLengthAndFlushBuffer(t){if("PARSING"===this.state||"PARSED"===this.state){const e=t.frag,i=t.parent,r=this.getFwdBufferInfo(this.mediaBuffer,i),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len,e?.duration||10);const o=!s;return o&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${i} buffer`),e&&(this.fragmentTracker.removeFragment(e),this.nextLoadPosition=e.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(t){"audio"===t&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),"STOPPED"!==this.state&&(this.state="IDLE")}afterBufferFlushed(t,e,i){if(!t)return;const r=Me.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,r,i),"ENDED"===this.state&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,"STOPPED"!==this.state&&(this.state="IDLE")}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=this.levelLastLoaded,e=t?t.details:null;null!=e&&e.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(e,e.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.log(`Loading context changed while buffering sn ${t.sn} of ${this.playlistLabel()} ${-1===t.level?"<removed>":t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,i,r){const s=i.details;if(s){var a;if(!Object.keys(t.elementaryStreams).reduce((l,c)=>{const u=t.elementaryStreams[c];if(u){const d=u.endPTS-u.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${t.sn} ${c} duration reliably (${d})`),l||!1;const f=r?0:dN(s,t,u.startPTS,u.endPTS,u.startDTS,u.endDTS,this);return this.hls.trigger(v.LEVEL_PTS_UPDATED,{details:s,level:i,drift:f,type:c,frag:t,start:u.startPTS,end:u.endPTS}),!0}return l},!1)&&(0===i.fragmentError&&this.treatAsGap(t,i),null===(null==(a=this.transmuxer)?void 0:a.error))){const l=new Error(`Found no media in fragment ${t.sn} of ${this.playlistLabel()} ${t.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:t,reason:`Found no media in msn ${t.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state="PARSED",this.log(`Parsed ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)})`),this.hls.trigger(v.FRAG_PARSED,{frag:t,part:e})}else this.warn("level.details undefined")}playlistLabel(){return"main"===this.playlistType?"level":"track"}fragInfo(t,e=!0,i){var r,s;return`${this.playlistLabel()} ${t.level} (${i?"part":"frag"}:[${(null!=(r=e&&!i?t.startPTS:(i||t).start)?r:NaN).toFixed(3)}-${(null!=(s=e&&!i?t.endPTS:(i||t).end)?s:NaN).toFixed(3)}]${i&&"main"===t.type?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(t,e){e&&e.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)}resetTransmuxer(){var t;null==(t=this.transmuxer)||t.reset()}recoverWorkerError(t){"demuxerWorker"===t.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(t){const e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}}function TN(n){return!!n.interstitialsController&&!1!==n.enableInterstitialPlayback}class DN{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let i;return t.length?(i=1===t.length?t[0]:function QZ(n,t){const e=new Uint8Array(t);let i=0;for(let r=0;r<n.length;r++){const s=n[r];e.set(s,i),i+=s.length}return e}(t,e),this.reset(),i):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}var CN,d1={exports:{}},XZ=function ZZ(){return CN||(CN=1,function(n){var t=Object.prototype.hasOwnProperty,e="~";function i(){}function r(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,f){if("function"!=typeof u)throw new TypeError("The listener must be a function");var h=new r(u,d||l,f),p=e?e+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function o(l,c){0==--l._eventsCount?l._events=new i:delete l._events[c]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(e=!1)),a.prototype.eventNames=function(){var u,d,c=[];if(0===this._eventsCount)return c;for(d in u=this._events)t.call(u,d)&&c.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var d=this._events[e?e+c:c];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(c){var d=this._events[e?e+c:c];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,f,h,p){var g=e?e+c:c;if(!this._events[g])return!1;var y,b,m=this._events[g],_=arguments.length;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),_){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,f),!0;case 5:return m.fn.call(m.context,u,d,f,h),!0;case 6:return m.fn.call(m.context,u,d,f,h,p),!0}for(b=1,y=new Array(_-1);b<_;b++)y[b-1]=arguments[b];m.fn.apply(m.context,y)}else{var C,S=m.length;for(b=0;b<S;b++)switch(m[b].once&&this.removeListener(c,m[b].fn,void 0,!0),_){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,u);break;case 3:m[b].fn.call(m[b].context,u,d);break;case 4:m[b].fn.call(m[b].context,u,d,f);break;default:if(!y)for(C=1,y=new Array(_-1);C<_;C++)y[C-1]=arguments[C];m[b].fn.apply(m[b].context,y)}}return!0},a.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,f){var h=e?e+c:c;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var g=0,m=[],_=p.length;g<_;g++)(p[g].fn!==u||f&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[h]=1===m.length?m[0]:m:o(this,h)}return this},a.prototype.removeAllListeners=function(c){var u;return c?this._events[u=e?e+c:c]&&o(this,u):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,n.exports=a}(d1)),d1.exports}(),f1=TQ(XZ);const bd="1.6.14",Xl={};function IN(n,t){return t+10<=n.length&&51===n[t]&&68===n[t+1]&&73===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128}function h1(n,t){return t+10<=n.length&&73===n[t]&&68===n[t+1]&&51===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128}function fg(n,t){let e=0;return e=(127&n[t])<<21,e|=(127&n[t+1])<<14,e|=(127&n[t+2])<<7,e|=127&n[t+3],e}function Ed(n,t){const e=t;let i=0;for(;h1(n,t);)i+=10,i+=fg(n,t+6),IN(n,t+10)&&(i+=10),t+=i;if(i>0)return n.subarray(e,e+i)}function wN(n,t){return 255===n[t]&&240==(246&n[t+1])}function xN(n,t){return 1&n[t+1]?7:9}function p1(n,t){return(3&n[t+3])<<11|n[t+4]<<3|(224&n[t+5])>>>5}function hg(n,t){return t+1<n.length&&wN(n,t)}function oX(n,t){if(hg(n,t)){const e=xN(n,t);if(t+e>=n.length)return!1;const i=p1(n,t);if(i<=e)return!1;const r=t+i;return r===n.length||hg(n,r)}return!1}function AN(n,t,e,i,r){if(!n.samplerate){const s=function iX(n,t,e,i){const s=t[e+2],o=s>>2&15;if(o>12){const h=new Error(`invalid ADTS sampling index:${o}`);return void n.emit(v.ERROR,v.ERROR,{type:fe.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,fatal:!0,error:h,reason:h.message})}const a=1+(s>>6&3),l=t[e+3]>>6&3|(1&s)<<2,c="mp4a.40."+a,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][o];let d=o;(5===a||29===a)&&(d-=3);const f=[a<<3|(14&d)>>1,(1&d)<<7|l<<3];return ut.log(`manifest codec:${i}, parsed codec:${c}, channels:${l}, rate:${u} (ADTS object type:${a} sampling index:${o})`),{config:f,samplerate:u,channelCount:l,codec:c,parsedCodec:c,manifestCodec:i}}(t,e,i,r);if(!s)return;vt(n,s)}}function MN(n){return 9216e4/n}function RN(n,t,e,i,r){const o=i+r*MN(n.samplerate),a=function aX(n,t){const e=xN(n,t);if(t+e<=n.length){const i=p1(n,t)-e;if(i>0)return{headerLength:e,frameLength:i}}}(t,e);let l;if(a){const{frameLength:d,headerLength:f}=a,h=f+d,p=Math.max(0,e+h-t.length);p?(l=new Uint8Array(h-f),l.set(t.subarray(e+f,t.length),0)):l=t.subarray(e+f,e+h);const g={unit:l,pts:o};return p||n.samples.push(g),{sample:g,length:h,missing:p}}const c=t.length-e;return l=new Uint8Array(c),l.set(t.subarray(e,t.length),0),{sample:{unit:l,pts:o},length:c,missing:-1}}function lX(n,t){return h1(n,t)&&fg(n,t+6)+10<=n.length-t}function g1(n,t=0,e=1/0){return function uX(n,t,e,i){const r=function dX(n){return n instanceof ArrayBuffer?n:n.buffer}(n);let s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);const o=function fX(n){return n&&n.buffer instanceof ArrayBuffer&&void 0!==n.byteLength&&void 0!==n.byteOffset}(n)?n.byteOffset:0,a=(o+n.byteLength)/s,c=Math.floor(Math.max(0,Math.min((o+t)/s,a)));return new i(r,c,Math.floor(Math.min(c+Math.max(e,0),a))-c)}(n,t,e,Uint8Array)}function _X(n){return"PRIV"===n.type?function pX(n){if(n.size<2)return;const t=xi(n.data,!0),e=new Uint8Array(n.data.subarray(t.length+1));return{key:n.type,info:t,data:e.buffer}}(n):"W"===n.type[0]?function mX(n){if("WXXX"===n.type){if(n.size<2)return;let e=1;const i=xi(n.data.subarray(e),!0);e+=i.length+1;const r=xi(n.data.subarray(e));return{key:n.type,info:i,data:r}}const t=xi(n.data);return{key:n.type,info:"",data:t}}(n):"APIC"===n.type?function hX(n){const t={key:n.type,description:"",data:"",mimeType:null,pictureType:null};if(n.size<2)return;if(3!==n.data[0])return void console.log("Ignore frame with unrecognized character encoding");const i=n.data.subarray(1).indexOf(0);if(-1===i)return;const r=xi(g1(n.data,1,i)),s=n.data[2+i],o=n.data.subarray(3+i).indexOf(0);if(-1===o)return;const a=xi(g1(n.data,3+i,o));let l;return l="--\x3e"===r?xi(g1(n.data,4+i+o)):function cX(n){return n instanceof ArrayBuffer?n:0==n.byteOffset&&n.byteLength==n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}(n.data.subarray(4+i+o)),t.mimeType=r,t.pictureType=s,t.description=a,t.data=l,t}(n):function gX(n){if(n.size<2)return;if("TXXX"===n.type){let e=1;const i=xi(n.data.subarray(e),!0);e+=i.length+1;const r=xi(n.data.subarray(e));return{key:n.type,info:i,data:r}}const t=xi(n.data.subarray(1));return{key:n.type,info:"",data:t}}(n)}function vX(n){const t=String.fromCharCode(n[0],n[1],n[2],n[3]),e=fg(n,4);return{type:t,size:e,data:n.subarray(10,10+e)}}function kN(n){let t=0;const e=[];for(;h1(n,t);){const i=fg(n,t+6);n[t+5]>>6&1&&(t+=10),t+=10;const r=t+i;for(;t+10<r;){const s=vX(n.subarray(t)),o=_X(s);o&&e.push(o),t+=s.size+10}IN(n,t)&&(t+=10)}return e}function ON(n){return n&&"PRIV"===n.key&&"com.apple.streaming.transportStreamTimestamp"===n.info}function bX(n){if(8===n.data.byteLength){const t=new Uint8Array(n.data);let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,1&t[3]&&(i+=47721858.84),Math.round(i)}}function m1(n){const t=kN(n);for(let e=0;e<t.length;e++){const i=t[e];if(ON(i))return bX(i)}}let Mi=function(n){return n.audioId3="org.id3",n.dateRange="com.apple.quicktime.HLS",n.emsg="https://aomedia.org/emsg/ID3",n.misbklv="urn:misb:KLV:bin:1910.1",n}({});function Jr(n="",t=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class _1{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,i){}demux(t,e){this.cachedData&&(t=tr(this.cachedData,t),this.cachedData=null);let s,i=Ed(t,0),r=i?i.length:0;const o=this._audioTrack,a=this._id3Track,l=i?m1(i):void 0,c=t.length;for((null===this.basePTS||0===this.frameIndex&&re(l))&&(this.basePTS=EX(l,e,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Mi.audioId3,duration:Number.POSITIVE_INFINITY});r<c;){if(this.canParse(t,r)){const u=this.appendFrame(o,t,r);u?(this.frameIndex++,this.lastPTS=u.sample.pts,r+=u.length,s=r):r=c}else lX(t,r)?(i=Ed(t,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Mi.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,s=r):r++;if(r===c&&s!==c){const u=t.slice(s);this.cachedData=this.cachedData?tr(this.cachedData,u):u}}return{audioTrack:o,videoTrack:Jr(),id3Track:a,textTrack:Jr()}}demuxSampleAes(t,e,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:Jr(),id3Track:this._id3Track,textTrack:Jr()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const EX=(n,t,e)=>re(n)?90*n:9e4*t+(e?9e4*e.baseTime/e.timescale:0);let gg=null;const SX=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],TX=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],DX=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],CX=[0,1,1,4];function NN(n,t,e,i,r){if(e+24>t.length)return;const s=PN(t,e);if(s&&e+s.frameLength<=t.length){const a=i+r*(9e4*s.samplesPerFrame/s.sampleRate),l={unit:t.subarray(e,e+s.frameLength),pts:a,dts:a};return n.config=[],n.channelCount=s.channelCount,n.samplerate=s.sampleRate,n.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function PN(n,t){const e=n[t+1]>>3&3,i=n[t+1]>>1&3,r=n[t+2]>>4&15,s=n[t+2]>>2&3;if(1!==e&&0!==r&&15!==r&&3!==s){const a=n[t+3]>>6,c=1e3*SX[14*(3===e?3-i:3===i?3:4)+r-1],d=TX[3*(3===e?0:2===e?1:2)+s],f=3===a?1:2,h=DX[e][i],p=CX[i],g=8*h*p,m=Math.floor(h*c/d+(n[t+2]>>1&1))*p;if(null===gg){const b=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);gg=b?parseInt(b[1]):0}return!!gg&&gg<=87&&2===i&&c>=224e3&&0===a&&(n[t+3]=128|n[t+3]),{sampleRate:d,channelCount:f,frameLength:m,samplesPerFrame:g}}}function v1(n,t){return!(255!==n[t]||224&~n[t+1]||!(6&n[t+1]))}function LN(n,t){return t+1<n.length&&v1(n,t)}function FN(n,t){if(t+1<n.length&&v1(n,t)){const i=PN(n,t);let r=4;null!=i&&i.frameLength&&(r=i.frameLength);const s=t+r;return s===n.length||LN(n,s)}return!1}const BN=(n,t)=>{let e=0,i=5;t+=i;const r=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;i>0;){o[0]=n[t];const a=Math.min(i,8),l=8-a;s[0]=4278190080>>>24+l<<l,r[0]=(o[0]&s[0])>>l,e=e?e<<a|r[0]:r[0],t+=1,i-=a}return e};function UN(n,t,e,i,r){if(e+8>t.length||11!==t[e]||119!==t[e+1])return-1;const s=t[e+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],l=63&t[e+4],u=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*l+s];if(e+u>t.length)return-1;const d=t[e+6]>>5;let f=0;2===d?f+=2:(1&d&&1!==d&&(f+=2),4&d&&(f+=2));const h=(t[e+6]<<8|t[e+7])>>12-f&1,g=[2,1,2,3,3,4,4,5][d]+h,_=7&t[e+5],y=new Uint8Array([s<<6|t[e+5]>>3<<1|_>>2,(3&_)<<6|d<<3|h<<2|l>>4,l<<4&224]),S=i+r*(1536/a*9e4),C=t.subarray(e,e+u);return n.config=y,n.channelCount=g,n.samplerate=a,n.samples.push({unit:C,pts:S}),u}const MX=/\/emsg[-/]ID3/i;function $N(n,t){return re(n.presentationTime)?n.presentationTime/n.timeScale:t+n.presentationTimeDelta/n.timeScale}class kX{constructor(t,e,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Jb(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,0)}decryptAacSample(t,e,i){const r=t[e].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);r.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,i)}).catch(i)}decryptAacSamples(t,e,i){for(;;e++){if(e>=t.length)return void i();if(!(t[e].unit.length<32||(this.decryptAacSample(t,e,i),this.decrypter.isSync())))return}}getAvcEncryptedData(t){const e=16*Math.floor((t.length-48)/160)+16,i=new Int8Array(e);let r=0;for(let s=32;s<t.length-16;s+=160,r+=16)i.set(t.subarray(s,s+16),r);return i}getAvcDecryptedUnit(t,e){const i=new Uint8Array(e);let r=0;for(let s=32;s<t.length-16;s+=160,r+=16)t.set(i.subarray(r,r+16),s);return t}decryptAvcSample(t,e,i,r,s){const o=mO(s.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(t,e,i+1,r)}).catch(r)}decryptAvcSamples(t,e,i,r){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length)return void r();const s=t[e].units;for(;!(i>=s.length);i++){const o=s[i];if(!(o.data.length<=48||1!==o.type&&5!==o.type||(this.decryptAvcSample(t,e,i,r,o),this.decrypter.isSync())))return}}}}class VN{constructor(){this.VideoSample=null}createVideoSample(t,e,i){return{key:t,frame:!1,pts:e,dts:i,units:[],length:0}}getLastNalUnit(t){var e;let r,i=this.VideoSample;if((!i||0===i.units.length)&&(i=t[t.length-1]),null!=(e=i)&&e.units){const s=i.units;r=s[s.length-1]}return r}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){const i=e.samples,r=i.length;if(!r)return void e.dropped++;{const s=i[r-1];t.pts=s.pts,t.dts=s.dts}}e.samples.push(t)}}parseNALu(t,e,i){const r=e.byteLength;let s=t.naluState||0;const o=s,a=[];let c,u,d,l=0,f=-1,h=0;for(-1===s&&(f=0,h=this.getNALuType(e,0),s=0,l=1);l<r;)if(c=e[l++],s)if(1!==s)if(c)if(1===c){if(u=l-s-1,f>=0){const p={data:e.subarray(f,u),type:h};a.push(p)}else{const p=this.getLastNalUnit(t.samples);p&&(o&&l<=4-o&&p.state&&(p.data=p.data.subarray(0,p.data.byteLength-o)),u>0&&(p.data=tr(p.data,e.subarray(0,u)),p.state=0))}l<r?(d=this.getNALuType(e,l),f=l,h=d,s=0):s=-1}else s=0;else s=3;else s=c?0:2;else s=c?0:1;if(f>=0&&s>=0){const p={data:e.subarray(f,r),type:h,state:s};a.push(p)}if(0===a.length){const p=this.getLastNalUnit(t.samples);p&&(p.data=tr(p.data,e))}return t.naluState=s,a}}class Sd{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,i=t.byteLength-e,r=new Uint8Array(4),s=Math.min(4,e);if(0===s)throw new Error("no bytes available");r.set(t.subarray(i,i+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*s,this.bytesAvailable-=s}skipBits(t){let e;t=Math.min(t,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(e=(t-=this.bitsAvailable)>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const i=this.word>>>32-e;if(t>32&&ut.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(this.word&2147483648>>>t)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class OX extends VN{parsePES(t,e,i,r){const s=this.parseNALu(t,i.data,r);let a,o=this.VideoSample,l=!1;i.data=null,o&&s.length&&!t.audFound&&(this.pushAccessUnit(o,t),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),s.forEach(c=>{var u,d;switch(c.type){case 1:{let g=!1;a=!0;const m=c.data;if(l&&m.length>4){const _=this.readSliceType(m);(2===_||4===_||7===_||9===_)&&(g=!0)}var f;g&&null!=(f=o)&&f.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.frame=!0,o.key=g;break}case 5:a=!0,null!=(u=o)&&u.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 6:a=!0,zb(c.data,1,i.pts,e.samples);break;case 7:{var h,p;a=!0,l=!0;const g=c.data,m=this.readSPS(g);if(!t.sps||t.width!==m.width||t.height!==m.height||(null==(h=t.pixelRatio)?void 0:h[0])!==m.pixelRatio[0]||(null==(p=t.pixelRatio)?void 0:p[1])!==m.pixelRatio[1]){t.width=m.width,t.height=m.height,t.pixelRatio=m.pixelRatio,t.sps=[g];const _=g.subarray(1,4);let y="avc1.";for(let b=0;b<3;b++){let S=_[b].toString(16);S.length<2&&(S="0"+S),y+=S}t.codec=y}break}case 8:a=!0,t.pps=[c.data];break;case 9:a=!0,t.audFound=!0,null!=(d=o)&&d.frame&&(this.pushAccessUnit(o,t),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:a=!0;break;default:a=!1}o&&a&&o.units.push(c)}),r&&o&&(this.pushAccessUnit(o,t),this.VideoSample=null)}getNALuType(t,e){return 31&t[e]}readSliceType(t){const e=new Sd(t);return e.readUByte(),e.readUEG(),e.readUEG()}skipScalingList(t,e){let s,i=8,r=8;for(let o=0;o<t;o++)0!==r&&(s=e.readEG(),r=(i+s+256)%256),i=0===r?i:r}readSPS(t){const e=new Sd(t);let a,l,c,i=0,r=0,s=0,o=0;const u=e.readUByte.bind(e),d=e.readBits.bind(e),f=e.readUEG.bind(e),h=e.readBoolean.bind(e),p=e.skipBits.bind(e),g=e.skipEG.bind(e),m=e.skipUEG.bind(e),_=this.skipScalingList.bind(this);u();const y=u();if(d(5),p(3),u(),m(),100===y||110===y||122===y||244===y||44===y||83===y||86===y||118===y||128===y){const M=f();if(3===M&&p(1),m(),m(),p(1),h())for(l=3!==M?8:12,c=0;c<l;c++)h()&&_(c<6?16:64,e)}m();const b=f();if(0===b)f();else if(1===b)for(p(1),g(),g(),a=f(),c=0;c<a;c++)g();m(),p(1);const S=f(),C=f(),k=d(1);0===k&&p(1),p(1),h()&&(i=f(),r=f(),s=f(),o=f());let I=[1,1];if(h()&&h())switch(u()){case 1:I=[1,1];break;case 2:I=[12,11];break;case 3:I=[10,11];break;case 4:I=[16,11];break;case 5:I=[40,33];break;case 6:I=[24,11];break;case 7:I=[20,11];break;case 8:I=[32,11];break;case 9:I=[80,33];break;case 10:I=[18,11];break;case 11:I=[15,11];break;case 12:I=[64,33];break;case 13:I=[160,99];break;case 14:I=[4,3];break;case 15:I=[3,2];break;case 16:I=[2,1];break;case 255:I=[u()<<8|u(),u()<<8|u()]}return{width:Math.ceil(16*(S+1)-2*i-2*r),height:(2-k)*(C+1)*16-(k?2:4)*(s+o),pixelRatio:I}}}class NX extends VN{constructor(...t){super(...t),this.initVPS=null}parsePES(t,e,i,r){const s=this.parseNALu(t,i.data,r);let a,o=this.VideoSample,l=!1;i.data=null,o&&s.length&&!t.audFound&&(this.pushAccessUnit(o,t),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),s.forEach(c=>{var u,d;switch(c.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),o.frame=!0,a=!0;break;case 16:case 17:case 18:case 21:var f;a=!0,l&&null!=(f=o)&&f.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:a=!0,null!=(u=o)&&u.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0,o.frame=!0;break;case 39:a=!0,zb(c.data,2,i.pts,e.samples);break;case 32:a=!0,t.vps||("object"!=typeof t.params&&(t.params={}),t.params=vt(t.params,this.readVPS(c.data)),this.initVPS=c.data),t.vps=[c.data];break;case 33:if(a=!0,l=!0,void 0!==t.vps&&t.vps[0]!==this.initVPS&&void 0!==t.sps&&!this.matchSPS(t.sps[0],c.data)&&(this.initVPS=t.vps[0],t.sps=t.pps=void 0),!t.sps){const h=this.readSPS(c.data);t.width=h.width,t.height=h.height,t.pixelRatio=h.pixelRatio,t.codec=h.codecString,t.sps=[],"object"!=typeof t.params&&(t.params={});for(const p in h.params)t.params[p]=h.params[p]}this.pushParameterSet(t.sps,c.data,t.vps),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),o.key=!0;break;case 34:if(a=!0,"object"==typeof t.params){if(!t.pps){t.pps=[];const h=this.readPPS(c.data);for(const p in h)t.params[p]=h[p]}this.pushParameterSet(t.pps,c.data,t.vps)}break;case 35:a=!0,t.audFound=!0,null!=(d=o)&&d.frame&&(this.pushAccessUnit(o,t),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:a=!1}o&&a&&o.units.push(c)}),r&&o&&(this.pushAccessUnit(o,t),this.VideoSample=null)}pushParameterSet(t,e,i){(i&&i[0]===this.initVPS||!i&&!t.length)&&t.push(e)}getNALuType(t,e){return(126&t[e])>>>1}ebsp2rbsp(t){const e=new Uint8Array(t.byteLength);let i=0;for(let r=0;r<t.byteLength;r++)r>=2&&3===t[r]&&0===t[r-1]&&0===t[r-2]||(e[i]=t[r],i++);return new Uint8Array(e.buffer,0,i)}pushAccessUnit(t,e){super.pushAccessUnit(t,e),this.initVPS&&(this.initVPS=null)}readVPS(t){const e=new Sd(t);return e.readUByte(),e.readUByte(),e.readBits(4),e.skipBits(2),e.readBits(6),{numTemporalLayers:e.readBits(3)+1,temporalIdNested:e.readBoolean()}}readSPS(t){const e=new Sd(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.readBits(4);const i=e.readBits(3);e.readBoolean();const r=e.readBits(2),s=e.readBoolean(),o=e.readBits(5),a=e.readUByte(),l=e.readUByte(),c=e.readUByte(),u=e.readUByte(),d=e.readUByte(),f=e.readUByte(),h=e.readUByte(),p=e.readUByte(),g=e.readUByte(),m=e.readUByte(),_=e.readUByte(),y=[],b=[];for(let qe=0;qe<i;qe++)y.push(e.readBoolean()),b.push(e.readBoolean());if(i>0)for(let qe=i;qe<8;qe++)e.readBits(2);for(let qe=0;qe<i;qe++)y[qe]&&(e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte()),b[qe]&&e.readUByte();e.readUEG();const S=e.readUEG();3==S&&e.skipBits(1);const C=e.readUEG(),k=e.readUEG(),I=e.readBoolean();let M=0,O=0,x=0,B=0;I&&(M+=e.readUEG(),O+=e.readUEG(),x+=e.readUEG(),B+=e.readUEG());const K=e.readUEG(),ee=e.readUEG(),oe=e.readUEG();for(let qe=e.readBoolean()?0:i;qe<=i;qe++)e.skipUEG(),e.skipUEG(),e.skipUEG();if(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.readBoolean()&&e.readBoolean())for(let yn=0;yn<4;yn++)for(let gi=0;gi<(3===yn?2:6);gi++)if(e.readBoolean()){const bn=Math.min(64,1<<4+(yn<<1));yn>1&&e.readEG();for(let xr=0;xr<bn;xr++)e.readEG()}else e.readUEG();e.readBoolean(),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.skipUEG(),e.skipUEG(),e.readBoolean());const te=e.readUEG();let ae=0;for(let qe=0;qe<te;qe++){let yn=!1;if(0!==qe&&(yn=e.readBoolean()),yn){qe===te&&e.readUEG(),e.readBoolean(),e.readUEG();let gi=0;for(let Bs=0;Bs<=ae;Bs++){const bn=e.readBoolean();let xr=!1;bn||(xr=e.readBoolean()),(bn||xr)&&gi++}ae=gi}else{const gi=e.readUEG(),Bs=e.readUEG();ae=gi+Bs;for(let bn=0;bn<gi;bn++)e.readUEG(),e.readBoolean();for(let bn=0;bn<Bs;bn++)e.readUEG(),e.readBoolean()}}if(e.readBoolean()){const qe=e.readUEG();for(let yn=0;yn<qe;yn++){for(let gi=0;gi<oe+4;gi++)e.readBits(1);e.readBits(1)}}let Z=0,q=1,Re=1,We=!0,Te=1,Be=0;e.readBoolean(),e.readBoolean();let Xt=!1;if(e.readBoolean()){if(e.readBoolean()){const ss=e.readUByte();ss>0&&ss<16?(q=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][ss-1],Re=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][ss-1]):255===ss&&(q=e.readBits(16),Re=e.readBits(16))}if(e.readBoolean()&&e.readBoolean(),e.readBoolean()&&(e.readBits(3),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.readUByte(),e.readUByte())),e.readBoolean()&&(e.readUEG(),e.readUEG()),e.readBoolean(),e.readBoolean(),e.readBoolean(),Xt=e.readBoolean(),Xt&&(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG()),e.readBoolean()&&(Te=e.readBits(32),Be=e.readBits(32),e.readBoolean()&&e.readUEG(),e.readBoolean())){const So=e.readBoolean(),Wd=e.readBoolean();let To=!1;(So||Wd)&&(To=e.readBoolean(),To&&(e.readUByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),To&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let Kd=0;Kd<=i;Kd++){We=e.readBoolean();let R2=!1;We||e.readBoolean()?e.readEG():R2=e.readBoolean();const k2=R2?1:e.readUEG()+1;if(So)for(let qd=0;qd<k2;qd++)e.readUEG(),e.readUEG(),To&&(e.readUEG(),e.readUEG()),e.skipBits(1);if(Wd)for(let qd=0;qd<k2;qd++)e.readUEG(),e.readUEG(),To&&(e.readUEG(),e.readUEG()),e.skipBits(1)}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),Z=e.readUEG())}let Un=C,sr=k;if(I){let qe=1,yn=1;1===S?qe=yn=2:2==S&&(qe=2),Un=C-qe*O-qe*M,sr=k-yn*B-yn*x}const wr=r?["A","B","C"][r]:"",WE=a<<24|l<<16|c<<8|u;let vc=0;for(let qe=0;qe<32;qe++)vc=(vc|(WE>>qe&1)<<31-qe)>>>0;let Gd=vc.toString(16);return 1===o&&"2"===Gd&&(Gd="6"),{codecString:`hvc1.${wr}${o}.${Gd}.${s?"H":"L"}${_}.B0`,params:{general_tier_flag:s,general_profile_idc:o,general_profile_space:r,general_profile_compatibility_flags:[a,l,c,u],general_constraint_indicator_flags:[d,f,h,p,g,m],general_level_idc:_,bit_depth:K+8,bit_depth_luma_minus8:K,bit_depth_chroma_minus8:ee,min_spatial_segmentation_idc:Z,chroma_format_idc:S,frame_rate:{fixed:We,fps:Be/Te}},width:Un,height:sr,pixelRatio:[q,Re]}}readPPS(t){const e=new Sd(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.skipUEG(),e.skipUEG(),e.skipBits(2),e.skipBits(3),e.skipBits(2),e.skipUEG(),e.skipUEG(),e.skipEG(),e.skipBits(2),e.readBoolean()&&e.skipUEG(),e.skipEG(),e.skipEG(),e.skipBits(4);const r=e.readBoolean(),s=e.readBoolean();let o=1;return s&&r?o=0:s?o=3:r&&(o=2),{parallelismType:o}}matchSPS(t,e){return String.fromCharCode.apply(null,t).substr(3)===String.fromCharCode.apply(null,e).substr(3)}}const wn=188;class mo{constructor(t,e,i,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=r,this.videoParser=null}static probe(t,e){const i=mo.syncOffset(t);return i>0&&e.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),-1!==i}static syncOffset(t){const e=t.length;let i=Math.min(940,e-wn)+1,r=0;for(;r<i;){let s=!1,o=-1,a=0;for(let l=r;l<e;l+=wn){if(71!==t[l]||e-l!==wn&&71!==t[l+wn]){if(a)return-1;break}if(a++,-1===o&&(o=l,0!==o&&(i=Math.min(o+18612,t.length-wn)+1)),s||(s=0===y1(t,l)),s&&a>1&&(0===o&&a>2||l+wn>i))return o}r++}return-1}static createTrack(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:lO[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}}resetInitSegment(t,e,i,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=mo.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=mo.createTrack("audio",r),this._id3Track=mo.createTrack("id3"),this._txtTrack=mo.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:e,_id3Track:i}=this;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e,i=!1,r=!1){let s;i||(this.sampleAes=null);const o=this._videoTrack,a=this._audioTrack,l=this._id3Track,c=this._txtTrack;let u=o.pid,d=o.pesData,f=a.pid,h=l.pid,p=a.pesData,g=l.pesData,m=null,_=this.pmtParsed,y=this._pmtId,b=t.length;if(this.remainderData&&(b=(t=tr(this.remainderData,t)).length,this.remainderData=null),b<wn&&!r)return this.remainderData=t,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};const S=Math.max(0,mo.syncOffset(t));b-=(b-S)%wn,b<t.byteLength&&!r&&(this.remainderData=new Uint8Array(t.buffer,b,t.buffer.byteLength-b));let C=0;for(let I=S;I<b;I+=wn)if(71===t[I]){const M=!!(64&t[I+1]),O=y1(t,I);let B;if((48&t[I+3])>>4>1){if(B=I+5+t[I+4],B===I+wn)continue}else B=I+4;switch(O){case u:M&&(d&&(s=Jl(d,this.logger))&&(this.readyVideoParser(o.segmentCodec),null!==this.videoParser&&this.videoParser.parsePES(o,c,s,!1)),d={data:[],size:0}),d&&(d.data.push(t.subarray(B,I+wn)),d.size+=I+wn-B);break;case f:if(M){if(p&&(s=Jl(p,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,s);break;case"mp3":this.parseMPEGPES(a,s);break;case"ac3":this.parseAC3PES(a,s)}p={data:[],size:0}}p&&(p.data.push(t.subarray(B,I+wn)),p.size+=I+wn-B);break;case h:M&&(g&&(s=Jl(g,this.logger))&&this.parseID3PES(l,s),g={data:[],size:0}),g&&(g.data.push(t.subarray(B,I+wn)),g.size+=I+wn-B);break;case 0:M&&(B+=t[B]+1),y=this._pmtId=PX(t,B);break;case y:{M&&(B+=t[B]+1);const K=LX(t,B,this.typeSupported,i,this.observer,this.logger);u=K.videoPid,u>0&&(o.pid=u,o.segmentCodec=K.segmentVideoCodec),f=K.audioPid,f>0&&(a.pid=f,a.segmentCodec=K.segmentAudioCodec),h=K.id3Pid,h>0&&(l.pid=h),null!==m&&!_&&(this.logger.warn(`MPEG-TS PMT found at ${I} after unknown PID '${m}'. Backtracking to sync byte @${S} to parse all TS packets.`),m=null,I=S-188),_=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=O}}else C++;C>0&&b1(this.observer,new Error(`Found ${C} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=d,a.pesData=p,l.pesData=g;const k={audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};return r&&this.extractRemainingSamples(k),k}flush(){const{remainderData:t}=this;let e;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,videoTrack:i,id3Track:r,textTrack:s}=t,o=i.pesData,a=e.pesData,l=r.pesData;let c;if(o&&(c=Jl(o,this.logger))?(this.readyVideoParser(i.segmentCodec),null!==this.videoParser&&(this.videoParser.parsePES(i,s,c,!0),i.pesData=null)):i.pesData=o,a&&(c=Jl(a,this.logger))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,c);break;case"mp3":this.parseMPEGPES(e,c);break;case"ac3":this.parseAC3PES(e,c)}e.pesData=null}else null!=a&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=a;l&&(c=Jl(l,this.logger))?(this.parseID3PES(r,c),r.pesData=null):r.pesData=l}demuxSampleAes(t,e,i){const r=this.demux(t,i,!0,!this.config.progressive),s=this.sampleAes=new kX(this.observer,this.config,e);return this.decrypt(r,s)}readyVideoParser(t){null===this.videoParser&&("avc"===t?this.videoParser=new OX:"hevc"===t&&(this.videoParser=new NX))}decrypt(t,e){return new Promise(i=>{const{audioTrack:r,videoTrack:s}=t;r.samples&&"aac"===r.segmentCodec?e.decryptAacSamples(r.samples,0,()=>{s.samples?e.decryptAvcSamples(s.samples,0,0,()=>{i(t)}):i(t)}):s.samples&&e.decryptAvcSamples(s.samples,0,0,()=>{i(t)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(t,e){let i=0;const r=this.aacOverFlow;let o,a,l,s=e.data;if(r){this.aacOverFlow=null;const d=r.missing,f=r.sample.unit.byteLength;if(-1===d)s=tr(r.sample.unit,s);else{const h=f-d;r.sample.unit.set(s.subarray(0,d),h),t.samples.push(r.sample),i=r.missing}}for(o=i,a=s.length;o<a-1&&!hg(s,o);o++);if(o!==i){let d;const f=o<a-1;if(d=f?`AAC PES did not start with ADTS header,offset:${o}`:"No ADTS header found in AAC PES",b1(this.observer,new Error(d),f,this.logger),!f)return}if(AN(t,this.observer,s,o,this.audioCodec),void 0!==e.pts)l=e.pts;else{if(!r)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const d=MN(t.samplerate);l=r.sample.pts+d}}let u,c=0;for(;o<a;){if(u=RN(t,s,o,l,c),o+=u.length,u.missing){this.aacOverFlow=u;break}for(c++;o<a-1&&!hg(s,o);o++);}}parseMPEGPES(t,e){const i=e.data,r=i.length;let s=0,o=0;const a=e.pts;if(void 0!==a)for(;o<r;)if(LN(i,o)){const l=NN(t,i,o,a,s);if(!l)break;o+=l.length,s++}else o++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(t,e){{const i=e.data,r=e.pts;if(void 0===r)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const s=i.length;let l,o=0,a=0;for(;a<s&&(l=UN(t,i,a,r,o++))>0;)a+=l}}parseID3PES(t,e){if(void 0===e.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const i=vt({},e,{type:this._videoTrack?Mi.emsg:Mi.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(i)}}function y1(n,t){return((31&n[t+1])<<8)+n[t+2]}function PX(n,t){return(31&n[t+10])<<8|n[t+11]}function LX(n,t,e,i,r,s){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},l=t+3+((15&n[t+1])<<8|n[t+2])-4;for(t+=12+((15&n[t+10])<<8|n[t+11]);t<l;){const u=y1(n,t),d=(15&n[t+3])<<8|n[t+4];switch(n[t]){case 207:if(!i){E1("ADTS AAC",s);break}case 15:-1===o.audioPid&&(o.audioPid=u);break;case 21:-1===o.id3Pid&&(o.id3Pid=u);break;case 219:if(!i){E1("H.264",s);break}case 27:-1===o.videoPid&&(o.videoPid=u);break;case 3:case 4:e.mpeg||e.mp3?-1===o.audioPid&&(o.audioPid=u,o.segmentAudioCodec="mp3"):s.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){E1("AC-3",s);break}case 129:e.ac3?-1===o.audioPid&&(o.audioPid=u,o.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===o.audioPid&&d>0){let f=t+5,h=d;for(;h>2;){106===n[f]&&(!0!==e.ac3?s.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=u,o.segmentAudioCodec="ac3"));const g=n[f+1]+2;f+=g,h-=g}}break;case 194:case 135:return b1(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),o;case 36:-1===o.videoPid&&(o.videoPid=u,o.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"))}t+=d+5}return o}function b1(n,t,e,i){i.warn(`parsing error: ${t.message}`),n.emit(v.ERROR,v.ERROR,{type:fe.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,fatal:!1,levelRetry:e,error:t,reason:t.message})}function E1(n,t){t.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function Jl(n,t){let i,r,s,o,a,e=0;const l=n.data;if(!n||0===n.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=tr(l[0],l[1]),l.splice(1,1);if(i=l[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(r=(i[4]<<8)+i[5],r&&r>n.size-6)return null;const u=i[7];192&u&&(o=536870912*(14&i[9])+4194304*(255&i[10])+16384*(254&i[11])+128*(255&i[12])+(254&i[13])/2,64&u?(a=536870912*(14&i[14])+4194304*(255&i[15])+16384*(254&i[16])+128*(255&i[17])+(254&i[18])/2,o-a>54e5&&(t.warn(`${Math.round((o-a)/9e4)}s delta between PTS and DTS, align them`),o=a)):a=o),s=i[8];let d=s+9;if(n.size<=d)return null;n.size-=d;const f=new Uint8Array(n.size);for(let h=0,p=l.length;h<p;h++){i=l[h];let g=i.byteLength;if(d){if(d>g){d-=g;continue}i=i.subarray(d),g-=d,d=0}f.set(i,e),e+=g}return r&&(r-=s+3),{data:f,pts:o,dts:a,len:r}}return null}class FX{static getSilentFrame(t,e){if("mp4a.40.2"===t){if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const _o=Math.pow(2,32)-1;let ec=(()=>{class n{static init(){let e;for(e in n.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},n.types)n.types.hasOwnProperty(e)&&(n.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);n.HDLR_TYPES={video:i,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);n.STTS=n.STSC=n.STCO=o,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);n.FTYP=n.box(n.types.ftyp,a,c,a,l),n.DINF=n.box(n.types.dinf,n.box(n.types.dref,s))}static box(e,...i){let r=8,s=i.length;const o=s;for(;s--;)r+=i[s].byteLength;const a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=255&r,a.set(e,4),s=0,r=8;s<o;s++)a.set(i[s],r),r+=i[s].byteLength;return a}static hdlr(e){return n.box(n.types.hdlr,n.HDLR_TYPES[e])}static mdat(e){return n.box(n.types.mdat,e)}static mdhd(e,i){i*=e;const r=Math.floor(i/(_o+1)),s=Math.floor(i%(_o+1));return n.box(n.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s,85,196,0,0]))}static mdia(e){return n.box(n.types.mdia,n.mdhd(e.timescale||0,e.duration||0),n.hdlr(e.type),n.minf(e))}static mfhd(e){return n.box(n.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return n.box(n.types.minf,"audio"===e.type?n.box(n.types.smhd,n.SMHD):n.box(n.types.vmhd,n.VMHD),n.DINF,n.stbl(e))}static moof(e,i,r){return n.box(n.types.moof,n.mfhd(e),n.traf(r,i))}static moov(e){let i=e.length;const r=[];for(;i--;)r[i]=n.trak(e[i]);return n.box.apply(null,[n.types.moov,n.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(n.mvex(e)))}static mvex(e){let i=e.length;const r=[];for(;i--;)r[i]=n.trex(e[i]);return n.box.apply(null,[n.types.mvex,...r])}static mvhd(e,i){i*=e;const r=Math.floor(i/(_o+1)),s=Math.floor(i%(_o+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n.box(n.types.mvhd,o)}static sdtp(e){const i=e.samples||[],r=new Uint8Array(4+i.length);let s,o;for(s=0;s<i.length;s++)o=i[s].flags,r[s+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return n.box(n.types.sdtp,r)}static stbl(e){return n.box(n.types.stbl,n.stsd(e),n.box(n.types.stts,n.STTS),n.box(n.types.stsc,n.STSC),n.box(n.types.stsz,n.STSZ),n.box(n.types.stco,n.STCO))}static avc1(e){let s,o,a,i=[],r=[];for(s=0;s<e.sps.length;s++)o=e.sps[s],a=o.byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(o));for(s=0;s<e.pps.length;s++)o=e.pps[s],a=o.byteLength,r.push(a>>>8&255),r.push(255&a),r=r.concat(Array.prototype.slice.call(o));const l=n.box(n.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|e.sps.length].concat(i).concat([e.pps.length]).concat(r))),c=e.width,u=e.height,d=e.pixelRatio[0],f=e.pixelRatio[1];return n.box(n.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,255&c,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),n.box(n.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,f>>24,f>>16&255,f>>8&255,255&f])))}static esds(e){return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e.config,6,1,2])}static audioStsd(e){const i=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,i>>8&255,255&i,0,0])}static mp4a(e){return n.box(n.types.mp4a,n.audioStsd(e),n.box(n.types.esds,n.esds(e)))}static mp3(e){return n.box(n.types[".mp3"],n.audioStsd(e))}static ac3(e){return n.box(n.types["ac-3"],n.audioStsd(e),n.box(n.types.dac3,e.config))}static stsd(e){const{segmentCodec:i}=e;if("audio"===e.type){if("aac"===i)return n.box(n.types.stsd,n.STSD,n.mp4a(e));if("ac3"===i&&e.config)return n.box(n.types.stsd,n.STSD,n.ac3(e));if("mp3"===i&&"mp3"===e.codec)return n.box(n.types.stsd,n.STSD,n.mp3(e))}else{if(!e.pps||!e.sps)throw new Error("video track missing pps or sps");if("avc"===i)return n.box(n.types.stsd,n.STSD,n.avc1(e));if("hevc"===i&&e.vps)return n.box(n.types.stsd,n.STSD,n.hvc1(e))}throw new Error(`unsupported ${e.type} segment codec (${i}/${e.codec})`)}static tkhd(e){const i=e.id,r=(e.duration||0)*(e.timescale||0),s=e.width||0,o=e.height||0,a=Math.floor(r/(_o+1)),l=Math.floor(r%(_o+1));return n.box(n.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,o>>8&255,255&o,0,0]))}static traf(e,i){const r=n.sdtp(e),s=e.id,o=Math.floor(i/(_o+1)),a=Math.floor(i%(_o+1));return n.box(n.types.traf,n.box(n.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s])),n.box(n.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a])),n.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,n.box(n.types.trak,n.tkhd(e),n.mdia(e))}static trex(e){const i=e.id;return n.box(n.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,i){const r=e.samples||[],s=r.length,o=12+16*s,a=new Uint8Array(o);let l,c,u,d,f,h;for(a.set(["video"===e.type?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,255&s,(i+=8+o)>>>24&255,i>>>16&255,i>>>8&255,255&i],0),l=0;l<s;l++)c=r[l],u=c.duration,d=c.size,f=c.flags,h=c.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,d>>>24&255,d>>>16&255,d>>>8&255,255&d,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,61440&f.degradPrio,15&f.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*l);return n.box(n.types.trun,a)}static initSegment(e){n.types||n.init();const i=n.moov(e);return tr(n.FTYP,i)}static hvc1(e){const i=e.params,r=[e.vps,e.sps,e.pps],o=new Uint8Array([1,i.general_profile_space<<6|(i.general_tier_flag?32:0)|i.general_profile_idc,i.general_profile_compatibility_flags[0],i.general_profile_compatibility_flags[1],i.general_profile_compatibility_flags[2],i.general_profile_compatibility_flags[3],i.general_constraint_indicator_flags[0],i.general_constraint_indicator_flags[1],i.general_constraint_indicator_flags[2],i.general_constraint_indicator_flags[3],i.general_constraint_indicator_flags[4],i.general_constraint_indicator_flags[5],i.general_level_idc,240|i.min_spatial_segmentation_idc>>8,255&i.min_spatial_segmentation_idc,252|i.parallelismType,252|i.chroma_format_idc,248|i.bit_depth_luma_minus8,248|i.bit_depth_chroma_minus8,0,parseInt(i.frame_rate.fps),3|i.temporal_id_nested<<2|i.num_temporal_layers<<3|(i.frame_rate.fixed?64:0),r.length]);let a=o.length;for(let g=0;g<r.length;g+=1){a+=3;for(let m=0;m<r[g].length;m+=1)a+=2+r[g][m].length}const l=new Uint8Array(a);l.set(o,0),a=o.length;const c=r.length-1;for(let g=0;g<r.length;g+=1){l.set(new Uint8Array([32+g|(g===c?128:0),0,r[g].length]),a),a+=3;for(let m=0;m<r[g].length;m+=1)l.set(new Uint8Array([r[g][m].length>>8,255&r[g][m].length]),a),a+=2,l.set(r[g][m],a),a+=r[g][m].length}const u=n.box(n.types.hvcC,l),d=e.width,f=e.height,h=e.pixelRatio[0],p=e.pixelRatio[1];return n.box(n.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,255&d,f>>8&255,255&f,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),n.box(n.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,255&h,p>>24,p>>16&255,p>>8&255,255&p])))}}return n.types=void 0,n.HDLR_TYPES=void 0,n.STTS=void 0,n.STSC=void 0,n.STCO=void 0,n.STSZ=void 0,n.VMHD=void 0,n.SMHD=void 0,n.STSD=void 0,n.FTYP=void 0,n.DINF=void 0,n})();function S1(n,t,e=1,i=!1){const r=n*t*e;return i?Math.round(r):r}function Td(n,t=!1){return S1(n,1e3,1/9e4,t)}function HN(n){const{baseTime:t,timescale:e,trackId:i}=n;return`${t/e} (${t}/${e}) trackId: ${i}`}let Ns,tc=null,T1=null;function GN(n,t,e,i){return{duration:t,size:e,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:n?2:1,isNonSync:n?0:1}}}class mg extends er{constructor(t,e,i,r){if(super("mp4-remuxer",r),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.ISGenerated=!1,null===tc){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);tc=o?parseInt(o[1]):0}if(null===T1){const s=navigator.userAgent.match(/Safari\/(\d+)/i);T1=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){const e=this._initPTS;(!e||!t||t.trackId!==e.trackId||t.baseTime!==e.baseTime||t.timescale!==e.timescale)&&this.log(`Reset initPTS: ${e&&HN(e)} > ${t&&HN(t)}`),this._initPTS=this._initDTS=t}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1;const i=t[0].pts,r=t.reduce((s,o)=>{let a=o.pts,l=a-s;return l<-4294967296&&(e=!0,a=Ri(a,i),l=a-s),l>0?s:a},i);return e&&this.debug("PTS rollover detected"),r}remux(t,e,i,r,s,o,a,l){let c,u,d,f,h,p,g=s,m=s;const y=e.pid>-1,b=e.samples.length,S=t.samples.length>0,C=a&&b>0||b>1;if((!(t.pid>-1)||S)&&(!y||C)||this.ISGenerated||a){if(this.ISGenerated){var I,M,O,x;const oe=this.videoTrackConfig;(oe&&(e.width!==oe.width||e.height!==oe.height||(null==(I=e.pixelRatio)?void 0:I[0])!==(null==(M=oe.pixelRatio)?void 0:M[0])||(null==(O=e.pixelRatio)?void 0:O[1])!==(null==(x=oe.pixelRatio)?void 0:x[1]))||!oe&&C||null===this.nextAudioTs&&S)&&this.resetInitSegment()}this.ISGenerated||(d=this.generateIS(t,e,s,o));const B=this.isVideoContiguous;let ee,K=-1;if(C&&(K=function GX(n){for(let t=0;t<n.length;t++)if(n[t].key)return t;return-1}(e.samples),!B&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,K>0){this.warn(`Dropped ${K} out of ${b} video samples due to a missing keyframe`);const oe=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(K),e.dropped+=K,m+=(e.samples[0].pts-oe)/e.inputTimeScale,ee=m}else-1===K&&(this.warn(`No keyframe found out of ${b} video samples`),p=!1);if(this.ISGenerated){if(S&&C){const oe=this.getVideoStartPts(e.samples),G=(Ri(t.samples[0].pts,oe)-oe)/e.inputTimeScale;g+=Math.max(0,G),m+=Math.max(0,-G)}if(S){if(t.samplerate||(this.warn("regenerate InitSegment as audio detected"),d=this.generateIS(t,e,s,o)),u=this.remuxAudio(t,g,this.isAudioContiguous,o,y||C||"audio"===l?m:void 0),C){const oe=u?u.endPTS-u.startPTS:0;e.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),d=this.generateIS(t,e,s,o)),c=this.remuxVideo(e,m,B,oe)}}else C&&(c=this.remuxVideo(e,m,B,0));c&&(c.firstKeyFrame=K,c.independent=-1!==K,c.firstKeyFramePTS=ee)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(h=zN(i,s,this._initPTS,this._initDTS)),r.samples.length&&(f=WN(r,s,this._initPTS))),{audio:u,video:c,initSegment:d,independent:p,text:f,id3:h}}computeInitPts(t,e,i,r){const s=Math.round(i*e);let o=Ri(t,s);if(o<s+e)for(this.log(`Adjusting PTS for rollover in timeline near ${(s-o)/e} ${r}`);o<s+e;)o+=8589934592;return o-s}generateIS(t,e,i,r){const s=t.samples,o=e.samples,a=this.typeSupported,l={},c=this._initPTS;let f,h,p,u=!c||r,d="audio/mp4",g=-1;if(u&&(f=h=1/0),t.config&&s.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":a.mpeg?(d="audio/mpeg",t.codec=""):a.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3"}l.audio={id:"audio",container:d,codec:t.codec,initSegment:"mp3"===t.segmentCodec&&a.mpeg?new Uint8Array(0):ec.initSegment([t]),metadata:{channelCount:t.channelCount}},u&&(g=t.id,p=t.inputTimeScale,c&&p===c.timescale?u=!1:f=h=this.computeInitPts(s[0].pts,p,i,"audio"))}if(e.sps&&e.pps&&o.length){if(e.timescale=e.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:ec.initSegment([e]),metadata:{width:e.width,height:e.height}},u)if(g=e.id,p=e.inputTimeScale,c&&p===c.timescale)u=!1;else{const m=this.getVideoStartPts(o),_=Ri(o[0].dts,m),y=this.computeInitPts(_,p,i,"video"),b=this.computeInitPts(m,p,i,"video");h=Math.min(h,y),f=Math.min(f,b)}this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,u?(c&&this.warn(`Timestamps at playlist time: ${r?"":"~"}${i} ${f/p} != initPTS: ${c.baseTime/c.timescale} (${c.baseTime}/${c.timescale}) trackId: ${c.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${f/p} (${f}/${p}) trackId: ${g}`),this._initPTS={baseTime:f,timescale:p,trackId:g},this._initDTS={baseTime:h,timescale:p,trackId:g}):f=p=void 0,{tracks:l,initPTS:f,timescale:p,trackId:g}}remuxVideo(t,e,i,r){const s=t.inputTimeScale,o=t.samples,a=[],l=o.length,c=this._initPTS,u=c.baseTime*s/c.timescale;let p,g,d=this.nextVideoTs,f=8,h=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,y=!1;if(!i||null===d){const Z=u+e*s,q=o[0].pts-Ri(o[0].dts,o[0].pts);tc&&null!==d&&Math.abs(Z-q-(d+u))<15e3?i=!0:d=Z-q-u}const b=d+u;for(let Z=0;Z<l;Z++){const q=o[Z];q.pts=Ri(q.pts,b),q.dts=Ri(q.dts,b),q.dts<o[Z>0?Z-1:Z].dts&&(y=!0)}y&&o.sort(function(Z,q){return Z.dts-q.dts||Z.pts-q.pts}),p=o[0].dts,g=o[o.length-1].dts;const S=g-p,C=S?Math.round(S/(l-1)):h||t.inputTimeScale/30;if(i){const Z=p-b,q=Z>C,Re=Z<-1;if((q||Re)&&(this.warn(q?`${(t.segmentCodec||"").toUpperCase()}: ${Td(Z,!0)} ms (${Z}dts) hole between fragments detected at ${e.toFixed(3)}`:`${(t.segmentCodec||"").toUpperCase()}: ${Td(-Z,!0)} ms (${Z}dts) overlapping between fragments detected at ${e.toFixed(3)}`),!Re||b>=o[0].pts||tc)){p=b;const We=o[0].pts-Z;if(q)o[0].dts=p,o[0].pts=We;else{let Te=!0;for(let Be=0;Be<o.length&&!(o[Be].dts>We&&Te);Be++){const Xt=o[Be].pts;if(o[Be].dts-=Z,o[Be].pts-=Z,Be<o.length-1){const kt=o[Be+1].pts;Te=kt<=o[Be].pts==kt<=Xt}}}this.log(`Video: Initial PTS/DTS adjusted: ${Td(We,!0)}/${Td(p,!0)}, delta: ${Td(Z,!0)} ms`)}}p=Math.max(0,p);let k=0,I=0,M=p;for(let Z=0;Z<l;Z++){const q=o[Z],Re=q.units,We=Re.length;let Te=0;for(let Be=0;Be<We;Be++)Te+=Re[Be].data.length;I+=Te,k+=We,q.length=Te,q.dts<M?(q.dts=M,M+=C/4|0||1):M=q.dts,m=Math.min(q.pts,m),_=Math.max(q.pts,_)}g=o[l-1].dts;const O=I+4*k+8;let x;try{x=new Uint8Array(O)}catch(Z){return void this.observer.emit(v.ERROR,v.ERROR,{type:fe.MUX_ERROR,details:N.REMUX_ALLOC_ERROR,fatal:!1,error:Z,bytes:O,reason:`fail allocating video mdat ${O}`})}const B=new DataView(x.buffer);B.setUint32(0,O),x.set(ec.types.mdat,4);let K=!1,ee=Number.POSITIVE_INFINITY,oe=Number.POSITIVE_INFINITY,se=Number.NEGATIVE_INFINITY,G=Number.NEGATIVE_INFINITY;for(let Z=0;Z<l;Z++){const q=o[Z],Re=q.units;let Te,We=0;for(let Xt=0,kt=Re.length;Xt<kt;Xt++){const Un=Re[Xt],sr=Un.data,wr=Un.data.byteLength;B.setUint32(f,wr),f+=4,x.set(sr,f),f+=wr,We+=4+wr}if(Z<l-1)h=o[Z+1].dts-q.dts,Te=o[Z+1].pts-q.pts;else{const Xt=this.config,kt=Z>0?q.dts-o[Z-1].dts:C;if(Te=Z>0?q.pts-o[Z-1].pts:C,Xt.stretchShortVideoTrack&&null!==this.nextAudioTs){const Un=Math.floor(Xt.maxBufferHole*s),sr=(r?m+r*s:this.nextAudioTs+u)-q.pts;sr>Un?(h=sr-kt,h<0?h=kt:K=!0,this.log(`It is approximately ${sr/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=kt}else h=kt}const Be=Math.round(q.pts-q.dts);ee=Math.min(ee,h),se=Math.max(se,h),oe=Math.min(oe,Te),G=Math.max(G,Te),a.push(GN(q.key,h,We,Be))}if(a.length)if(tc){if(tc<70){const Z=a[0].flags;Z.dependsOn=2,Z.isNonSync=0}}else if(T1&&G-oe<se-ee&&C/se<.025&&0===a[0].cts){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let Z=p;for(let q=0,Re=a.length;q<Re;q++){const We=Z+a[q].duration;a[q].duration=q<Re-1?We+a[q+1].cts-(Z+a[q].cts):q?a[q-1].duration:C,a[q].cts=0,Z=We}}h=K||!h?C:h,this.nextVideoTs=d=g+h-u,this.videoSampleDuration=h,this.isVideoContiguous=!0;const ge={data1:ec.moof(t.sequenceNumber++,p,vt(t,{samples:a})),data2:x,startPTS:(m-u)/s,endPTS:(_+h-u)/s,startDTS:(p-u)/s,endDTS:d/s,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:t.dropped};return t.samples=[],t.dropped=0,ge}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(t,e,i,r,s){const o=t.inputTimeScale,l=o/(t.samplerate?t.samplerate:o),c=this.getSamplesPerFrame(t),u=c*l,d=this._initPTS,f="mp3"===t.segmentCodec&&this.typeSupported.mpeg,h=[],p=void 0!==s;let g=t.samples,m=f?0:8,_=this.nextAudioTs||-1;const y=d.baseTime*o/d.timescale,b=y+e*o;if(this.isAudioContiguous=i=i||g.length&&_>0&&(r&&Math.abs(b-(_+y))<9e3||Math.abs(Ri(g[0].pts,b)-(_+y))<20*u),g.forEach(function(G){G.pts=Ri(G.pts,b)}),!i||_<0){const G=g.length;if(g=g.filter(ie=>ie.pts>=0),G!==g.length&&this.warn(`Removed ${g.length-G} of ${G} samples (initPTS ${y} / ${o})`),!g.length)return;_=0===s?0:r&&!p?Math.max(0,b-y):g[0].pts-y}if("aac"===t.segmentCodec){const G=this.config.maxAudioFramesDrift;for(let ie=0,te=_+y;ie<g.length;ie++){const ae=g[ie],ge=ae.pts,Z=ge-te,q=Math.abs(1e3*Z/o);if(Z<=-G*u&&p)0===ie&&(this.warn(`Audio frame @ ${(ge/o).toFixed(3)}s overlaps marker by ${Math.round(1e3*Z/o)} ms.`),this.nextAudioTs=_=ge-y,te=ge);else if(Z>=G*u&&q<1e4&&p){let Re=Math.round(Z/u);for(te=ge-Re*u;te<0&&Re&&u;)Re--,te+=u;0===ie&&(this.nextAudioTs=_=te-y),this.warn(`Injecting ${Re} audio frames @ ${((te-y)/o).toFixed(3)}s due to ${Math.round(1e3*Z/o)} ms gap.`);for(let We=0;We<Re;We++){let Te=FX.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);Te||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),Te=ae.unit.subarray()),g.splice(ie,0,{unit:Te,pts:te}),te+=u,ie++}}ae.pts=te,te+=u}}let k,S=null,C=null,I=0,M=g.length;for(;M--;)I+=g[M].unit.byteLength;for(let G=0,ie=g.length;G<ie;G++){const te=g[G],ae=te.unit;let ge=te.pts;if(null!==C)h[G-1].duration=Math.round((ge-C)/l);else{if(i&&"aac"===t.segmentCodec&&(ge=_+y),S=ge,!(I>0))return;I+=m;try{k=new Uint8Array(I)}catch(q){return void this.observer.emit(v.ERROR,v.ERROR,{type:fe.MUX_ERROR,details:N.REMUX_ALLOC_ERROR,fatal:!1,error:q,bytes:I,reason:`fail allocating audio mdat ${I}`})}f||(new DataView(k.buffer).setUint32(0,I),k.set(ec.types.mdat,4))}k.set(ae,m);const Z=ae.byteLength;m+=Z,h.push(GN(!0,c,Z,0)),C=ge}const O=h.length;if(!O)return;_=C-y,this.nextAudioTs=_+l*h[h.length-1].duration;const B=f?new Uint8Array(0):ec.moof(t.sequenceNumber++,S/l,vt({},t,{samples:h}));t.samples=[];const K=(S-y)/o,ee=_/o,se={data1:B,data2:k,startPTS:K,endPTS:ee,startDTS:K,endDTS:ee,type:"audio",hasAudio:!0,hasVideo:!1,nb:O};return this.isAudioContiguous=!0,se}}function Ri(n,t){let e;if(null===t)return n;for(e=t<n?-8589934592:8589934592;Math.abs(n-t)>4294967296;)n+=e;return n}function zN(n,t,e,i){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let a=0;a<r;a++){const l=n.samples[a];l.pts=Ri(l.pts-e.baseTime*s/e.timescale,t*s)/s,l.dts=Ri(l.dts-i.baseTime*s/i.timescale,t*s)/s}const o=n.samples;return n.samples=[],{samples:o}}function WN(n,t,e){const i=n.samples.length;if(!i)return;const r=n.inputTimeScale;for(let o=0;o<i;o++){const a=n.samples[o];a.pts=Ri(a.pts-e.baseTime*r/e.timescale,t*r)/r}n.samples.sort((o,a)=>o.pts-a.pts);const s=n.samples;return n.samples=[],{samples:s}}function _g(n,t,e=!1){return void 0!==n?.start?(n.start+(e?n.duration:0))/n.timescale:t}function KN(n,t,e){const i=n.codec;return i&&i.length>4?i:"audio"===t?"ec-3"===i||"ac-3"===i||"alac"===i?i:"fLaC"===i||"Opus"===i?Xp(i,!1):(e.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(e.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}try{Ns=self.performance.now.bind(self.performance)}catch{Ns=Date.now}const vg=[{demux:class RX{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,i,r){const s=this.videoTrack=Jr("video",1),o=this.audioTrack=Jr("audio",1),a=this.txtTrack=Jr("text",1);if(this.id3Track=Jr("id3",1),this.timeOffset=0,null==t||!t.byteLength)return;const l=fO(t);if(l.video){const{id:c,timescale:u,codec:d,supplemental:f}=l.video;s.id=c,s.timescale=a.timescale=u,s.codec=d,s.supplemental=f}if(l.audio){const{id:c,timescale:u,codec:d}=l.audio;o.id=c,o.timescale=u,o.codec=d}a.id=lO.text,s.sampleDuration=0,s.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(t){return function xQ(n){const t=n.byteLength;for(let e=0;e<t;){const i=Ie(n,e);if(i>8&&109===n[e+4]&&111===n[e+5]&&111===n[e+6]&&102===n[e+7])return!0;e=i>1?e+i:t}return!1}(t)}demux(t,e){this.timeOffset=e;let i=t;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=tr(this.remainderData,t));const a=function PQ(n){const t={valid:null,remainder:null},e=He(n,["moof"]);if(e.length<2)return t.remainder=n,t;const i=e[e.length-1];return t.valid=n.slice(0,i.byteOffset-8),t.remainder=n.slice(i.byteOffset-8),t}(i);this.remainderData=a.remainder,r.samples=a.valid||new Uint8Array}else r.samples=i;const o=this.extractID3Track(r,e);return s.samples=gO(e,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,e=this.videoTrack,i=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(e,this.timeOffset);return i.samples=gO(t,e),{videoTrack:e,audioTrack:Jr(),id3Track:r,textTrack:Jr()}}extractID3Track(t,e){const i=this.id3Track;if(t.samples.length){const r=He(t.samples,["emsg"]);r&&r.forEach(s=>{const o=function FQ(n){const t=n[0];let e="",i="",r=0,s=0,o=0,a=0,l=0,c=0;if(0===t){for(;"\0"!==_n(n.subarray(c,c+1));)e+=_n(n.subarray(c,c+1)),c+=1;for(e+=_n(n.subarray(c,c+1)),c+=1;"\0"!==_n(n.subarray(c,c+1));)i+=_n(n.subarray(c,c+1)),c+=1;i+=_n(n.subarray(c,c+1)),c+=1,r=Ie(n,12),s=Ie(n,16),a=Ie(n,20),l=Ie(n,24),c=28}else if(1===t){c+=4,r=Ie(n,c),c+=4;const d=Ie(n,c);c+=4;const f=Ie(n,c);for(c+=4,o=2**32*d+f,hQ(o)||(o=Number.MAX_SAFE_INTEGER,ut.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=Ie(n,c),c+=4,l=Ie(n,c),c+=4;"\0"!==_n(n.subarray(c,c+1));)e+=_n(n.subarray(c,c+1)),c+=1;for(e+=_n(n.subarray(c,c+1)),c+=1;"\0"!==_n(n.subarray(c,c+1));)i+=_n(n.subarray(c,c+1)),c+=1;i+=_n(n.subarray(c,c+1)),c+=1}return{schemeIdUri:e,value:i,timeScale:r,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:l,payload:n.subarray(c,n.byteLength)}}(s);if(MX.test(o.schemeIdUri)){const a=$N(o,e);let l=4294967295===o.eventDuration?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const c=o.payload;i.samples.push({data:c,len:c.byteLength,dts:a,pts:a,type:Mi.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const a=$N(o,e);i.samples.push({data:o.payload,len:o.payload.byteLength,dts:a,pts:a,type:Mi.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}},remux:class zX extends er{constructor(t,e,i,r){super("passthrough-remuxer",r),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(t){this.lastEndTime=null;const e=this.initPTS;e&&t&&e.baseTime===t.baseTime&&e.timescale===t.timescale||(this.initPTS=t)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(t,e,i,r){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(t,r),this.emitInitSegment=!0}generateInitSegment(t,e){let{audioCodec:i,videoCodec:r}=this;if(null==t||!t.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const{audio:s,video:o}=this.initData=fO(t);if(e)!function kQ(n,t){if(!n||!t)return;const e=t.keyId;e&&t.isCommonEncryption&&hO(n,(i,r)=>{const s=i.subarray(8,24);s.some(o=>0!==o)||(ut.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${Qn(s)} -> ${Qn(e)}`),i.set(e,8))})}(t,e);else{const l=s||o;null!=l&&l.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${l.codec}")!`)}s&&(i=KN(s,"audio",this)),o&&(r=KN(o,"video",this));const a={};s&&o?a.audiovideo={container:"video/mp4",codec:i+","+r,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:t,id:"main"}:s?a.audio={container:"audio/mp4",codec:i,encrypted:s.encrypted,initSegment:t,id:"audio"}:o?a.video={container:"video/mp4",codec:r,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:t,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(t,e,i,r,s,o){var a,l;let{initPTS:c,lastEndTime:u}=this;const d={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};re(u)||(u=this.lastEndTime=s||0);const f=e.samples;if(!f.length)return d;const h={initPTS:void 0,timescale:void 0,trackId:void 0};let p=this.initData;if(null!=(a=p)&&a.length||(this.generateInitSegment(f),p=this.initData),null==(l=p)||!l.length)return this.warn("Failed to generate initSegment."),d;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const g=function NQ(n,t,e){const i={},r=He(n,["moof","traf"]);for(let s=0;s<r.length;s++){const o=r[s],a=He(o,["tfhd"])[0],l=Ie(a,4),c=t[l];if(!c)continue;i[l]||(i[l]={start:NaN,duration:0,sampleCount:0,timescale:c.timescale,type:c.type});const u=i[l],d=He(o,["tfdt"])[0];if(d){const b=d[0];let S=Ie(d,4);1===b&&(S===aO?e.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(S*=aO+1,S+=Ie(d,8))),re(S)&&(!re(u.start)||S<u.start)&&(u.start=S)}const f=c.default,h=Ie(a,0)|f?.flags;let p=f?.duration||0;8&h&&(p=Ie(a,2&h?12:8));const g=He(o,["trun"]);let m=u.start||0,_=0,y=p;for(let b=0;b<g.length;b++){const S=g[b],C=Ie(S,4),k=u.sampleCount;u.sampleCount+=C;const O=1&S[2],x=2&S[2],B=4&S[2],K=8&S[2];let ee=8,oe=C;for(1&S[3]&&(ee+=4),4&S[3]&&C&&(!(1&S[ee+1])&&void 0===u.keyFrameIndex&&(u.keyFrameIndex=k),ee+=4,O?(y=Ie(S,ee),ee+=4):y=p,x&&(ee+=4),K&&(ee+=4),m+=y,_+=y,oe--);oe--;)O?(y=Ie(S,ee),ee+=4):y=p,x&&(ee+=4),B&&(1&S[ee+1]||void 0===u.keyFrameIndex&&(u.keyFrameIndex=u.sampleCount-(oe+1),u.keyFrameStart=m),ee+=4),K&&(ee+=4),m+=y,_+=y;!_&&p&&(_+=p*C)}u.duration+=_}if(!Object.keys(i).some(s=>i[s].duration)){let s=1/0,o=0;const a=He(n,["sidx"]);for(let l=0;l<a.length;l++){const c=AQ(a[l]);if(null!=c&&c.references){s=Math.min(s,c.earliestPresentationTime/c.timescale);const u=c.references.reduce((d,f)=>d+f.info.duration||0,0);o=Math.max(o,u+c.earliestPresentationTime/c.timescale)}}o&&re(o)&&Object.keys(i).forEach(l=>{i[l].duration||(i[l].duration=o*i[l].timescale-i[l].start)})}return i}(f,p,this),m=p.audio?g[p.audio.id]:null,_=p.video?g[p.video.id]:null,y=_g(_,1/0),b=_g(m,1/0),S=_g(_,0,!0),C=_g(m,0,!0);let k=s,I=0;const M=m&&(!_||!c&&b<y||c&&c.trackId===p.audio.id),O=M?m:_;if(O){const te=O.timescale,ae=O.start-s*te,ge=M?p.audio.id:p.video.id;k=O.start/te,I=M?C-b:S-y,(o||!c)&&(function WX(n,t,e,i){if(null===n)return!0;const r=Math.max(i,1);return Math.abs(t-n.baseTime/n.timescale-e)>r}(c,k,s,I)||te!==c.timescale)&&(c&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${s} ${ae/te} != initPTS: ${c.baseTime/c.timescale} (${c.baseTime}/${c.timescale}) trackId: ${c.trackId}`),this.log(`Found initPTS at playlist time: ${s} offset: ${k-s} (${ae}/${te}) trackId: ${ge}`),c=null,h.initPTS=ae,h.timescale=te,h.trackId=ge)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${s}`);c?(h.initPTS=c.baseTime,h.timescale=c.timescale,h.trackId=c.trackId):((!h.timescale||void 0===h.trackId||void 0===h.initPTS)&&(this.warn("Could not set initPTS"),h.initPTS=k,h.timescale=1,h.trackId=-1),this.initPTS=c={baseTime:h.initPTS,timescale:h.timescale,trackId:h.trackId});const x=k-c.baseTime/c.timescale,B=x+I;I>0?this.lastEndTime=B:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const K=!!p.audio,ee=!!p.video;let oe="";K&&(oe+="audio"),ee&&(oe+="video");const G={data1:f,startPTS:x,startDTS:x,endPTS:B,endDTS:B,type:oe,hasAudio:K,hasVideo:ee,nb:1,dropped:0,encrypted:!!p.audio&&p.audio.encrypted||!!p.video&&p.video.encrypted};d.audio=K&&!ee?G:void 0,d.video=ee?G:void 0;const ie=_?.sampleCount;if(ie){const te=_.keyFrameIndex,ae=-1!==te;G.nb=ie,G.dropped=0===te||this.isVideoContiguous?0:ae?te:ie,G.independent=ae,G.firstKeyFrame=te,ae&&_.keyFrameStart&&(G.firstKeyFramePTS=(_.keyFrameStart-c.baseTime)/c.timescale),this.isVideoContiguous||(d.independent=ae),this.isVideoContiguous||(this.isVideoContiguous=ae),G.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${te}/${ie} dropped: ${G.dropped} start: ${G.firstKeyFramePTS||"NA"}`)}return d.initSegment=h,d.id3=zN(i,s,c,c),r.samples.length&&(d.text=WN(r,s,c)),d}}},{demux:mo,remux:mg},{demux:class wX extends _1{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,i,r){super.resetInitSegment(t,e,i,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:r,inputTimeScale:9e4,dropped:0}}static probe(t,e){if(!t)return!1;const i=Ed(t,0);let r=i?.length||0;if(FN(t,r))return!1;for(let s=t.length;r<s;r++)if(oX(t,r))return e.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return function sX(n,t){return function rX(n,t){return t+5<n.length}(n,t)&&wN(n,t)&&p1(n,t)<=n.length-t}(t,e)}appendFrame(t,e,i){AN(t,this.observer,e,i,t.manifestCodec);const r=RN(t,e,i,this.basePTS,this.frameIndex);if(r&&0===r.missing)return r}},remux:mg},{demux:class AX extends _1{resetInitSegment(t,e,i,r){super.resetInitSegment(t,e,i,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:r,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=Ed(t,0);let i=e?.length||0;if(e&&11===t[i]&&119===t[i+1]&&void 0!==m1(e)&&BN(t,i)<=16)return!1;for(let r=t.length;i<r;i++)if(FN(t,i))return ut.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return function IX(n,t){return v1(n,t)&&4<=n.length-t}(t,e)}appendFrame(t,e,i){if(null!==this.basePTS)return NN(t,e,i,this.basePTS,this.frameIndex)}},remux:mg}];vg.splice(2,0,{demux:class xX extends _1{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,i,r){super.resetInitSegment(t,e,i,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:r,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,i){const r=UN(t,e,i,this.basePTS,this.frameIndex);if(-1!==r)return{sample:t.samples[t.samples.length-1],length:r,missing:0}}static probe(t){if(!t)return!1;const e=Ed(t,0);if(!e)return!1;const i=e.length;return 11===t[i]&&119===t[i+1]&&void 0!==m1(e)&&BN(t,i)<16}},remux:mg});class qN{constructor(t,e,i,r,s,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=i,this.id=s,this.logger=o}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,i,r){const s=i.transmuxing;s.executeStart=Ns();let o=new Uint8Array(t);const{currentTransmuxState:a,transmuxConfig:l}=this;r&&(this.currentTransmuxState=r);const{contiguous:c,discontinuity:u,trackSwitch:d,accurateTimeOffset:f,timeOffset:h,initSegmentChange:p}=r||a,{audioCodec:g,videoCodec:m,defaultInitPts:_,duration:y,initSegmentData:b}=l,S=function KX(n,t){let e=null;return n.byteLength>0&&null!=t?.key&&null!==t.iv&&null!=t.method&&(e=t),e}(o,e);if(S&&Zl(S.method)){const M=this.getDecrypter(),O=n1(S.method);if(!M.isSync())return this.asyncResult=!0,this.decryptionPromise=M.webCryptoDecrypt(o,S.key.buffer,S.iv.buffer,O).then(x=>{const B=this.push(x,null,i);return this.decryptionPromise=null,B}),this.decryptionPromise;{let x=M.softwareDecrypt(o,S.key.buffer,S.iv.buffer,O);if(i.part>-1){const K=M.flush();x=K&&K.buffer}if(!x)return s.executeEnd=Ns(),D1(i);o=new Uint8Array(x)}}const C=this.needsProbing(u,d);if(C){const M=this.configureTransmuxer(o);if(M)return this.logger.warn(`[transmuxer] ${M.message}`),this.observer.emit(v.ERROR,v.ERROR,{type:fe.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message}),s.executeEnd=Ns(),D1(i)}(u||d||p||C)&&this.resetInitSegment(b,g,m,y,e),(u||p||C)&&this.resetInitialTimestamp(_),c||this.resetContiguity();const k=this.transmux(o,S,h,f,i);this.asyncResult=Dd(k);const I=this.currentTransmuxState;return I.contiguous=!0,I.discontinuity=!1,I.trackSwitch=!1,s.executeEnd=Ns(),k}flush(t){const e=t.transmuxing;e.executeStart=Ns();const{decrypter:i,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return this.asyncResult=!0,s.then(()=>this.flush(t));const o=[],{timeOffset:a}=r;if(i){const d=i.flush();d&&o.push(this.push(d.buffer,null,t))}const{demuxer:l,remuxer:c}=this;if(!l||!c){e.executeEnd=Ns();const d=[D1(t)];return this.asyncResult?Promise.resolve(d):d}const u=l.flush(a);return Dd(u)?(this.asyncResult=!0,u.then(d=>(this.flushRemux(o,d,t),o))):(this.flushRemux(o,u,t),this.asyncResult?Promise.resolve(o):o)}flushRemux(t,e,i){const{audioTrack:r,videoTrack:s,id3Track:o,textTrack:a}=e,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${"main"===this.id?"level":"track"} ${i.level}`);const u=this.remuxer.remux(r,s,o,a,c,l,!0,this.id);t.push({remuxResult:u,chunkMeta:i}),i.transmuxing.executeEnd=Ns()}resetInitialTimestamp(t){const{demuxer:e,remuxer:i}=this;!e||!i||(e.resetTimeStamp(t),i.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;!t||!e||(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,i,r,s){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(t,e,i,r),a.resetInitSegment(t,e,i,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,i,r,s){let o;return o=e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,i,r,s):this.transmuxUnencrypted(t,i,r,s),o}transmuxUnencrypted(t,e,i,r){const{audioTrack:s,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,a,l,e,i,!1,this.id),chunkMeta:r}}transmuxSampleAes(t,e,i,r,s){return this.demuxer.demuxSampleAes(t,e,i).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,i,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(t){const{config:e,observer:i,typeSupported:r}=this;let s;for(let d=0,f=vg.length;d<f;d++){var o;if(null!=(o=vg[d].demux)&&o.probe(t,this.logger)){s=vg[d];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,l=this.remuxer,c=s.remux,u=s.demux;(!l||!(l instanceof c))&&(this.remuxer=new c(i,e,r,this.logger)),(!a||!(a instanceof u))&&(this.demuxer=new u(i,e,r,this.logger),this.probe=u.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Jb(this.config)),t}}const D1=n=>({remuxResult:{},chunkMeta:n});function Dd(n){return"then"in n&&n.then instanceof Function}class qX{constructor(t,e,i,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=i,this.duration=r,this.defaultInitPts=s||null}}class YX{constructor(t,e,i,r,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=o}}let YN=0;class QN{constructor(t,e,i,r){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=YN++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{const c=l.data,u=this.hls;if(u&&null!=c&&c.event&&c.instanceNo===this.instanceNo)switch(c.event){case"init":{var d;const f=null==(d=this.workerContext)?void 0:d.objectURL;f&&self.URL.revokeObjectURL(f);break}case"transmuxComplete":this.handleTransmuxComplete(c.data);break;case"flush":this.onFlush(c.data);break;case"workerLog":u.logger[c.data.logType]&&u.logger[c.data.logType](c.data.message);break;default:c.data=c.data||{},c.data.frag=this.frag,c.data.part=this.part,c.data.id=this.id,u.trigger(c.event,c.data)}},this.onWorkerError=l=>{if(!this.hls)return;const c=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:c})};const s=t.config;this.hls=t,this.id=e,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;const o=(l,c)=>{(c=c||{}).frag=this.frag||void 0,l===v.ERROR&&(c.parent=this.id,c.part=this.part,this.error=c.error),this.hls.trigger(l,c)};this.observer=new f1,this.observer.on(v.FRAG_DECRYPTED,o),this.observer.on(v.ERROR,o);const a=bO(s.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const l=this.hls.logger;if(s.workerPath||function JZ(){return"function"==typeof __HLS_WORKER_BUNDLE__}()){try{s.workerPath?(l.log(`loading Web Worker ${s.workerPath} for "${e}"`),this.workerContext=function tX(n){const t=Xl[n];if(t)return t.clientCount++,t;const e=new self.URL(n,self.location.href).href,r={worker:new self.Worker(e),scriptURL:e,clientCount:1};return Xl[n]=r,r}(s.workerPath)):(l.log(`injecting Web Worker for "${e}"`),this.workerContext=function eX(){const n=Xl[bd];if(n)return n.clientCount++,n;const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(t),r={worker:new self.Worker(e),objectURL:e,clientCount:1};return Xl[bd]=r,r}());const{worker:u}=this.workerContext;u.addEventListener("message",this.onWorkerMessage),u.addEventListener("error",this.onWorkerError),u.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:a,id:e,config:It(s)})}catch(u){l.warn(`Error setting up "${e}" Web Worker, fallback to inline`,u),this.terminateWorker(),this.error=null,this.transmuxer=new qN(this.observer,a,s,"",e,t.logger)}return}}this.transmuxer=new qN(this.observer,a,s,"",e,t.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const t=this.instanceNo;this.instanceNo=YN++;const e=this.hls.config,i=bO(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:i,id:this.id,config:It(e)})}}terminateWorker(){if(this.workerContext){const{worker:t}=this.workerContext;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),function nX(n){const t=Xl[n||bd];if(t&&1==t.clientCount--){const{worker:i,objectURL:r}=t;delete Xl[n||bd],r&&self.URL.revokeObjectURL(r),i.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(t,e,i,r,s,o,a,l,c,u){var d,f;c.transmuxing.start=self.performance.now();const{instanceNo:h,transmuxer:p}=this,g=o?o.start:s.start,m=s.decryptdata,_=this.frag,y=!(_&&s.cc===_.cc),b=!(_&&c.level===_.level),S=_?c.sn-_.sn:-1,C=this.part?c.part-this.part.index:-1,I=!b&&(1===S||0===S&&(1===C||0===S&&c.id>1&&c.id===_?.stats.chunkCount&&C<=0)),M=self.performance.now();(b||S||0===s.stats.parsing.start)&&(s.stats.parsing.start=M),o&&(C||!I)&&(o.stats.parsing.start=M);const O=!(_&&(null==(d=s.initSegment)?void 0:d.url)===(null==(f=_.initSegment)?void 0:f.url)),x=new YX(y,I,l,b,g,O);if(!I||y||O){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${s.type} sn: ${c.sn}${c.part>-1?" part: "+c.part:""} ${"main"===this.id?"level":"track"}: ${c.level} id: ${c.id}\n        discontinuity: ${y}\n        trackSwitch: ${b}\n        contiguous: ${I}\n        accurateTimeOffset: ${l}\n        timeOffset: ${g}\n        initSegmentChange: ${O}`);const B=new qX(i,r,e,a,u);this.configureTransmuxer(B)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:h,cmd:"demux",data:t,decryptdata:m,chunkMeta:c,state:x},t instanceof ArrayBuffer?[t]:[]);else if(p){const B=p.push(t,m,c,x);Dd(B)?B.then(K=>{this.handleTransmuxComplete(K)}).catch(K=>{this.transmuxerError(K,c,"transmuxer-interface push error")}):this.handleTransmuxComplete(B)}}flush(t){t.transmuxing.start=self.performance.now();const{instanceNo:e,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:e,cmd:"flush",chunkMeta:t});else if(i){const r=i.flush(t);Dd(r)?r.then(s=>{this.handleFlushResult(s,t)}).catch(s=>{this.transmuxerError(s,t,"transmuxer-interface flush error")}):this.handleFlushResult(r,t)}}transmuxerError(t,e,i){this.hls&&(this.error=t,this.hls.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:i}))}handleFlushResult(t,e){t.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(e)}configureTransmuxer(t){const{instanceNo:e,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):i&&i.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}class C1 extends er{constructor(t,e){super(e,t.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,i){const r=e?.renditionReports;if(r){let s=-1;for(let o=0;o<r.length;o++){const a=r[o];let l;try{l=new self.URL(a.URI,e.url).href}catch(c){this.warn(`Could not construct new URL for Rendition Report: ${c}`),l=a.URI||""}if(l===t){s=o;break}l===t.substring(0,l.length)&&(s=o)}if(-1!==s){const o=r[s],a=parseInt(o["LAST-MSN"])||e.lastPartSn;let l=parseInt(o["LAST-PART"])||e.lastPartIndex;if(this.hls.config.lowLatencyMode){const u=Math.min(e.age-e.partTarget,e.targetduration);l>=0&&u>e.partTarget&&(l+=1)}const c=i&&CO(i);return new IO(a,l>=0?l:void 0,c)}}}loadPlaylist(t){this.clearTimer()}loadingPlaylist(t,e){this.clearTimer()}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}getUrlWithDirectives(t,e){if(e)try{return e.addDirectives(t)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return t}playlistLoaded(t,e,i){const{details:r,stats:s}=e,o=self.performance.now(),a=s.loading.first?Math.max(0,o-s.loading.first):0;r.advancedDateTime=Date.now()-a;const l=this.hls.config.timelineOffset;if(l!==r.appliedTimelineOffset){const u=Math.max(l||0,0);r.appliedTimelineOffset=u,r.fragments.forEach(d=>{d.setStart(d.playlistOffset+u)})}if(r.live||null!=i&&i.live){const u="levelInfo"in e?e.levelInfo:e.track;if(r.reloaded(i),i&&r.fragments.length>0){!function jZ(n,t,e){if(n===t)return;let i=null;const r=n.fragments;for(let u=r.length-1;u>=0;u--){const d=r[u].initSegment;if(d){i=d;break}}let s;n.fragmentHint&&delete n.fragmentHint.endPTS,function zZ(n,t,e){const i=t.skippedSegments,r=Math.max(n.startSN,t.startSN)-t.startSN,s=(n.fragmentHint?1:0)+(i?t.endSN:Math.min(n.endSN,t.endSN))-t.startSN,o=t.startSN-n.startSN,a=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let c=r;c<=s;c++){const u=l[o+c];let d=a[c];if(i&&!d&&u&&(d=t.fragments[c]=u),u&&d){e(u,d,c,a);const f=u.relurl;if(f&&WZ(f,d.relurl))return void(t.playlistParsingError=fN(`media sequence mismatch ${d.sn}:`,n,t,0,d));if(u.cc!==d.cc)return void(t.playlistParsingError=fN(`discontinuity sequence mismatch (${u.cc}!=${d.cc})`,n,t,0,d))}}}(n,t,(u,d,f,h)=>{if((!t.startCC||t.skippedSegments)&&d.cc!==u.cc){const p=u.cc-d.cc;for(let g=f;g<h.length;g++)h[g].cc+=p;t.endCC=h[h.length-1].cc}re(u.startPTS)&&re(u.endPTS)&&(d.setStart(d.startPTS=u.startPTS),d.startDTS=u.startDTS,d.maxStartPTS=u.maxStartPTS,d.endPTS=u.endPTS,d.endDTS=u.endDTS,d.minEndPTS=u.minEndPTS,d.setDuration(u.endPTS-u.startPTS),d.duration&&(s=d),t.PTSKnown=t.alignedSliding=!0),u.hasStreams&&(d.elementaryStreams=u.elementaryStreams),d.loader=u.loader,u.hasStats&&(d.stats=u.stats),u.initSegment&&(d.initSegment=u.initSegment,i=u.initSegment)});const o=t.fragments,a=t.fragmentHint?o.concat(t.fragmentHint):o;if(i&&a.forEach(u=>{var d;u&&(!u.initSegment||u.initSegment.relurl===(null==(d=i)?void 0:d.relurl))&&(u.initSegment=i)}),t.skippedSegments){if(t.deltaUpdateFailed=o.some(u=>!u),t.deltaUpdateFailed){e.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let u=t.skippedSegments;u--;)o.shift();t.startSN=o[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=function HZ(n,t,e){const{dateRanges:i,recentlyRemovedDateranges:r}=t,s=vt({},n);r&&r.forEach(l=>{delete s[l]});const a=Object.keys(s).length;return a?(Object.keys(i).forEach(l=>{const c=s[l],u=new qO(i[l].attr,c);u.isValid?(s[l]=u,c||(u.tagOrder+=a)):e.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${It(i[l].attr)}"`)}),s):i}(n.dateRanges,t,e));const u=n.fragments.filter(d=>d.rawProgramDateTime);if(n.hasProgramDateTime&&!t.hasProgramDateTime)for(let d=1;d<a.length;d++)null===a[d].programDateTime&&a1(a[d],a[d-1],u);iN(u,t)}t.endCC=o[o.length-1].cc}if(!t.startCC){var l;const u=gN(n,t.startSN-1);t.startCC=null!=(l=u?.cc)?l:o[0].cc}(function GZ(n,t,e){if(n&&t){let i=0;for(let r=0,s=n.length;r<=s;r++){const o=n[r],a=t[r+i];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?e(o,a):i--}}})(n.partList,t.partList,(u,d)=>{d.elementaryStreams=u.elementaryStreams,d.stats=u.stats}),s?dN(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS,e):hN(n,t),o.length&&(t.totalduration=t.edge-o[0].start),t.driftStartTime=n.driftStartTime,t.driftStart=n.driftStart;const c=t.advancedDateTime;if(t.advanced&&c){const u=t.edge;t.driftStart||(t.driftStartTime=c,t.driftStart=u),t.driftEndTime=c,t.driftEnd=u}else t.driftEndTime=n.driftEndTime,t.driftEnd=n.driftEnd,t.advancedDateTime=n.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=n.requestScheduled)}(i,r,this);const y=r.playlistParsingError;if(y){this.warn(y);const b=this.hls;if(!b.config.ignorePlaylistParsingErrors){var c;const{networkDetails:S}=e;return void b.trigger(v.ERROR,{type:fe.NETWORK_ERROR,details:N.LEVEL_PARSING_ERROR,fatal:!1,url:r.url,error:y,reason:y.message,level:e.level||void 0,parent:null==(c=r.fragments[0])?void 0:c.type,networkDetails:S,stats:s})}r.playlistParsingError=null}}-1===r.requestScheduled&&(r.requestScheduled=s.loading.start);const d=this.hls.mainForwardBufferInfo,p=pN(r,1e3*(r.edge-(d?d.end-d.len:0)));if(r.requestScheduled+p<o?r.requestScheduled=o:r.requestScheduled+=p,this.log(`live playlist ${t} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),!this.canLoad||!r.live)return;let g,m,_;if(r.canBlockReload&&r.endSN&&r.advanced){const y=this.hls.config.lowLatencyMode,b=r.lastPartSn,S=r.endSN,C=r.lastPartIndex,I=b===S;-1!==C?I?(m=S+1,_=y?0:C):(m=b,_=y?C+1:r.maxPartIndex):m=S+1;const M=r.age,O=M+r.ageHeader;let x=Math.min(O-r.partTarget,1.5*r.targetduration);if(x>0){if(O>3*r.targetduration)this.log(`Playlist last advanced ${M.toFixed(2)}s ago. Omitting segment and part directives.`),m=void 0,_=void 0;else if(null!=i&&i.tuneInGoal&&O-r.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${x} with playlist age: ${r.age}`),x=0;else{const B=Math.floor(x/r.targetduration);m+=B,void 0!==_&&(_+=Math.round(x%r.targetduration/r.partTarget)),this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${M.toFixed(2)}s goal: ${x} skip sn ${B} to part ${_}`)}r.tuneInGoal=x}if(g=this.getDeliveryDirectives(r,e.deliveryDirectives,m,_),y||!I)return r.requestScheduled=o,void this.loadingPlaylist(u,g)}else(r.canBlockReload||r.canSkipUntil)&&(g=this.getDeliveryDirectives(r,e.deliveryDirectives,m,_));g&&void 0!==m&&r.canBlockReload&&(r.requestScheduled=s.loading.first+Math.max(p-2*a,p/2)),this.scheduleLoading(u,g,r)}else this.clearTimer()}scheduleLoading(t,e,i){const r=i||t.details;if(!r)return void this.loadingPlaylist(t,e);const s=self.performance.now(),o=r.requestScheduled;if(s>=o)return void this.loadingPlaylist(t,e);const a=o-s;this.log(`reload live playlist ${t.name||t.bitrate+"bps"} in ${Math.round(a)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(t,e),a)}getDeliveryDirectives(t,e,i,r){let s=CO(t);return null!=e&&e.skip&&t.deltaUpdateFailed&&(i=e.msn,r=e.part,s=""),new IO(i,r,s)}checkRetry(t){const e=t.details,i=ig(t),r=t.errorAction,{action:s,retryCount:o=0,retryConfig:a}=r||{},l=!!r&&!!a&&(5===s||!r.resolved&&2===s);if(l){var c;if(o>=a.maxNumRetry)return!1;if(i&&null!=(c=t.context)&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist();else{const u=Zb(a,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),u),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${e}" in ${u}ms`)}t.levelRetry=!0,r.resolved=!0}return l}}function XN(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!Cd(n[e].attrs,t[e].attrs))return!1;return!0}function Cd(n,t,e){const i=n["STABLE-RENDITION-ID"];return i&&!e?i===t["STABLE-RENDITION-ID"]:!(e||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>n[r]!==t[r])}function I1(n,t){return t.label.toLowerCase()===n.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(n.lang||"").toLowerCase())}class XX{constructor(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}destroy(){this.tracks=this.queues=null}append(t,e,i){if(null===this.queues||null===this.tracks)return;const r=this.queues[e];r.push(t),1===r.length&&!i&&this.executeNext(e)}appendBlocker(t){return new Promise(e=>{this.append({label:"async-blocker",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}},t)})}prependBlocker(t){return new Promise(e=>{this.queues&&this.queues[t].unshift({label:"async-blocker-prepend",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}})})}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(t=>{var e;const i=null==(e=t[0])?void 0:e.label;("async-blocker"===i||"async-blocker-prepend"===i)&&(t[0].execute(),t.splice(0,1))})}unblockAudio(t){null!==this.queues&&this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")}executeNext(t){if(null===this.queues||null===this.tracks)return;const e=this.queues[t];if(e.length){const r=e[0];try{r.execute()}catch(s){var i;if(r.onError(s),null===this.queues||null===this.tracks)return;const o=null==(i=this.tracks[t])?void 0:i.buffer;null!=o&&o.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){null!==this.queues&&(this.queues[t].shift(),this.executeNext(t))}current(t){var e;return(null==(e=this.queues)?void 0:e[t][0])||null}toString(){const{queues:t,tracks:e}=this;return null===t||null===e?"<destroyed>":`\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`}list(t){var e,i;return null!=(e=this.queues)&&e[t]||null!=(i=this.tracks)&&i[t]?`${t}: (${this.listSbInfo(t)}) ${this.listOps(t)}`:""}listSbInfo(t){var e;const i=null==(e=this.tracks)?void 0:e[t],r=i?.buffer;return r?`SourceBuffer${r.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(t){var e;return(null==(e=this.queues)?void 0:e[t].map(i=>i.label).join(", "))||""}}const JN=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,eP="HlsJsTrackRemovedError";class JX extends Error{constructor(t){super(t),this.name=eP}}function tP(n){const t=n.querySelectorAll("source");[].slice.call(t).forEach(e=>{n.removeChild(e)})}function w1(n){return"audio"===n?1:0}class x1{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(v.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(v.BUFFER_CODECS,this.onBufferCodecs,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(v.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(v.BUFFER_CODECS,this.onBufferCodecs,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){const i=this.hls.levels[e.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){const i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&re(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const t=this.hls.levels;if(t.length){const e=this.hls,i=this.getMaxLevel(t.length-1);i!==this.autoLevelCapping&&e.logger.log(`Setting autoLevelCapping to ${i}: ${t[i].height}p@${t[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),e.autoLevelCapping=i,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const i=e.filter((r,s)=>this.isLevelAllowed(r)&&s<=t);return this.clientRect=null,x1.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,!e.width&&!e.height&&(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch{}return Math.min(t,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(t){return!this.restrictedLevels.some(i=>t.bitrate===i.bitrate&&t.width===i.width&&t.height===i.height)}static getMaxLevelByMediaSize(t,e,i){if(null==t||!t.length)return-1;const r=(a,l)=>!l||a.width!==l.width||a.height!==l.height;let s=t.length-1;const o=Math.max(e,i);for(let a=0;a<t.length;a+=1){const l=t[a];if((l.width>=o||l.height>=o)&&r(l,t[a+1])){s=a;break}}return s}}class es{constructor(t,e){Array.isArray(t)&&(t=t.map(i=>i instanceof es?i:new es(i))),this.value=t,this.params=e}}function ts(n,t,e){return function sJ(n,t,e,i){return new Error(`failed to ${n} "${function rJ(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":"object"==typeof n?JSON.stringify(n):String(n)}(t)}" as ${e}`,{cause:i})}("serialize",n,t,e)}class nP{constructor(t){this.description=t}}const iP="Bare Item";function rP(n){if(function fJ(n){return n<-999999999999999||999999999999999<n}(n))throw ts(n,"Integer");return n.toString()}function sP(n,t){if(n<0)return-sP(-n,t);const e=Math.pow(10,t);if(Math.abs(n*e%1-.5)<Number.EPSILON){const r=Math.floor(n*e);return(r%2==0?r:r+1)/e}return Math.round(n*e)/e}function gJ(n){const t=sP(n,3);if(Math.floor(Math.abs(t)).toString().length>12)throw ts(n,"Decimal");const e=t.toString();return e.includes(".")?e:`${e}.0`}const _J=/[\x00-\x1f\x7f]+/;function oP(n){const t=function yJ(n){return n.description||n.toString().slice(7,-1)}(n);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw ts(t,"Token");return t}function A1(n){switch(typeof n){case"number":if(!re(n))throw ts(n,iP);return Number.isInteger(n)?rP(n):gJ(n);case"string":return function vJ(n){if(_J.test(n))throw ts(n,"String");return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(n);case"symbol":return oP(n);case"boolean":return function aJ(n){if("boolean"!=typeof n)throw ts(n,"Boolean");return n?"?1":"?0"}(n);case"object":if(n instanceof Date)return function hJ(n){return`@${rP(n.getTime()/1e3)}`}(n);if(n instanceof Uint8Array)return function uJ(n){if(!1===ArrayBuffer.isView(n))throw ts(n,"Byte Sequence");return`:${function lJ(n){return btoa(String.fromCharCode(...n))}(n)}:`}(n);if(n instanceof nP)return oP(n);default:throw ts(n,iP)}}function M1(n){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(n))throw ts(n,"Key");return n}function R1(n){return null==n?"":Object.entries(n).map(([t,e])=>!0===e?`;${M1(t)}`:`;${M1(t)}=${A1(e)}`).join("")}function aP(n){return n instanceof es?`${A1(n.value)}${R1(n.params)}`:A1(n)}function lP(n,t){return function TJ(n,t={whitespace:!0}){if("object"!=typeof n||null==n)throw ts(n,"Dict");const e=n instanceof Map?n.entries():Object.entries(n),i=t?.whitespace?" ":"";return Array.from(e).map(([r,s])=>{s instanceof es||(s=new es(s));let o=M1(r);return!0===s.value?o+=R1(s.params):(o+="=",Array.isArray(s.value)?o+=function SJ(n){return`(${n.value.map(aP).join(" ")})${R1(n.params)}`}(s):o+=aP(s)),o}).join(`,${i}`)}(n,t)}const ns="CMCD-Object",qt="CMCD-Request",_a="CMCD-Session",vo="CMCD-Status",DJ={br:ns,ab:ns,d:ns,ot:ns,tb:ns,tpb:ns,lb:ns,tab:ns,lab:ns,url:ns,pb:qt,bl:qt,tbl:qt,dl:qt,ltc:qt,mtp:qt,nor:qt,nrr:qt,rc:qt,sn:qt,sta:qt,su:qt,ttfb:qt,ttfbb:qt,ttlb:qt,cmsdd:qt,cmsds:qt,smrt:qt,df:qt,cs:qt,ts:qt,cid:_a,pr:_a,sf:_a,sid:_a,st:_a,v:_a,msd:_a,bs:vo,bsd:vo,cdn:vo,rtp:vo,bg:vo,pt:vo,ec:vo,e:vo},CJ_REQUEST=qt;const cP="event",yg=n=>Math.round(n),k1=(n,t)=>Array.isArray(n)?n.map(e=>k1(e,t)):n instanceof es&&"string"==typeof n.value?new es(k1(n.value,t),n.params):(t.baseUrl&&(n=function MJ(n,t){const e=new URL(n),i=new URL(t);if(e.origin!==i.origin)return n;const r=e.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")+e.search+e.hash}(n,t.baseUrl)),1===t.version?encodeURIComponent(n):n),bg=n=>100*yg(n/100),RJ={br:yg,d:yg,bl:bg,dl:bg,mtp:bg,nor:(n,t)=>{let e=n;return t.version>=2&&(n instanceof es&&"string"==typeof n.value?e=new es([n]):"string"==typeof n&&(e=[n])),k1(e,t)},rtp:bg,tb:yg},uP="request",dP="response",O1=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],kJ=["e"],OJ=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Eg(n){return OJ.test(n)}const fP=["d","dl","nor","ot","rtp","su"],LJ=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"],BJ=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function UJ(n){return BJ.includes(n)||Eg(n)}const $J={[dP]:function FJ(n){return O1.includes(n)||fP.includes(n)||LJ.includes(n)||Eg(n)},[cP]:function NJ(n){return O1.includes(n)||kJ.includes(n)||Eg(n)},[uP]:function PJ(n){return O1.includes(n)||fP.includes(n)||Eg(n)}};function hP(n,t={}){const e={};if(null==n||"object"!=typeof n)return e;const i=t.version||n.v||1,r=t.reportingMode||uP,s=1===i?UJ:$J[r];let o=Object.keys(n).filter(s);const a=t.filter;"function"==typeof a&&(o=o.filter(a));const l=r===dP||"event"===r;l&&!o.includes("ts")&&o.push("ts"),i>1&&!o.includes("v")&&o.push("v");const c=vt({},RJ,t.formatters),u={version:i,reportingMode:r,baseUrl:t.baseUrl};return o.sort().forEach(d=>{let f=n[d];const h=c[d];if("function"==typeof h&&(f=h(f,u)),"v"===d){if(1===i)return;f=i}"pr"==d&&1===f||(l&&"ts"===d&&!re(f)&&(f=Date.now()),function AJ(n){return"number"==typeof n?re(n):null!=n&&""!==n&&!1!==n}(f)&&(function xJ(n){return["ot","sf","st","e","sta"].includes(n)}(d)&&"string"==typeof f&&(f=new nP(f)),e[d]=f))}),e}function jJ(n,t,e){return vt(n,function VJ(n,t={}){const e={};if(!n)return e;const r=function wJ(n,t){const e={};if(!n)return e;const i=Object.keys(n),r=t?function IJ(n){return Object.keys(n).reduce((t,e)=>{var i;return null===(i=n[e])||void 0===i||i.forEach(r=>t[r]=e),t},{})}(t):{};return i.reduce((s,o)=>{var a;const l=DJ[o]||r[o]||CJ_REQUEST;return(null!==(a=s[l])&&void 0!==a?a:s[l]={})[o]=n[o],s},e)}(hP(n,t),t?.customHeaderMap);return Object.entries(r).reduce((s,[o,a])=>{const l=lP(a,{whitespace:!1});return l&&(s[o]=l),s},e)}(t,e))}const pP=/CMCD=[^&#]+/;function KJ(n,t,e){const i=function WJ(n,t={}){return n?`CMCD=${function zJ(n,t={}){if(!n)return"";const e=function GJ(n,t={}){return n?lP(hP(n,t),{whitespace:!1}):""}(n,t);return encodeURIComponent(e)}(n,t)}`:""}(t,e);if(!i)return n;if(pP.test(n))return n.replace(pP,i);const r=n.includes("?")?"&":"?";return`${n}${r}${i}`}function gP(n,t,e,i){n&&Object.keys(t).forEach(r=>{const s=n.filter(o=>o.groupId===r).map(o=>{const a=vt({},o);return a.details=void 0,a.attrs=new Vt(a.attrs),a.url=a.attrs.URI=mP(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",e),a.groupId=a.attrs["GROUP-ID"]=t[r],a.attrs["PATHWAY-ID"]=i,a});n.push(...s)})}function mP(n,t,e,i){const{HOST:r,PARAMS:s,[e]:o}=i;let a;t&&(a=o?.[t],a&&(n=a));const l=new self.URL(n);return r&&!a&&(l.host=r),s&&Object.keys(s).sort().forEach(c=>{c&&l.searchParams.set(c,s[c])}),l.href}let ZJ=(()=>{class n extends er{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=n.CDMCleanupPromise?[n.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=i=>{const{initDataType:r,initData:s}=i,o=`"${i.type}" event: init data type: "${r}"`;if(this.debug(o),null!==s){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=vd(this.config));const l=a.map(s1).filter(c=>!!c);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(a=>{const l=cg(a);if("sinf"!==r||l!==jt.FAIRPLAY)return void this.log(`Ignoring "${i.type}" event with init data type: "${r}" for selected key-system ${l}`);let c;try{const p=_n(new Uint8Array(s)),m=pO(i1(JSON.parse(p).sinf));if(!m)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");c=new Uint8Array(m.subarray(8,24))}catch(p){return void this.warn(`${o} Failed to parse sinf: ${p}`)}const u=Qn(c),{keyIdToKeySessionPromise:d,mediaKeySessions:f}=this;let h=d[u];for(let p=0;p<f.length;p++){const g=f[p],m=g.decryptdata;if(!m.keyId)continue;const _=Qn(m.keyId);if(ag(c,m.keyId)||-1!==m.uri.replace(/-/g,"").indexOf(u)){if(h=d[_],!h)continue;if(m.pssh)break;delete d[_],m.pssh=new Uint8Array(s),m.keyId=c,h=d[u]=h.then(()=>this.generateRequestWithPreferredKeySession(g,r,s,"encrypted-event-key-match")),h.catch(y=>this.handleError(y));break}}h||this.handleError(new Error(`Key ID ${u} not encountered in playlist. Key-system sessions ${f.length}.`))}).catch(a=>this.handleError(a))}},this.onWaitingForKey=i=>{this.log(`"${i.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(v.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(v.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(v.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(v.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:i,widevineLicenseUrl:r}=this.config,s=i?.[e];return s?s.licenseUrl:e===jt.WIDEVINE&&r?r:void 0}getLicenseServerUrlOrThrow(e){const i=this.getLicenseServerUrl(e);if(void 0===i)throw new Error(`no license server URL configured for key-system "${e}"`);return i}getServerCertificateUrl(e){const{drmSystems:i}=this.config,r=i?.[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const i=this.hls.levels,r=(a,l,c)=>!!a&&c.indexOf(a)===l,s=i.map(a=>a.audioCodec).filter(r),o=i.map(a=>a.videoCodec).filter(r);return s.length+o.length===0&&o.push("avc1.42e01e"),new Promise((a,l)=>{const c=u=>{const d=u.shift();this.getMediaKeysPromise(d,s,o).then(f=>a({keySystem:d,mediaKeys:f})).catch(f=>{u.length?c(u):l(f instanceof ki?f:new ki({type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_ACCESS,error:f,fatal:!0},f.message))})};c(e)})}requestMediaKeySystemAccess(e,i){const{requestMediaKeySystemAccessFunc:r}=this.config;if("function"!=typeof r){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return null===XO&&"http:"===self.location.protocol&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(e,i)}getMediaKeysPromise(e,i,r){var s;const o=function OZ(n,t,e,i){let r;switch(n){case jt.FAIRPLAY:r=["cenc","sinf"];break;case jt.WIDEVINE:case jt.PLAYREADY:r=["cenc"];break;case jt.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return function NZ(n,t,e,i){return[{initDataTypes:n,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(s=>({contentType:`audio/mp4; codecs=${s}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:e.map(s=>({contentType:`video/mp4; codecs=${s}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}(r,t,e,i)}(e,i,r,this.config.drmSystemOptions||{});let a=this.keySystemAccessPromises[e],l=null==(s=a)?void 0:s.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${It(o)}`),l=this.requestMediaKeySystemAccess(e,o);const c=a=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(u=>{this.log(`Failed to obtain access to key-system "${e}": ${u}`)}),l.then(u=>{this.log(`Access for key-system "${u.keySystem}" obtained`);const d=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const f=c.mediaKeys=u.createMediaKeys().then(h=>(this.log(`Media-keys created for "${e}"`),c.hasMediaKeys=!0,d.then(p=>p?this.setMediaKeysServerCertificate(h,e,p):h)));return f.catch(h=>{this.error(`Failed to create media-keys for "${e}"}: ${h}`)}),f})}return l.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:i,mediaKeys:r}){this.log(`Creating key-system session "${i}" keyId: ${Qn(e.keyId||[])} keyUri: ${e.uri}`);const s=r.createSession(),o={decryptdata:e,keySystem:i,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(e){const i=e.decryptdata;if(i.pssh){const r=this.createMediaKeySessionContext(e),s=Sg(i);this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,"cenc",i.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,i){const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${Qn(e.decryptdata.keyId||[])}\n      } (data length: ${i.byteLength})`),r.update(i)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>s1(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:i,mediaKeys:r})=>this.attemptSetMediaKeys(i,r))}selectKeySystem(e){return new Promise((i,r)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:s})=>{const o=s1(s);o?i(o):r(new Error(`Unable to find format for key-system "${s}"`))}).catch(r)})}selectKeySystemFormat(e){const i=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)),this.keyFormatPromise}getKeyFormatPromise(e){const i=vd(this.config),r=e.map(cg).filter(s=>!!s&&-1!==i.indexOf(s));return this.selectKeySystem(r)}getKeyStatus(e){const{mediaKeySessions:i}=this;for(let r=0;r<i.length;r++){const s=XJ(e,i[r]);if(s)return s}}loadKey(e){const i=e.keyInfo.decryptdata,r=Sg(i),s=this.bannedKeyIds[r];if(s||"internal-error"===this.getKeyStatus(i)){const l=_P(s||"internal-error",i);return this.handleError(l,e.frag),Promise.reject(l)}const o=`(keyId: ${r} format: "${i.keyFormat}" method: ${i.method} uri: ${i.uri})`;this.log(`Starting session for key ${o}`);const a=this.keyIdToKeySessionPromise[r];if(!a){const l=this.getKeySystemForKeyPromise(i).then(({keySystem:c,mediaKeys:u})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${o}`),this.attemptSetMediaKeys(c,u).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:c,mediaKeys:u,decryptdata:i}))))).then(c=>this.generateRequestWithPreferredKeySession(c,"cenc",i.pssh?i.pssh.buffer:null,"playlist-key"));return l.catch(c=>this.handleError(c,e.frag)),this.keyIdToKeySessionPromise[r]=l,l}return a.catch(l=>{if(l instanceof ki){const c=ct({},l.data);"internal-error"===this.getKeyStatus(i)&&(c.decryptdata=i);const u=new ki(c,l.message);this.handleError(u,e.frag)}}),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,i){if(this.hls)if(e instanceof ki){i&&(e.data.frag=i);const r=e.data.decryptdata;this.error(`${e.message}${r?` (${Qn(r.keyId||[])})`:""}`),this.hls.trigger(v.ERROR,e.data)}else this.error(e.message),this.hls.trigger(v.ERROR,{type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const i=Sg(e),r=this.keyIdToKeySessionPromise[i];if(!r){const s=cg(e.keyFormat),o=s?[s]:vd(this.config);return this.attemptKeySystemAccess(o)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=vd(this.config)),0===e.length)throw new ki({type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${It({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,i){if(this.mediaResolved=void 0,this.mediaKeys===i)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(r).then(()=>this.media?this.media.setMediaKeys(i):new Promise((o,a)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return a(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=i,this.media.setMediaKeys(i).then(o).catch(a)}}));return this.mediaKeys=i,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>-1===r.indexOf(o))})}generateRequestWithPreferredKeySession(e,i,r,s){var o;const a=null==(o=this.config.drmSystems)||null==(o=o[e.keySystem])?void 0:o.generateRequest;if(a)try{const g=a.call(this.hls,i,r,e);if(!g)throw new Error("Invalid response from configured generateRequest filter");i=g.initDataType,e.decryptdata.pssh=(r=g.initData?g.initData:null)?new Uint8Array(r):null}catch(g){if(this.warn(g.message),this.hls&&this.hls.config.debug)throw g}if(null===r)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const l=Sg(e.decryptdata),c=e.decryptdata.uri;this.log(`Generating key-session request for "${s}" keyId: ${l} URI: ${c} (init data type: ${i} length: ${r.byteLength})`);const u=new f1,d=e._onmessage=g=>{const m=e.mediaKeysSession;if(!m)return void u.emit("error",new Error("invalid state"));const{messageType:_,message:y}=g;this.log(`"${_}" message event for session "${m.sessionId}" message size: ${y.byteLength}`),"license-request"===_||"license-renewal"===_?this.renewLicense(e,y).catch(b=>{u.eventNames().length?u.emit("error",b):this.handleError(b)}):"license-release"===_?e.keySystem===jt.FAIRPLAY&&this.updateKeySession(e,r1("acknowledged")).then(()=>this.removeSession(e)).catch(b=>this.handleError(b)):this.warn(`unhandled media key message type "${_}"`)},f=(g,m)=>{let _;m.keyStatus=g,g.startsWith("usable")?u.emit("resolved"):"internal-error"===g||"output-restricted"===g||"output-downscaled"===g?_=_P(g,m.decryptdata):"expired"===g?_=new Error(`key expired (keyId: ${l})`):"released"===g?_=new Error("key released"):"status-pending"===g||this.warn(`unhandled key status change "${g}" (keyId: ${l})`),_&&(u.eventNames().length?u.emit("error",_):this.handleError(_))},h=e._onkeystatuseschange=g=>{if(!e.mediaKeysSession)return void u.emit("error",new Error("invalid state"));const _=this.getKeyStatuses(e);if(!Object.keys(_).some(C=>"status-pending"!==_[C]))return;if("expired"===_[l])return this.log(`Expired key ${It(_)} in key-session "${e.mediaKeysSession.sessionId}"`),void this.renewKeySession(e);let b=_[l];var S;b?f(b,e):(e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(S=e.keyStatusTimeouts)[l]||(S[l]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const k=this.getKeyStatus(e.decryptdata);if(k&&"status-pending"!==k)return this.log(`No status for keyId ${l} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${k} from other session.`),f(k,e);this.log(`key status for ${l} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),b="internal-error",f(b,e)},1e3)),this.log(`No status for keyId ${l} (${It(_)}).`))};Zn(e.mediaKeysSession,"message",d),Zn(e.mediaKeysSession,"keystatuseschange",h);const p=new Promise((g,m)=>{u.on("error",m),u.on("resolved",g)});return e.mediaKeysSession.generateRequest(i,r).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${l} URI: ${c}`)}).catch(g=>{throw new ki({type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_SESSION,error:g,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${g}`)}).then(()=>p).catch(g=>(u.removeAllListeners(),this.removeSession(e).then(()=>{throw g}))).then(()=>(u.removeAllListeners(),e))}getKeyStatuses(e){const i={};return e.mediaKeysSession.keyStatuses.forEach((r,s)=>{if("string"==typeof s&&"object"==typeof r){const l=s;s=r,r=l}const o="buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s);e.keySystem===jt.PLAYREADY&&16===o.length&&QO(o);const a=Qn(o);"internal-error"===r&&(this.bannedKeyIds[a]=r),this.log(`key status change "${r}" for keyStatuses keyId: ${a} key-session "${e.mediaKeysSession.sessionId}"`),i[a]=r}),i}fetchServerCertificate(e){const i=this.config,s=new(0,i.loader)(i),o=this.getServerCertificateUrl(e);return o?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,l)=>{const c={responseType:"arraybuffer",url:o},u=i.certLoadPolicy.default;s.load(c,{loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(h,p,g,m)=>{a(h.data)},onError:(h,p,g,m)=>{l(new ki({type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:ct({url:c.url,data:void 0},h)},`"${e}" certificate request failed (${o}). Status: ${h.code} (${h.text})`))},onTimeout:(h,p,g)=>{l(new ki({type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:{url:c.url,data:void 0}},`"${e}" certificate request timed out (${o})`))},onAbort:(h,p,g)=>{l(new Error("aborted"))}})})):Promise.resolve()}setMediaKeysServerCertificate(e,i,r){return new Promise((s,o)=>{e.setServerCertificate(r).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${r.byteLength}) on "${i}"`),s(e)}).catch(a=>{o(new ki({type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,i){return this.requestLicense(e,new Uint8Array(i)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(s=>{throw new ki({type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:s,fatal:!1},s.message)}))}unpackPlayReadyKeyMessage(e,i){const r=String.fromCharCode.apply(null,new Uint16Array(i.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),i;const s=(new DOMParser).parseFromString(r,"application/xml"),o=s.querySelectorAll("HttpHeader");if(o.length>0){let d;for(let f=0,h=o.length;f<h;f++){var a,l;d=o[f];const p=null==(a=d.querySelector("name"))?void 0:a.textContent,g=null==(l=d.querySelector("value"))?void 0:l.textContent;p&&g&&e.setRequestHeader(p,g)}}const c=s.querySelector("Challenge"),u=c?.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return r1(atob(u))}setupLicenseXHR(e,i,r,s){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return o.call(this.hls,e,i,r,s)}).catch(a=>{if(!r.decryptdata)throw a;return e.open("POST",i,!0),o.call(this.hls,e,i,r,s)}).then(a=>(e.readyState||e.open("POST",i,!0),{xhr:e,licenseChallenge:a||s})):(e.open("POST",i,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,i){const r=this.config.keyLoadPolicy.default;return new Promise((s,o)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return o(new Error("invalid state"));if(4===l.readyState)if(200===l.status){this._requestLicenseFailureCount=0;let c=l.response;this.log(`License received ${c instanceof ArrayBuffer?c.byteLength:c}`);const u=this.config.licenseResponseCallback;if(u)try{c=u.call(this.hls,l,a,e)}catch(d){this.error(d)}s(c)}else{const c=r.errorRetry,u=c?c.maxNumRetry:0;this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||l.status>=400&&l.status<500?o(new ki({type:fe.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:l,response:{url:a,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${a}). Status: ${l.status} (${l.statusText})`)):(this.warn(`Retrying license request, ${u-this._requestLicenseFailureCount+1} attempts left`),this.requestLicense(e,i).then(s,o))}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,a,e,i).then(({xhr:c,licenseChallenge:u})=>{e.keySystem==jt.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(c,u)),c.send(u)}).catch(o)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,i){if(!this.config.emeEnabled)return;const r=i.media;this.media=r,Zn(r,"encrypted",this.onMediaEncrypted),Zn(r,"waitingforkey",this.onWaitingForKey);const s=this.mediaResolved;s?s():this.mediaKeys=r.mediaKeys}onMediaDetached(){const e=this.media;e&&(di(e,"encrypted",this.onMediaEncrypted),di(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const i=this.mediaResolved;if(i&&i(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const r=this.media,s=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,ma.clearKeyUriToKeyIdMap();const o=s.length;n.CDMCleanupPromise=Promise.all(s.map(a=>this.removeSession(a)).concat((null==r||null==(e=r.setMediaKeys(null))?void 0:e.catch(a=>{this.log(`Could not clear media keys: ${a}`),this.hls&&this.hls.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${a}`)})}))||Promise.resolve())).catch(a=>{this.log(`Could not close sessions and clear media keys: ${a}`),this.hls&&this.hls.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${a}`)})}).then(()=>{o&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:i}){if(i&&this.config.emeEnabled&&!this.keyFormatPromise){const r=i.reduce((s,o)=>(-1===s.indexOf(o.keyFormat)&&s.push(o.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:i,licenseXhr:r,decryptdata:s}=e;if(i){this.log(`Remove licenses and keys and close session "${i.sessionId}" keyId: ${Qn(s?.keyId||[])}`),e._onmessage&&(i.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(i.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const o=this.mediaKeySessions.indexOf(e);o>-1&&this.mediaKeySessions.splice(o,1);const{keyStatusTimeouts:a}=e;a&&Object.keys(a).forEach(u=>self.clearTimeout(a[u]));const{drmSystemOptions:l}=this.config;return(function PZ(n){var t;return!(!n||"persistent-license"!==n.sessionType&&(null==(t=n.sessionTypes)||!t.some(e=>"persistent-license"===e)))}(l)?new Promise((u,d)=>{self.setTimeout(()=>d(new Error("MediaKeySession.remove() timeout")),8e3),i.remove().then(u).catch(d)}):Promise.resolve()).catch(u=>{this.log(`Could not remove session: ${u}`),this.hls&&this.hls.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${u}`)})}).then(()=>i.close()).catch(u=>{this.log(`Could not close session: ${u}`),this.hls&&this.hls.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${u}`)})})}return Promise.resolve()}}return n.CDMCleanupPromise=void 0,n})();function Sg(n){if(!n)throw new Error("Could not read keyId of undefined decryptdata");if(null===n.keyId)throw new Error("keyId is null");return Qn(n.keyId)}function XJ(n,t){return n.keyId&&t.mediaKeysSession.keyStatuses.has(n.keyId)?t.mediaKeysSession.keyStatuses.get(n.keyId):n.matches(t.decryptdata)?t.keyStatus:void 0}class ki extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}}function _P(n,t){const e="output-restricted"===n;return new ki({type:fe.KEY_SYSTEM_ERROR,details:e?N.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:N.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!1,decryptdata:t},e?"HDCP level output restricted":`key status changed to "${n}"`)}function vP(n,t){let e;try{e=new Event("addtrack")}catch{e=document.createEvent("Event"),e.initEvent("addtrack",!1,!1)}e.track=n,t.dispatchEvent(e)}function yP(n,t){const e=n.mode;if("disabled"===e&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(t.id))try{if(n.addCue(t),!n.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(i){ut.debug(`[texttrack-utils]: ${i}`);try{const r=new self.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id,n.addCue(r)}catch(r){ut.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}"disabled"===e&&(n.mode=e)}function nc(n,t){const e=n.mode;if("disabled"===e&&(n.mode="hidden"),n.cues)for(let i=n.cues.length;i--;)t&&n.cues[i].removeEventListener("enter",t),n.removeCue(n.cues[i]);"disabled"===e&&(n.mode=e)}function N1(n,t,e,i){const r=n.mode;if("disabled"===r&&(n.mode="hidden"),n.cues&&n.cues.length>0){const s=function tee(n,t,e){const i=[],r=function eee(n,t){if(t<=n[0].startTime)return 0;const e=n.length-1;if(t>n[e].endTime)return-1;let s,i=0,r=e;for(;i<=r;)if(s=Math.floor((r+i)/2),t<n[s].startTime)r=s-1;else{if(!(t>n[s].startTime&&i<e))return s;i=s+1}return n[i].startTime-t<t-n[r].startTime?i:r}(n,t);if(r>-1)for(let s=r,o=n.length;s<o;s++){const a=n[s];if(a.startTime>=t&&a.endTime<=e)i.push(a);else if(a.startTime>e)return i}return i}(n.cues,t,e);for(let o=0;o<s.length;o++)(!i||i(s[o]))&&n.removeCue(s[o])}"disabled"===r&&(n.mode=r)}function Tg(n){const t=[];for(let e=0;e<n.length;e++){const i=n[e];("subtitles"===i.kind||"captions"===i.kind)&&i.label&&t.push(n[e])}return t}function Id(n){let t=5381,e=n.length;for(;e;)t=33*t^n.charCodeAt(--e);return(t>>>0).toString()}const ic=.025;let Dg=function(n){return n[n.Point=0]="Point",n[n.Range=1]="Range",n}({});function ree(n,t,e){return`${n.identifier}-${e+1}-${Id(t)}`}class see{constructor(t,e){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=e,this.dateRange=t,this.setDateRange(t)}setDateRange(t){this.dateRange=t,this.resumeOffset=t.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=t.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=t.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=t.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var t;this.appendInPlaceStarted=!1,null==(t=this.assetListLoader)||t.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(t){var e;if(t>0&&t>=this.assetList.length)return!0;const i=this.playoutLimit;return!(t<=0||isNaN(i))&&(0===i||((null==(e=this.assetList[t])?void 0:e.startOffset)||0)>i)}findAssetIndex(t){return this.assetList.indexOf(t)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const t=this.dateRange.startTime;if(this.snapOptions.out){const e=this.dateRange.tagAnchor;if(e)return P1(t,e)}return t}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const t=this.dateRange.tagAnchor;if(t){const e=this.dateRange.startTime;return e-P1(e,t)<.1}return!1}get resumptionOffset(){const t=this.resumeOffset,e=re(t)?t:this.duration;return this.cumulativeDuration+e}get resumeTime(){const t=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const e=this.resumeAnchor;if(e)return P1(t,e)}return t}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<ic))}set appendInPlace(t){this.appendInPlaceStarted?this.resetOnResume=!t:this.appendInPlaceDisabled=!t}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(t){this._timelineStart=t}get duration(){const t=this.playoutLimit;let e;return e=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(t){this._duration=t}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?Dg.Range:Dg.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return function oee(n){return`["${n.identifier}" ${n.cue.pre?"<pre>":n.cue.post?"<post>":""}${n.timelineStart.toFixed(2)}-${n.resumeTime.toFixed(2)}]`}(this)}}function P1(n,t){return n-t.start<t.duration/2&&!(Math.abs(n-(t.start+t.duration))<ic)?t.start:t.start+t.duration}function bP(n,t,e){const i=new self.URL(n,e);return"data:"!==i.protocol&&i.searchParams.set("_HLS_primary_id",t),i}function L1(n,t){for(;null!=(e=n.assetList[++t])&&e.error;)var e;return t}function rc(n){const t=n.timelineStart,e=n.duration||0;return`["${n.identifier}" ${t.toFixed(2)}-${(t+e).toFixed(2)}]`}class aee{constructor(t,e,i,r){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(v.PLAYOUT_LIMIT_REACHED,{})};const s=this.hls=new t(e);this.interstitial=i,this.assetItem=r;const o=()=>{this.hasDetails=!0};s.once(v.LEVEL_LOADED,o),s.once(v.AUDIO_TRACK_LOADED,o),s.once(v.SUBTITLE_TRACK_LOADED,o),s.on(v.MEDIA_ATTACHING,(a,{media:l})=>{this.removeMediaListeners(),this.mediaAttached=l,this.interstitial.playoutLimit&&(l.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&s.on(v.BUFFER_APPENDED,()=>{const u=this.bufferedEnd;this.reachedPlayout(u)&&(this._bufferedEosTime=u,s.trigger(v.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const t=this.hls;if(t)if(t.url)t.levels.length&&!t.started&&t.startLoad(-1,!0);else{let e=this.assetItem.uri;try{e=bP(e,t.config.primarySessionId||"").href}catch{}t.loadSource(e)}}bufferedInPlaceToEnd(t){var e;if(!this.appendInPlace)return!1;if(null!=(e=this.hls)&&e.bufferedToEnd)return!0;if(!t)return!1;const i=Math.min(this._bufferedEosTime||1/0,this.duration),s=Me.bufferInfo(t,this.timelineOffset,0);return this.getAssetTime(s.end)>=i-.02}reachedPlayout(t){return this.startOffset+t>=this.interstitial.playoutLimit}get destroyed(){var t;return!(null!=(t=this.hls)&&t.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var t;return(null==(t=this.hls)?void 0:t.media)||null}get bufferedEnd(){const t=this.media||this.mediaAttached;if(!t)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const e=Me.bufferInfo(t,t.currentTime,.001);return this.getAssetTime(e.end)}get currentTime(){const t=this.media||this.mediaAttached;return t?this.getAssetTime(t.currentTime):this._currentTime||0}get duration(){const t=this.assetItem.duration;if(!t)return 0;const e=this.interstitial.playoutLimit;if(e){const i=e-this.startOffset;if(i>0&&i<t)return i}return t}get remaining(){const t=this.duration;return t?Math.max(0,t-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var t;return(null==(t=this.hls)?void 0:t.config.timelineOffset)||0}set timelineOffset(t){const e=this.timelineOffset;if(t!==e&&Math.abs(t-e)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=t}}getAssetTime(t){const i=this.duration;return Math.min(Math.max(0,t-this.timelineOffset),i)}removeMediaListeners(){const t=this.mediaAttached;t&&(this._currentTime=t.currentTime,this.bufferSnapShot(),t.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var t;this.mediaAttached&&null!=(t=this.hls)&&t.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(t){var e;this.loadSource(),null==(e=this.hls)||e.attachMedia(t)}detachMedia(){var t;this.removeMediaListeners(),this.mediaAttached=null,null==(t=this.hls)||t.detachMedia()}resumeBuffering(){var t;null==(t=this.hls)||t.resumeBuffering()}pauseBuffering(){var t;null==(t=this.hls)||t.pauseBuffering()}transferMedia(){var t;return this.bufferSnapShot(),(null==(t=this.hls)?void 0:t.transferMedia())||null}resetDetails(){const t=this.hls;if(t&&this.hasDetails){t.stopLoad();const e=i=>delete i.details;t.levels.forEach(e),t.allAudioTracks.forEach(e),t.allSubtitleTracks.forEach(e),this.hasDetails=!1}}on(t,e,i){var r;null==(r=this.hls)||r.on(t,e)}once(t,e,i){var r;null==(r=this.hls)||r.once(t,e)}off(t,e,i){var r;null==(r=this.hls)||r.off(t,e)}toString(){var t;return`HlsAssetPlayer: ${rc(this.assetItem)} ${null==(t=this.hls)?void 0:t.sessionId} ${this.appendInPlace?"append-in-place":""}`}}class lee extends er{constructor(t,e){super("interstitials-sched",e),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=t}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(t=>t.reset()),this.events=this.items=null}resetErrorsInRange(t,e){return this.events?this.events.reduce((i,r)=>t<=r.startOffset&&e>r.startOffset?(delete r.error,i+1):i,0):0}get duration(){const t=this.items;return t?t[t.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(t){return t&&this.eventMap[t]||null}hasEvent(t){return t in this.eventMap}findItemIndex(t,e){if(t.event)return this.findEventIndex(t.event.identifier);let i=-1;t.nextEvent?i=this.findEventIndex(t.nextEvent.identifier)-1:t.previousEvent&&(i=this.findEventIndex(t.previousEvent.identifier)+1);const r=this.items;if(r)for(r[i]||(void 0===e&&(e=t.start),i=this.findItemIndexAtTime(e));i>=0&&null!=(s=r[i])&&s.event;){var s;i--}return i}findItemIndexAtTime(t,e){const i=this.items;if(i)for(let r=0;r<i.length;r++){let s=i[r];if(e&&"primary"!==e&&(s=s[e]),t===s.start||t>s.start&&t<s.end)return r}return-1}findJumpRestrictedIndex(t,e){const i=this.items;if(i)for(let r=t;r<=e&&i[r];r++){const s=i[r].event;if(null!=s&&s.restrictions.jump&&!s.appendInPlace)return r}return-1}findEventIndex(t){const e=this.items;if(e)for(let r=e.length;r--;){var i;if((null==(i=e[r].event)?void 0:i.identifier)===t)return r}return-1}findAssetIndex(t,e){const i=t.assetList,r=i.length;if(r>1)for(let s=0;s<r;s++){const o=i[s];if(!o.error){const a=o.timelineStart;if(e===a||e>a&&(e<a+(o.duration||0)||s===r-1))return s}}return 0}get assetIdAtEnd(){var t;const e=null==(t=this.items)||null==(t=t[this.length-1])?void 0:t.event;if(e){const i=e.assetList,r=i[i.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(t,e){const i=t.main.details,{dateRanges:r}=i,s=this.events,o=this.parseDateRanges(r,{url:i.url},e),a=Object.keys(r),l=s?s.filter(c=>!a.includes(c.identifier)):[];o.length&&o.sort((c,u)=>{const d=c.cue.pre,f=c.cue.post,h=u.cue.pre,p=u.cue.post;if(d&&!h)return-1;if(h&&!d||f&&!p)return 1;if(p&&!f)return-1;if(!(d||h||f||p)){const g=c.startTime,m=u.startTime;if(g!==m)return g-m}return c.dateRange.tagOrder-u.dateRange.tagOrder}),this.events=o,l.forEach(c=>{this.removeEvent(c)}),this.updateSchedule(t,l)}updateSchedule(t,e=[],i=!1){const r=this.events||[];if(r.length||e.length||this.length<2){const s=this.items,o=this.parseSchedule(r,t);(i||e.length||s?.length!==o.length||o.some((l,c)=>Math.abs(l.playout.start-s[c].playout.start)>.005||Math.abs(l.playout.end-s[c].playout.end)>.005))&&(this.items=o,this.onScheduleUpdate(e,s))}}parseDateRanges(t,e,i){const r=[],s=Object.keys(t);for(let o=0;o<s.length;o++){const a=s[o],l=t[a];if(l.isInterstitial){let c=this.eventMap[a];c?c.setDateRange(l):(c=new see(l,e),this.eventMap[a]=c,!1===i&&(c.appendInPlace=i)),r.push(c)}}return r}parseSchedule(t,e){const i=[],r=e.main.details,s=r.live?1/0:r.edge;let o=0;if((t=t.filter(l=>!(l.error||l.cue.once&&l.hasPlayed))).length){this.resolveOffsets(t,e);let l=0,c=0;if(t.forEach((u,d)=>{const f=u.cue.pre,h=u.cue.post,p=t[d-1]||null,g=u.appendInPlace,m=h?s:u.startOffset,_=u.duration,y=u.timelineOccupancy===Dg.Range?_:0,b=u.resumptionOffset,S=p?.startTime===m,C=m+u.cumulativeDuration;let k=g?C+_:m+b;if(f||!h&&m<=0){const M=c;c+=y,u.timelineStart=C;const O=o;o+=_,i.push({event:u,start:C,end:k,playout:{start:O,end:o},integrated:{start:M,end:c}})}else{if(!(m<=s))return;{if(!S){const x=m-l;if(x>.033){const K=c;c+=x;const ee=o;o+=x,i.push({previousEvent:t[d-1]||null,nextEvent:u,start:l,end:l+x,playout:{start:ee,end:o},integrated:{start:K,end:c}})}else x>0&&p&&(p.cumulativeDuration+=x,i[i.length-1].end=m)}h&&(k=C),u.timelineStart=C;const M=c;c+=y;const O=o;o+=_,i.push({event:u,start:C,end:k,playout:{start:O,end:o},integrated:{start:M,end:c}})}}const I=u.resumeTime;l=h||I>s?s:I}),l<s){var a;const d=c,f=s-l;c+=f;const h=o;o+=f,i.push({previousEvent:(null==(a=i[i.length-1])?void 0:a.event)||null,nextEvent:null,start:l,end:l+f,playout:{start:h,end:o},integrated:{start:d,end:c}})}this.setDurations(s,o,c)}else i.push({previousEvent:null,nextEvent:null,start:0,end:s,playout:{start:0,end:s},integrated:{start:0,end:s}}),this.setDurations(s,s,s);return i}setDurations(t,e,i){this.durations={primary:t,playout:e,integrated:i}}resolveOffsets(t,e){const i=e.main.details,r=i.live?1/0:i.edge;let s=0,o=-1;t.forEach((a,l)=>{const u=a.cue.post,d=a.cue.pre?0:u?r:a.startTime;this.updateAssetDurations(a),o===d?a.cumulativeDuration=s:(s=0,o=d),!u&&a.snapOptions.in&&(a.resumeAnchor=ga(null,i.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(a,e)||(a.appendInPlace=!1)),!a.appendInPlace&&l+1<t.length&&t[l+1].startTime-t[l].resumeTime<.033&&(t[l+1].appendInPlace=!1,t[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${a}`));const h=re(a.resumeOffset)?a.resumeOffset:a.duration;s+=h})}primaryCanResumeInPlaceAt(t,e){const i=t.resumeTime,r=t.startTime+t.resumptionOffset;return Math.abs(i-r)>ic?(this.log(`"${t.identifier}" resumption ${i} not aligned with estimated timeline end ${r}`),!1):!Object.keys(e).some(o=>{const a=e[o].details,l=a.edge;if(i>=l)return this.log(`"${t.identifier}" resumption ${i} past ${o} playlist end ${l}`),!1;const c=ga(null,a.fragments,i);if(!c)return this.log(`"${t.identifier}" resumption ${i} does not align with any fragments in ${o} playlist (${a.fragStart}-${a.fragmentEnd})`),!0;const u="audio"===o?.175:0;return!(Math.abs(c.start-i)<ic+u||Math.abs(c.end-i)<ic+u||(this.log(`"${t.identifier}" resumption ${i} not aligned with ${o} fragment bounds (${c.start}-${c.end} sn: ${c.sn} cc: ${c.cc})`),0))})}updateAssetDurations(t){if(!t.assetListLoaded)return;const e=t.timelineStart;let i=0,r=!1,s=!1;for(let o=0;o<t.assetList.length;o++){const a=t.assetList[o],l=e+i;a.startOffset=i,a.timelineStart=l,r||(r=null===a.duration),s||(s=!!a.error),i+=a.error?0:a.duration||0}t.duration=r&&!s?Math.max(i,t.duration):i}removeEvent(t){t.reset(),delete this.eventMap[t.identifier]}}function Sr(n){return`[${n.event?'"'+n.event.identifier+'"':"primary"}: ${n.start.toFixed(2)}-${n.end.toFixed(2)}]`}class cee{constructor(t){this.hls=void 0,this.hls=t}destroy(){this.hls=null}loadAssetList(t,e){const i=t.assetListUrl;let r;try{r=bP(i,this.hls.sessionId,t.baseUrl)}catch(f){const h=this.assignAssetListError(t,N.ASSET_LIST_LOAD_ERROR,f,i);return void this.hls.trigger(v.ERROR,h)}e&&"data:"!==r.protocol&&r.searchParams.set("_HLS_start_offset",""+e);const s=this.hls.config,a=new(0,s.loader)(s),c=s.interstitialAssetListLoadPolicy.default;return a.load({responseType:"json",url:r.href},{loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(f,h,p,g)=>{const m=f.data,_=m?.ASSETS;if(Array.isArray(_))t.assetListResponse=m,this.hls.trigger(v.ASSET_LIST_LOADED,{event:t,assetListResponse:m,networkDetails:g});else{const y=this.assignAssetListError(t,N.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),p.url,h,g);this.hls.trigger(v.ERROR,y)}},onError:(f,h,p,g)=>{const m=this.assignAssetListError(t,N.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${f.code} ${f.text} (${h.url})`),h.url,g,p);this.hls.trigger(v.ERROR,m)},onTimeout:(f,h,p)=>{const g=this.assignAssetListError(t,N.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${h.url})`),h.url,f,p);this.hls.trigger(v.ERROR,g)}}),this.hls.trigger(v.ASSET_LIST_LOADING,{event:t}),a}assignAssetListError(t,e,i,r,s,o){return t.error=i,{type:fe.NETWORK_ERROR,details:e,fatal:!1,interstitial:t,url:r,error:i,networkDetails:o,stats:s}}}function SP(n){var t;null==n||null==(t=n.play())||t.catch(()=>{})}function Cg(n,t){return`[${n}] Advancing timeline position to ${t}`}class fee{constructor(t){this.buffered=void 0;const e=(i,r,s)=>{if((r>>>=0)>s-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return t[r][i]};this.buffered={get length(){return t.length},end:i=>e("end",i,t.length),start:i=>e("start",i,t.length)}}}const hee={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},DP=n=>String.fromCharCode(hee[n]||n),Ps=100,pee={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},gee={17:2,18:4,21:6,22:8,23:10,19:13,20:15},mee={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},_ee={25:2,26:4,29:6,30:8,31:10,27:13,28:15},vee=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class yee{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){const i="function"==typeof e?e():e;ut.log(`${this.time} [${t}] ${i}`)}}}const va=function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].toString(16));return e};class CP{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const e=["foreground","underline","italics","background","flash"];for(let i=0;i<e.length;i++){const r=e[i];t.hasOwnProperty(r)&&(this[r]=t[r])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class bee{constructor(){this.uchar=" ",this.penState=new CP}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class Eee{constructor(t){this.chars=[],this.pos=0,this.currPenState=new CP,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<Ps;e++)this.chars.push(new bee);this.logger=t}equals(t){for(let e=0;e<Ps;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<Ps;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<Ps;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Ps&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Ps)}moveCursor(t){const e=this.pos+t;if(t>1)for(let i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const e=DP(t);this.pos>=Ps?this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))}clearFromPos(t){let e;for(e=t;e<Ps;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let e=!0;for(let i=0;i<Ps;i++){const r=this.chars[i].uchar;" "!==r&&(e=!1),t.push(r)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class F1{constructor(t){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<15;e++)this.rows.push(new Eee(t));this.logger=t}reset(){for(let t=0;t<15;t++)this.rows[t].clear();this.currRow=14}equals(t){let e=!0;for(let i=0;i<15;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e}copy(t){for(let e=0;e<15;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<15;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+It(t));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let a=0;a<15;a++)this.rows[a].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[s].cueStartTime,l=this.logger.time;if(null!==a&&null!==l&&a<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[e-this.nrRollUpRows+c+1].copy(o.rows[s+c])}}this.currRow=e;const i=this.rows[this.currRow];if(null!==t.indent){const o=Math.max(t.indent-1,0);i.setCursor(t.indent),t.color=i.chars[o].penState.foreground}this.setPen({foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1})}setBkgData(t){this.logger.log(2,()=>"bkgData = "+It(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const e=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const e=[];let i="",r=-1;for(let s=0;s<15;s++){const o=this.rows[s].getTextString();o&&(r=s+1,e.push(t?"Row "+r+": '"+o+"'":o.trim()))}return e.length>0&&(i=t?"["+e.join(" | ")+"]":e.join("\n")),i}getTextAndFormat(){return this.rows}}class IP{constructor(t,e,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new F1(i),this.nonDisplayedMemory=new F1(i),this.lastOutputScreen=new F1(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let i=0;i<t.length;i++)this.writeScreen.insertChar(t[i]);const e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>e+": "+this.writeScreen.getDisplayText(!0)),("MODE_PAINT-ON"===this.mode||"MODE_ROLL-UP"===this.mode)&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{const i=Math.floor(t/2)-16;e.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}this.logger.log(2,"MIDROW: "+It(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){const e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class wP{constructor(t,e,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const r=this.logger=new yee;this.channels=[null,new IP(t,e,r),new IP(t+1,i,r)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){this.logger.time=t;for(let i=0;i<e.length;i+=2){const r=127&e[i],s=127&e[i+1];let o=!1,a=null;if(0===r&&0===s)continue;this.logger.log(3,()=>"["+va([e[i],e[i+1]])+"] -> ("+va([r,s])+")");const l=this.cmdHistory;if(r>=16&&r<=31){if(See(r,s,l)){Ig(null,null,l),this.logger.log(3,()=>"Repeated command ("+va([r,s])+") is dropped");continue}Ig(r,s,this.cmdHistory),o=this.parseCmd(r,s),o||(o=this.parseMidrow(r,s)),o||(o=this.parsePAC(r,s)),o||(o=this.parseBackgroundAttributes(r,s))}else Ig(null,null,l);if(!o&&(a=this.parseChars(r,s),a)){const u=this.currentChannel;u&&u>0?this.channels[u].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+va([r,s])+" orig: "+va([e[i],e[i+1]]))}}parseCmd(t,e){if(!((20===t||28===t||21===t||29===t)&&e>=32&&e<=47||(23===t||31===t)&&e>=33&&e<=35))return!1;const s=20===t||21===t||23===t?1:2,o=this.channels[s];return 20===t||21===t||28===t||29===t?32===e?o.ccRCL():33===e?o.ccBS():34===e?o.ccAOF():35===e?o.ccAON():36===e?o.ccDER():37===e?o.ccRU(2):38===e?o.ccRU(3):39===e?o.ccRU(4):40===e?o.ccFON():41===e?o.ccRDC():42===e?o.ccTR():43===e?o.ccRTD():44===e?o.ccEDM():45===e?o.ccCR():46===e?o.ccENM():47===e&&o.ccEOC():o.ccTO(e-32),this.currentChannel=s,!0}parseMidrow(t,e){let i=0;if((17===t||25===t)&&e>=32&&e<=47){if(i=17===t?1:2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[i];return!!r&&(r.ccMIDROW(e),this.logger.log(3,()=>"MIDROW ("+va([t,e])+")"),!0)}return!1}parsePAC(t,e){let i;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127||(16===t||24===t)&&e>=64&&e<=95))return!1;const o=t<=23?1:2;i=e>=64&&e<=95?1===o?pee[t]:mee[t]:1===o?gee[t]:_ee[t];const a=this.channels[o];return!!a&&(a.setPAC(this.interpretPAC(i,e)),this.currentChannel=o,!0)}interpretPAC(t,e){let i;const r={color:null,italics:!1,indent:null,underline:!1,row:t};return i=e>95?e-96:e-64,r.underline=!(1&~i),i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((i-16)/2),r}parseChars(t,e){let i,r=null,s=null;if(t>=25?(i=2,s=t-8):(i=1,s=t),s>=17&&s<=19){let o;o=17===s?e+80:18===s?e+112:e+144,this.logger.log(2,()=>"Special char '"+DP(o)+"' in channel "+i),r=[o]}else t>=32&&t<=127&&(r=0===e?[t]:[t,e]);return r&&this.logger.log(3,()=>"Char codes =  "+va(r).join(",")),r}parseBackgroundAttributes(t,e){if(!((16===t||24===t)&&e>=32&&e<=47||(23===t||31===t)&&e>=45&&e<=47))return!1;let s;const o={};return 16===t||24===t?(s=Math.floor((e-32)/2),o.background=vee[s],e%2==1&&(o.background=o.background+"_semi")):45===e?o.background="transparent":(o.foreground="black",47===e&&(o.underline=!0)),this.channels[t<=23?1:2].setBkgData(o),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const e=this.channels[t];e&&e.reset()}Ig(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){const i=this.channels[e];i&&i.cueSplitAtTime(t)}}}function Ig(n,t,e){e.a=n,e.b=t}function See(n,t,e){return e.a===n&&e.b===t}var B1=function(){if(null!=lg&&lg.VTTCue)return self.VTTCue;const n=["","lr","rl"],t=["start","middle","end","left","right"];function e(a,l){if("string"!=typeof l||!Array.isArray(a))return!1;const c=l.toLowerCase();return!!~a.indexOf(c)&&c}function r(a){return e(t,a)}function s(a,...l){let c=1;for(;c<arguments.length;c++){const u=arguments[c];for(const d in u)a[d]=u[d]}return a}function o(a,l,c){const u=this,d={enumerable:!0};u.hasBeenReset=!1;let f="",h=!1,p=a,g=l,m=c,_=null,y="",b=!0,S="auto",C="start",k=50,I="middle",M=50,O="middle";Object.defineProperty(u,"id",s({},d,{get:function(){return f},set:function(x){f=""+x}})),Object.defineProperty(u,"pauseOnExit",s({},d,{get:function(){return h},set:function(x){h=!!x}})),Object.defineProperty(u,"startTime",s({},d,{get:function(){return p},set:function(x){if("number"!=typeof x)throw new TypeError("Start time must be set to a number.");p=x,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",s({},d,{get:function(){return g},set:function(x){if("number"!=typeof x)throw new TypeError("End time must be set to a number.");g=x,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",s({},d,{get:function(){return m},set:function(x){m=""+x,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",s({},d,{get:function(){return _},set:function(x){_=x,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",s({},d,{get:function(){return y},set:function(x){const B=function i(a){return e(n,a)}(x);if(!1===B)throw new SyntaxError("An invalid or illegal string was specified.");y=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",s({},d,{get:function(){return b},set:function(x){b=!!x,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",s({},d,{get:function(){return S},set:function(x){if("number"!=typeof x&&"auto"!==x)throw new SyntaxError("An invalid number or illegal string was specified.");S=x,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",s({},d,{get:function(){return C},set:function(x){const B=r(x);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");C=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",s({},d,{get:function(){return k},set:function(x){if(x<0||x>100)throw new Error("Position must be between 0 and 100.");k=x,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",s({},d,{get:function(){return I},set:function(x){const B=r(x);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");I=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",s({},d,{get:function(){return M},set:function(x){if(x<0||x>100)throw new Error("Size must be between 0 and 100.");M=x,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",s({},d,{get:function(){return O},set:function(x){const B=r(x);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");O=B,this.hasBeenReset=!0}})),u.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class Dee{decode(t,e){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function xP(n){function t(i,r,s,o){return 3600*(0|i)+60*(0|r)+(0|s)+parseFloat(o||0)}const e=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return e?parseFloat(e[2])>59?t(e[2],e[3],0,e[4]):t(e[1],e[2],e[3],e[4]):null}class Cee{constructor(){this.values=Object.create(null)}set(t,e){!this.get(t)&&""!==e&&(this.values[t]=e)}get(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,i){for(let r=0;r<i.length;++r)if(e===i[r]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){const i=parseFloat(e);if(i>=0&&i<=100)return this.set(t,i),!0}return!1}}function AP(n,t,e,i){const r=i?n.split(i):[n];for(const s in r){if("string"!=typeof r[s])continue;const o=r[s].split(e);2===o.length&&t(o[0],o[1])}}const U1=new B1(0,0,""),wg="middle"===U1.align?"middle":"center";function Iee(n,t,e){const i=n;function r(){const a=xP(n);if(null===a)throw new Error("Malformed timestamp: "+i);return n=n.replace(/^[^\sa-zA-Z-]+/,""),a}function o(){n=n.replace(/^\s+/,"")}if(o(),t.startTime=r(),o(),"--\x3e"!==n.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);n=n.slice(3),o(),t.endTime=r(),o(),function s(a,l){const c=new Cee;AP(a,function(f,h){let p;switch(f){case"region":for(let g=e.length-1;g>=0;g--)if(e[g].id===h){c.set(f,e[g].region);break}break;case"vertical":c.alt(f,h,["rl","lr"]);break;case"line":p=h.split(","),c.integer(f,p[0]),c.percent(f,p[0])&&c.set("snapToLines",!1),c.alt(f,p[0],["auto"]),2===p.length&&c.alt("lineAlign",p[1],["start",wg,"end"]);break;case"position":p=h.split(","),c.percent(f,p[0]),2===p.length&&c.alt("positionAlign",p[1],["start",wg,"end","line-left","line-right","auto"]);break;case"size":c.percent(f,h);break;case"align":c.alt(f,h,["start",wg,"end","left","right"])}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let u=c.get("line","auto");"auto"===u&&-1===U1.line&&(u=-1),l.line=u,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",wg);let d=c.get("position","auto");"auto"===d&&50===U1.position&&(d="start"===l.align||"left"===l.align?0:"end"===l.align||"right"===l.align?100:50),l.position=d}(n,t)}function MP(n){return n.replace(/<br(?: \/)?>/gi,"\n")}class wee{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Dee,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const e=this;function i(){let s=e.buffer,o=0;for(s=MP(s);o<s.length&&"\r"!==s[o]&&"\n"!==s[o];)++o;const a=s.slice(0,o);return"\r"===s[o]&&++o,"\n"===s[o]&&++o,e.buffer=s.slice(o),a}function r(s){AP(s,function(o,a){},/:/)}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{let s="";if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;s=i();const a=s.match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==a||!a[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let o=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(o?o=!1:s=i(),e.state){case"HEADER":/:/.test(s)?r(s):s||(e.state="ID");continue;case"NOTE":s||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){e.state="NOTE";break}if(!s)continue;if(e.cue=new B1(0,0,""),e.state="CUE",-1===s.indexOf("--\x3e")){e.cue.id=s;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{Iee(s,e.cue,e.regionList)}catch{e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{const a=-1!==s.indexOf("--\x3e");if(!s||a&&(o=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(null===e.cue)continue;e.cue.text&&(e.cue.text+="\n"),e.cue.text+=s}continue;case"BADCUE":s||(e.state="ID")}}}catch{"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state||"BADWEBVTT"===t.state)throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this}}const xee=/\r\n|\n\r|\n|\r/g,$1=function(t,e,i=0){return t.slice(i,i+e.length)===e};function V1(n,t,e){return Id(n.toString())+Id(t.toString())+Id(e)}const j1="stpp.ttml.im1t",RP=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,kP=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,kee={left:"start",center:"center",right:"end",start:"start",end:"end"};function OP(n,t,e,i){const r=He(new Uint8Array(n),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map(a=>xi(a)),o=function BX(n,t,e=1,i=!1){return S1(n,t,1/e,i)}(t.baseTime,1,t.timescale);try{s.forEach(a=>e(function Oee(n,t){const r=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((d,f)=>(d[f]=r.getAttribute(`ttp:${f}`)||s[f],d),{}),a="preserve"!==r.getAttribute("xml:space"),l=NP(H1(r,"styling","style")),c=NP(H1(r,"layout","region")),u=H1(r,"body","[begin]");return[].map.call(u,d=>{const f=PP(d,a);if(!f||!d.hasAttribute("begin"))return null;const h=z1(d.getAttribute("begin"),o),p=z1(d.getAttribute("dur"),o);let g=z1(d.getAttribute("end"),o);if(null===h)throw LP(d);if(null===g){if(null===p)throw LP(d);g=h+p}const m=new B1(h-t,g-t,f);m.id=V1(m.startTime,m.endTime,m.text);const b=function Nee(n,t,e){const i="http://www.w3.org/ns/ttml#styling";let r=null;const o=null!=n&&n.hasAttribute("style")?n.getAttribute("style"):null;return o&&e.hasOwnProperty(o)&&(r=e[o]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((a,l)=>{const c=G1(t,i,l)||G1(n,i,l)||G1(r,i,l);return c&&(a[l]=c),a},{})}(c[d.getAttribute("region")],l[d.getAttribute("style")],l),{textAlign:S}=b;if(S){const C=kee[S];C&&(m.lineAlign=C),m.align=S}return vt(m,b),m}).filter(d=>null!==d)}(a,o)))}catch(a){i(a)}}function H1(n,t,e){const i=n.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(e)):[]}function NP(n){return n.reduce((t,e)=>{const i=e.getAttribute("xml:id");return i&&(t[i]=e),t},{})}function PP(n,t){return[].slice.call(n.childNodes).reduce((e,i,r)=>{var s;return"br"===i.nodeName&&r?e+"\n":null!=(s=i.childNodes)&&s.length?PP(i,t):t?e+i.textContent.trim().replace(/\s+/g," "):e+i.textContent},"")}function G1(n,t,e){return n&&n.hasAttributeNS(t,e)?n.getAttributeNS(t,e):null}function LP(n){return new Error(`Could not parse ttml timestamp ${n}`)}function z1(n,t){if(!n)return null;let e=xP(n);return null===e&&(RP.test(n)?e=function Pee(n,t){const e=RP.exec(n);return 3600*(0|e[1])+60*(0|e[2])+(0|e[3])+((0|e[4])+(0|e[5])/t.subFrameRate)/t.frameRate}(n,t):kP.test(n)&&(e=function Lee(n,t){const e=kP.exec(n),i=Number(e[1]);switch(e[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(n,t))),e}class xg{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,i){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}function FP(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function BP(n,t){return!!n&&n.kind===FP(t)&&I1(t,n)}function Bee(n,t,e,i){return Math.min(t,i)-Math.max(n,e)}const Uee=/\s/,$ee={newCue(n,t,e,i){const r=[];let s,o,a,l,c;const u=self.VTTCue||self.TextTrackCue;for(let f=0;f<i.rows.length;f++)if(s=i.rows[f],a=!0,l=0,c="",!s.isEmpty()){var d;for(let g=0;g<s.chars.length;g++)Uee.test(s.chars[g].uchar)&&a?l++:(c+=s.chars[g].uchar,a=!1);s.cueStartTime=t,t===e&&(e+=1e-4),l>=16?l--:l++;const h=MP(c.trim()),p=V1(t,e,h);null!=n&&null!=(d=n.cues)&&d.getCueById(p)||(o=new u(t,e,h),o.id=p,o.line=f+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(o))}return n&&r.length&&(r.sort((f,h)=>"auto"===f.line||"auto"===h.line?0:f.line>8&&h.line>8?h.line-f.line:f.line-h.line),r.forEach(f=>yP(n,f))),r}},jee=/(\d+)-(\d+)\/(\d+)/;class $P{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||Wee,this.controller=new self.AbortController,this.stats=new jb}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,i){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=function Hee(n,t){const e={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(vt({},n.headers))};return n.rangeEnd&&e.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),e}(t,this.controller.signal),o="arraybuffer"===t.responseType,a=o?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:c}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,s),self.clearTimeout(this.requestTimeout),e.timeout=l&&re(l)?l:c,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,t,this.response))},e.timeout),(Dd(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(d=>{var f;this.response=this.loader=d;const h=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,t,this.response))},c-(h-r.loading.start)),!d.ok){const{status:g,statusText:m}=d;throw new Kee(m||"fetch, bad network response",g,d)}r.loading.first=h,r.total=function zee(n){const t=n.get("Content-Range");if(t){const i=function Gee(n){const t=jee.exec(n);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(re(i))return i}const e=n.get("Content-Length");if(e)return parseInt(e)}(d.headers)||r.total;const p=null==(f=this.callbacks)?void 0:f.onProgress;return p&&re(e.highWaterMark)?this.loadProgressively(d,r,t,e.highWaterMark,p):o?d.arrayBuffer():"json"===t.responseType?d.json():d.text()}).then(d=>{var f,h;const p=this.response;if(!p)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const g=d[a];g&&(r.loaded=r.total=g);const m={url:p.url,data:d,code:p.status},_=null==(f=this.callbacks)?void 0:f.onProgress;_&&!re(e.highWaterMark)&&_(r,t,d,p),null==(h=this.callbacks)||h.onSuccess(m,r,t,p)}).catch(d=>{var f;self.clearTimeout(this.requestTimeout),r.aborted||null==(f=this.callbacks)||f.onError({code:d&&d.code||0,text:d?d.message:null},t,d?d.details:null,r)})}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,i,r=0,s){const o=new DN,a=t.body.getReader(),l=()=>a.read().then(c=>{if(c.done)return o.dataLength&&s(e,i,o.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));const u=c.value,d=u.length;return e.loaded+=d,d<r||o.dataLength?(o.push(u),o.dataLength>=r&&s(e,i,o.flush().buffer,t)):s(e,i,u.buffer,t),l()}).catch(()=>Promise.reject());return l()}}function Wee(n,t){return new self.Request(n.url,t)}class Kee extends Error{constructor(t,e,i){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=i}}const qee=/^age:\s*[\d.]+\s*$/im;class VP{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new jb,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t||!e)return;const i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(this.loader===i&&!this.stats.aborted)return s(i,e.url)}).catch(o=>{if(this.loader===i&&!this.stats.aborted)return i.open("GET",e.url,!0),s(i,e.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,e,t)}).catch(o=>{var a;null==(a=this.callbacks)||a.onError({code:i.status,text:o.message},e,i,r)}):this.openAndSendXhr(i,e,t)}openAndSendXhr(t,e,i){t.readyState||t.open("GET",e.url,!0);const r=e.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=i.loadPolicy;if(r)for(const a in r)t.setRequestHeader(a,r[a]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),i.timeout=s&&re(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),t.send()}readystatechange(){const{context:t,loader:e,stats:i}=this;if(!t||!e)return;const r=e.readyState,s=this.config;if(!i.aborted&&r>=2&&(0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),4===r)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;const c=e.status;if(c>=200&&c<300){const p=("text"===e.responseType?e.responseText:null)??e.response;if(null!=p){var o,a;i.loading.end=Math.max(self.performance.now(),i.loading.first),i.loaded=i.total="arraybuffer"===e.responseType?p.byteLength:p.length,i.bwEstimate=8e3*i.total/(i.loading.end-i.loading.first);const m=null==(o=this.callbacks)?void 0:o.onProgress;return m&&m(i,t,p,e),void(null==(a=this.callbacks)||a.onSuccess({url:e.responseURL,data:p,code:c},i,t,e))}}const d=s.loadPolicy.errorRetry;var l;rg(d,i.retry,!1,{url:t.url,data:void 0,code:c})?this.retry(d):(ut.error(`${c} while loading ${t.url}`),null==(l=this.callbacks)||l.onError({code:c,text:e.statusText},t,e,i))}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry;if(rg(t,this.stats.retry,!0))this.retry(t);else{var i;ut.warn(`timeout while loading ${null==(i=this.context)?void 0:i.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:e,stats:i}=this;this.retryDelay=Zb(t,i.retry),i.retry++,ut.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${e?.url}, retrying ${i.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&qee.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const Qee=ct(ct({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:VP,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class uZ extends er{constructor(t){super("abr",t.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var i;const{fragCurrent:r,partCurrent:s,hls:o}=this,{autoLevelEnabled:a,media:l}=o;if(!r||!l)return;const c=performance.now(),u=s?s.stats:r.stats,d=s?s.duration:r.duration,f=c-u.loading.start,h=o.minAutoLevel,p=r.level,g=this._nextAutoLevel;if(u.aborted||u.loaded&&u.loaded===u.total||p<=h)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!a)return;const m=g>-1&&g!==p,_=!!e||m;if(!_&&(l.paused||!l.playbackRate||!l.readyState))return;const y=o.mainForwardBufferInfo;if(!_&&null===y)return;const b=this.bwEstimator.getEstimateTTFB(),S=Math.abs(l.playbackRate);if(f<=Math.max(b,d/(2*S)*1e3))return;const C=y?y.len/S:0,k=u.loading.first?u.loading.first-u.loading.start:-1,I=u.loaded&&k>-1,M=this.getBwEstimate(),O=o.levels,B=Math.max(u.loaded,Math.round(d*(r.bitrate||O[p].averageBitrate)/8));let K=I?f-k:f;K<1&&I&&(K=Math.min(f,8*u.loaded/M));const ee=I?1e3*u.loaded/K:0,oe=b/1e3,se=ee?(B-u.loaded)/ee:8*B/M+oe;if(se<=C)return;const G=ee?8*ee:M,ie=!0===(null==(i=e?.details||this.hls.latestLevelDetails)?void 0:i.live),te=this.hls.config.abrBandWidthUpFactor;let ge,ae=Number.POSITIVE_INFINITY;for(ge=p-1;ge>h&&(ae=this.getTimeToLoadFrag(oe,G,d*O[ge].maxBitrate,!O[ge].details||ie),!(ae<Math.min(C,d+oe)));ge--);if(ae>=se||ae>10*d)return;I?this.bwEstimator.sample(f-Math.min(b,k),u.loaded):this.bwEstimator.sampleTTFB(f);const Z=O[ge].maxBitrate;this.getBwEstimate()*te>Z&&this.resetEstimator(Z);const q=this.findBestLevel(Z,h,ge,0,C,1,1);q>-1&&(ge=q),this.warn(`Fragment ${r.sn}${s?" part "+s.index:""} of level ${p} is loading too slowly;\n      Fragment duration: ${r.duration.toFixed(3)}\n      Time to underbuffer: ${C.toFixed(3)} s\n      Estimated load time for current fragment: ${se.toFixed(3)} s\n      Estimated load time for down switch fragment: ${ae.toFixed(3)} s\n      TTFB estimate: ${0|k} ms\n      Current BW estimate: ${re(M)?0|M:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${ge} @ ${0|Z} bps`),o.nextLoadLevel=o.nextAutoLevel=ge,this.clearTimer();const Re=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===ge&&ge>0){const We=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${ge>0?"and switching down":""}\n      Fragment duration: ${r.duration.toFixed(3)} s\n      Time to underbuffer: ${We.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,ge>h){let Te=this.findBestLevel(this.hls.levels[h].bitrate,h,ge,0,We,1,1);-1===Te&&(Te=h),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Te,this.resetEstimator(this.hls.levels[Te].bitrate)}}};m||se>2*ae?Re():this.timer=self.setInterval(Re,1e3*ae),o.trigger(v.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:s,stats:u})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(this.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new gQ(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.FRAG_LOADING,this.onFragLoading,this),t.on(v.FRAG_LOADED,this.onFragLoaded,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this),t.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(v.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.FRAG_LOADING,this.onFragLoading,this),t.off(v.FRAG_LOADED,this.onFragLoaded,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this),t.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(v.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(v.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){const i=e.frag;var r;this.ignoreFragment(i)||(i.bitrateTest||(this.fragCurrent=i,this.partCurrent=null!=(r=e.part)?r:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100))}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case N.BUFFER_ADD_CODEC_ERROR:case N.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case N.FRAG_LOAD_TIMEOUT:{const i=e.frag,{fragCurrent:r,partCurrent:s}=this;if(i&&r&&i.sn===r.sn&&i.level===r.level){const o=performance.now(),a=s?s.stats:i.stats,l=o-a.loading.start,c=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&c>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,c),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(t,e,i,r){return t+i/e+(r?t+this.lastLevelLoadSec:0)}onLevelLoaded(t,e){const i=this.hls.config,{loading:r}=e.stats,s=r.end-r.first;re(s)&&(this.lastLevelLoadSec=s/1e3),e.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(e.levelInfo)}onFragLoaded(t,{frag:e,part:i}){const r=i?i.stats:e.stats;if("main"===e.type&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(e)){if(this.clearTimer(),e.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const o=this.hls.levels[e.level],a=(o.loaded?o.loaded.bytes:0)+r.loaded,l=(o.loaded?o.loaded.duration:0)+(i?i.duration:e.duration);o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}e.bitrateTest?(this.onFragBuffered(v.FRAG_BUFFERED,{stats:r,frag:e,part:i,id:e.type}),e.bitrateTest=!1):this.lastLoadedFragLevel=e.level}}onFragBuffered(t,e){const{frag:i,part:r}=e,s=null!=r&&r.stats.loaded?r.stats:i.stats;if(s.aborted||this.ignoreFragment(i))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.getBwEstimate(),this.bitrateTestDelay=i.bitrateTest?o/1e3:0}ignoreFragment(t){return"main"!==t.type||"initSegment"===t.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:e}=this.hls,i=this.getBwEstimate(),s=this.findBestLevel(i,e,t,0,this.hls.config.maxStarvationDelay,1,1);if(s>-1)return s;const o=this.hls.firstLevel,a=Math.min(Math.max(o,e),t);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(!(-1===t||i&&r&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return t;const s=i&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==t){const o=this.hls.levels;if(o.length>Math.max(t,s)&&o[t].loadError<=o[s].loadError)return t}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:r,config:s,minAutoLevel:o}=i,a=e?e.duration:t?t.duration:0,l=this.getBwEstimate(),c=this.getStarvationDelay();let u=s.abrBandWidthFactor,d=s.abrBandWidthUpFactor;if(c){const m=this.findBestLevel(l,o,r,c,0,u,d);if(m>=0)return this.rebufferNotice=-1,m}let f=a?Math.min(a,s.maxStarvationDelay):s.maxStarvationDelay;if(!c){const m=this.bitrateTestDelay;m&&(f=(a?Math.min(a,s.maxLoadingDelay):s.maxLoadingDelay)-m,this.info(`bitrate test took ${Math.round(1e3*m)}ms, set first fragment max fetchDuration to ${Math.round(1e3*f)} ms`),u=d=1)}const h=this.findBestLevel(l,o,r,c,f,u,d);if(this.rebufferNotice!==h&&(this.rebufferNotice=h,this.info(`${c?"rebuffering expected":"buffer is empty"}, optimal quality level ${h}`)),h>-1)return h;const p=i.levels[o],g=i.loadLevelObj;return g&&p?.bitrate<g.bitrate?o:i.loadLevel}getStarvationDelay(){const t=this.hls,e=t.media;if(!e)return 1/0;const i=e&&0!==e.playbackRate?Math.abs(e.playbackRate):1,r=t.mainForwardBufferInfo;return(r?r.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,i,r,s,o,a){var l;const c=r+s,u=this.lastLoadedFragLevel,d=-1===u?this.hls.firstLevel:u,{fragCurrent:f,partCurrent:h}=this,{levels:p,allAudioTracks:g,loadLevel:m,config:_}=this.hls;if(1===p.length)return 0;const y=p[d],b=!(null==(l=this.hls.latestLevelDetails)||!l.live),S=-1===m||-1===u;let C,k="SDR",I=y?.frameRate||0;const{audioPreference:M,videoPreference:O}=_,x=this.audioTracksByGroup||(this.audioTracksByGroup=xO(g));let B=-1;if(S){if(-1!==this.firstSelection)return this.firstSelection;const G=this.codecTiers||(this.codecTiers=function oZ(n,t,e,i){return n.slice(e,i+1).reduce((r,s,o)=>{if(!s.codecSet)return r;const a=s.audioGroups;let l=r[s.codecSet];l||(r[s.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,s.bitrate);const c=Math.min(s.height,s.width);return l.minHeight=Math.min(l.minHeight,c),l.minFramerate=Math.min(l.minFramerate,s.frameRate),l.minIndex=Math.min(l.minIndex,o),l.maxScore=Math.max(l.maxScore,s.score),l.fragmentError+=s.fragmentError,l.videoRanges[s.videoRange]=(l.videoRanges[s.videoRange]||0)+1,a&&a.forEach(u=>{if(!u)return;const d=t.groups[u];d&&(l.hasDefaultAudio=l.hasDefaultAudio||t.hasDefaultAudio?d.hasDefault:d.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(d.channels).forEach(f=>{l.channels[f]=(l.channels[f]||0)+d.channels[f]}))}),r},{})}(p,x,e,i)),ie=function sZ(n,t,e,i,r){const s=Object.keys(n),o=i?.channels,a=i?.audioCodec,l=r?.videoCodec,c=o&&2===parseInt(o);let u=!1,d=!1,f=1/0,h=1/0,p=1/0,g=1/0,m=0,_=[];const{preferHDR:y,allowedVideoRanges:b}=function iZ(n,t){let e=!1,i=[];if(n&&(e="SDR"!==n,i=[n]),t){i=t.allowedVideoRanges||eg.slice(0);const r="SDR"!==i.join("")&&!t.videoCodec;e=void 0!==t.preferHDR?t.preferHDR:r&&function nZ(){if("function"==typeof matchMedia){const n=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(n.media!==t.media)return!0===n.matches}return!1}(),e||(i=["SDR"])}return{preferHDR:e,allowedVideoRanges:i}}(t,r);for(let M=s.length;M--;){const O=n[s[M]];u||(u=O.channels[2]>0),f=Math.min(f,O.minHeight),h=Math.min(h,O.minFramerate),p=Math.min(p,O.minBitrate),b.filter(B=>O.videoRanges[B]>0).length>0&&(d=!0)}f=re(f)?f:0,h=re(h)?h:0;const S=Math.max(1080,f),C=Math.max(30,h);p=re(p)?p:e,e=Math.max(p,e),d||(t=void 0);const k=s.length>1;return{codecSet:s.reduce((M,O)=>{const x=n[O];if(O===M)return M;if(_=d?b.filter(B=>x.videoRanges[B]>0):[],k){if(x.minBitrate>e)return Qr(O,`min bitrate of ${x.minBitrate} > current estimate of ${e}`),M;if(!x.hasDefaultAudio)return Qr(O,"no renditions with default or auto-select sound found"),M;if(a&&O.indexOf(a.substring(0,4))%5!=0)return Qr(O,`audio codec preference "${a}" not found`),M;if(o&&!c){if(!x.channels[o])return Qr(O,`no renditions with ${o} channel sound found (channels options: ${Object.keys(x.channels)})`),M}else if((!a||c)&&u&&0===x.channels[2])return Qr(O,"no renditions with stereo sound found"),M;if(x.minHeight>S)return Qr(O,`min resolution of ${x.minHeight} > maximum of ${S}`),M;if(x.minFramerate>C)return Qr(O,`min framerate of ${x.minFramerate} > maximum of ${C}`),M;if(!_.some(B=>x.videoRanges[B]>0))return Qr(O,`no variants with VIDEO-RANGE of ${It(_)} found`),M;if(l&&O.indexOf(l.substring(0,4))%5!=0)return Qr(O,`video codec preference "${l}" not found`),M;if(x.maxScore<m)return Qr(O,`max score of ${x.maxScore} < selected max of ${m}`),M}return M&&(Zp(O)>=Zp(M)||x.fragmentError>n[M].fragmentError)?M:(g=x.minIndex,m=x.maxScore,O)},void 0),videoRanges:_,preferHDR:y,minFramerate:h,minBitrate:p,minIndex:g}}(G,k,t,M,O),{codecSet:te,videoRanges:ae,minFramerate:ge,minBitrate:Z,minIndex:q,preferHDR:Re}=ie;B=q,C=te,k=Re?ae[ae.length-1]:ae[0],I=ge,t=Math.max(t,Z),this.log(`picked start tier ${It(ie)}`)}else C=y?.codecSet,k=y?.videoRange;const K=h?h.duration:f?f.duration:0,ee=this.bwEstimator.getEstimateTTFB()/1e3,oe=[];for(let G=i;G>=e;G--){var se;const ie=p[G],te=G>d;if(!ie)continue;if(_.useMediaCapabilities&&!ie.supportedResult&&!ie.supportedPromise){const Te=navigator.mediaCapabilities;"function"==typeof Te?.decodingInfo&&YQ(ie,x,k,I,t,M)?(ie.supportedPromise=TO(ie,x,Te,this.supportedCache),ie.supportedPromise.then(Be=>{if(!this.hls)return;ie.supportedResult=Be;const Xt=this.hls.levels,kt=Xt.indexOf(ie);Be.error?this.warn(`MediaCapabilities decodingInfo error: "${Be.error}" for level ${kt} ${It(Be)}`):Be.supported?Be.decodingInfoResults.some(Un=>!1===Un.smooth||!1===Un.powerEfficient)&&this.log(`MediaCapabilities decodingInfo for level ${kt} not smooth or powerEfficient: ${It(Be)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${kt} ${It(Be)}`),kt>-1&&Xt.length>1&&(this.log(`Removing unsupported level ${kt}`),this.hls.removeLevel(kt),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))}).catch(Be=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${Be}`)})):ie.supportedResult=EO}if((C&&ie.codecSet!==C||k&&ie.videoRange!==k||te&&I>ie.frameRate||!te&&I>0&&I<ie.frameRate||null!=(se=ie.supportedResult)&&null!=(se=se.decodingInfoResults)&&se.some(Te=>!1===Te.smooth))&&(!S||G!==B)){oe.push(G);continue}const ae=ie.details,ge=(h?ae?.partTarget:ae?.averagetargetduration)||K;let Z;Z=te?a*t:o*t;const q=K&&r>=2*K&&0===s?ie.averageBitrate:ie.maxBitrate,Re=this.getTimeToLoadFrag(ee,Z,q*ge,void 0===ae);if(Z>=q&&(G===u||0===ie.loadError&&0===ie.fragmentError)&&(Re<=ee||!re(Re)||b&&!this.bitrateTestDelay||Re<c)){const Te=this.forcedAutoLevel;return G!==m&&(-1===Te||Te!==m)&&(oe.length&&this.trace(`Skipped level(s) ${oe.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${p[oe[0]].codecs}" ${p[oe[0]].videoRange}; not compatible with "${C}" ${k}`),this.info(`switch candidate:${d}->${G} adjustedbw(${Math.round(Z)})-bitrate=${Math.round(Z-q)} ttfb:${ee.toFixed(1)} avgDuration:${ge.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${Re.toFixed(1)} firstSelection:${S} codecSet:${ie.codecSet} videoRange:${ie.videoRange} hls.loadLevel:${m}`)),S&&(this.firstSelection=G),G}}return-1}set nextAutoLevel(t){const e=this.deriveNextAutoLevel(t);this._nextAutoLevel!==e&&(this.nextAutoLevelKey="",this._nextAutoLevel=e)}deriveNextAutoLevel(t){const{maxAutoLevel:e,minAutoLevel:i}=this.hls;return Math.min(Math.max(t,i),e)}},bufferController:class eJ extends er{constructor(t,e){super("buffer-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var r;this.hls&&"open"===(null==(r=this.mediaSource)?void 0:r.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:r,mediaSource:s}=this;i&&this.log("Media source opened"),r&&s&&(s.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(v.MEDIA_ATTACHED,{media:r,mediaSource:s}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:r}=this;i!==r&&this.error(`Media element src was set while attaching MediaSource (${r} > ${i})`)},this.hls=t,this.fragmentTracker=e,this.appendSource=function SQ(n){return typeof self<"u"&&n===self.ManagedMediaSource}(po(t.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.BUFFER_RESET,this.onBufferReset,this),t.on(v.BUFFER_APPENDING,this.onBufferAppending,this),t.on(v.BUFFER_CODECS,this.onBufferCodecs,this),t.on(v.BUFFER_EOS,this.onBufferEos,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(v.FRAG_PARSED,this.onFragParsed,this),t.on(v.FRAG_CHANGED,this.onFragChanged,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.BUFFER_RESET,this.onBufferReset,this),t.off(v.BUFFER_APPENDING,this.onBufferAppending,this),t.off(v.BUFFER_CODECS,this.onBufferCodecs,this),t.off(v.BUFFER_EOS,this.onBufferEos,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(v.FRAG_PARSED,this.onFragParsed,this),t.off(v.FRAG_CHANGED,this.onFragChanged,this),t.off(v.ERROR,this.onError,this)}transferMedia(){const{media:t,mediaSource:e}=this;if(!t)return null;const i={};if(this.operationQueue){const s=this.isUpdating();s||this.operationQueue.removeBlockers();const o=this.isQueued();(s||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${s?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const r=this.transferData;return!this.sourceBufferCount&&r&&r.mediaSource===e?vt(i,r.tracks):this.sourceBuffers.forEach(s=>{const[o]=s;o&&(i[o]=vt({},this.tracks[o]),this.removeBuffer(o)),s[0]=s[1]=null}),{media:t,mediaSource:e,tracks:i}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){var i;let r=2;(e.audio&&!e.video||!e.altAudio)&&(r=1),this.bufferCodecEventsTotal=r,this.log(`${r} bufferCodec event(s) expected.`),null!=(i=this.transferData)&&i.mediaSource&&this.sourceBufferCount&&r&&this.bufferCreated()}onMediaAttaching(t,e){const i=this.media=e.media;this.transferData=this.overrides=void 0;const r=po(this.appendSource);if(r){const s=!!e.mediaSource;(s||e.overrides)&&(this.transferData=e,this.overrides=e.overrides);const o=this.mediaSource=e.mediaSource||new r;if(this.assignMediaSource(o),s)this._objectUrl=i.src,this.attachTransferred();else{const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{i.removeAttribute("src");const l=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||l&&o instanceof l,tP(i),function tJ(n,t){const e=self.document.createElement("source");e.type="video/mp4",e.src=t,n.appendChild(e)}(i,a),i.load()}catch{i.src=a}else i.src=a}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(t){var e,i;this.log(`${(null==(e=this.transferData)?void 0:e.mediaSource)===t?"transferred":"created"} media source: ${null==(i=t.constructor)?void 0:i.name}`),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const t=this.media,e=this.transferData;if(!e||!t)return;const i=this.tracks,r=e.tracks,s=r?Object.keys(r):null,a=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(r&&s&&s&&s.length){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${It(i,(l,c)=>"initSegment"===l?void 0:c)};\ntransfer tracks: ${It(r,(l,c)=>"initSegment"===l?void 0:c)}}`),!nO(r,i)){e.mediaSource=null,e.tracks=void 0;const l=t.currentTime,c=this.details,u=Math.max(l,c?.fragments[0].start||0);return u-l>1?void this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${u}`):(this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(r)}"->"${Object.keys(i)}") start time: ${u} currentTime: ${l}`),this.onMediaDetaching(v.MEDIA_DETACHING,{}),this.onMediaAttaching(v.MEDIA_ATTACHING,e),void(t.currentTime=u))}this.transferData=void 0,s.forEach(l=>{const c=l,u=r[c];if(u){const d=u.buffer;if(d){const f=this.fragmentTracker,h=u.id;if(f.hasFragments(h)||f.hasParts(h)){const m=Me.getBuffered(d);f.detectEvictedFragments(c,m,h,null,!0)}const p=w1(c);this.sourceBuffers[p]=[c,d],d.updating&&this.operationQueue&&this.operationQueue.prependBlocker(c),this.trackSourceBuffer(c,u)}}}),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var t;const e=null==(t=this.mediaSource)?void 0:t.readyState;return"open"===e||"ended"===e}onMediaDetaching(t,e){const i=!!e.transferMedia;this.transferData=this.overrides=void 0;const{media:r,mediaSource:s,_objectUrl:o}=this;if(s){if(this.log("media source "+(i?"transferring":"detaching")),i)this.sourceBuffers.forEach(([a])=>{a&&this.removeBuffer(a)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const a="open"===s.readyState;try{const l=s.sourceBuffers;for(let c=l.length;c--;)a&&l[c].abort(),s.removeSourceBuffer(l[c]);a&&s.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(s.removeEventListener("startstreaming",this._onStartStreaming),s.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}r&&(r.removeEventListener("emptied",this._onMediaEmptied),i||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(r.removeAttribute("src"),this.appendSource&&tP(r),r.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(v.MEDIA_DETACHED,e)}onBufferReset(){this.sourceBuffers.forEach(([t])=>{t&&this.resetBuffer(t)}),this.initTracks()}resetBuffer(t){var e;const i=null==(e=this.tracks[t])?void 0:e.buffer;if(this.removeBuffer(t),i)try{var r;null!=(r=this.mediaSource)&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(s){this.warn(`onBufferReset ${t}`,s)}delete this.tracks[t]}removeBuffer(t){this.removeBufferListeners(t),this.sourceBuffers[w1(t)]=[null,null];const e=this.tracks[t];e&&(e.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new XX(this.tracks)}onBufferCodecs(t,e){var i;const r=this.tracks,s=Object.keys(e);this.log(`BUFFER_CODECS: "${s}" (current SB count ${this.sourceBufferCount})`);const o="audiovideo"in e&&(r.audio||r.video)||r.audiovideo&&("audio"in e||"video"in e),a=!o&&this.sourceBufferCount&&this.media&&s.some(l=>!r[l]);o||a?this.warn(`Unsupported transition between "${Object.keys(r)}" and "${s}" SourceBuffers`):(s.forEach(l=>{var c,u;const d=e[l],{id:f,codec:h,levelCodec:p,container:g,metadata:m,supplemental:_}=d;let y=r[l];const b=null==(c=this.transferData)||null==(c=c.tracks)?void 0:c[l],S=null!=b&&b.buffer?b:y,C=S?.pendingCodec||S?.codec,k=S?.levelCodec;y||(y=r[l]={buffer:void 0,listeners:[],codec:h,supplemental:_,container:g,levelCodec:p,metadata:m,id:f});const I=Jp(C,k),M=I?.replace(JN,"$1");let O=Jp(h,p);const x=null==(u=O)?void 0:u.replace(JN,"$1");O&&I&&M!==x&&("audio"===l.slice(0,5)&&(O=Xp(O,this.appendSource)),this.log(`switching codec ${C} to ${O}`),O!==(y.pendingCodec||y.codec)&&(y.pendingCodec=O),y.container=g,this.appendChangeType(l,g,O))}),(this.tracksReady||this.sourceBufferCount)&&(e.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!e.video&&"main"===(null==(i=e.audio)?void 0:i.id)&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks()))}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((t,e)=>{const i=this.tracks[e];return t[e]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},t},{})}appendChangeType(t,e,i){const r=`${e};codecs=${i}`;this.append({label:`change-type=${r}`,execute:()=>{const o=this.tracks[t];if(o){const a=o.buffer;null!=a&&a.changeType&&(this.log(`changing ${t} sourceBuffer type to ${r}`),a.changeType(r),o.codec=i,o.container=e)}this.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${t} SourceBuffer type`,o)}},t,this.isPending(this.tracks[t]))}blockAudio(t){var e;const i=t.start,r=i+.05*t.duration;if(!0===(null==(e=this.fragmentTracker.getAppendedFrag(i,"main"))?void 0:e.gap))return;const o={label:"block-audio",execute:()=>{var a;const l=this.tracks.video;(this.lastVideoAppendEnd>r||null!=l&&l.buffer&&Me.isBuffered(l.buffer,r)||!0===(null==(a=this.fragmentTracker.getAppendedFrag(r,"main"))?void 0:a.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn("Error executing block-audio operation",a)}};this.blockedAudioAppend={op:o,frag:t},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:t,operationQueue:e}=this;t&&e&&(this.blockedAudioAppend=null,e.unblockAudio(t.op))}onBufferAppending(t,e){const{tracks:i}=this,{data:r,type:s,parent:o,frag:a,part:l,chunkMeta:c,offset:u}=e,d=c.buffering[s],{sn:f,cc:h}=a,p=self.performance.now();d.start=p;const g=a.stats.buffering,m=l?l.stats.buffering:null;0===g.start&&(g.start=p),m&&0===m.start&&(m.start=p);const _=i.audio;let y=!1;"audio"===s&&"audio/mpeg"===_?.container&&(y=!this.lastMpegAudioChunk||1===c.id||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const b=i.video,S=b?.buffer;if(S&&"initSegment"!==f){const I=l||a,M=this.blockedAudioAppend;if("audio"!==s||"main"===o||this.blockedAudioAppend||b.ending||b.ended){if("video"===s){const O=I.end;if(M){const x=M.frag.start;(O>x||O<this.lastVideoAppendEnd||Me.isBuffered(S,x))&&this.unblockAudio()}this.lastVideoAppendEnd=O}}else{const x=I.start+.05*I.duration,B=S.buffered,K=this.currentOp("video");B.length||K?!K&&!Me.isBuffered(S,x)&&this.lastVideoAppendEnd<x&&this.blockAudio(I):this.blockAudio(I)}}const C=(l||a).start,k={label:`append-${s}`,execute:()=>{var I;d.executeStart=self.performance.now();const M=null==(I=this.tracks[s])?void 0:I.buffer;M&&(y?this.updateTimestampOffset(M,C,.1,s,f,h):void 0!==u&&re(u)&&this.updateTimestampOffset(M,u,1e-6,s,f,h)),this.appendExecutor(r,s)},onStart:()=>{},onComplete:()=>{const I=self.performance.now();d.executeEnd=d.end=I,0===g.first&&(g.first=I),m&&0===m.first&&(m.first=I);const M={};this.sourceBuffers.forEach(([O,x])=>{O&&(M[O]=Me.getBuffered(x))}),this.appendErrors[s]=0,"audio"===s||"video"===s?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(v.BUFFER_APPENDED,{type:s,frag:a,part:l,chunkMeta:c,parent:a.type,timeRanges:M})},onError:I=>{var M;const O={type:fe.MEDIA_ERROR,parent:a.type,details:N.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:a,part:l,chunkMeta:c,error:I,err:I,fatal:!1},x=null==(M=this.media)?void 0:M.error;if(I.code===DOMException.QUOTA_EXCEEDED_ERR||"QuotaExceededError"==I.name||"quota"in I)O.details=N.BUFFER_FULL_ERROR;else if(I.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!x)O.errorAction=Yl(!0);else if(I.name===eP&&0===this.sourceBufferCount)O.errorAction=Yl(!0);else{const B=++this.appendErrors[s];this.warn(`Failed ${B}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${s}" sourceBuffer (${x||"no media error"})`),(B>=this.hls.config.appendErrorMaxRetry||x)&&(O.fatal=!0)}this.hls.trigger(v.ERROR,O)}};this.log(`queuing "${s}" append sn: ${f}${l?" p: "+l.index:""} of ${"main"===a.type?"level":"track"} ${a.level} cc: ${h}`),this.append(k,s,this.isPending(this.tracks[s]))}getFlushOp(t,e,i){return this.log(`queuing "${t}" remove ${e}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(t,e,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(v.BUFFER_FLUSHED,{type:t})},onError:r=>{this.warn(`Failed to remove ${e}-${i} from "${t}" SourceBuffer`,r)}}}onBufferFlushing(t,e){const{type:i,startOffset:r,endOffset:s}=e;i?this.append(this.getFlushOp(i,r,s),i):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,r,s),o)})}onFragParsed(t,e){const{frag:i,part:r}=e,s=[],o=r?r.elementaryStreams:i.elementaryStreams;o.audiovideo?s.push("audiovideo"):(o.audio&&s.push("audio"),o.video&&s.push("video")),0===s.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(()=>{const l=self.performance.now();i.stats.buffering.end=l,r&&(r.stats.buffering.end=l),this.hls.trigger(v.FRAG_BUFFERED,{frag:i,part:r,stats:r?r.stats:i.stats,id:i.type})},s).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(t,e){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([t])=>{if(t){const e=this.tracks[t];if(e)return!e.ended||e.ending}return!1})}onBufferEos(t,e){var i;this.sourceBuffers.forEach(([o])=>{if(o){const a=this.tracks[o];(!e.type||e.type===o)&&(a.ending=!0,a.ended||(a.ended=!0,this.log(`${o} buffer reached EOS`)))}});const r=!1!==(null==(i=this.overrides)?void 0:i.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var a;return o&&!(null!=(a=this.tracks[o])&&a.ended)})?r?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;o&&"open"===o.readyState?(this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(v.BUFFERED_TO_END,void 0)):o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`)})):(this.tracksEnded(),this.hls.trigger(v.BUFFERED_TO_END,void 0)):"video"===e.type&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([t])=>{if(null!==t){const e=this.tracks[t];e&&(e.ending=!1)}})}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const t=this.getDurationAndRange();t&&this.updateMediaSource(t)})}onError(t,e){if(e.details===N.BUFFER_APPEND_ERROR&&e.frag){var i;const r=null==(i=e.errorAction)?void 0:i.nextAutoLevel;re(r)&&r!==e.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:t,details:e,media:i}=this;if(!i||null===e||!this.sourceBufferCount)return;const r=t.config,s=i.currentTime,o=e.levelTargetDuration,a=e.live&&null!==r.liveBackBufferLength?r.liveBackBufferLength:r.backBufferLength;if(re(a)&&a>=0){const c=Math.max(a,o),u=Math.floor(s/o)*o-c;this.flushBackBuffer(s,o,u)}const l=r.frontBufferFlushThreshold;if(re(l)&&l>0){const c=Math.max(r.maxBufferLength,l),u=Math.max(c,o),d=Math.floor(s/o)*o+u;this.flushFrontBuffer(s,o,d)}}flushBackBuffer(t,e,i){this.sourceBuffers.forEach(([r,s])=>{if(s){const a=Me.getBuffered(s);if(a.length>0&&i>a.start(0)){var o;this.hls.trigger(v.BACK_BUFFER_REACHED,{bufferEnd:i});const l=this.tracks[r];if(null!=(o=this.details)&&o.live)this.hls.trigger(v.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(null!=l&&l.ended)return void this.log(`Cannot flush ${r} back buffer while SourceBuffer is in ended state`);this.hls.trigger(v.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:r})}}})}flushFrontBuffer(t,e,i){this.sourceBuffers.forEach(([r,s])=>{if(s){const o=Me.getBuffered(s),a=o.length;if(a<2)return;const l=o.start(a-1),c=o.end(a-1);if(i>l||t>=l&&t<=c)return;this.hls.trigger(v.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:r})}})}getDurationAndRange(){var t;const{details:e,mediaSource:i}=this;if(!e||!this.media||"open"!==i?.readyState)return null;const r=e.edge;if(e.live&&this.hls.config.liveDurationInfinity){if(e.fragments.length&&i.setLiveSeekableRange){const c=Math.max(0,e.fragmentStart);return{duration:1/0,start:c,end:Math.max(c,r)}}return{duration:1/0}}const s=null==(t=this.overrides)?void 0:t.duration;if(s)return re(s)?{duration:s}:null;const o=this.media.duration;return r>(re(i.duration)?i.duration:0)&&r>o||!re(o)?{duration:r}:null}updateMediaSource({duration:t,start:e,end:i}){const r=this.mediaSource;!this.media||!r||"open"!==r.readyState||(r.duration!==t&&(re(t)&&this.log(`Updating MediaSource duration to ${t.toFixed(3)}`),r.duration=t),void 0!==e&&void 0!==i&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${e}-${i}.`),r.setLiveSeekableRange(e,i)))}get tracksReady(){const t=this.pendingTrackCount;return t>0&&(t>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:t,pendingTrackCount:e,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${e} codec events expected: ${t}) ${It(i)}`),this.tracksReady){var r;const s=null==(r=this.transferData)?void 0:r.tracks;s&&Object.keys(s).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const t={};this.sourceBuffers.forEach(([e,i])=>{if(e){const r=this.tracks[e];t[e]={buffer:i,container:r.container,codec:r.codec,supplemental:r.supplemental,levelCodec:r.levelCodec,id:r.id,metadata:r.metadata}}}),this.hls.trigger(v.BUFFER_CREATED,{tracks:t}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([e])=>{this.executeNext(e)})}else{const t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}createSourceBuffers(){const{tracks:t,sourceBuffers:e,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in t){const o=s,a=t[o];if(this.isPending(a)){const l=this.getTrackCodec(a,o),c=`${a.container};codecs=${l}`;a.codec=l,this.log(`creating sourceBuffer(${c})${this.currentOp(o)?" Queued":""} ${It(a)}`);try{const u=i.addSourceBuffer(c);e[w1(o)]=[o,u],a.buffer=u}catch(u){var r;return this.error(`error while trying to add sourceBuffer: ${u.message}`),this.shiftAndExecuteNext(o),null==(r=this.operationQueue)||r.removeBlockers(),delete this.tracks[o],void this.hls.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,sourceBufferName:o,mimeType:c,parent:a.id})}this.trackSourceBuffer(o,a)}}this.bufferCreated()}getTrackCodec(t,e){const i=t.supplemental;let r=t.codec;i&&("video"===e||"audiovideo"===e)&&gd(i,"video")&&(r=function GQ(n,t){const e=[];if(n){const i=n.split(",");for(let r=0;r<i.length;r++)Wb(i[r],"video")||e.push(i[r])}return t&&e.push(t),e.join(",")}(r,i));const s=Jp(r,t.levelCodec);return s?"audio"===e.slice(0,5)?Xp(s,this.appendSource):s:""}trackSourceBuffer(t,e){const i=e.buffer;if(!i)return;const r=this.getTrackCodec(e,t);this.tracks[t]={buffer:i,codec:r,container:e.container,levelCodec:e.levelCodec,supplemental:e.supplemental,metadata:e.metadata,id:e.id,listeners:[]},this.removeBufferListeners(t),this.addBufferListener(t,"updatestart",this.onSBUpdateStart),this.addBufferListener(t,"updateend",this.onSBUpdateEnd),this.addBufferListener(t,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(t,"bufferedchange",(s,o)=>{const a=o.removedRanges;null!=a&&a.length&&this.hls.trigger(v.BUFFER_FLUSHED,{type:s})})}get mediaSrc(){var t,e;const i=(null==(t=this.media)||null==(e=t.querySelector)?void 0:e.call(t,"source"))||this.media;return i?.src}onSBUpdateStart(t){const e=this.currentOp(t);e&&e.onStart()}onSBUpdateEnd(t){var e;if("closed"===(null==(e=this.mediaSource)?void 0:e.readyState))return void this.resetBuffer(t);const i=this.currentOp(t);i&&(i.onComplete(),this.shiftAndExecuteNext(t))}onSBUpdateError(t,e){var i;const r=new Error(`${t} SourceBuffer error. MediaSource readyState: ${null==(i=this.mediaSource)?void 0:i.readyState}`);this.error(`${r}`,e),this.hls.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:r,fatal:!1});const s=this.currentOp(t);s&&s.onError(r)}updateTimestampOffset(t,e,i,r,s,o){Math.abs(e-t.timestampOffset)>=i&&(this.log(`Updating ${r} SourceBuffer timestampOffset to ${e} (sn: ${s} cc: ${o})`),t.timestampOffset=e)}removeExecutor(t,e,i){const{media:r,mediaSource:s}=this,o=this.tracks[t],a=o?.buffer;if(!r||!s||!a)return this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),void this.shiftAndExecuteNext(t);const l=re(r.duration)?r.duration:1/0,c=re(s.duration)?s.duration:1/0,u=Math.max(0,e),d=Math.min(i,l,c);d>u&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${u},${d}] from the ${t} SourceBuffer`),a.remove(u,d)):this.shiftAndExecuteNext(t)}appendExecutor(t,e){const i=this.tracks[e],r=i?.buffer;if(!r)throw new JX(`Attempting to append to the ${e} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,r.appendBuffer(t)}blockUntilOpen(t){if(this.isUpdating()||this.isQueued())this.blockBuffers(t).catch(e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{t()}catch(e){this.warn(`Callback run without blocking ${this.operationQueue} ${e}`)}}isUpdating(){return this.sourceBuffers.some(([t,e])=>t&&e.updating)}isQueued(){return this.sourceBuffers.some(([t])=>t&&!!this.currentOp(t))}isPending(t){return!!t&&!t.buffer}blockBuffers(t,e=this.sourceBufferTypes){if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);const{operationQueue:i}=this,r=e.map(o=>this.appendBlocker(o));return e.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(r).then(o=>{i===this.operationQueue&&(t(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(t){t.forEach(e=>{var i;const r=null==(i=this.tracks[e])?void 0:i.buffer;!r||r.updating||this.shiftAndExecuteNext(e)})}append(t,e,i){this.operationQueue&&this.operationQueue.append(t,e,i)}appendBlocker(t){if(this.operationQueue)return this.operationQueue.appendBlocker(t)}currentOp(t){return this.operationQueue?this.operationQueue.current(t):null}executeNext(t){t&&this.operationQueue&&this.operationQueue.executeNext(t)}shiftAndExecuteNext(t){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(t)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((t,e)=>t+(this.isPending(this.tracks[e])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((t,[e])=>t+(e?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([t])=>t).filter(t=>!!t)}addBufferListener(t,e,i){const r=this.tracks[t];if(!r)return;const s=r.buffer;if(!s)return;const o=i.bind(this,t);r.listeners.push({event:e,listener:o}),s.addEventListener(e,o)}removeBufferListeners(t){const e=this.tracks[t];if(!e)return;const i=e.buffer;i&&(e.listeners.forEach(r=>{i.removeEventListener(r.event,r.listener)}),e.listeners.length=0)}},capLevelController:x1,errorController:class gZ extends er{constructor(t){super("error-controller",t.logger),this.hls=void 0,this.playlistError=0,this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(v.ERROR,this.onError,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(v.ERROR,this.onError,this),t.off(v.ERROR,this.onErrorOut,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return"main"===t?.type?t.level:this.getVariantIndex()}getVariantIndex(){var t;const e=this.hls,i=e.currentLevel;return null!=(t=e.loadLevelObj)&&t.details||-1===i?e.loadLevel:i}variantHasKey(t,e){if(t){var i;if(null!=(i=t.details)&&i.hasKey(e))return!0;const r=t.audioGroups;if(r)return this.hls.allAudioTracks.filter(o=>r.indexOf(o.groupId)>=0).some(o=>{var a;return null==(a=o.details)?void 0:a.hasKey(e)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(t,e){var i;if(e.fatal)return;const r=this.hls,s=e.context;switch(e.details){case N.FRAG_LOAD_ERROR:case N.FRAG_LOAD_TIMEOUT:case N.KEY_LOAD_ERROR:case N.KEY_LOAD_TIMEOUT:return void(e.errorAction=this.getFragRetryOrSwitchAction(e));case N.FRAG_PARSING_ERROR:if(null!=(i=e.frag)&&i.gap)return void(e.errorAction=Yl());case N.FRAG_GAP:case N.FRAG_DECRYPT_ERROR:return e.errorAction=this.getFragRetryOrSwitchAction(e),void(e.errorAction.action=2);case N.LEVEL_EMPTY_ERROR:case N.LEVEL_PARSING_ERROR:{var o;const l="main"===e.parent?e.level:r.loadLevel;e.details===N.LEVEL_EMPTY_ERROR&&null!=(o=e.context)&&null!=(o=o.levelDetails)&&o.live?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,l):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,l))}return;case N.LEVEL_LOAD_ERROR:case N.LEVEL_LOAD_TIMEOUT:return void("number"==typeof s?.level&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,s.level)));case N.AUDIO_TRACK_LOAD_ERROR:case N.AUDIO_TRACK_LOAD_TIMEOUT:case N.SUBTITLE_LOAD_ERROR:case N.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const l=r.loadLevelObj;if(l&&("audioTrack"===s.type&&l.hasAudioGroup(s.groupId)||"subtitleTrack"===s.type&&l.hasSubtitleGroup(s.groupId)))return e.errorAction=this.getPlaylistRetryOrSwitchAction(e,r.loadLevel),e.errorAction.action=2,void(e.errorAction.flags=1)}return;case N.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:return void(e.errorAction={action:2,flags:2});case N.KEY_SYSTEM_SESSION_UPDATE_FAILED:case N.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case N.KEY_SYSTEM_NO_SESSION:return void(e.errorAction={action:2,flags:4});case N.BUFFER_ADD_CODEC_ERROR:case N.REMUX_ALLOC_ERROR:case N.BUFFER_APPEND_ERROR:var a;return void(e.errorAction||(e.errorAction=this.getLevelSwitchAction(e,null!=(a=e.level)?a:r.loadLevel)));case N.INTERNAL_EXCEPTION:case N.BUFFER_APPENDING_ERROR:case N.BUFFER_FULL_ERROR:case N.LEVEL_SWITCH_ERROR:case N.BUFFER_STALLED_ERROR:case N.BUFFER_SEEK_OVER_HOLE:case N.BUFFER_NUDGE_ON_STALL:return void(e.errorAction=Yl())}e.type===fe.KEY_SYSTEM_ERROR&&(e.levelRetry=!1,e.errorAction=Yl())}getPlaylistRetryOrSwitchAction(t,e){const r=LO(this.hls.config.playlistLoadPolicy,t),s=this.playlistError++;if(rg(r,s,ig(t),t.response))return{action:5,flags:0,retryConfig:r,retryCount:s};const a=this.getLevelSwitchAction(t,e);return r&&(a.retryConfig=r,a.retryCount=s),a}getFragRetryOrSwitchAction(t){const e=this.hls,i=this.getVariantLevelIndex(t.frag),r=e.levels[i],{fragLoadPolicy:s,keyLoadPolicy:o}=e.config,a=LO(NO(t)?o:s,t),l=e.levels.reduce((u,d)=>u+d.fragmentError,0);if(r&&(t.details!==N.FRAG_GAP&&r.fragmentError++,!PO(t)&&rg(a,l,ig(t),t.response)))return{action:5,flags:0,retryConfig:a,retryCount:l};const c=this.getLevelSwitchAction(t,i);return a&&(c.retryConfig=a,c.retryCount=l),c}getLevelSwitchAction(t,e){const i=this.hls;null==e&&(e=i.loadLevel);const r=this.hls.levels[e];if(r){var s,o;const c=t.details;r.loadError++,c===N.BUFFER_APPEND_ERROR&&r.fragmentError++;let u=-1;const{levels:d,loadLevel:f,minAutoLevel:h,maxAutoLevel:p}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const g=null==(s=t.frag)?void 0:s.type,_=("audio"===g&&c===N.FRAG_PARSING_ERROR||"audio"===t.sourceBufferName&&(c===N.BUFFER_ADD_CODEC_ERROR||c===N.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:k})=>r.audioCodec!==k),b="video"===t.sourceBufferName&&(c===N.BUFFER_ADD_CODEC_ERROR||c===N.BUFFER_APPEND_ERROR)&&d.some(({codecSet:k,audioCodec:I})=>r.codecSet!==k&&r.audioCodec===I),{type:S,groupId:C}=null!=(o=t.context)?o:{};for(let k=d.length;k--;){const I=(k+f)%d.length;if(I!==f&&I>=h&&I<=p&&0===d[I].loadError){var a,l;const M=d[I];if(c===N.FRAG_GAP&&"main"===g&&t.frag){const O=d[I].details;if(O){const x=ga(t.frag,O.fragments,t.frag.start);if(null!=x&&x.gap)continue}}else{if("audioTrack"===S&&M.hasAudioGroup(C)||"subtitleTrack"===S&&M.hasSubtitleGroup(C))continue;if("audio"===g&&null!=(a=r.audioGroups)&&a.some(O=>M.hasAudioGroup(O))||"subtitle"===g&&null!=(l=r.subtitleGroups)&&l.some(O=>M.hasSubtitleGroup(O))||_&&r.audioCodec===M.audioCodec||b&&r.codecSet===M.codecSet||!_&&r.codecSet!==M.codecSet)continue}u=I;break}}if(u>-1&&i.loadLevel!==u)return t.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:u}}return{action:2,flags:1}}onErrorOut(t,e){var i;switch(null==(i=e.errorAction)?void 0:i.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(e),e.errorAction.resolved||e.details===N.FRAG_GAP?/MediaSource readyState: ended/.test(e.error.message)&&(this.warn(`MediaSource ended after "${e.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):e.fatal=!0}e.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(t){const e=this.hls,i=t.errorAction;if(!i)return;const{flags:r}=i,s=i.nextAutoLevel;switch(r){case 0:this.switchLevel(t,s);break;case 2:{const l=this.getVariantLevelIndex(t.frag),c=e.levels[l],u=c?.attrs["HDCP-LEVEL"];if(i.hdcpLevel=u,"NONE"===u)this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(u){e.maxHdcpLevel=Qb[Qb.indexOf(u)-1],i.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`);break}}case 4:{const l=t.decryptdata;if(l){const c=this.hls.levels,u=c.length;for(let f=u;f--;)if(this.variantHasKey(c[f],l)){var o,a;this.log(`Banned key found in level ${f} (${c[f].bitrate}bps) or audio group "${null==(o=c[f].audioGroups)?void 0:o.join(",")}" (${null==(a=t.frag)?void 0:a.type} fragment) ${Qn(l.keyId||[])}`),c[f].fragmentError++,c[f].loadError++,this.log(`Removing level ${f} with key error (${t.error})`),this.hls.removeLevel(f)}const d=t.frag;if(this.hls.levels.length<u)i.resolved=!0;else if(d&&"main"!==d.type){const f=d.decryptdata;f&&!l.matches(f)&&(i.resolved=!0)}}break}}i.resolved||this.switchLevel(t,s)}switchLevel(t,e){if(void 0!==e&&t.errorAction&&(this.warn(`switching to level ${e} after ${t.details}`),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,t.details===N.BUFFER_ADD_CODEC_ERROR&&t.mimeType&&"audiovideo"!==t.sourceBufferName)){const i=Yb(t.mimeType),r=this.hls.levels;for(let s=r.length;s--;)r[s][`${t.sourceBufferName}Codec`]===i&&(this.log(`Removing level ${s} for ${t.details} ("${i}" not supported)`),this.hls.removeLevel(s))}}},fpsController:class JJ{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(v.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(v.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const i=this.hls.config;if(i.capLevelOnFPSDrop){const r=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=r,r&&"function"==typeof r.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(t,e,i){const r=performance.now();if(e){if(this.lastTime){const o=i-this.lastDroppedFrames,a=e-this.lastDecodedFrames,l=1e3*o/(r-this.lastTime),c=this.hls;if(c.trigger(v.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:i}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*a){let u=c.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=u)&&(u-=1,c.trigger(v.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:c.currentLevel}),c.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:XO,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},function Zee(){return{cueHandler:$ee,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}()),{},{subtitleStreamController:class dee extends u1{constructor(t,e,i){super(t,e,i,"subtitle-stream-controller","subtitle"),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(v.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(v.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(t,e){this.stopLoad(),this.state="IDLE",this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(t,e){this.tracksBuffered=[],super.onMediaDetaching(t,e)}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){const{frag:i,success:r}=e;if(this.fragContextChanged(i)||(ln(i)&&(this.fragPrevious=i),this.state="IDLE"),!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const a=i.start;for(let c=0;c<s.length;c++)if(a>=s[c].start&&a<=s[c].end){o=s[c];break}const l=i.start+i.duration;o?o.end=l:(o={start:a,end:l},s.push(o)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(t,e){const{startOffset:i,endOffset:r}=e;if(0===i&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;e.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;)if(o[a].end<=s)o.shift();else{if(!(o[a].start<s))break;o[a].start=s,a++}}),this.fragmentTracker.removeFragmentsInRange(i,s,"subtitle")}}onError(t,e){const i=e.frag;"subtitle"===i?.type&&(e.details===N.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),"STOPPED"!==this.state&&(this.state="IDLE"))}onSubtitleTracksUpdated(t,{subtitleTracks:e}){this.levels&&XN(this.levels,e)?this.levels=e.map(i=>new _d(i)):(this.tracksBuffered=[],this.levels=e.map(i=>{const r=new _d(i);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,"subtitle"),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(t,e){var i;if(this.currentTrackId=e.id,null==(i=this.levels)||!i.length||-1===this.currentTrackId)return void this.clearInterval();const r=this.levels[this.currentTrackId];this.mediaBuffer=null!=r&&r.details?this.mediaBufferTimeRanges:null,r&&"STOPPED"!==this.state&&this.setInterval(500)}onSubtitleTrackLoaded(t,e){var i;const{currentTrackId:r,levels:s}=this,{details:o,id:a}=e;if(!s)return void this.warn(`Subtitle tracks were reset while loading level ${a}`);const l=s[a];if(a>=s.length||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(o.live||null!=(i=l.details)&&i.live){if(o.deltaUpdateFailed)return;const d=this.mainDetails;if(!d)return void(this.startFragRequested=!1);const f=d.fragments[0];var u;l.details?(c=this.alignPlaylists(o,l.details,null==(u=this.levelLastLoaded)?void 0:u.details),0===c&&f&&(c=f.start,c1(o,c))):o.hasProgramDateTime&&d.hasProgramDateTime?(dg(o,d),c=o.fragmentStart):f&&(c=f.start,c1(o,c)),d&&!this.startFragRequested&&this.setStartPosition(d,c)}l.details=o,this.levelLastLoaded=l,a===r&&(this.hls.trigger(v.SUBTITLE_TRACK_UPDATED,{details:o,id:a,groupId:e.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&"IDLE"===this.state&&(ga(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(t){const{frag:e,payload:i}=t,r=e.decryptdata,s=this.hls;if(!this.fragContextChanged(e)&&i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&Zl(r.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,n1(r.method)).catch(a=>{throw s.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:e}),a}).then(a=>{const l=performance.now();s.trigger(v.FRAG_DECRYPTED,{frag:e,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state="IDLE"})}}doTick(){if(this.media){if("IDLE"===this.state){const{currentTrackId:t,levels:e}=this,i=e?.[t];if(!i||!e.length||!i.details||this.waitForLive(i))return;const{config:r}=this,s=this.getLoadPosition(),o=Me.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:a,len:l}=o,c=i.details;if(l>this.hls.maxBufferLength+c.levelTargetDuration)return;const d=c.fragments,f=d.length,h=c.edge;let p=null;const g=this.fragPrevious;if(a<h){const y=r.maxFragLookUpTolerance,b=a>h-y?0:y;p=ga(g,d,Math.max(d[0].start,a),b),!p&&g&&g.start<d[0].start&&(p=d[0])}else p=d[f-1];if(p=this.filterReplacedPrimary(p,i.details),!p)return;const _=d[p.sn-c.startSN-1];if(_&&_.cc===p.cc&&"NOT_LOADED"===this.fragmentTracker.getState(_)&&(p=_),"NOT_LOADED"===this.fragmentTracker.getState(p)){const y=this.mapToInitFragWhenRequired(p);y&&this.loadFragment(y,i,a)}}}else this.state="IDLE"}loadFragment(t,e,i){ln(t)?super.loadFragment(t,e,i):this._loadInitSegment(t,e)}get mediaBufferTimeRanges(){return new fee(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class nee extends C1{constructor(t){super(t,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const i=Tg(this.media.textTracks);for(let s=0;s<i.length;s++)if("hidden"===i[s].mode)e=i[s];else if("showing"===i[s].mode){e=i[s];break}const r=this.findTrackForTextTrack(e);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.LEVEL_LOADING,this.onLevelLoading,this),t.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.LEVEL_LOADING,this.onLevelLoading,this),t.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(v.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(t,e){const i=this.media;if(!i)return;const r=!!e.transferMedia;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,r||Tg(i.textTracks).forEach(o=>{nc(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){const{id:i,groupId:r,details:s}=e,o=this.tracksInGroup[i];if(!o||o.groupId!==r)return void this.warn(`Subtitle track with id:${i} and group:${r} not found in active group ${o?.groupId}`);const a=o.details;o.details=e.details,this.log(`Subtitle track ${i} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,a)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.subtitleGroups||null,r=this.groupIds;let s=this.currentTrack;if(!i||r?.length!==i?.length||null!=i&&i.some(o=>-1===r?.indexOf(o))){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(u=>!i||-1!==i.indexOf(u.groupId));if(o.length)this.selectDefaultTrack&&!o.some(u=>u.default)&&(this.selectDefaultTrack=!1),o.forEach((u,d)=>{u.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!s&&a){this.selectDefaultTrack=!1;const u=Zr(a,o);if(u>-1)s=o[u];else{const d=Zr(a,this.tracks);s=this.tracks[d]}}let l=this.findTrackId(s);-1===l&&s&&(l=this.findTrackId(null));const c={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${i?.join(",")}" group-id`),this.hls.trigger(v.SUBTITLE_TRACKS_UPDATED,c),-1!==l&&-1===this.trackId&&this.setSubtitleTrack(l)}}findTrackId(t){const e=this.tracksInGroup,i=this.selectDefaultTrack;for(let r=0;r<e.length;r++){const s=e[r];if((!i||s.default)&&(i||t)&&(!t||ha(s,t)))return r}if(t){for(let r=0;r<e.length;r++)if(Cd(t.attrs,e[r].attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r;for(let r=0;r<e.length;r++)if(Cd(t.attrs,e[r].attrs,["LANGUAGE"]))return r}return-1}findTrackForTextTrack(t){if(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++)if(I1(e[i],t))return i}return-1}onError(t,e){e.fatal||!e.context||"subtitleTrack"===e.context.type&&e.context.id===this.trackId&&(!this.groupIds||-1!==this.groupIds.indexOf(e.context.groupId))&&this.checkRetry(e)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){if(-1===t.id)return this.setSubtitleTrack(-1),null;const e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){const i=this.currentTrack;if(i&&ha(t,i))return i;const r=Zr(t,this.tracksInGroup);if(r>-1){const s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}if(i)return null;{const s=Zr(t,e);if(s>-1)return e[s]}}}return null}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,r=t.groupId,s=this.getUrlWithDirectives(t.url,e),o=t.details,a=o?.age;this.log(`Loading subtitle ${i} "${t.name}" lang:${t.lang} group:${r}${void 0!==e?.msn?" at sn "+e.msn+" part "+e.part:""}${a&&o.live?" age "+a.toFixed(1)+(o.type?" "+o.type||0:""):""} ${s}`),this.hls.trigger(v.SUBTITLE_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null,track:t})}toggleTrackModes(){const{media:t}=this;if(!t)return;const e=Tg(t.textTracks),i=this.currentTrack;let r;if(i&&(r=e.filter(s=>I1(i,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(e).forEach(s=>{"disabled"!==s.mode&&s!==r&&(s.mode="disabled")}),r){const s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(t){const e=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=t);if(t<-1||t>=e.length||!re(t))return void this.warn(`Invalid subtitle track id: ${t}`);this.selectDefaultTrack=!1;const i=this.currentTrack,r=e[t]||null;if(this.trackId=t,this.currentTrack=r,this.toggleTrackModes(),!r)return void this.hls.trigger(v.SUBTITLE_TRACK_SWITCH,{id:t});if(t===this.trackId&&r===i&&r.details&&!r.details.live)return;this.log(`Switching to subtitle-track ${t}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:o,groupId:a="",name:l,type:c,url:u}=r;this.hls.trigger(v.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:c,url:u});const d=this.switchParams(r.url,i?.details,r.details);this.loadPlaylist(d)}},timelineController:class Fee{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(v.FRAG_LOADING,this.onFragLoading,this),t.on(v.FRAG_LOADED,this.onFragLoaded,this),t.on(v.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(v.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(v.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(v.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(v.FRAG_LOADING,this.onFragLoading,this),t.off(v.FRAG_LOADED,this.onFragLoaded,this),t.off(v.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(v.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(v.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(v.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const t=new xg(this,"textTrack1"),e=new xg(this,"textTrack2"),i=new xg(this,"textTrack3"),r=new xg(this,"textTrack4");this.cea608Parser1=new wP(1,t,e),this.cea608Parser2=new wP(3,i,r)}addCues(t,e,i,r,s){let o=!1;for(let a=s.length;a--;){const l=s[a],c=Bee(l[0],l[1],e,i);if(c>=0&&(l[0]=Math.min(l[0],e),l[1]=Math.max(l[1],i),o=!0,c/(i-e)>.5))return}if(o||s.push([e,i]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[t],e,i,r);else{const a=this.Cues.newCue(null,e,i,r);this.hls.trigger(v.CUES_PARSED,{type:"captions",cues:a,track:t})}}onInitPtsFound(t,{frag:e,id:i,initPTS:r,timescale:s,trackId:o}){const{unparsedVttFrags:a}=this;"main"===i&&(this.initPTS[e.cc]={baseTime:r,timescale:s,trackId:o}),a.length&&(this.unparsedVttFrags=[],a.forEach(l=>{this.initPTS[l.frag.cc]?this.onFragLoaded(v.FRAG_LOADED,l):this.hls.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(t,e){const{media:i}=this;if(i)for(let r=0;r<i.textTracks.length;r++){const s=i.textTracks[r];if(BP(s,{name:t,lang:e,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return s}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:e,captionsTracks:i,media:r}=this,{label:s,languageCode:o}=e[t],a=this.getExistingTrack(s,o);if(a)i[t]=a,nc(i[t]),vP(i[t],r);else{const l=this.createTextTrack("captions",s,o);l&&(l[t]=!0,i[t]=l)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const e=this.captionsProperties[t];if(!e)return;const r={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=r,this.hls.trigger(v.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(t,e,i){const r=this.media;if(r)return r.addTextTrack(t,e,i)}onMediaAttaching(t,e){this.media=e.media,e.mediaSource||this._cleanTracks()}onMediaDetaching(t,e){const i=!!e.transferMedia;if(this.media=null,i)return;const{captionsTracks:r}=this;Object.keys(r).forEach(s=>{nc(r[s]),delete r[s]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const e=t.textTracks;if(e)for(let i=0;i<e.length;i++)nc(e[i])}onSubtitleTracksUpdated(t,e){const i=e.subtitleTracks||[],r=i.some(s=>s.textCodec===j1);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(XN(this.tracks,i))return void(this.tracks=i);if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const o=this.media,a=o?Tg(o.textTracks):null;if(this.tracks.forEach((l,c)=>{let u;if(a){let d=null;for(let f=0;f<a.length;f++)if(a[f]&&BP(a[f],l)){d=a[f],a[f]=null;break}d&&(u=d)}if(u)nc(u);else{const d=FP(l);u=this.createTextTrack(d,l.name,l.lang),u&&(u.mode="disabled")}u&&this.textTracks.push(u)}),null!=a&&a.length){const l=a.filter(c=>null!==c).map(c=>c.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(v.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(i=>{const r=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!r)return;const o=this.captionsProperties[`textTrack${r[1]}`];o&&(o.label=i.name,i.lang&&(o.languageCode=i.lang),o.media=i)})}closedCaptionsForLevel(t){const e=this.hls.levels[t.level];return e?.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){if(this.enabled&&"main"===e.frag.type){var i,r;const{cea608Parser1:s,cea608Parser2:o,lastSn:a}=this,{cc:l,sn:c}=e.frag,u=null!=(i=null==(r=e.part)?void 0:r.index)?i:-1;s&&o&&(c!==a+1||c===a&&u!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),o.reset()),this.lastCc=l,this.lastSn=c,this.lastPartIndex=u}}onFragLoaded(t,e){const{frag:i,payload:r}=e;if("subtitle"===i.type)if(r.byteLength){const s=i.decryptdata;if(null==s||!s.encrypted||"stats"in e){const a=this.tracks[i.level],l=this.vttCCs;l[i.cc]||(l[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),a&&a.textCodec===j1?this._parseIMSC1(i,r):this._parseVTTs(e)}}else this.hls.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){const i=this.hls;OP(e,this.initPTS[t.cc],r=>{this._appendCues(r,t.level),i.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},r=>{i.logger.log(`Failed to parse IMSC1: ${r}`),i.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:r})})}_parseVTTs(t){var e;const{frag:i,payload:r}=t,{initPTS:s,unparsedVttFrags:o}=this,a=s.length-1;if(!s[i.cc]&&-1===a)return void o.push(t);const l=this.hls;!function Ree(n,t,e,i,r,s,o){const a=new wee,l=xi(new Uint8Array(n)).trim().replace(xee,"\n").split("\n"),c=[],u=t?function UX(n,t=1){return S1(n,9e4,1/t)}(t.baseTime,t.timescale):0;let p,d="00:00.000",f=0,h=0,g=!0;a.oncue=function(m){const _=e[i];let y=e.ccOffset;const b=(f-u)/9e4;if(null!=_&&_.new&&(void 0!==h?y=e.ccOffset=_.start:function(t,e,i){let r=t[e],s=t[r.prevCC];if(!s||!s.new&&r.new)return t.ccOffset=t.presentationOffset=r.start,void(r.new=!1);for(;null!=(o=s)&&o.new;){var o;t.ccOffset+=r.start-s.start,r.new=!1,r=s,s=t[r.prevCC]}t.presentationOffset=i}(e,i,b)),b){if(!t)return void(p=new Error("Missing initPTS for VTT MPEGTS"));y=b-e.presentationOffset}const S=m.endTime-m.startTime,C=Ri(9e4*(m.startTime+y-h),9e4*r)/9e4;m.startTime=Math.max(C,0),m.endTime=Math.max(C+S,0);const k=m.text.trim();m.text=decodeURIComponent(encodeURIComponent(k)),m.id||(m.id=V1(m.startTime,m.endTime,k)),m.endTime>0&&c.push(m)},a.onparsingerror=function(m){p=m},a.onflush=function(){p?o(p):s(c)},l.forEach(m=>{if(g){if($1(m,"X-TIMESTAMP-MAP=")){g=!1,m.slice(16).split(",").forEach(_=>{$1(_,"LOCAL:")?d=_.slice(6):$1(_,"MPEGTS:")&&(f=parseInt(_.slice(7)))});try{h=function(t){let e=parseInt(t.slice(-3));const i=parseInt(t.slice(-6,-4)),r=parseInt(t.slice(-9,-7)),s=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!(re(e)&&re(i)&&re(r)&&re(s)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return e+=1e3*i,e+=6e4*r,e+=36e5*s,e}(d)/1e3}catch(_){p=_}return}""===m&&(g=!1)}a.parse(m+"\n")}),a.flush()}(null!=(e=i.initSegment)&&e.data?tr(i.initSegment.data,new Uint8Array(r)).buffer:r,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,u=>{this._appendCues(u,i.level),l.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},u=>{const d="Missing initPTS for VTT MPEGTS"===u.message;d?o.push(t):this._fallbackToIMSC1(i,r),l.logger.log(`Failed to parse VTT cue: ${u}`),!(d&&a>i.cc)&&l.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:u})})}_fallbackToIMSC1(t,e){const i=this.tracks[t.level];i.textCodec||OP(e,this.initPTS[t.cc],()=>{i.textCodec=j1,this._parseIMSC1(t,e)},()=>{i.textCodec="wvtt"})}_appendCues(t,e){const i=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[e];if(!r||"disabled"===r.mode)return;t.forEach(s=>yP(r,s))}else{const r=this.tracks[e];if(!r)return;i.trigger(v.CUES_PARSED,{type:"subtitles",cues:t,track:r.default?"default":"subtitles"+e})}}onFragDecrypted(t,e){const{frag:i}=e;"subtitle"===i.type&&this.onFragLoaded(v.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:r}=e;if("main"!==i.type||"NONE"!==this.closedCaptionsForLevel(i))for(let s=0;s<r.length;s++){const o=r[s].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const a=this.extractCea608Data(o);this.cea608Parser1.addData(r[s].pts,a[0]),this.cea608Parser2.addData(r[s].pts,a[1])}}}onBufferFlushing(t,{startOffset:e,endOffset:i,endOffsetSubtitles:r,type:s}){const{media:o}=this;if(o&&!(o.currentTime<i)){if(!s||"video"===s){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>N1(a[l],e,i))}if(this.config.renderTextTracksNatively&&0===e&&void 0!==r){const{textTracks:a}=this;Object.keys(a).forEach(l=>N1(a[l],e,r))}}}extractCea608Data(t){const e=[[],[]],i=31&t[0];let r=2;for(let s=0;s<i;s++){const o=t[r++],a=127&t[r++],l=127&t[r++];if((0!==a||0!==l)&&4&o){const u=3&o;(0===u||1===u)&&(e[u].push(a),e[u].push(l))}}return e}},audioStreamController:class QX extends u1{constructor(t,e,i){super(t,e,i,"audio-stream-controller","audio"),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(v.BUFFER_RESET,this.onBufferReset,this),t.on(v.BUFFER_CREATED,this.onBufferCreated,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(v.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(v.FRAG_LOADING,this.onFragLoading,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:t}=this;t&&(super.unregisterListeners(),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(v.BUFFER_RESET,this.onBufferReset,this),t.off(v.BUFFER_CREATED,this.onBufferCreated,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(v.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(v.FRAG_LOADING,this.onFragLoading,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(t,{frag:e,id:i,initPTS:r,timescale:s,trackId:o}){if("main"===i){const a=e.cc,l=this.fragCurrent;if(this.initPTS[a]={baseTime:r,timescale:s,trackId:o},this.log(`InitPTS for cc: ${a} found from main: ${r/s} (${r}/${s}) trackId: ${o}`),this.mainAnchor=e,"WAITING_INIT_PTS"===this.state){const c=this.waitingData;(!c&&!this.loadingParts||c&&c.frag.cc!==a)&&this.syncWithAnchor(e,c?.frag)}else!this.hls.hasEnoughToStart&&l&&l.cc!==a?(l.abortRequests(),this.syncWithAnchor(e,l)):"IDLE"===this.state&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(t,e){var i;const r=(null==(i=this.mainFragLoading)?void 0:i.frag)||null;if(e&&r?.cc===e.cc)return;const s=(r||t).cc,l=OO(this.getLevelDetails(),s,this.getLoadPosition());l&&(this.log(`Syncing with main frag at ${l.start} cc ${l.cc}`),this.startFragRequested=!1,this.nextLoadPosition=l.start,this.resetLoadingState(),"IDLE"===this.state&&this.doTickIdle())}startLoad(t,e){if(!this.levels)return this.startPosition=t,void(this.state="STOPPED");const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),i>0&&-1===t?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i,this.state="IDLE"):this.state="WAITING_TRACK",this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}doTick(){switch(this.state){case"IDLE":this.doTickIdle();break;case"WAITING_TRACK":{const{levels:t,trackId:e}=this,i=t?.[e],r=i?.details;if(r&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(r))break;this.state="WAITING_INIT_PTS"}break}case"FRAG_LOADING_WAITING_RETRY":this.checkRetryDate();break;case"WAITING_INIT_PTS":{const t=this.waitingData;if(t){const{frag:e,part:i,cache:r,complete:s}=t,o=this.mainAnchor;if(void 0!==this.initPTS[e.cc]){this.waitingData=null,this.state="FRAG_LOADING";const l={frag:e,part:i,payload:r.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(l),s&&super._handleFragmentLoadComplete(l)}else o&&o.cc!==t.frag.cc&&this.syncWithAnchor(o,t.frag)}else this.state="IDLE"}}this.onTickEnd()}resetLoadingState(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:t}=this;null!=t&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var t;const{hls:e,levels:i,media:r,trackId:s}=this;if(!this.buffering||!r&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||null==i||!i[s])return;const a=i[s],l=a.details;if(!l||this.waitForLive(a)||this.waitForCdnTuneIn(l))return this.state="WAITING_TRACK",void(this.startFragRequested=!1);const c=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&c&&(this.bufferFlushed=!1,this.afterBufferFlushed(c,"audio","audio"));const u=this.getFwdBufferInfo(c,"audio");if(null===u)return;if(!this.switchingTrack&&this._streamEnded(u,l))return e.trigger(v.BUFFER_EOS,{type:"audio"}),void(this.state="ENDED");const d=u.len,f=e.maxBufferLength,h=l.fragments,p=h[0].start,g=this.getLoadPosition(),m=this.flushing?g:u.end;if(this.switchingTrack&&r&&l.PTSKnown&&g<p&&(u.end>p||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=p+.05),d>=f&&!this.switchingTrack&&m<h[h.length-1].start)return;let _=this.getNextFragment(m,l);if(_&&this.isLoopLoading(_,m)&&(_=this.getNextFragmentLoopLoading(_,l,u,"main",f)),!_)return void(this.bufferFlushed=!0);let y=(null==(t=this.mainFragLoading)?void 0:t.frag)||null;if(!this.audioOnly&&this.startFragRequested&&y&&ln(_)&&!_.endList&&(!l.live||!this.loadingParts&&m<this.hls.liveSyncPosition)&&("OK"===this.fragmentTracker.getState(y)&&(this.mainFragLoading=y=null),y&&ln(y))){if(_.start>y.end){const S=this.fragmentTracker.getFragAtPos(m,"main");S&&S.end>y.end&&(y=S,this.mainFragLoading={frag:S,targetBufferTime:null})}if(_.start>y.end)return}this.loadFragment(_,a,m)}onMediaDetaching(t,e){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(t,e)}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map(i=>new _d(i))}onAudioTrackSwitching(t,e){const i=!!e.url;this.trackId=e.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),i?(this.switchingTrack=e,this.flushAudioIfNeeded(e),"STOPPED"!==this.state&&(this.setInterval(100),this.state="IDLE",this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=e,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(t,e){this.mainDetails=e.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(v.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(t,e){var i;const{levels:r}=this,{details:s,id:o,groupId:a,track:l}=e;if(!r)return void this.warn(`Audio tracks reset while loading track ${o} "${l.name}" of "${a}"`);const c=this.mainDetails;if(!c||s.endCC>c.endCC||c.expired)return this.cachedTrackLoadedData=e,void("STOPPED"!==this.state&&(this.state="WAITING_TRACK"));this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${l.name}" of "${a}" loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const u=r[o];let d=0;if(s.live||null!=(i=u.details)&&i.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;var f;u.details&&(d=this.alignPlaylists(s,u.details,null==(f=this.levelLastLoaded)?void 0:f.details)),s.alignedSliding||(SN(s,c),s.alignedSliding||dg(s,c),d=s.fragmentStart)}u.details=s,this.levelLastLoaded=u,this.startFragRequested||this.setStartPosition(c,d),this.hls.trigger(v.AUDIO_TRACK_UPDATED,{details:s,id:o,groupId:e.groupId}),"WAITING_TRACK"===this.state&&!this.waitForCdnTuneIn(s)&&(this.state="IDLE"),this.tick()}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:r,payload:s}=t,{config:o,trackId:a,levels:l}=this;if(!l)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const c=l[a];if(!c)return void this.warn("Audio track is undefined on fragment load progress");const u=c.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(i.start);const d=o.defaultAudioCodec||c.audioCodec||"mp4a.40.2";let f=this.transmuxer;f||(f=this.transmuxer=new QN(this.hls,"audio",this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[i.cc],p=null==(e=i.initSegment)?void 0:e.data;if(void 0!==h){const m=r?r.index:-1,y=new e1(i.level,i.sn,i.stats.chunkCount,s.byteLength,m,-1!==m);f.push(s,p,d,"",i,r,u.totalduration,!1,y,h)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${u.startSN} ,${u.endSN}],track ${a}`);const{cache:g}=this.waitingData=this.waitingData||{frag:i,part:r,cache:new DN,complete:!1};g.push(new Uint8Array(s)),"STOPPED"!==this.state&&(this.state="WAITING_INIT_PTS")}}_handleFragmentLoadComplete(t){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(t,e){this.bufferFlushed=this.flushing=!1;const i=e.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(t,e){!this.audioOnly&&"main"===e.frag.type&&ln(e.frag)&&(this.mainFragLoading=e,"IDLE"===this.state&&this.tick())}onFragBuffered(t,e){const{frag:i,part:r}=e;if("audio"===i.type)if(this.fragContextChanged(i))this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if(ln(i)){this.fragPrevious=i;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(v.AUDIO_TRACK_SWITCHED,ct({},s)))}this.fragBufferedComplete(i,r),this.media&&this.tick()}else!this.audioOnly&&"main"===i.type&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null)}onError(t,e){var i;if(e.fatal)this.state="ERROR";else switch(e.details){case N.FRAG_GAP:case N.FRAG_PARSING_ERROR:case N.FRAG_DECRYPT_ERROR:case N.FRAG_LOAD_ERROR:case N.FRAG_LOAD_TIMEOUT:case N.KEY_LOAD_ERROR:case N.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError("audio",e);break;case N.AUDIO_TRACK_LOAD_ERROR:case N.AUDIO_TRACK_LOAD_TIMEOUT:case N.LEVEL_PARSING_ERROR:!e.levelRetry&&"WAITING_TRACK"===this.state&&"audioTrack"===(null==(i=e.context)?void 0:i.type)&&(this.state="IDLE");break;case N.BUFFER_ADD_CODEC_ERROR:case N.BUFFER_APPEND_ERROR:if("audio"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)||this.resetLoadingState();break;case N.BUFFER_FULL_ERROR:if("audio"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case N.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onBufferFlushing(t,{type:e}){"video"!==e&&(this.flushing=!0)}onBufferFlushed(t,{type:e}){if("video"!==e){this.flushing=!1,this.bufferFlushed=!0,"ENDED"===this.state&&(this.state="IDLE");const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,e,"audio"),this.tick())}}_handleTransmuxComplete(t){var e;const i="audio",{hls:r}=this,{remuxResult:s,chunkMeta:o}=t,a=this.getCurrentContext(o);if(!a)return void this.resetWhenMissingContext(o);const{frag:l,part:c,level:u}=a,{details:d}=u,{audio:f,text:h,id3:p,initSegment:g}=s;if(!this.fragContextChanged(l)&&d){if(this.state="PARSING",this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),null!=g&&g.tracks){const m=l.initSegment||l;if(this.unhandledEncryptionError(g,l))return;this._bufferInitSegment(u,g.tracks,m,o),r.trigger(v.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:i,tracks:g.tracks})}if(f){const{startPTS:m,endPTS:_,startDTS:y,endDTS:b}=f;c&&(c.elementaryStreams.audio={startPTS:m,endPTS:_,startDTS:y,endDTS:b}),l.setElementaryStreamInfo("audio",m,_,y,b),this.bufferFragmentData(f,l,c,o)}if(null!=p&&null!=(e=p.samples)&&e.length){const m=vt({id:i,frag:l,details:d},p);r.trigger(v.FRAG_PARSING_METADATA,m)}if(h){const m=vt({id:i,frag:l,details:d},h);r.trigger(v.FRAG_PARSING_USERDATA,m)}}else this.fragmentTracker.removeFragment(l)}_bufferInitSegment(t,e,i,r){if("PARSING"!==this.state||(e.video&&delete e.video,e.audiovideo&&delete e.audiovideo,!e.audio))return;const s=e.audio;s.id="audio";const o=t.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${o}/${s.codec}]`),o&&1===o.split(",").length&&(s.levelCodec=o),this.hls.trigger(v.BUFFER_CODECS,e);const a=s.initSegment;null!=a&&a.byteLength&&this.hls.trigger(v.BUFFER_APPENDING,{type:"audio",frag:i,part:null,chunkMeta:r,parent:i.type,data:a}),this.tickImmediate()}loadFragment(t,e,i){const r=this.fragmentTracker.getState(t);var s;if(this.switchingTrack||"NOT_LOADED"===r||"PARTIAL"===r)if(ln(t))if(null!=(s=e.details)&&s.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state="WAITING_INIT_PTS";const o=this.mainDetails;o&&o.fragmentStart!==e.details.fragmentStart&&dg(e.details,o)}else super.loadFragment(t,e,i);else this._loadInitSegment(t,e);else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){const{name:e,lang:i,assocLang:r,characteristics:s,audioCodec:o,channels:a}=this.bufferedTrack;ha({name:e,lang:i,assocLang:r,characteristics:s,audioCodec:o,channels:a},t,pa)||(ng(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}}completeAudioSwitch(t){const{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(v.AUDIO_TRACK_SWITCHED,ct({},t))}},audioTrackController:class ZX extends C1{constructor(t){super(t,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.LEVEL_LOADING,this.onLevelLoading,this),t.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.LEVEL_LOADING,this.onLevelLoading,this),t.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(v.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){const{id:i,groupId:r,details:s}=e,o=this.tracksInGroup[i];if(!o||o.groupId!==r)return void this.warn(`Audio track with id:${i} and group:${r} not found in active group ${o?.groupId}`);const a=o.details;o.details=e.details,this.log(`Audio track ${i} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,a)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.audioGroups||null,r=this.groupIds;let s=this.currentTrack;if(!i||r?.length!==i?.length||null!=i&&i.some(a=>-1===r?.indexOf(a))){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(f=>!i||-1!==i.indexOf(f.groupId));if(a.length)this.selectDefaultTrack&&!a.some(f=>f.default)&&(this.selectDefaultTrack=!1),a.forEach((f,h)=>{f.id=h});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.audioPreference;if(!s&&l){const f=Zr(l,a,pa);if(f>-1)s=a[f];else{const h=Zr(l,this.tracks);s=this.tracks[h]}}let c=this.findTrackId(s);-1===c&&s&&(c=this.findTrackId(null));const u={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${i?.join(",")}`),this.hls.trigger(v.AUDIO_TRACKS_UPDATED,u);const d=this.trackId;if(-1!==c&&-1===d)this.setAudioTrack(c);else if(a.length&&-1===d){var o;const f=new Error(`No audio track selected for current audio group-ID(s): ${null==(o=this.groupIds)?void 0:o.join(",")} track count: ${a.length}`);this.warn(f.message),this.hls.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:f})}}}onError(t,e){e.fatal||!e.context||"audioTrack"===e.context.type&&e.context.id===this.trackId&&(!this.groupIds||-1!==this.groupIds.indexOf(e.context.groupId))&&this.checkRetry(e)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const e=this.hls;if(e.config.audioPreference=t,t){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const r=this.currentTrack;if(r&&ha(t,r,pa))return r;const s=Zr(t,this.tracksInGroup,pa);if(s>-1){const o=this.tracksInGroup[s];return this.setAudioTrack(s),o}if(r){let o=e.loadLevel;-1===o&&(o=e.firstAutoLevel);const a=function cZ(n,t,e,i,r){const s=t[i],a=t.reduce((f,h,p)=>{const g=h.uri;return(f[g]||(f[g]=[])).push(p),f},{})[s.uri];a.length>1&&(i=Math.max.apply(Math,a));const l=s.videoRange,c=s.frameRate,u=s.codecSet.substring(0,4),d=MO(t,i,f=>{if(f.videoRange!==l||f.frameRate!==c||f.codecSet.substring(0,4)!==u)return!1;const h=f.audioGroups,p=e.filter(g=>!h||-1!==h.indexOf(g.groupId));return Zr(n,p,r)>-1});return d>-1?d:MO(t,i,f=>{const h=f.audioGroups,p=e.filter(g=>!h||-1!==h.indexOf(g.groupId));return Zr(n,p,r)>-1})}(t,e.levels,i,o,pa);if(-1===a)return null;e.nextLoadLevel=a}if(t.channels||t.audioCodec){const o=Zr(t,i);if(o>-1)return i[o]}}}return null}setAudioTrack(t){const e=this.tracksInGroup;if(t<0||t>=e.length)return void this.warn(`Invalid audio track id: ${t}`);this.selectDefaultTrack=!1;const i=this.currentTrack,r=e[t],s=r.details&&!r.details.live;if(t===this.trackId&&r===i&&s||(this.log(`Switching to audio-track ${t} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=t,this.currentTrack=r,this.hls.trigger(v.AUDIO_TRACK_SWITCHING,ct({},r)),s))return;const o=this.switchParams(r.url,i?.details,r.details);this.loadPlaylist(o)}findTrackId(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const r=e[i];if((!this.selectDefaultTrack||r.default)&&(!t||ha(t,r,pa)))return i}if(t){const{name:i,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:l}=t;for(let c=0;c<e.length;c++)if(ha({name:i,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:l},e[c],pa))return c;for(let c=0;c<e.length;c++)if(Cd(t.attrs,e[c].attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return c;for(let c=0;c<e.length;c++)if(Cd(t.attrs,e[c].attrs,["LANGUAGE"]))return c}return-1}loadPlaylist(t){super.loadPlaylist();const e=this.currentTrack;this.shouldLoadPlaylist(e)&&ng(e.url,this.hls)&&this.scheduleLoading(e,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,r=t.groupId,s=this.getUrlWithDirectives(t.url,e),o=t.details,a=o?.age;this.log(`Loading audio-track ${i} "${t.name}" lang:${t.lang} group:${r}${void 0!==e?.msn?" at sn "+e.msn+" part "+e.part:""}${a&&o.live?" age "+a.toFixed(1)+(o.type?" "+o.type||0:""):""} ${s}`),this.hls.trigger(v.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null,track:t})}},emeController:ZJ,cmcdController:class qJ{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:"m",su:!this.initialized})}catch(s){this.hls.logger.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const{frag:s,part:o}=r,a=this.hls.levels[s.level],l=this.getObjectType(s),c={d:1e3*(o||s).duration,ot:l};("v"===l||"a"===l||"av"==l)&&(c.br=a.bitrate/1e3,c.tb=this.getTopBandwidth(l)/1e3,c.bl=this.getBufferLength(l));const u=o?this.getNextPart(o):this.getNextFrag(s);null!=u&&u.url&&u.url!==s.url&&(c.nor=u.url),this.apply(r,c)}catch(s){this.hls.logger.warn("Could not generate segment CMCD data.",s)}},this.hls=t;const e=this.config=t.config,{cmcd:i}=e;null!=i&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||t.sessionId,this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHED,this.onMediaDetached,this),t.on(v.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHED,this.onMediaDetached,this),t.off(v.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var i,r;this.audioBuffer=null==(i=e.tracks.audio)?void 0:i.buffer,this.videoBuffer=null==(r=e.tracks.video)?void 0:r.buffer}createData(){var t;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(t=this.media)?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){vt(e,this.createData()),this.starved&&("i"===e.ot||"v"===e.ot||"av"===e.ot)&&(e.bs=!0,e.su=!0,this.starved=!1),null==e.su&&(e.su=this.buffering);const{includeKeys:r}=this;r&&(e=Object.keys(e).reduce((o,a)=>(r.includes(a)&&(o[a]=e[a]),o),{}));const s={baseUrl:t.url};this.useHeaders?(t.headers||(t.headers={}),jJ(t.headers,e,s)):t.url=KJ(t.url,e,s)}getNextFrag(t){var e;const i=null==(e=this.hls.levels[t.level])?void 0:e.details;if(i)return i.fragments[t.sn-i.startSN+1]}getNextPart(t){var e;const{index:i,fragment:r}=t,s=null==(e=this.hls.levels[r.level])||null==(e=e.details)?void 0:e.partList;if(s){const{sn:o}=r;for(let a=s.length-1;a>=0;a--){const l=s[a];if(l.index===i&&l.fragment.sn===o)return s[a+1]}}}getObjectType(t){const{type:e}=t;return"subtitle"===e?"tt":"initSegment"===t.sn?"i":"audio"===e?"a":"main"===e?this.hls.audioTracks.length?"v":"av":void 0}getTopBandwidth(t){let i,e=0;const r=this.hls;if("a"===t)i=r.audioTracks;else{const s=r.maxAutoLevel;i=r.levels.slice(0,s>-1?s+1:r.levels.length)}return i.forEach(s=>{s.bitrate>e&&(e=s.bitrate)}),e>0?e:NaN}getBufferLength(t){const e=this.media,i="a"===t?this.audioBuffer:this.videoBuffer;return i&&e?1e3*Me.bufferInfo(i,e.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){const{pLoader:t}=this.config,e=this.applyPlaylistData,i=t||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){e(s),this.loader.load(s,o,a)}}}createFragmentLoader(){const{fLoader:t}=this.config,e=this.applyFragmentData,i=t||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){e(s),this.loader.load(s,o,a)}}}},contentSteeringController:class QJ extends er{constructor(t){super("content-steering",t.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((t,e)=>(-1===t.indexOf(e.pathwayId)&&t.push(e.pathwayId),t),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(t){this.updatePathwayPriority(t)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=1e3*this.timeToLoad-(performance.now()-this.updated);if(t>0)return void this.scheduleRefresh(this.uri,t)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const e=this.levels;e&&(this.levels=e.filter(i=>i!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){const{contentSteering:i}=e;null!==i&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){const{errorAction:i}=e;if(2===i?.action&&1===i.flags){const r=this.levels;let s=this._pathwayPriority,o=this.pathwayId;if(e.context){const{groupId:a,pathwayId:l,type:c}=e.context;a&&r?o=this.getPathwayForGroupId(a,c,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!s&&r&&(s=this.pathways()),s&&s.length>1&&(this.updatePathwayPriority(s),i.resolved=this.pathwayId!==o),e.details!==N.BUFFER_APPEND_ERROR||e.fatal?i.resolved||this.warn(`Could not resolve ${e.details} ("${e.error.message}") with content-steering for Pathway: ${o} levels: ${r&&r.length} priorities: ${It(s)} penalized: ${It(this.penalizedPathways)}`):i.resolved=!0}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(0===e.length){const i=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),e=this.getLevelsForPathway(i),this.pathwayId=i}return e.length!==t.length&&this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e}getLevelsForPathway(t){return null===this.levels?[]:this.levels.filter(e=>t===e.pathwayId)}updatePathwayPriority(t){let e;this._pathwayPriority=t;const i=this.penalizedPathways,r=performance.now();Object.keys(i).forEach(s=>{r-i[s]>3e5&&delete i[s]});for(let s=0;s<t.length;s++){const o=t[s];if(o in i)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(e=this.getLevelsForPathway(o),e.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,vN(e),this.hls.trigger(v.LEVELS_UPDATED,{levels:e});const c=this.hls.levels[a];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(t,e,i){const r=this.getLevelsForPathway(i).concat(this.levels||[]);for(let s=0;s<r.length;s++)if("audioTrack"===e&&r[s].hasAudioGroup(t)||"subtitleTrack"===e&&r[s].hasSubtitleGroup(t))return r[s].pathwayId;return i}clonePathways(t){const e=this.levels;if(!e)return;const i={},r={};t.forEach(s=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=s;if(e.some(u=>u.pathwayId===o))return;const c=this.getLevelsForPathway(a).map(u=>{const d=new Vt(u.attrs);d["PATHWAY-ID"]=o;const f=d.AUDIO&&`${d.AUDIO}_clone_${o}`,h=d.SUBTITLES&&`${d.SUBTITLES}_clone_${o}`;f&&(i[d.AUDIO]=f,d.AUDIO=f),h&&(r[d.SUBTITLES]=h,d.SUBTITLES=h);const p=mP(u.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),g=new _d({attrs:d,audioCodec:u.audioCodec,bitrate:u.bitrate,height:u.height,name:u.name,url:p,videoCodec:u.videoCodec,width:u.width});if(u.audioGroups)for(let m=1;m<u.audioGroups.length;m++)g.addGroupId("audio",`${u.audioGroups[m]}_clone_${o}`);if(u.subtitleGroups)for(let m=1;m<u.subtitleGroups.length;m++)g.addGroupId("text",`${u.subtitleGroups[m]}_clone_${o}`);return g});e.push(...c),gP(this.audioTracks,i,l,o),gP(this.subtitleTracks,r,l,o)})}loadSteeringManifest(t){const e=this.hls.config,i=e.loader;let r;this.loader&&this.loader.destroy(),this.loader=new i(e);try{r=new self.URL(t)}catch{return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${t}`)}if("data:"!==r.protocol){const u=0|(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate);r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+u)}const s={responseType:"json",url:r.href},o=e.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},c={onSuccess:(u,d,f,h)=>{this.log(`Loaded steering manifest: "${r}"`);const p=u.data;if(1!==p?.VERSION)return void this.log(`Steering VERSION ${p.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=p.TTL;const{"RELOAD-URI":g,"PATHWAY-CLONES":m,"PATHWAY-PRIORITY":_}=p;if(g)try{this.uri=new self.URL(g,r).href}catch{return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${g}`)}this.scheduleRefresh(this.uri||f.url),m&&this.clonePathways(m);const y={steeringManifest:p,url:r.toString()};this.hls.trigger(v.STEERING_MANIFEST_LOADED,y),_&&this.updatePathwayPriority(_)},onError:(u,d,f,h)=>{if(this.log(`Error loading steering manifest: ${u.code} ${u.text} (${d.url})`),this.stopLoad(),410===u.code)return this.enabled=!1,void this.log(`Steering manifest ${d.url} no longer available`);let p=1e3*this.timeToLoad;if(429!==u.code)this.scheduleRefresh(this.uri||d.url,p);else{const g=this.loader;if("function"==typeof g?.getResponseHeader){const m=g.getResponseHeader("Retry-After");m&&(p=1e3*parseFloat(m))}this.log(`Steering manifest ${d.url} rate limited`)}},onTimeout:(u,d,f)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,l,c)}scheduleRefresh(t,e=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const r=null==(i=this.hls)?void 0:i.media;!r||r.ended?this.scheduleRefresh(t,1e3*this.timeToLoad):this.loadSteeringManifest(t)},e)}},interstitialsController:class uee extends er{constructor(t,e){super("interstitials",t.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(void 0===i||this.playbackDisabled||!this.schedule)return;const r=i-this.timelinePos;if(Math.abs(r)<1/7056e5)return;const o=r<=-.01;this.timelinePos=i,this.bufferedPos=i;const a=this.playingItem;if(!a)return void this.checkBuffer();if(o&&this.schedule.resetErrorsInRange(i,i-r)&&this.updateSchedule(!0),this.checkBuffer(),o&&i<a.start||i>=a.end){var l;const h=this.findItemIndex(a);let p=this.schedule.findItemIndexAtTime(i);if(-1===p&&(p=h+(o?-1:1),this.log(`seeked ${o?"back ":""}to position not covered by schedule ${i} (resolving from ${h} to ${p})`)),!this.isInterstitial(a)&&null!=(l=this.media)&&l.paused&&(this.shouldPlay=!1),!o&&p>h){const g=this.schedule.findJumpRestrictedIndex(h+1,p);if(g>h)return void this.setSchedulePosition(g)}return void this.setSchedulePosition(p)}const c=this.playingAsset;if(!c){if(this.playingLastItem&&this.isInterstitial(a)){const h=a.event.assetList[0];h&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,h))}return}const u=c.timelineStart;var f;(o&&i<u||i>=u+(c.duration||0))&&(null!=(f=a.event)&&f.appendInPlace&&(this.clearInterstitial(a.event,a),this.flushFrontBuffer(i)),this.setScheduleToAssetAtTime(i,c))},this.onTimeupdate=()=>{const i=this.currentTime;if(void 0===i||this.playbackDisabled)return;if(!(i>this.timelinePos))return;this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();const r=this.playingItem;if(!r||this.playingLastItem)return;if(i>=r.end){this.timelinePos=r.end;const a=this.findItemIndex(r);this.setSchedulePosition(a+1)}const s=this.playingAsset;s&&i>=s.timelineStart+(s.duration||0)&&this.setScheduleToAssetAtTime(i,s)},this.onScheduleUpdate=(i,r)=>{const s=this.schedule;if(!s)return;const o=this.playingItem,a=s.events||[],l=s.items||[],c=s.durations,u=i.map(g=>g.identifier),d=!(!a.length&&!u.length);(d||r)&&this.log(`INTERSTITIALS_UPDATED (${a.length}): ${a}\nSchedule: ${l.map(g=>Sr(g))} pos: ${this.timelinePos}`),u.length&&this.log(`Removed events ${u}`);let f=null,h=null;o&&(f=this.updateItem(o,this.timelinePos),this.itemsMatch(o,f)?this.playingItem=f:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const p=this.bufferingItem;if(p&&(h=this.updateItem(p,this.bufferedPos),this.itemsMatch(p,h)?this.bufferingItem=h:p.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(p.event,null))),i.forEach(g=>{g.assetList.forEach(m=>{this.clearAssetPlayer(m.identifier,null)})}),this.playerQueue.forEach(g=>{if(g.interstitial.appendInPlace){const m=g.assetItem.timelineStart,_=g.timelineOffset-m;if(_)try{g.timelineOffset=m}catch(y){Math.abs(_)>ic&&this.warn(`${y} ("${g.assetId}" ${g.timelineOffset}->${m})`)}}}),d||r){if(this.hls.trigger(v.INTERSTITIALS_UPDATED,{events:a.slice(0),schedule:l.slice(0),durations:c,removedIds:u}),this.isInterstitial(o)&&u.includes(o.event.identifier))return this.warn(`Interstitial "${o.event.identifier}" removed while playing`),void this.primaryFallback(o.event);o&&this.trimInPlace(f,o),p&&h!==f&&this.trimInPlace(h,p),this.checkBuffer()}},this.hls=t,this.HlsPlayerClass=e,this.assetListLoader=new cee(t),this.schedule=new lee(this.onScheduleUpdate,t.logger),this.registerListeners()}registerListeners(){const t=this.hls;t&&(t.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(v.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.on(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(v.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.on(v.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.on(v.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.on(v.BUFFER_APPENDED,this.onBufferAppended,this),t.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(v.BUFFERED_TO_END,this.onBufferedToEnd,this),t.on(v.MEDIA_ENDED,this.onMediaEnded,this),t.on(v.ERROR,this.onError,this),t.on(v.DESTROYING,this.onDestroying,this))}unregisterListeners(){const t=this.hls;t&&(t.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(v.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.off(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(v.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.off(v.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.off(v.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.off(v.BUFFER_CODECS,this.onBufferCodecs,this),t.off(v.BUFFER_APPENDED,this.onBufferAppended,this),t.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(v.BUFFERED_TO_END,this.onBufferedToEnd,this),t.off(v.MEDIA_ENDED,this.onMediaEnded,this),t.off(v.ERROR,this.onError,this),t.off(v.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var t;null==(t=this.getBufferingPlayer())||t.resumeBuffering()}pauseBuffering(){var t;null==(t=this.getBufferingPlayer())||t.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const t=this.primaryMedia||this.media;t&&this.removeMediaListeners(t)}removeMediaListeners(t){di(t,"play",this.onPlay),di(t,"pause",this.onPause),di(t,"seeking",this.onSeeking),di(t,"timeupdate",this.onTimeupdate)}onMediaAttaching(t,e){const i=this.media=e.media;Zn(i,"seeking",this.onSeeking),Zn(i,"timeupdate",this.onTimeupdate),Zn(i,"play",this.onPlay),Zn(i,"pause",this.onPause)}onMediaAttached(t,e){const i=this.effectivePlayingItem,r=this.detachedData;if(this.detachedData=null,null===i)this.checkStart();else if(!r){this.clearScheduleState();const s=this.findItemIndex(i);this.setSchedulePosition(s)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(t,e){const i=!!e.transferMedia,r=this.media;if(this.media=null,!i&&(r&&this.removeMediaListeners(r),this.detachedData)){const s=this.getBufferingPlayer();s&&(this.log(`Removing schedule state for detachedData and ${s}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,s.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const t=this,e=()=>t.bufferingItem||t.waitingItem,i=d=>d&&t.getAssetPlayer(d.identifier),r=(d,f,h,p,g)=>{if(d){let m=d[f].start;const _=d.event;if(_){if("playout"===f||_.timelineOccupancy!==Dg.Point){const y=i(h);y?.interstitial===_&&(m+=y.assetItem.startOffset+y[g])}}else m+=("bufferedPos"===p?o():t[p])-d.start;return m}return 0},o=()=>{const d=t.bufferedPos;return d===Number.MAX_VALUE?a("primary"):Math.max(d,0)},a=d=>{var f,h;return null!=(f=t.primaryDetails)&&f.live?t.primaryDetails.edge:(null==(h=t.schedule)?void 0:h.durations[d])||0},l=(d,f)=>{var h,p;const g=t.effectivePlayingItem;if(null!=g&&null!=(h=g.event)&&h.restrictions.skip||!t.schedule)return;t.log(`seek to ${d} "${f}"`);const m=t.effectivePlayingItem,_=t.schedule.findItemIndexAtTime(d,f),y=null==(p=t.schedule.items)?void 0:p[_],b=t.getBufferingPlayer(),S=b?.interstitial,C=S?.appendInPlace,k=m&&t.itemsMatch(m,y);if(m&&(C||k)){const I=i(t.playingAsset),M=I?.media||t.primaryMedia;if(M){const O="primary"===f?M.currentTime:r(m,f,t.playingAsset,"timelinePos","currentTime"),B=(C?O:M.currentTime)+(d-O);if(B>=0&&(!I||C||B<=I.duration))return void(M.currentTime=B)}}if(y){let I=d;"primary"!==f&&(I=y.start+(d-y[f].start));const M=!t.isInterstitial(y);if(t.isInterstitial(m)&&!m.event.appendInPlace||!M&&!y.event.appendInPlace){if(m){const O=t.findItemIndex(m);if(_>O){const B=t.schedule.findJumpRestrictedIndex(O+1,_);if(B>O)return void t.setSchedulePosition(B)}let x=0;if(M)t.timelinePos=I,t.checkBuffer();else{const B=y.event.assetList,K=d-(y[f]||y).start;for(let ee=B.length;ee--;){const oe=B[ee];if(oe.duration&&K>=oe.startOffset&&K<oe.startOffset+oe.duration){x=ee;break}}}t.setSchedulePosition(_,x)}}else{const O=t.media||(C?b?.media:null);O&&(O.currentTime=I)}}},c=()=>{const d=t.effectivePlayingItem;if(t.isInterstitial(d))return d;const f=e();return t.isInterstitial(f)?f:null},u={get bufferedEnd(){const d=e(),f=t.bufferingItem;var h;return f&&f===d&&(r(f,"playout",t.bufferingAsset,"bufferedPos","bufferedEnd")-f.playout.start||(null==(h=t.bufferingAsset)?void 0:h.startOffset))||0},get currentTime(){const d=c(),f=t.effectivePlayingItem;return f&&f===d?r(f,"playout",t.effectivePlayingAsset,"timelinePos","currentTime")-f.playout.start:0},set currentTime(d){const f=c(),h=t.effectivePlayingItem;h&&h===f&&l(d+h.playout.start,"playout")},get duration(){const d=c();return d?d.playout.end-d.playout.start:0},get assetPlayers(){var d;const f=null==(d=c())?void 0:d.event.assetList;return f?f.map(h=>t.getAssetPlayer(h.identifier)):[]},get playingIndex(){var d;const f=null==(d=c())?void 0:d.event;return f&&t.effectivePlayingAsset?f.findAssetIndex(t.effectivePlayingAsset):-1},get scheduleItem(){return c()}};return this.manager={get events(){var d;return(null==(d=t.schedule)||null==(d=d.events)?void 0:d.slice(0))||[]},get schedule(){var d;return(null==(d=t.schedule)||null==(d=d.items)?void 0:d.slice(0))||[]},get interstitialPlayer(){return c()?u:null},get playerQueue(){return t.playerQueue.slice(0)},get bufferingAsset(){return t.bufferingAsset},get bufferingItem(){return e()},get bufferingIndex(){const d=e();return t.findItemIndex(d)},get playingAsset(){return t.effectivePlayingAsset},get playingItem(){return t.effectivePlayingItem},get playingIndex(){return t.findItemIndex(t.effectivePlayingItem)},primary:{get bufferedEnd(){return o()},get currentTime(){const d=t.timelinePos;return d>0?d:0},set currentTime(d){l(d,"primary")},get duration(){return a("primary")},get seekableStart(){var d;return(null==(d=t.primaryDetails)?void 0:d.fragmentStart)||0}},integrated:{get bufferedEnd(){return r(e(),"integrated",t.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return r(t.effectivePlayingItem,"integrated",t.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(d){l(d,"integrated")},get duration(){return a("integrated")},get seekableStart(){var d;return((d,f)=>{var h;if(0!==d&&null!=(h=t.schedule)&&h.length){var p;const g=t.schedule.findItemIndexAtTime(d),m=null==(p=t.schedule.items)?void 0:p[g];if(m)return d+(m[f].start-m.start)}return d})((null==(d=t.primaryDetails)?void 0:d.fragmentStart)||0,"integrated")}},skip:()=>{const d=t.effectivePlayingItem,f=d?.event;if(f&&!f.restrictions.skip){const h=t.findItemIndex(d);f.appendInPlace?l(d.playout.start+d.event.duration+.001,"playout"):t.advanceAfterAssetEnded(f,h,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var t;const e=this.playingItem,i=null==(t=this.schedule)?void 0:t.items;return!!(this.playbackStarted&&e&&i)&&this.findItemIndex(e)===i.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var t,e;if(null===this.mediaSelection)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let r=this.media;!r&&null!=(t=this.bufferingItem)&&null!=(t=t.event)&&t.appendInPlace&&(r=this.primaryMedia);const s=null==(e=r)?void 0:e.currentTime;return void 0!==s&&re(s)?s:void 0}get primaryMedia(){var t;return this.media||(null==(t=this.detachedData)?void 0:t.media)||null}isInterstitial(t){return!(null==t||!t.event)}retreiveMediaSource(t,e){const i=this.getAssetPlayer(t);i&&this.transferMediaFromPlayer(i,e)}transferMediaFromPlayer(t,e){const r=t.media;if(t.interstitial.appendInPlace&&r===this.primaryMedia){if(this.bufferingAsset=null,(!e||this.isInterstitial(e)&&!e.event.appendInPlace)&&e&&r)return void(this.detachedData={media:r});const s=t.transferMedia();this.log(`transfer MediaSource from ${t} ${It(s)}`),this.detachedData=s}else e&&r&&(this.shouldPlay||(this.shouldPlay=!r.paused))}transferMediaTo(t,e){var i,r;if(t.media===e)return;let s=null;const o=this.hls,a=t!==o,l=a&&t.interstitial.appendInPlace,c=null==(i=this.detachedData)?void 0:i.mediaSource;let u;if(o.media)l&&(s=o.transferMedia(),this.detachedData=s),u="Primary";else if(c){const p=this.getBufferingPlayer();p?(s=p.transferMedia(),u=`${p}`):u="detached MediaSource"}else u="detached media";if(!s)if(c)s=this.detachedData,this.log(`using detachedData: MediaSource ${It(s)}`);else if(!this.detachedData||o.media===e){const p=this.playerQueue;p.length>1&&p.forEach(g=>{if(a&&g.interstitial.appendInPlace!==l){const m=g.interstitial;this.clearInterstitial(g.interstitial,null),m.appendInPlace=!1,m.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${m}`)}}),this.hls.detachMedia(),this.detachedData={media:e}}const d=s&&"mediaSource"in s&&"closed"!==(null==(r=s.mediaSource)?void 0:r.readyState),f=d&&s?s:e;this.log(`${d?"transfering MediaSource":"attaching media"} to ${a?t:"Primary"} from ${u} (media.currentTime: ${e.currentTime})`);const h=this.schedule;f===s&&h&&(f.overrides={duration:h.duration,endOfStream:!a||a&&t.assetId===h.assetIdAtEnd,cueRemoval:!a}),t.attachMedia(f)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const t=this.schedule,e=t?.events;if(!e||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const r=this.effectivePlayingItem;if(-1===this.timelinePos){const s=this.hls.startPosition;if(this.log(Cg("checkStart",s)),this.timelinePos=s,e.length&&e[0].cue.pre){const o=t.findEventIndex(e[0].identifier);this.setSchedulePosition(o)}else if(s>=0||!this.primaryLive){const o=this.timelinePos=s>0?s:0,a=t.findItemIndexAtTime(o);this.setSchedulePosition(a)}}else if(r&&!this.playingItem){const s=t.findItemIndex(r);this.setSchedulePosition(s)}}advanceAssetBuffering(t,e){const i=t.event,r=i.findAssetIndex(e),s=L1(i,r);if(i.isAssetPastPlayoutLimit(s)){if(this.schedule){var o;const a=null==(o=this.schedule.items)?void 0:o[this.findItemIndex(t)+1];a&&this.bufferedToItem(a)}}else this.bufferedToEvent(t,s)}advanceAfterAssetEnded(t,e,i){const r=L1(t,i);if(t.isAssetPastPlayoutLimit(r)){if(this.schedule){const s=this.schedule.items;if(s){const o=e+1;if(o>=s.length)return void this.setSchedulePosition(-1);const l=t.resumeTime;this.timelinePos<l&&(this.log(Cg("advanceAfterAssetEnded",l)),this.timelinePos=l,t.appendInPlace&&this.advanceInPlace(l),this.checkBuffer(this.bufferedPos<l)),this.setSchedulePosition(o)}}}else{if(t.appendInPlace){const s=t.assetList[r];s&&this.advanceInPlace(s.timelineStart)}this.setSchedulePosition(e,r)}}setScheduleToAssetAtTime(t,e){const i=this.schedule;if(!i)return;const r=e.parentIdentifier,s=i.getEvent(r);if(s){const o=i.findEventIndex(r),a=i.findAssetIndex(s,t);this.advanceAfterAssetEnded(s,o,a-1)}}setSchedulePosition(t,e){var i;const r=null==(i=this.schedule)?void 0:i.items;if(!r||this.playbackDisabled)return;const s=t>=0?r[t]:null;this.log(`setSchedulePosition ${t}, ${e} (${s&&Sr(s)}) pos: ${this.timelinePos}`);const o=this.waitingItem||this.playingItem,a=this.playingLastItem;if(this.isInterstitial(o)){const u=o.event,d=this.playingAsset,f=d?.identifier,h=f?this.getAssetPlayer(f):null;if(h&&f&&(!this.eventItemsMatch(o,s)||void 0!==e&&f!==u.assetList[e].identifier)){var l;const p=u.findAssetIndex(d);if(this.log(`INTERSTITIAL_ASSET_ENDED ${p+1}/${u.assetList.length} ${rc(d)}`),this.endedAsset=d,this.playingAsset=null,this.hls.trigger(v.INTERSTITIAL_ASSET_ENDED,{asset:d,assetListIndex:p,event:u,schedule:r.slice(0),scheduleIndex:t,player:h}),o!==this.playingItem)return void(this.itemsMatch(o,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(u,this.findItemIndex(this.playingItem),p));this.retreiveMediaSource(f,s),h.media&&(null==(l=this.detachedData)||!l.mediaSource)&&h.detachMedia()}if(!this.eventItemsMatch(o,s)&&(this.endedItem=o,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${u} ${Sr(o)}`),u.hasPlayed=!0,this.hls.trigger(v.INTERSTITIAL_ENDED,{event:u,schedule:r.slice(0),scheduleIndex:t}),u.cue.once)){var c;this.updateSchedule();const p=null==(c=this.schedule)?void 0:c.items;if(s&&p){const g=this.findItemIndex(s);this.advanceSchedule(g,p,e,o,a)}return}}this.advanceSchedule(t,r,e,o,a)}advanceSchedule(t,e,i,r,s){const o=this.schedule;if(!o)return;const a=e[t]||null,l=this.primaryMedia,c=this.playerQueue;if(c.length&&c.forEach(u=>{const d=u.interstitial,f=o.findEventIndex(d.identifier);(f<t||f>t+1)&&this.clearInterstitial(d,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const u=a.event;if(void 0===i){const p=L1(u,(i=o.findAssetIndex(u,this.timelinePos))-1);if(u.isAssetPastPlayoutLimit(p)||u.appendInPlace&&this.timelinePos===a.end)return void this.advanceAfterAssetEnded(u,t,i);i=p}const d=this.waitingItem;this.assetsBuffered(a,l)||this.setBufferingItem(a);let f=this.preloadAssets(u,i);if(this.eventItemsMatch(a,d||r)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${Sr(a)} ${u.appendInPlace?"append in place":""}`),this.hls.trigger(v.INTERSTITIAL_STARTED,{event:u,schedule:e.slice(0),scheduleIndex:t})),!u.assetListLoaded)return void this.log(`Waiting for ASSET-LIST to complete loading ${u}`);if(u.assetListLoader&&(u.assetListLoader.destroy(),u.assetListLoader=void 0),!l)return void this.log(`Waiting for attachMedia to start Interstitial ${u}`);this.waitingItem=this.endedItem=null,this.playingItem=a;const h=u.assetList[i];if(!h)return void this.advanceAfterAssetEnded(u,t,i||0);if(f||(f=this.getAssetPlayer(h.identifier)),(null===f||f.destroyed)&&(this.warn(`asset ${i+1}/${u.assetList.length} player destroyed ${u}`),f=this.createAssetPlayer(u,h,i),f.loadSource()),!this.eventItemsMatch(a,this.bufferingItem)&&u.appendInPlace&&this.isAssetBuffered(h))return;this.startAssetPlayer(f,i,e,t,l),this.shouldPlay&&SP(f.media)}else a?(this.resumePrimary(a,t,r),this.shouldPlay&&SP(this.hls.media)):s&&this.isInterstitial(r)&&(this.endedItem=null,this.playingItem=r,r.event.appendInPlace||this.attachPrimary(o.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var t;return null==(t=this.mediaSelection)?void 0:t.main.details}get primaryLive(){var t;return!(null==(t=this.primaryDetails)||!t.live)}resumePrimary(t,e,i){var r,s;if(this.playingItem=t,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(t),this.log(`resuming ${Sr(t)}`),null==(r=this.detachedData)||!r.mediaSource){let a=this.timelinePos;(a<t.start||a>=t.end)&&(a=this.getPrimaryResumption(t,e),this.log(Cg("resumePrimary",a)),this.timelinePos=a),this.attachPrimary(a,t)}if(!i)return;const o=null==(s=this.schedule)?void 0:s.items;o&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Sr(t)}`),this.hls.trigger(v.INTERSTITIALS_PRIMARY_RESUMED,{schedule:o.slice(0),scheduleIndex:e}),this.checkBuffer())}getPrimaryResumption(t,e){const i=t.start;if(this.primaryLive){const r=this.primaryDetails;if(0===e)return this.hls.startPosition;if(r&&(i<r.fragmentStart||i>r.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(t){const e=this.getAssetPlayer(t.identifier);return null!=e&&e.hls?e.hls.bufferedToEnd:Me.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=t.timelineStart+(t.duration||0)}attachPrimary(t,e,i){e?this.setBufferingItem(e):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const r=this.primaryMedia;if(!r)return;const s=this.hls;s.media?this.checkBuffer():(this.transferMediaTo(s,r),i&&this.startLoadingPrimaryAt(t,i)),i||(this.log(Cg("attachPrimary",t)),this.timelinePos=t,this.startLoadingPrimaryAt(t,i))}startLoadingPrimaryAt(t,e){var i;const r=this.hls;!r.loadingEnabled||!r.media||Math.abs(((null==(i=r.mainForwardBufferInfo)?void 0:i.start)||r.media.currentTime)-t)>.5?r.startLoad(t,e):r.bufferingEnabled||r.resumeBuffering()}onManifestLoading(){var t;this.stopLoad(),null==(t=this.schedule)||t.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(v.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(v.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(t,e){if(-1===e.level||!this.schedule)return;const i=this.hls.levels[e.level];if(!i.details)return;const r=ct(ct({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=r,this.schedule.parseInterstitialDateRanges(r,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(t,e){const i=this.hls.audioTracks[e.id],r=this.mediaSelection;if(!r)return void(this.altSelection=ct(ct({},this.altSelection),{},{audio:i}));const s=ct(ct({},r),{},{audio:i});this.mediaSelection=s}onSubtitleTrackUpdated(t,e){const i=this.hls.subtitleTracks[e.id],r=this.mediaSelection;if(!r)return void(this.altSelection=ct(ct({},this.altSelection),{},{subtitles:i}));const s=ct(ct({},r),{},{subtitles:i});this.mediaSelection=s}onAudioTrackSwitching(t,e){const i=AO(e);this.playerQueue.forEach(({hls:r})=>r&&(r.setAudioOption(e)||r.setAudioOption(i)))}onSubtitleTrackSwitch(t,e){const i=AO(e);this.playerQueue.forEach(({hls:r})=>r&&(r.setSubtitleOption(e)||-1!==e.id&&r.setSubtitleOption(i)))}onBufferCodecs(t,e){const i=e.tracks;i&&(this.requiredTracks=i)}onBufferAppended(t,e){this.checkBuffer()}onBufferFlushed(t,e){const i=this.playingItem;!i||this.itemsMatch(i,this.bufferingItem)||this.isInterstitial(i)||(this.bufferedPos=this.timelinePos,this.checkBuffer())}onBufferedToEnd(t){if(!this.schedule)return;const e=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&e){for(let r=0;r<e.length;r++){const s=e[r];if(s.cue.post){var i;const o=this.schedule.findEventIndex(s.identifier),a=null==(i=this.schedule.items)?void 0:i[o];this.isInterstitial(a)&&this.eventItemsMatch(a,this.bufferingItem)&&this.bufferedToItem(a,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(t){const e=this.playingItem;if(!this.playingLastItem&&e){const i=this.findItemIndex(e);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(t,e){var i;const r=null==(i=this.schedule)?void 0:i.items;return t&&r&&r[this.findItemIndex(t,e)]||null}trimInPlace(t,e){if(this.isInterstitial(t)&&t.event.appendInPlace&&e.end-t.end>.25){t.event.assetList.forEach((s,o)=>{t.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(s.identifier,null)});const i=t.end+.25,r=Me.bufferInfo(this.primaryMedia,i,0);(r.end>i||(r.nextStart||0)>i)&&(this.log(`trim buffered interstitial ${Sr(t)} (was ${Sr(e)})`),this.attachPrimary(i,null,!0),this.flushFrontBuffer(i))}}itemsMatch(t,e){return!!e&&(t===e||t.event&&e.event&&this.eventItemsMatch(t,e)||!t.event&&!e.event&&this.findItemIndex(t)===this.findItemIndex(e))}eventItemsMatch(t,e){var i;return!!e&&(t===e||t.event.identifier===(null==(i=e.event)?void 0:i.identifier))}findItemIndex(t,e){return t&&this.schedule?this.schedule.findItemIndex(t,e):-1}updateSchedule(t=!1){var e;const i=this.mediaSelection;i&&(null==(e=this.schedule)||e.updateSchedule(i,[],t))}checkBuffer(t){var e;const i=null==(e=this.schedule)?void 0:e.items;if(!i)return;const r=Me.bufferInfo(this.primaryMedia,this.timelinePos,0);t&&(this.bufferedPos=this.timelinePos),t||(t=r.len<1),this.updateBufferedPos(r.end,i,t)}updateBufferedPos(t,e,i){const r=this.schedule,s=this.bufferingItem;if(this.bufferedPos>t||!r)return;if(1===e.length&&this.itemsMatch(e[0],s))return void(this.bufferedPos=t);const o=this.playingItem,a=this.findItemIndex(o);let l=r.findItemIndexAtTime(t);if(this.bufferedPos<t){var c;const u=this.findItemIndex(s),d=Math.min(u+1,e.length-1),f=e[d];if((-1===l&&s&&t>=s.end||null!=(c=f.event)&&c.appendInPlace&&t+.01>=f.start)&&(l=d),this.isInterstitial(s)){const h=s.event;if(d-a>1&&!1===h.appendInPlace||0===h.assetList.length&&h.assetListLoader)return}if(this.bufferedPos=t,l>u&&l>a)this.bufferedToItem(f);else{const h=this.primaryDetails;this.primaryLive&&h&&t>h.edge-h.targetduration&&f.start<h.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(f)&&this.preloadAssets(f.event,0)}}else i&&o&&!this.itemsMatch(o,s)&&(l===a?this.bufferedToItem(o):l===a+1&&this.bufferedToItem(e[l]))}assetsBuffered(t,e){return 0!==t.event.assetList.length&&!t.event.assetList.some(r=>{const s=this.getAssetPlayer(r.identifier);return!(null!=s&&s.bufferedInPlaceToEnd(e))})}setBufferingItem(t){const e=this.bufferingItem,i=this.schedule;if(!this.itemsMatch(t,e)&&i){const{items:r,events:s}=i;if(!r||!s)return e;const o=this.isInterstitial(t),a=this.getBufferingPlayer();this.bufferingItem=t,this.bufferedPos=Math.max(t.start,Math.min(t.end,this.timelinePos));const l=a?a.remaining:e?e.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Sr(t)}`+(e?` (${l.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(o){const c=i.findAssetIndex(t.event,this.bufferedPos);t.event.assetList.forEach((u,d)=>{const f=this.getAssetPlayer(u.identifier);f&&(d===c&&f.loadSource(),f.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(c=>c.pauseBuffering());this.hls.trigger(v.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:s.slice(0),schedule:r.slice(0),bufferingIndex:this.findItemIndex(t),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==t&&(this.bufferingItem=t);return e}bufferedToItem(t,e=0){const i=this.setBufferingItem(t);if(!this.playbackDisabled)if(this.isInterstitial(t))this.bufferedToEvent(t,e);else if(null!==i){this.bufferingAsset=null;const r=this.detachedData;r&&r.mediaSource?this.attachPrimary(t.start,t,!0):this.preloadPrimary(t)}}preloadPrimary(t){const e=this.findItemIndex(t),i=this.getPrimaryResumption(t,e);this.startLoadingPrimaryAt(i)}bufferedToEvent(t,e){const i=t.event;if(0===i.assetList.length&&!i.assetListLoader||!i.cue.once){const o=this.preloadAssets(i,e);if(null!=o&&o.interstitial.appendInPlace){const a=this.primaryMedia;a&&this.bufferAssetPlayer(o,a)}}}preloadAssets(t,e){const i=t.assetUrl,r=t.assetList.length;if(0!==r||t.assetListLoader){if(!t.cue.once&&r){for(let c=e;c<r;c++){const u=t.assetList[c],d=this.getAssetPlayerQueueIndex(u.identifier);(-1===d||this.playerQueue[d].destroyed)&&!u.error&&this.createAssetPlayer(t,u,c)}const l=t.assetList[e];if(l){const c=this.getAssetPlayer(l.identifier);return c&&c.loadSource(),c}}}else{const l=t.timelineStart;if(t.appendInPlace){var a;const f=this.playingItem;!this.isInterstitial(f)&&(null==f||null==(a=f.nextEvent)?void 0:a.identifier)===t.identifier&&this.flushFrontBuffer(l+.25)}let c,u=0;if(!this.playingItem&&this.primaryLive&&(u=this.hls.startPosition,-1===u&&(u=this.hls.liveSyncPosition||0)),u&&!t.cue.pre&&!t.cue.post){const f=u-l;f>0&&(c=Math.round(1e3*f)/1e3)}if(this.log(`Load interstitial asset ${e+1}/${i?1:r} ${t}${c?` live-start: ${u} start-offset: ${c}`:""}`),i)return this.createAsset(t,0,0,l,t.duration,i);const d=this.assetListLoader.loadAssetList(t,c);d&&(t.assetListLoader=d)}return null}flushFrontBuffer(t){const e=this.requiredTracks;e&&(this.log(`Removing front buffer starting at ${t}`),Object.keys(e).forEach(r=>{this.hls.trigger(v.BUFFER_FLUSHING,{startOffset:t,endOffset:1/0,type:r})}))}getAssetPlayerQueueIndex(t){const e=this.playerQueue;for(let i=0;i<e.length;i++)if(t===e[i].assetId)return i;return-1}getAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);return this.playerQueue[e]||null}getBufferingPlayer(){const{playerQueue:t,primaryMedia:e}=this;if(e)for(let i=0;i<t.length;i++)if(t[i].media===e)return t[i];return null}createAsset(t,e,i,r,s,o){const a={parentIdentifier:t.identifier,identifier:ree(t,o,e),duration:s,startOffset:i,timelineStart:r,uri:o};return this.createAssetPlayer(t,a,e)}createAssetPlayer(t,e,i){const r=this.hls,s=r.userConfig;let o=s.videoPreference;const a=r.loadLevelObj||r.levels[r.currentLevel];(o||a)&&(o=vt({},o),a.videoCodec&&(o.videoCodec=a.videoCodec),a.videoRange&&(o.allowedVideoRanges=[a.videoRange]));const l=r.audioTracks[r.audioTrack],c=r.subtitleTracks[r.subtitleTrack];let u=0;if(this.primaryLive||t.appendInPlace){const S=this.timelinePos-e.timelineStart;if(S>1){const C=e.duration;C&&S<C&&(u=S)}}const d=e.identifier,f=ct(ct({},s),{},{maxMaxBufferLength:Math.min(180,r.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:r.sessionId,assetPlayerId:d,abrEwmaDefaultEstimate:r.bandwidthEstimate,interstitialsController:void 0,startPosition:u,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:l||s.audioPreference,subtitlePreference:c||s.subtitlePreference});t.appendInPlace&&(t.appendInPlaceStarted=!0,e.timelineStart&&(f.timelineOffset=e.timelineStart));const h=f.cmcd;null!=h&&h.sessionId&&h.contentId&&(f.cmcd=vt({},h,{contentId:Id(e.uri)})),this.getAssetPlayer(d)&&this.warn(`Duplicate date range identifier ${t} and asset ${d}`);const p=new aee(this.HlsPlayerClass,f,t,e);this.playerQueue.push(p),t.assetList[i]=e;let g=!0;const m=S=>{if(S.live){var C;const M=new Error(`Interstitials MUST be VOD assets ${t}`),O={fatal:!0,type:fe.OTHER_ERROR,details:N.INTERSTITIAL_ASSET_ITEM_ERROR,error:M},x=(null==(C=this.schedule)?void 0:C.findEventIndex(t.identifier))||-1;return void this.handleAssetItemError(O,t,x,i,M.message)}const k=S.edge-S.fragmentStart,I=e.duration;(g||null===I||k>I)&&(g=!1,this.log(`Interstitial asset "${d}" duration change ${I} > ${k}`),e.duration=k,this.updateSchedule())};p.on(v.LEVEL_UPDATED,(S,{details:C})=>m(C)),p.on(v.LEVEL_PTS_UPDATED,(S,{details:C})=>m(C)),p.on(v.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const _=(S,C)=>{const k=this.getAssetPlayer(d);if(k&&C.tracks){k.off(v.BUFFER_CODECS,_),k.tracks=C.tracks;const I=this.primaryMedia;this.bufferingAsset===k.assetItem&&I&&!k.media&&this.bufferAssetPlayer(k,I)}};p.on(v.BUFFER_CODECS,_),p.on(v.BUFFERED_TO_END,()=>{var S;const C=this.getAssetPlayer(d);if(this.log(`buffered to end of asset ${C}`),!C||!this.schedule)return;const k=this.schedule.findEventIndex(t.identifier),I=null==(S=this.schedule.items)?void 0:S[k];this.isInterstitial(I)&&this.advanceAssetBuffering(I,e)});const b=S=>()=>{if(!this.getAssetPlayer(d)||!this.schedule)return;this.shouldPlay=!0;const k=this.schedule.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,k,S)};return p.once(v.MEDIA_ENDED,b(i)),p.once(v.PLAYOUT_LIMIT_REACHED,b(1/0)),p.on(v.ERROR,(S,C)=>{if(!this.schedule)return;const k=this.getAssetPlayer(d);if(C.details===N.BUFFER_STALLED_ERROR)return null!=k&&k.appendInPlace?void this.handleInPlaceStall(t):(this.onTimeupdate(),void this.checkBuffer(!0));this.handleAssetItemError(C,t,this.schedule.findEventIndex(t.identifier),i,`Asset player error ${C.error} ${t}`)}),p.on(v.DESTROYING,()=>{if(!this.getAssetPlayer(d)||!this.schedule)return;const C=new Error(`Asset player destroyed unexpectedly ${d}`);this.handleAssetItemError({fatal:!0,type:fe.OTHER_ERROR,details:N.INTERSTITIAL_ASSET_ITEM_ERROR,error:C},t,this.schedule.findEventIndex(t.identifier),i,C.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${rc(e)}`),this.hls.trigger(v.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:e,assetListIndex:i,event:t,player:p}),p}clearInterstitial(t,e){t.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,e)}),t.reset()}resetAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);if(-1!==e){this.log(`reset asset player "${t}" after error`);const i=this.playerQueue[e];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(t,e){const i=this.getAssetPlayerQueueIndex(t);if(-1!==i){const r=this.playerQueue[i];this.log(`clear ${r} toSegment: ${e&&Sr(e)}`),this.transferMediaFromPlayer(r,e),this.playerQueue.splice(i,1),r.destroy()}}emptyPlayerQueue(){let t;for(;t=this.playerQueue.pop();)t.destroy();this.playerQueue=[]}startAssetPlayer(t,e,i,r,s){const{interstitial:o,assetItem:a,assetId:l}=t,c=o.assetList.length,u=this.playingAsset;this.endedAsset=null,this.playingAsset=a,(!u||u.identifier!==l)&&(u&&(this.clearAssetPlayer(u.identifier,i[r]),delete u.error),this.log(`INTERSTITIAL_ASSET_STARTED ${e+1}/${c} ${rc(a)}`),this.hls.trigger(v.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:e,event:o,schedule:i.slice(0),scheduleIndex:r,player:t})),this.bufferAssetPlayer(t,s)}bufferAssetPlayer(t,e){var i,r;if(!this.schedule)return;const{interstitial:s,assetItem:o}=t,a=this.schedule.findEventIndex(s.identifier),l=null==(i=this.schedule.items)?void 0:i[a];if(!l)return;t.loadSource(),this.setBufferingItem(l),this.bufferingAsset=o;const c=this.getBufferingPlayer();if(c===t)return;const u=s.appendInPlace;if(u&&!1===c?.interstitial.appendInPlace)return;const d=c?.tracks||(null==(r=this.detachedData)?void 0:r.tracks)||this.requiredTracks;if(u&&o!==this.playingAsset){if(!t.tracks)return void this.log(`Waiting for track info before buffering ${t}`);if(d&&!nO(d,t.tracks)){const f=new Error(`Asset ${rc(o)} SourceBuffer tracks ('${Object.keys(t.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`),h={fatal:!0,type:fe.OTHER_ERROR,details:N.INTERSTITIAL_ASSET_ITEM_ERROR,error:f},p=s.findAssetIndex(o);return void this.handleAssetItemError(h,s,a,p,f.message)}}this.transferMediaTo(t,e)}handleInPlaceStall(t){const e=this.schedule,i=this.primaryMedia;if(!e||!i)return;const r=i.currentTime,s=e.findAssetIndex(t,r),o=t.assetList[s];if(o){const a=this.getAssetPlayer(o.identifier);if(a){const l=a.currentTime||r-o.timelineStart,c=a.duration-l;if(this.warn(`Stalled at ${l} of ${l+c} in ${a} ${t} (media.currentTime: ${r})`),l&&(c/i.playbackRate<.5||a.bufferedInPlaceToEnd(i))&&a.hls){const u=e.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,u,s)}}}}advanceInPlace(t){const e=this.primaryMedia;e&&e.currentTime<t&&(e.currentTime=t)}handleAssetItemError(t,e,i,r,s){if(t.details===N.BUFFER_STALLED_ERROR)return;const o=e.assetList[r]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&rc(o)} ${t.error}`),!this.schedule)return;const a=o?.identifier||"",l=this.getAssetPlayerQueueIndex(a),c=this.playerQueue[l]||null,u=this.schedule.items,d=vt({},t,{fatal:!1,errorAction:Yl(!0),asset:o,assetListIndex:r,event:e,schedule:u,scheduleIndex:i,player:c});if(this.hls.trigger(v.INTERSTITIAL_ASSET_ERROR,d),!t.fatal)return;const f=this.playingAsset,h=this.bufferingAsset,p=new Error(s);if(o&&(this.clearAssetPlayer(a,null),o.error=p),e.assetList.some(g=>!g.error))for(let g=r;g<e.assetList.length;g++)this.resetAssetPlayer(e.assetList[g].identifier);else e.error=p;this.updateSchedule(!0),e.error?this.primaryFallback(e):f&&f.identifier===a?this.advanceAfterAssetEnded(e,i,r):h&&h.identifier===a&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,h)}primaryFallback(t){const e=t.timelineStart,i=this.effectivePlayingItem;if(i){this.log(`Fallback to primary from event "${t.identifier}" start: ${e} pos: ${this.timelinePos} playing: ${Sr(i)} error: ${t.error}`);let r=this.timelinePos;-1===r&&(r=this.hls.startPosition);const s=this.updateItem(i,r);if(this.itemsMatch(i,s)&&this.clearInterstitial(t,null),t.appendInPlace&&(this.attachPrimary(e,null),this.flushFrontBuffer(e)),!this.schedule)return;const o=this.schedule.findItemIndexAtTime(r);this.setSchedulePosition(o)}else this.checkStart()}onAssetListLoaded(t,e){var i,r;const s=e.event,o=s.identifier,a=e.assetListResponse.ASSETS;if(null==(i=this.schedule)||!i.hasEvent(o))return;const l=s.timelineStart,c=s.duration;let u=0;a.forEach((g,m)=>{const _=parseFloat(g.DURATION);this.createAsset(s,m,u,l+u,_,g.URI),u+=_}),s.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${c}) ${s}`);const d=this.waitingItem,f=d?.event.identifier===o;this.updateSchedule();const h=null==(r=this.bufferingItem)?void 0:r.event;if(f){var p;const g=this.schedule.findEventIndex(o),m=null==(p=this.schedule.items)?void 0:p[g];if(m){if(!this.playingItem&&this.timelinePos>m.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==g)return s.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${s}`),this.updateSchedule(!0),void this.primaryFallback(s);this.setBufferingItem(m)}this.setSchedulePosition(g)}else if(h?.identifier===o){const g=s.assetList[0];if(g){const m=this.getAssetPlayer(g.identifier);if(h.appendInPlace){const _=this.primaryMedia;m&&_&&this.bufferAssetPlayer(m,_)}else m&&m.loadSource()}}}onError(t,e){if(this.schedule)switch(e.details){case N.ASSET_LIST_PARSING_ERROR:case N.ASSET_LIST_LOAD_ERROR:case N.ASSET_LIST_LOAD_TIMEOUT:{const i=e.interstitial;i&&(this.updateSchedule(!0),this.primaryFallback(i));break}case N.BUFFER_STALLED_ERROR:{const i=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&i.event.appendInPlace)return void this.handleInPlaceStall(i.event);this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}});function W1(n){return n&&"object"==typeof n?Array.isArray(n)?n.map(W1):Object.keys(n).reduce((t,e)=>(t[e]=W1(n[e]),t),{}):n}class ite extends jO{constructor(t,e){super("gap-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;null!=(i=this.media)&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var i;this.hls&&(this.ended=(null==(i=this.media)?void 0:i.currentTime)||1,this.hls.trigger(v.MEDIA_ENDED,{stalled:!1}))},this.hls=t,this.fragmentTracker=e,this.registerListeners()}registerListeners(){const{hls:t}=this;t&&(t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(t,e){this.setInterval(100),this.mediaSource=e.mediaSource;const i=this.media=e.media;Zn(i,"playing",this.onMediaPlaying),Zn(i,"waiting",this.onMediaWaiting),Zn(i,"ended",this.onMediaEnded)}onMediaDetaching(t,e){this.clearInterval();const{media:i}=this;i&&(di(i,"playing",this.onMediaPlaying),di(i,"waiting",this.onMediaWaiting),di(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(t,e){this.buffered=e.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var t;if(null==(t=this.media)||!t.readyState||!this.hasBuffered)return;const e=this.media.currentTime;this.poll(e,this.lastCurrentTime),this.lastCurrentTime=e}poll(t,e){var i,r;const s=null==(i=this.hls)?void 0:i.config;if(!s)return;const o=this.media;if(!o)return;const{seeking:a}=o,l=this.seeking&&!a,c=!this.seeking&&a,u=o.paused&&!a||o.ended||0===o.playbackRate;if(this.seeking=a,t!==e)return e&&(this.ended=0),this.moved=!0,a||(this.nudgeRetry=0,s.nudgeOnVideoHole&&!u&&t>e&&this.nudgeOnVideoHole(t,e)),void(0===this.waiting&&this.stallResolved(t));if(c||l)return void(l&&this.stallResolved(t));if(u)return this.nudgeRetry=0,this.stallResolved(t),void(!this.ended&&o.ended&&this.hls&&(this.ended=t||1,this.hls.trigger(v.MEDIA_ENDED,{stalled:!1})));if(!Me.getBuffered(o).length)return void(this.nudgeRetry=0);const d=Me.bufferInfo(o,t,0),f=d.nextStart||0,h=this.fragmentTracker;if(a&&h&&this.hls){const k=jP(this.hls.inFlightFragments,t),I=d.len>2,M=!f||k||f-t>2&&!h.getPartialFragment(t);if(I||M)return;this.moved=!1}const p=null==(r=this.hls)?void 0:r.latestLevelDetails;if(!this.moved&&null!==this.stalled&&h){if(!(d.len>0||f))return;const I=Math.max(f,d.start||0)-t,O=null!=p&&p.live?2*p.targetduration:2,x=Mg(t,h);if(I>0&&(I<=O||x))return void(o.paused||this._trySkipBufferHole(x))}const g=s.detectStallWithCurrentTimeMs,m=self.performance.now(),_=this.waiting;let y=this.stalled;if(null===y){if(!(_>0&&m-_<g))return void(this.stalled=m);y=this.stalled=_}const b=m-y;if(!a&&(b>=g||_)&&this.hls){var S;if("ended"===(null==(S=this.mediaSource)?void 0:S.readyState)&&(null==p||!p.live)&&Math.abs(t-(p?.edge||0))<1){if(this.ended)return;return this.ended=t||1,void this.hls.trigger(v.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(d),!this.media||!this.hls)return}const C=Me.bufferInfo(o,t,s.maxBufferHole);this._tryFixBufferStall(C,b,t)}stallResolved(t){const e=this.stalled;if(e&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-e;this.log(`playback not stuck anymore @${t}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(v.STALL_RESOLVED,{})}}nudgeOnVideoHole(t,e){var i;const r=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(i=this.buffered.audio)&&i.length&&r&&r.length>1&&t>r.end(0)){const s=Me.bufferedInfo(Me.timeRangesToArray(this.buffered.audio),t,0);if(s.len>1&&e>=s.start){const o=Me.timeRangesToArray(r),a=Me.bufferedInfo(o,e,0).bufferedIndex;if(a>-1&&a<o.length-1){const l=Me.bufferedInfo(o,t,0).bufferedIndex,c=o[a].end,u=o[a+1].start;if((-1===l||l>a)&&u-c<1&&t-c<2){const d=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${t} hole: ${c} -> ${u} buffered index: ${l}`);this.warn(d.message),this.media.currentTime+=1e-6;let f=Mg(t,this.fragmentTracker);f&&"fragment"in f?f=f.fragment:f||(f=void 0);const h=Me.bufferInfo(this.media,t,0);this.hls.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:d,reason:d.message,frag:f,buffer:h.len,bufferInfo:h})}}}}}_tryFixBufferStall(t,e,i){var r,s;const{fragmentTracker:o,media:a}=this,l=null==(r=this.hls)?void 0:r.config;if(!a||!o||!l)return;const c=null==(s=this.hls)?void 0:s.latestLevelDetails,u=Mg(i,o);if((u||null!=c&&c.live&&i<c.fragmentStart)&&(this._trySkipBufferHole(u)||!this.media))return;const d=t.buffered,f=this.adjacentTraversal(t,i);(d&&d.length>1&&t.len>l.maxBufferHole||t.nextStart&&(t.nextStart-i<l.maxBufferHole||f))&&(e>1e3*l.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(t))}adjacentTraversal(t,e){const i=this.fragmentTracker,r=t.nextStart;if(i&&r){const s=i.getFragAtPos(e,"main"),o=i.getFragAtPos(r,"main");if(s&&o)return o.sn-s.sn<2}return!1}_reportStall(t){const{hls:e,media:i,stallReported:r,stalled:s}=this;if(!r&&null!==s&&i&&e){this.stallReported=!0;const o=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${It(t)})`);this.warn(o.message),e.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:t.len,bufferInfo:t,stalled:{start:s}})}}_trySkipBufferHole(t){var e;const{fragmentTracker:i,media:r}=this,s=null==(e=this.hls)?void 0:e.config;if(!r||!i||!s)return 0;const o=r.currentTime,a=Me.bufferInfo(r,o,0),l=o<a.start?a.start:a.nextStart;if(l&&this.hls){const f=l-o;if(f>0&&(a.len<=s.maxBufferHole||a.len>0&&a.len<1&&r.readyState<3)){if(f>s.maxBufferHole){let p=!1;if(0===o){const g=i.getAppendedFrag(0,"main");g&&l<g.end&&(p=!0)}if(!p&&t){var c;if(null==(c=this.hls.loadLevelObj)||!c.details||jP(this.hls.inFlightFragments,l))return 0;let m=!1,_=t.end;for(;_<l;){const y=Mg(_,i);if(!y){m=!0;break}_+=y.duration}if(m)return 0}}const h=Math.max(l+.05,o+.1);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${h}`),this.moved=!0,r.currentTime=h,null==t||!t.gap){const p=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${h}`),g={type:fe.MEDIA_ERROR,details:N.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,buffer:a.len,bufferInfo:a};t&&("fragment"in t?g.part=t:g.frag=t),this.hls.trigger(v.ERROR,g)}return h}}return 0}_tryNudgeBuffer(t){const{hls:e,media:i,nudgeRetry:r}=this,s=e?.config;if(!i||!s)return 0;const o=i.currentTime;if(this.nudgeRetry++,r<s.nudgeMaxRetry){const a=o+(r+1)*s.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${o} to ${a}`);this.warn(l.message),i.currentTime=a,e.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:t.len,bufferInfo:t})}else{const a=new Error(`Playhead still not moving while enough data buffered @${o} after ${s.nudgeMaxRetry} nudges`);this.error(a.message),e.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.BUFFER_STALLED_ERROR,error:a,fatal:!0,buffer:t.len,bufferInfo:t})}}}function jP(n,t){const e=HP(n.main);if(e&&e.start<=t)return e;const i=HP(n.audio);return i&&i.start<=t?i:null}function HP(n){if(!n)return null;switch(n.state){case"IDLE":case"STOPPED":case"ENDED":case"ERROR":return null}return n.frag}function Mg(n,t){return t.getAppendedFrag(n,"main")||t.getPartialFragment(n)}function K1(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function q1(n,t,e,i,r){let s=new n(t,e,"");try{s.value=i,r&&(s.type=r)}catch{s=new n(t,e,It(r?ct({type:r},i):i))}return s}const Rg=(()=>{const n=K1();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class ste{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(v.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:t}=this;t&&(t.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(v.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(v.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(t,e){var i;this.media=e.media,!1===(null==(i=e.overrides)?void 0:i.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){var t;const e=null==(t=this.hls)?void 0:t.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(t,e){this.media=null,!e.transferMedia&&(this.id3Track&&(this.removeCues&&nc(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const i=t[e];if("metadata"===i.kind&&"id3"===i.label)return vP(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:i,enableID3MetadataCues:r}=this.hls.config;if(!i&&!r)return;const{samples:s}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=K1();if(o)for(let a=0;a<s.length;a++){const l=s[a].type;if(l===Mi.emsg&&!i||!r)continue;const c=kN(s[a].data),u=s[a].pts;let d=u+s[a].duration;d>Rg&&(d=Rg),d-u<=0&&(d=u+.25);for(let h=0;h<c.length;h++){const p=c[h];if(!ON(p)){this.updateId3CueEnds(u,l);const g=q1(o,u,d,p,l);g&&this.id3Track.addCue(g)}}}}updateId3CueEnds(t,e){var i;const r=null==(i=this.id3Track)?void 0:i.cues;if(r)for(let s=r.length;s--;){const o=r[s];o.type===e&&o.startTime<t&&o.endTime===Rg&&(o.endTime=t)}}onBufferFlushing(t,{startOffset:e,endOffset:i,type:r}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(s&&(a||l)){let c;c="audio"===r?u=>u.type===Mi.audioId3&&l:"video"===r?u=>u.type===Mi.emsg&&a:u=>u.type===Mi.audioId3&&l||u.type===Mi.emsg&&a,N1(s,e,i,c)}}onLevelUpdated(t,{details:e}){this.updateDateRangeCues(e,!0)}onLevelPtsUpdated(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)}updateDateRangeCues(t,e){if(!this.hls||!this.media)return;const{assetPlayerId:i,timelineOffset:r,enableDateRangeMetadataCues:s,interstitialsController:o}=this.hls.config;if(!s)return;const a=K1();if(i&&r&&!o){const{fragmentStart:g,fragmentEnd:m}=t;let _=this.assetCue;_?(_.startTime=g,_.endTime=m):a&&(_=this.assetCue=q1(a,g,m,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),_&&(_.id=i,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(_),_.addEventListener("enter",this.onEventCueEnter)))}if(!t.hasProgramDateTime)return;const{id3Track:l}=this,{dateRanges:c}=t,u=Object.keys(c);let d=this.dateRangeCuesAppended;var f;if(l&&e)if(null!=(f=l.cues)&&f.length){const g=Object.keys(d).filter(m=>!u.includes(m));for(let m=g.length;m--;){var h;const _=g[m],y=null==(h=d[_])?void 0:h.cues;delete d[_],y&&Object.keys(y).forEach(b=>{const S=y[b];if(S){S.removeEventListener("enter",this.onEventCueEnter);try{l.removeCue(S)}catch{}}})}}else d=this.dateRangeCuesAppended={};const p=t.fragments[t.fragments.length-1];if(0!==u.length&&re(p?.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let g=0;g<u.length;g++){const m=u[g],_=c[m],y=_.startTime,b=d[m],S=b?.cues||{};let C=b?.durationKnown||!1,k=Rg;const{duration:I,endDate:M}=_;if(M&&null!==I)k=y+I,C=!0;else if(_.endOnNext&&!C){const x=u.reduce((B,K)=>{if(K!==_.id){const ee=c[K];if(ee.class===_.class&&ee.startDate>_.startDate&&(!B||_.startDate<B.startDate))return ee}return B},null);x&&(k=x.startTime,C=!0)}const O=Object.keys(_.attr);for(let x=0;x<O.length;x++){const B=O[x];if(!xZ(B))continue;const K=S[B];if(K)!C||null!=b&&b.durationKnown?Math.abs(K.startTime-y)>.01&&(K.startTime=y,K.endTime=k):K.endTime=k;else if(a){let ee=_.attr[B];AZ(B)&&(ee=iO(ee));const se=q1(a,y,k,{key:B,data:ee},Mi.dateRange);se&&(se.id=m,this.id3Track.addCue(se),S[B]=se,o&&("X-ASSET-LIST"===B||"X-ASSET-URL"===B)&&se.addEventListener("enter",this.onEventCueEnter))}}d[m]={cues:S,dateRange:_,durationKnown:C}}}}}class ote{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,i=this.levelDetails;if(!e||!i)return;this.currentTime=e.currentTime;const r=this.computeLatency();if(null===r)return;this._latency=r;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:o}=this.config;if(!s||1===o||!i.live)return;const a=this.targetLatency;if(null===a)return;const l=r-a;if(l<Math.min(this.maxLatency,a+i.targetduration)&&l>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,o)),f=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,h=Math.min(d,Math.max(1,f));this.changeMediaPlaybackRate(e,h)}else 1!==e.playbackRate&&0!==e.playbackRate&&this.changeMediaPlaybackRate(e,1)},this.hls=t,this.config=t.config,this.registerListeners()}get levelDetails(){var t;return(null==(t=this.hls)?void 0:t.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:t}=this;if(void 0!==t.liveMaxLatencyDuration)return t.liveMaxLatencyDuration;const e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const t=this.levelDetails;if(null===t||null===this.hls)return null;const{holdBack:e,partHoldBack:i,targetduration:r}=t,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let c=a&&i||e;return(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||0===c)&&(c=void 0!==s?s:o*r),c+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,r)}set targetLatency(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency;if(null===t||null===e)return null;const i=this.levelDetails;if(null===i)return null;const r=i.edge,a=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(r-i.totalduration,t-e-this.edgeStalled),a)}get drift(){const t=this.levelDetails;return null===t?1:t.drift}get edgeStalled(){const t=this.levelDetails;return null===t?0:Math.max(t.age-3*(this.config.lowLatencyMode&&t.partTarget||t.targetduration),0)}get forwardBufferLength(){const{media:t}=this,e=this.levelDetails;if(!t||!e)return 0;const i=t.buffered.length;return(i?t.buffered.end(i-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:t}=this;t&&(t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(v.ERROR,this.onError,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(v.ERROR,this.onError,this))}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){e.advanced&&this.onTimeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(t,e){var i;e.details===N.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(i=this.levelDetails)&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(t,e){var i,r;t.playbackRate!==e&&(null==(i=this.hls)||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null==(r=this.targetLatency)?void 0:r.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${t.playbackRate} to ${e}`),t.playbackRate=e)}estimateLiveEdge(){const t=this.levelDetails;return null===t?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return null===t?null:t-this.currentTime}}class ate extends C1{constructor(t,e){super(t,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this),t.on(v.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this),t.off(v.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const i=this.hls.config.preferManagedMediaSource,r=[],s={},o={};let a=!1,l=!1,c=!1;e.levels.forEach(u=>{const d=u.attrs;let{audioCodec:f,videoCodec:h}=u;f&&(u.audioCodec=f=Xp(f,i)||void 0),h&&(h=u.videoCodec=function zQ(n){const t=n.split(",");for(let e=0;e<t.length;e++){const i=t[e].split(".");i.length>2&&"avc1"===i[0]&&(t[e]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return t.join(",")}(h));const{width:p,height:g,unknownCodecs:m}=u;if(a||(a=!(!p||!g)),l||(l=!!h),c||(c=!!f),m?.length||f&&!this.isAudioSupported(f)||h&&!this.isVideoSupported(h))return void this.log(`Some or all CODECS not supported "${d.CODECS}"`);const{CODECS:y,"FRAME-RATE":b,"HDCP-LEVEL":S,"PATHWAY-ID":C,RESOLUTION:k,"VIDEO-RANGE":I}=d,O=`${C||"."}-${u.bitrate}-${k}-${b}-${y}-${I}-${S}`;if(s[O])if(s[O].uri===u.url||u.attrs["PATHWAY-ID"])s[O].addGroupId("audio",d.AUDIO),s[O].addGroupId("text",d.SUBTITLES);else{const x=o[O]+=1;u.attrs["PATHWAY-ID"]=new Array(x+1).join(".");const B=this.createLevel(u);s[O]=B,r.push(B)}else{const x=this.createLevel(u);s[O]=x,o[O]=1,r.push(x)}}),this.filterAndSortMediaOptions(r,e,a,l,c)}createLevel(t){const e=new _d(t),i=t.supplemental;if(null!=i&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const r=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(r.message),e.supportedResult=SO(r,[])}return e}isAudioSupported(t){return gd(t,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(t){return gd(t,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(t,e,i,r,s){var o;let a=[],l=[],c=t;const u=(null==(o=e.stats)?void 0:o.parsing)||{};if((i||r)&&s&&(c=c.filter(({videoCodec:y,videoRange:b,width:S,height:C})=>(!!y||!(!S||!C))&&function tZ(n){return!!n&&eg.indexOf(n)>-1}(b))),0===c.length)return Promise.resolve().then(()=>{if(this.hls){let y="no level with compatible codecs found in manifest",b=y;e.levels.length&&(b=`one or more CODECS in variant not supported: ${It(e.levels.map(C=>C.attrs.CODECS).filter((C,k,I)=>I.indexOf(C)===k))}`,this.warn(b),y+=` (${b})`);const S=new Error(y);this.hls.trigger(v.ERROR,{type:fe.MEDIA_ERROR,details:N.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:S,reason:b})}}),void(u.end=performance.now());e.audioTracks&&(a=e.audioTracks.filter(y=>!y.audioCodec||this.isAudioSupported(y.audioCodec)),GP(a)),e.subtitles&&(l=e.subtitles,GP(l));const d=c.slice(0);c.sort((y,b)=>{if(y.attrs["HDCP-LEVEL"]!==b.attrs["HDCP-LEVEL"])return(y.attrs["HDCP-LEVEL"]||"")>(b.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&y.height!==b.height)return y.height-b.height;if(y.frameRate!==b.frameRate)return y.frameRate-b.frameRate;if(y.videoRange!==b.videoRange)return eg.indexOf(y.videoRange)-eg.indexOf(b.videoRange);if(y.videoCodec!==b.videoCodec){const S=vO(y.videoCodec),C=vO(b.videoCodec);if(S!==C)return C-S}if(y.uri===b.uri&&y.codecSet!==b.codecSet){const S=Zp(y.codecSet),C=Zp(b.codecSet);if(S!==C)return C-S}return y.averageBitrate!==b.averageBitrate?y.averageBitrate-b.averageBitrate:0});let f=d[0];if(this.steering&&(c=this.steering.filterParsedLevels(c),c.length!==d.length))for(let y=0;y<d.length;y++)if(d[y].pathwayId===c[0].pathwayId){f=d[y];break}this._levels=c;for(let y=0;y<c.length;y++)if(c[y]===f){var h;this._firstLevel=y;const b=f.bitrate,S=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${c.length} level(s) found, first bitrate: ${b}`),void 0===(null==(h=this.hls.userConfig)?void 0:h.abrEwmaDefaultEstimate)){const C=Math.min(b,this.hls.config.abrEwmaDefaultEstimateMax);C>S&&S===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=C)}break}const g=this.hls.config,_={levels:c,audioTracks:a,subtitleTracks:l,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:r,altAudio:!(!g.audioStreamController||!g.audioTrackController)&&!(s&&!r)&&a.some(y=>!!y.url)};u.end=performance.now(),this.hls.trigger(v.MANIFEST_PARSED,_)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(t){const e=this._levels;if(0===e.length)return;if(t<0||t>=e.length){const u=new Error("invalid level idx"),d=t<0;if(this.hls.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.LEVEL_SWITCH_ERROR,level:t,fatal:d,error:u,reason:u.message}),d)return;t=Math.min(t,e.length-1)}const i=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,o=e[t],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=o,i===t&&r&&s===a)return;this.log(`Switching to level ${t} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${i}${s?" with Pathway "+s:""}`),this.hls.trigger(v.LEVEL_SWITCHING,{level:t,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds});const c=o.details;if(!c||c.live){const u=this.switchParams(o.uri,r?.details,c);this.loadPlaylist(u)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(void 0===this._startLevel){const t=this.hls.config.startLevel;return void 0!==t?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(t){if(this.steering){const e=this.steering.pathways(),i=t.filter(r=>-1!==e.indexOf(r));if(t.length<1)return void this.warn(`pathwayPriority ${t} should contain at least one pathway from list: ${e}`);this.steering.pathwayPriority=i}}onError(t,e){e.fatal||!e.context||"level"===e.context.type&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,{frag:e}){if(void 0!==e&&"main"===e.type){const i=e.elementaryStreams;if(!Object.keys(i).some(s=>!!i[s]))return;const r=this._levels[e.level];null!=r&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(t,e){var i;const{level:r,details:s}=e,o=e.levelInfo;var a;if(!o)return this.warn(`Invalid level index ${r}`),void(null!=(a=e.deliveryDirectives)&&a.skip&&(s.deltaUpdateFailed=!0));if(o===this.currentLevel||e.withoutMultiVariant){0===o.fragmentError&&(o.loadError=0);let l=o.details;l===e.details&&l.advanced&&(l=void 0),this.playlistLoaded(r,e,l)}else null!=(i=e.deliveryDirectives)&&i.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=this.getUrlWithDirectives(t.uri,e),r=this.currentLevelIndex,s=t.attrs["PATHWAY-ID"],o=t.details,a=o?.age;this.log(`Loading level index ${r}${void 0!==e?.msn?" at sn "+e.msn+" part "+e.part:""}${s?" Pathway "+s:""}${a&&o.live?" age "+a.toFixed(1)+(o.type?" "+o.type||0:""):""} ${i}`),this.hls.trigger(v.LEVEL_LOADING,{url:i,level:r,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;if(1===this._levels.length)return;const i=this._levels.filter((s,o)=>o!==t||(this.steering&&this.steering.removeLevel(s),s===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,s.details&&s.details.fragments.forEach(a=>a.level=-1)),!1));vN(i),this._levels=i,this.currentLevelIndex>-1&&null!=(e=this.currentLevel)&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const r=i.length-1;this._firstLevel=Math.min(this._firstLevel,r),this._startLevel&&(this._startLevel=Math.min(this._startLevel,r)),this.hls.trigger(v.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(t,{levels:e}){this._levels=e}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(v.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function GP(n){const t={};n.forEach(e=>{const i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++})}function zP(){return self.SourceBuffer||self.WebKitSourceBuffer}function WP(){if(!po())return!1;const t=zP();return!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove}class dte extends u1{constructor(t,e,i){super(t,e,i,"stream-controller","main"),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const r=this.media,s=r?r.currentTime:null;if(null===s||!re(s)||(this.log(`Media seeked to ${s.toFixed(3)}`),!this.getBufferedFrag(s)))return;const o=this.getFwdBufferInfoAtPos(r,s,"main",0);null!==o&&0!==o.len?this.tick():this.warn(`Main forward buffer length at ${s} on "seeked" event ${o?o.len:"empty"})`)},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.LEVEL_LOADING,this.onLevelLoading,this),t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(v.BUFFER_CREATED,this.onBufferCreated,this),t.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(v.BUFFER_CREATED,this.onBufferCreated,this),t.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(t,e){if(this.levels){const{lastCurrentTime:i,hls:r}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let s=r.startLevel;-1===s&&(r.config.testBandwidth&&this.levels.length>1?(s=0,this.bitrateTest=!0):s=r.firstAutoLevel),r.nextLoadLevel=s,this.level=r.loadLevel,this._hasEnoughToStart=!!e}i>0&&-1===t&&!e&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i),this.state="IDLE",this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}else this._forceStartLoad=!0,this.state="STOPPED"}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case"WAITING_LEVEL":{const{levels:t,level:e}=this,i=t?.[e],r=i?.details;if(r&&(!r.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(r))break;this.state="IDLE";break}if(this.hls.nextLoadLevel!==this.level){this.state="IDLE";break}break}case"FRAG_LOADING_WAITING_RETRY":this.checkRetryDate()}"IDLE"===this.state&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var t;super.onTickEnd(),null!=(t=this.media)&&t.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:e,levels:i,media:r}=this;if(null===e||!r&&!this.primaryPrefetch&&(this.startFragRequested||!t.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?t.nextLoadLevel:t.loadLevel;if(null==i||!i[s])return;const o=i[s],a=this.getMainFwdBufferInfo();if(null===a)return;const l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){const g={};return 2===this.altAudio&&(g.type="video"),this.hls.trigger(v.BUFFER_EOS,g),void(this.state="ENDED")}if(!this.buffering)return;t.loadLevel!==s&&-1===t.manualLevel&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=t.nextLoadLevel=s;const c=o.details;if(!c||"WAITING_LEVEL"===this.state||this.waitForLive(o))return this.level=s,this.state="WAITING_LEVEL",void(this.startFragRequested=!1);const u=a.len,d=this.getMaxBufferLength(o.maxBitrate);if(u>=d)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const f=this.backtrackFragment?this.backtrackFragment.start:a.end;let h=this.getNextFragment(f,c);if(this.couldBacktrack&&!this.fragPrevious&&h&&ln(h)&&"OK"!==this.fragmentTracker.getState(h)){var p;const m=(null!=(p=this.backtrackFragment)?p:h).sn-c.startSN,_=c.fragments[m-1];_&&h.cc===_.cc&&(h=_,this.fragmentTracker.removeFragment(_))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(h&&this.isLoopLoading(h,f)){if(!h.gap){const m=this.audioOnly&&!this.altAudio?"audio":"video",_=("video"===m?this.videoBuffer:this.mediaBuffer)||this.media;_&&this.afterBufferFlushed(_,m,"main")}h=this.getNextFragmentLoopLoading(h,c,a,"main",d)}h&&(h.initSegment&&!h.initSegment.data&&!this.bitrateTest&&(h=h.initSegment),this.loadFragment(h,o,f))}loadFragment(t,e,i){const r=this.fragmentTracker.getState(t);"NOT_LOADED"===r||"PARTIAL"===r?ln(t)?this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):super.loadFragment(t,e,i):this._loadInitSegment(t,e):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,"main")}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(null!=e&&e.readyState){let i;const r=this.getAppendedFrag(e.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(null!=s&&s.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<2*s.targetduration)return}if(!e.paused&&t){const c=this.fragLastKbps;i=c&&this.fragCurrent?this.fragCurrent.duration*t[this.hls.nextLoadLevel].maxBitrate/(1e3*c)+1:0}else i=0;const o=this.getBufferedFrag(e.currentTime+i);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const c=a.duration,u=Math.max(o.end,(a.maxStartPTS?a.maxStartPTS:a.start)+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*(this.couldBacktrack?.5:.125)),c*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case"KEY_LOADING":case"FRAG_LOADING":case"FRAG_LOADING_WAITING_RETRY":case"PARSING":case"PARSED":this.state="IDLE"}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,2===this.altAudio?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const i=e.media;Zn(i,"playing",this.onMediaPlaying),Zn(i,"seeked",this.onMediaSeeked)}onMediaDetaching(t,e){const{media:i}=this;i&&(di(i,"playing",this.onMediaPlaying),di(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(t,e),!e.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(v.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(t,e){let i=!1,r=!1;for(let s=0;s<e.levels.length;s++){const o=e.levels[s].audioCodec;o&&(i=i||-1!==o.indexOf("mp4a.40.2"),r=r||-1!==o.indexOf("mp4a.40.5"))}this.audioCodecSwitch=i&&r&&!function cte(){var n;const t=zP();return"function"==typeof(null==t||null==(n=t.prototype)?void 0:n.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:i}=this;if(!i||"IDLE"!==this.state)return;const r=e.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state="WAITING_LEVEL")}onLevelLoaded(t,e){var i;const{levels:r,startFragRequested:s}=this,o=e.level,a=e.details,l=a.totalduration;if(!r)return void this.warn(`Levels were reset while loading level ${o}`);this.log(`Level ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${l}`);const c=e.levelInfo,u=this.fragCurrent;u&&("FRAG_LOADING"===this.state||"FRAG_LOADING_WAITING_RETRY"===this.state)&&u.level!==e.level&&u.loader&&this.abortCurrentFrag();let d=0;if(a.live||null!=(i=c.details)&&i.live){var f;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;d=this.alignPlaylists(a,c.details,null==(f=this.levelLastLoaded)?void 0:f.details)}if(c.details=a,this.levelLastLoaded=c,s||this.setStartPosition(a,d),this.hls.trigger(v.LEVEL_UPDATED,{details:a,level:o}),"WAITING_LEVEL"===this.state){if(this.waitForCdnTuneIn(a))return;this.state="IDLE"}s&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(t){const{config:e,media:i}=this;if(!i)return;const r=this.hls.liveSyncPosition,s=this.getLoadPosition(),a=t.edge,l=s>=t.fragmentStart-e.maxFragLookUpTolerance&&s<=a;if(null!==r&&i.duration>r&&(s<r||!l)&&(!l&&i.readyState<4||s<a-(void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration))&&(this._hasEnoughToStart||(this.nextLoadPosition=r),i.readyState))if(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${r.toFixed(3)}`),"buffered"===this.config.liveSyncMode){var c;const d=Me.bufferInfo(i,r,0);if(null==(c=d.buffered)||!c.length)return void(i.currentTime=r);if(d.start<=s)return void(i.currentTime=r);const{nextStart:h}=Me.bufferedInfo(d.buffered,s,0);h&&(i.currentTime=h)}else i.currentTime=r}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:r,payload:s}=t,{levels:o}=this;if(!o)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const a=o[i.level];if(!a)return void this.warn(`Level ${i.level} not found on progress`);const l=a.details;if(!l)return this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),void this.fragmentTracker.removeFragment(i);const c=a.videoCodec,u=l.PTSKnown||!l.live,d=null==(e=i.initSegment)?void 0:e.data,f=this._getAudioCodec(a),h=this.transmuxer=this.transmuxer||new QN(this.hls,"main",this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=r?r.index:-1,m=new e1(i.level,i.sn,i.stats.chunkCount,s.byteLength,p,-1!==p);h.push(s,d,f,c,i,r,l.totalduration,u,m,this.initPTS[i.cc])}onAudioTrackSwitching(t,e){const i=this.hls,r=2===this.altAudio;if(ng(e.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(r)return this.fragmentTracker.removeAllFragments(),i.once(v.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(v.AUDIO_TRACK_SWITCHED,e)}),void i.trigger(v.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});i.trigger(v.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){const i=ng(e.url,this.hls);if(i){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=i?2:0,this.tick()}onBufferCreated(t,e){const i=e.tracks;let r,s,o=!1;for(const a in i){const l=i[a];if("main"===l.id){if(s=a,r=l,"video"===a){const c=i[a];c&&(this.videoBuffer=c.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:i,part:r}=e,s="main"===i.type;if(s){if(this.fragContextChanged(i))return this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),void("PARSED"===this.state&&(this.state="IDLE"));const a=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),ln(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}const o=this.media;o&&(!this._hasEnoughToStart&&Me.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),s&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(t,e){var i;if(e.fatal)this.state="ERROR";else switch(e.details){case N.FRAG_GAP:case N.FRAG_PARSING_ERROR:case N.FRAG_DECRYPT_ERROR:case N.FRAG_LOAD_ERROR:case N.FRAG_LOAD_TIMEOUT:case N.KEY_LOAD_ERROR:case N.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError("main",e);break;case N.LEVEL_LOAD_ERROR:case N.LEVEL_LOAD_TIMEOUT:case N.LEVEL_PARSING_ERROR:!e.levelRetry&&"WAITING_LEVEL"===this.state&&"level"===(null==(i=e.context)?void 0:i.type)&&(this.state="IDLE");break;case N.BUFFER_ADD_CODEC_ERROR:case N.BUFFER_APPEND_ERROR:if("main"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&this.resetLoadingState();break;case N.BUFFER_FULL_ERROR:if("main"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case N.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onFragLoadEmergencyAborted(){this.state="IDLE",this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(t,{type:e}){if("audio"!==e||!this.altAudio){const i=("video"===e?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,e,"main"),this.tick())}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const e=t.currentTime;let i=this.startPosition;if(i>=0&&e<i){if(t.seeking)return void this.log(`could not seek to ${i}, already seeking at ${e}`);const r=this.timelineOffset;r&&i&&(i+=r);const s=this.getLevelDetails(),o=Me.getBuffered(t),a=o.length?o.start(0):0,l=a-i,c=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||l>0&&(l<c||this.loadingParts&&l<2*(s?.partTarget||0)))&&(this.log(`adjusting start position by ${l} to match buffer start`),i+=l,this.startPosition=i),e<i&&(this.log(`seek to target start position ${i} from current time ${e} buffer start ${a}`),t.currentTime=i)}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then(i=>{const{hls:r}=this,s=i?.frag;if(!s||this.fragContextChanged(s))return;e.fragmentError=0,this.state="IDLE",this.startFragRequested=!1,this.bitrateTest=!1;const o=s.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),r.trigger(v.FRAG_LOADED,i),s.bitrateTest=!1}).catch(i=>{"STOPPED"===this.state||"ERROR"===this.state||(this.warn(i),this.resetFragmentLoading(t))})}_handleTransmuxComplete(t){const e=this.playlistType,{hls:i}=this,{remuxResult:r,chunkMeta:s}=t,o=this.getCurrentContext(s);if(!o)return void this.resetWhenMissingContext(s);const{frag:a,part:l,level:c}=o,{video:u,text:d,id3:f,initSegment:h}=r,{details:p}=c,g=this.altAudio?void 0:r.audio;if(this.fragContextChanged(a))this.fragmentTracker.removeFragment(a);else{if(this.state="PARSING",h){const m=h.tracks;if(m){const S=a.initSegment||a;if(this.unhandledEncryptionError(h,a))return;this._bufferInitSegment(c,m,S,s),i.trigger(v.FRAG_PARSING_INIT_SEGMENT,{frag:S,id:e,tracks:m})}const _=h.initPTS,y=h.timescale,b=this.initPTS[a.cc];if(re(_)&&(!b||b.baseTime!==_||b.timescale!==y)){const S=h.trackId;this.initPTS[a.cc]={baseTime:_,timescale:y,trackId:S},i.trigger(v.INIT_PTS_FOUND,{frag:a,id:e,initPTS:_,timescale:y,trackId:S})}}if(u&&p){g&&"audiovideo"===u.type&&this.logMuxedErr(a);const m=p.fragments[a.sn-1-p.startSN],_=a.sn===p.startSN,y=!m||a.cc>m.cc;if(!1!==r.independent){const{startPTS:b,endPTS:S,startDTS:C,endDTS:k}=u;if(l)l.elementaryStreams[u.type]={startPTS:b,endPTS:S,startDTS:C,endDTS:k};else if(u.firstKeyFrame&&u.independent&&1===s.id&&!y&&(this.couldBacktrack=!0),u.dropped&&u.independent){const I=this.getMainFwdBufferInfo(),M=(I?I.end:this.getLoadPosition())+this.config.maxBufferHole;if(!_&&M<(u.firstKeyFramePTS?u.firstKeyFramePTS:b)-this.config.maxBufferHole&&!y)return void this.backtrack(a);y&&(a.gap=!0),a.setElementaryStreamInfo(u.type,a.start,S,a.start,k,!0)}else _&&b-(p.appliedTimelineOffset||0)>2&&(a.gap=!0);a.setElementaryStreamInfo(u.type,b,S,C,k),this.backtrackFragment&&(this.backtrackFragment=a),this.bufferFragmentData(u,a,l,s,_||y)}else{if(!_&&!y)return void this.backtrack(a);a.gap=!0}}if(g){const{startPTS:m,endPTS:_,startDTS:y,endDTS:b}=g;l&&(l.elementaryStreams.audio={startPTS:m,endPTS:_,startDTS:y,endDTS:b}),a.setElementaryStreamInfo("audio",m,_,y,b),this.bufferFragmentData(g,a,l,s)}p&&null!=f&&f.samples.length&&i.trigger(v.FRAG_PARSING_METADATA,{id:e,frag:a,details:p,samples:f.samples}),p&&d&&i.trigger(v.FRAG_PARSING_USERDATA,{id:e,frag:a,details:p,samples:d.samples})}}logMuxedErr(t){this.warn(`${ln(t)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${t.url}`)}_bufferInitSegment(t,e,i,r){if("PARSING"!==this.state)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&(delete e.audio,e.audiovideo&&this.logMuxedErr(i));const{audio:s,video:o,audiovideo:a}=e;if(s){const c=t.audioCodec;let u=Jp(s.codec,c);"mp4a"===u&&(u="mp4a.40.5");const d=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const f=s.metadata;f&&"channelCount"in f&&1!==(f.channelCount||1)&&-1===d.indexOf("firefox")&&(u="mp4a.40.5")}u&&-1!==u.indexOf("mp4a.40.5")&&-1!==d.indexOf("android")&&"audio/mpeg"!==s.container&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),c&&c!==u&&this.log(`Swapping manifest audio codec "${c}" for "${u}"`),s.levelCodec=u,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${u||""}/${c||""}/${s.codec}]`),delete e.audiovideo}if(o){o.levelCodec=t.videoCodec,o.id="main";const c=o.codec;if(4===c?.length)switch(c){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e"}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${t.videoCodec||""}/${c}]${o.codec!==c?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete e.audiovideo}a&&(this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${t.codecs}/${a.codec}]`),delete e.video,delete e.audio);const l=Object.keys(e);if(l.length){if(this.hls.trigger(v.BUFFER_CODECS,e),!this.hls)return;l.forEach(c=>{const d=e[c].initSegment;null!=d&&d.byteLength&&this.hls.trigger(v.BUFFER_APPENDING,{type:c,data:d,frag:i,part:null,chunkMeta:r,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media,"main")}get maxBufferLength(){const{levels:t,level:e}=this,i=t?.[e];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state="IDLE"}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&!1===t.seeking){const i=t.currentTime;if(Me.isBuffered(t,i)?e=this.getAppendedFrag(i):Me.isBuffered(t,i+.1)&&(e=this.getAppendedFrag(i+.1)),e){this.backtrackFragment=null;const r=this.fragPlaying,s=e.level;(!r||e.sn!==r.sn||r.level!==s)&&(this.fragPlaying=e,this.hls.trigger(v.FRAG_CHANGED,{frag:e}),(!r||r.level!==s)&&this.hls.trigger(v.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t;if(this.fragPlaying)return this.fragPlaying;const e=(null==(t=this.media)?void 0:t.currentTime)||this.lastCurrentTime;return re(e)?this.getAppendedFrag(e):null}get currentProgramDateTime(){var t;const e=(null==(t=this.media)?void 0:t.currentTime)||this.lastCurrentTime;if(re(e)){const i=this.getLevelDetails(),r=this.currentFrag||(i?ga(null,i.fragments,e):null);if(r){const s=r.programDateTime;if(null!==s)return new Date(s+1e3*(e-r.start))}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class fte extends er{constructor(t,e){super("key-loader",e),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const i in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[i].loader;if(r){var e;if(t&&t!==(null==(e=r.context)?void 0:e.frag.type))return;r.abort()}}}detach(){for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t].loader;e&&e.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(t,e=N.KEY_LOAD_ERROR,i,r,s){return new ks({type:fe.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:s,error:i,networkDetails:r})}loadClear(t,e,i){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(e.length)for(let r=0,s=e.length;r<s;r++){const o=e[r];if(t.cc<=o.cc&&(!ln(t)||!ln(o)||t.sn<o.sn)||!i&&r==s-1)return this.emeController.selectKeySystemFormat(o).then(a=>{if(!this.emeController)return;o.setKeyFormat(a);const l=cg(a);return l?this.emeController.getKeySystemAccess([l]):void 0})}if(this.config.requireKeySystemAccessOnStart){const r=vd(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then(e=>this.loadInternal(t,e)):this.loadInternal(t)}loadInternal(t,e){var i,r;e&&t.setKeyFormat(e);const s=t.decryptdata;if(!s){const c=new Error(e?`Expected frag.decryptdata to be defined after setting format ${e}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(t,N.KEY_LOAD_ERROR,c))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(t,N.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));const a=Y1(s);let l=this.keyIdToKeyInfo[a];if(null!=(i=l)&&i.decryptdata.key)return s.key=l.decryptdata.key,Promise.resolve({frag:t,keyInfo:l});if(this.emeController&&null!=(r=l)&&r.keyLoadPromise)switch(this.emeController.getKeyStatus(l.decryptdata)){case"usable":case"usable-in-future":return l.keyLoadPromise.then(u=>{const{keyInfo:d}=u;return s.key=d.decryptdata.key,{frag:t,keyInfo:d}})}switch(this.log(`${this.keyIdToKeyInfo[a]?"Rel":"L"}oading${s.keyId?" keyId: "+Qn(s.keyId):""} URI: ${s.uri} from ${t.type} ${t.level}`),l=this.keyIdToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===s.keyFormat?this.loadKeyHTTP(l,t):this.loadKeyEME(l,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(l,t);default:return Promise.reject(this.createKeyLoadError(t,N.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(t,e){const i={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){var r;if(!t.decryptdata.keyId&&null!=(r=e.initSegment)&&r.data){const o=function OQ(n){const t=[];return hO(n,e=>t.push(e.subarray(8,24))),t}(e.initSegment.data);if(o.length){const a=o[0];a.some(l=>0!==l)&&(this.log(`Using keyId found in init segment ${Qn(a)}`),t.decryptdata.keyId=a,ma.setKeyIdForUri(t.decryptdata.uri,a))}}const s=this.emeController.loadKey(i);return(t.keyLoadPromise=s.then(o=>(t.mediaKeySessionContext=o,i))).catch(o=>{throw t.keyLoadPromise=null,"data"in o&&(o.data.frag=e),o})}return Promise.resolve(i)}loadKeyHTTP(t,e){const i=this.config,s=new(0,i.loader)(i);return e.keyLoader=t.loader=s,t.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},c=i.keyLoadPolicy.default;s.load(l,{loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(f,h,p,g)=>{const{frag:m,keyInfo:_}=p,y=Y1(_.decryptdata);if(!m.decryptdata||_!==this.keyIdToKeyInfo[y])return a(this.createKeyLoadError(m,N.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),g));_.decryptdata.key=m.decryptdata.key=new Uint8Array(f.data),m.keyLoader=null,_.loader=null,o({frag:m,keyInfo:_})},onError:(f,h,p,g)=>{this.resetLoader(h),a(this.createKeyLoadError(e,N.KEY_LOAD_ERROR,new Error(`HTTP Error ${f.code} loading key ${f.text}`),p,ct({url:l.url,data:void 0},f)))},onTimeout:(f,h,p)=>{this.resetLoader(h),a(this.createKeyLoadError(e,N.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),p))},onAbort:(f,h,p)=>{this.resetLoader(h),a(this.createKeyLoadError(e,N.INTERNAL_ABORTED,new Error("key loading aborted"),p))}})})}resetLoader(t){const{frag:e,keyInfo:i,url:r}=t,s=i.loader;e.keyLoader===s&&(e.keyLoader=null,i.loader=null);const o=Y1(i.decryptdata)||r;delete this.keyIdToKeyInfo[o],s&&s.destroy()}}function Y1(n){if(n.keyFormat!==Rn_FAIRPLAY){const t=n.keyId;if(t)return Qn(t)}return n.uri}function KP(n){const{type:t}=n;switch(t){case"audioTrack":return"audio";case"subtitleTrack":return"subtitle";default:return"main"}}function Q1(n,t){let e=n.url;return(void 0===e||0===e.indexOf("data:"))&&(e=t.url),e}class hte{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.LEVEL_LOADING,this.onLevelLoading,this),t.on(v.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(v.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.LEVEL_LOADING,this.onLevelLoading,this),t.off(v.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(v.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(t){const e=this.hls.config,o=new(e.pLoader||e.loader)(e);return this.loaders[t.type]=o,o}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:i}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:"manifest",url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(t,e){const{id:i,level:r,pathwayId:s,url:o,deliveryDirectives:a,levelInfo:l}=e;this.load({id:i,level:r,pathwayId:s,responseType:"text",type:"level",url:o,deliveryDirectives:a,levelOrTrack:l})}onAudioTrackLoading(t,e){const{id:i,groupId:r,url:s,deliveryDirectives:o,track:a}=e;this.load({id:i,groupId:r,level:null,responseType:"text",type:"audioTrack",url:s,deliveryDirectives:o,levelOrTrack:a})}onSubtitleTrackLoading(t,e){const{id:i,groupId:r,url:s,deliveryDirectives:o,track:a}=e;this.load({id:i,groupId:r,level:null,responseType:"text",type:"subtitleTrack",url:s,deliveryDirectives:o,levelOrTrack:a})}onLevelsUpdated(t,e){const i=this.loaders.level;if(i){const r=i.context;r&&!e.levels.some(s=>s===r.levelOrTrack)&&(i.abort(),delete this.loaders.level)}}load(t){var e;const i=this.hls.config;let s,r=this.getInternalLoader(t);if(r){const c=this.hls.logger,u=r.context;if(u&&u.levelOrTrack===t.levelOrTrack&&(u.url===t.url||u.deliveryDirectives&&!t.deliveryDirectives))return void c.log(u.url===t.url?`[playlist-loader]: ignore ${t.url} ongoing request`:`[playlist-loader]: ignore ${t.url} in favor of ${u.url}`);c.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),r.abort()}if(s="manifest"===t.type?i.manifestLoadPolicy.default:vt({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(t),re(null==(e=t.deliveryDirectives)?void 0:e.part)){let c;if("level"===t.type&&null!==t.level?c=this.hls.levels[t.level].details:"audioTrack"===t.type&&null!==t.id?c=this.hls.audioTracks[t.id].details:"subtitleTrack"===t.type&&null!==t.id&&(c=this.hls.subtitleTracks[t.id].details),c){const u=c.partTarget,d=c.targetduration;if(u&&d){const f=1e3*Math.max(3*u,.8*d);s=vt({},s,{maxTimeToFirstByteMs:Math.min(f,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{};r.load(t,{loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},{onSuccess:(c,u,d,f)=>{const h=this.getInternalLoader(d);this.resetInternalLoader(d.type);const p=c.data;u.parsing.start=performance.now(),Xr.isMediaPlaylist(p)||"manifest"!==d.type?this.handleTrackOrLevelPlaylist(c,u,d,f||null,h):this.handleMasterPlaylist(c,u,d,f)},onError:(c,u,d,f)=>{this.handleNetworkError(u,d,!1,c,f)},onTimeout:(c,u,d)=>{this.handleNetworkError(u,d,!0,void 0,c)}})}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:t,startPosition:e},forceStartLoad:i}=this.hls;(t||i)&&(this.hls.logger.log(`${t?"auto":"force"} startLoad with configured startPosition ${e}`),this.hls.startLoad(e))}handleMasterPlaylist(t,e,i,r){const s=this.hls,o=t.data,a=Q1(t,i),l=Xr.parseMasterPlaylist(o,a);if(l.playlistParsingError)return e.parsing.end=performance.now(),void this.handleManifestParsingError(t,i,l.playlistParsingError,r,e);const{contentSteering:c,levels:u,sessionData:d,sessionKeys:f,startTimeOffset:h,variableList:p}=l;this.variableList=p,u.forEach(y=>{const{unknownCodecs:b}=y;if(b){const{preferManagedMediaSource:S}=this.hls.config;let{audioCodec:C,videoCodec:k}=y;for(let I=b.length;I--;){const M=b[I];gd(M,"audio",S)?(y.audioCodec=C=C?`${C},${M}`:M,ql.audio[C.substring(0,4)]=2,b.splice(I,1)):gd(M,"video",S)&&(y.videoCodec=k=k?`${k},${M}`:M,ql.video[k.substring(0,4)]=2,b.splice(I,1))}}});const{AUDIO:g=[],SUBTITLES:m,"CLOSED-CAPTIONS":_}=Xr.parseMasterPlaylistMedia(o,a,l);g.length&&!g.some(b=>!b.url)&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Vt({}),bitrate:0,url:""})),s.trigger(v.MANIFEST_LOADED,{levels:u,audioTracks:g,subtitles:m,captions:_,contentSteering:c,url:a,stats:e,networkDetails:r,sessionData:d,sessionKeys:f,startTimeOffset:h,variableList:p})}handleTrackOrLevelPlaylist(t,e,i,r,s){const o=this.hls,{id:a,level:l,type:c}=i,u=Q1(t,i),d=re(l)?l:re(a)?a:0,f=KP(i),h=Xr.parseLevelPlaylist(t.data,u,d,f,0,this.variableList);if("manifest"===c){const p={attrs:new Vt({}),bitrate:0,details:h,name:"",url:u};h.requestScheduled=e.loading.start+pN(h,0),o.trigger(v.MANIFEST_LOADED,{levels:[p],audioTracks:[],url:u,stats:e,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),i.levelDetails=h,this.handlePlaylistLoaded(h,t,e,i,r,s)}handleManifestParsingError(t,e,i,r,s){this.hls.trigger(v.ERROR,{type:fe.NETWORK_ERROR,details:N.MANIFEST_PARSING_ERROR,fatal:"manifest"===e.type,url:t.url,err:i,error:i,reason:i.message,response:t,context:e,networkDetails:r,stats:s})}handleNetworkError(t,e,i=!1,r,s){let o=`A network ${i?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${t.type}`;"level"===t.type?o+=`: ${t.level} id: ${t.id}`:("audioTrack"===t.type||"subtitleTrack"===t.type)&&(o+=` id: ${t.id} group-id: "${t.groupId}"`);const a=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let l=N.UNKNOWN,c=!1;const u=this.getInternalLoader(t);switch(t.type){case"manifest":l=i?N.MANIFEST_LOAD_TIMEOUT:N.MANIFEST_LOAD_ERROR,c=!0;break;case"level":l=i?N.LEVEL_LOAD_TIMEOUT:N.LEVEL_LOAD_ERROR,c=!1;break;case"audioTrack":l=i?N.AUDIO_TRACK_LOAD_TIMEOUT:N.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case"subtitleTrack":l=i?N.SUBTITLE_TRACK_LOAD_TIMEOUT:N.SUBTITLE_LOAD_ERROR,c=!1}u&&this.resetInternalLoader(t.type);const d={type:fe.NETWORK_ERROR,details:l,fatal:c,url:t.url,loader:u,context:t,error:a,networkDetails:e,stats:s};r&&(d.response=ct({url:e?.url||t.url,data:void 0},r)),this.hls.trigger(v.ERROR,d)}handlePlaylistLoaded(t,e,i,r,s,o){const a=this.hls,{type:l,level:c,levelOrTrack:u,id:d,groupId:f,deliveryDirectives:h}=r,p=Q1(e,r),g=KP(r);let m="number"==typeof r.level&&"main"===g?c:void 0;const _=t.playlistParsingError;if(_){if(this.hls.logger.warn(`${_} ${t.url}`),!a.config.ignorePlaylistParsingErrors)return void a.trigger(v.ERROR,{type:fe.NETWORK_ERROR,details:N.LEVEL_PARSING_ERROR,fatal:!1,url:p,error:_,reason:_.message,response:e,context:r,level:m,parent:g,networkDetails:s,stats:i});t.playlistParsingError=null}if(t.fragments.length)switch(t.live&&o&&(o.getCacheAge&&(t.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),l){case"manifest":case"level":if(m)if(u){if(u!==a.levels[m]){const y=a.levels.indexOf(u);y>-1&&(m=y)}}else m=0;a.trigger(v.LEVEL_LOADED,{details:t,levelInfo:u||a.levels[0],level:m||0,id:d||0,stats:i,networkDetails:s,deliveryDirectives:h,withoutMultiVariant:"manifest"===l});break;case"audioTrack":a.trigger(v.AUDIO_TRACK_LOADED,{details:t,track:u,id:d||0,groupId:f||"",stats:i,networkDetails:s,deliveryDirectives:h});break;case"subtitleTrack":a.trigger(v.SUBTITLE_TRACK_LOADED,{details:t,track:u,id:d||0,groupId:f||"",stats:i,networkDetails:s,deliveryDirectives:h})}else{const y=t.playlistParsingError=new Error("No Segments found in Playlist");a.trigger(v.ERROR,{type:fe.NETWORK_ERROR,details:N.LEVEL_EMPTY_ERROR,fatal:!1,url:p,error:y,reason:y.message,response:e,context:r,level:m,parent:g,networkDetails:s,stats:i})}}}let sc=(()=>{class n{static get version(){return bd}static isMSESupported(){return WP()}static isSupported(){return function lte(){if(!WP())return!1;const n=po();return"function"==typeof n?.isTypeSupported&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>n.isTypeSupported(md(t,"video")))||["mp4a.40.2","fLaC"].some(t=>n.isTypeSupported(md(t,"audio"))))}()}static getMediaSource(){return po()}static get Events(){return v}static get MetadataSchema(){return Mi}static get ErrorTypes(){return fe}static get ErrorDetails(){return N}static get DefaultConfig(){return n.defaultConfig?n.defaultConfig:Qee}static set DefaultConfig(e){n.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new f1,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const i=this.logger=function EQ(n,t,e){const i=Bb();if("object"==typeof console&&!0===n||"object"==typeof n){const r=["debug","log","info","warn","error"];r.forEach(s=>{i[s]=tO(s,n,e)});try{i.log(`Debug logs enabled for "${t}" in hls.js version 1.6.14`)}catch{return Bb()}r.forEach(s=>{Ub[s]=tO(s,n)})}else vt(Ub,i);return i}(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=function Xee(n,t,e){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=W1(n),s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(o=>{const a=`${"level"===o?"playlist":o}LoadPolicy`,l=void 0===t[a],c=[];s.forEach(u=>{const d=`${o}Loading${u}`,f=t[d];if(void 0!==f&&l){c.push(d);const h=i[a].default;switch(t[a]={default:h},u){case"TimeOut":h.maxLoadTimeMs=f,h.maxTimeToFirstByteMs=f;break;case"MaxRetry":h.errorRetry.maxNumRetry=f,h.timeoutRetry.maxNumRetry=f;break;case"RetryDelay":h.errorRetry.retryDelayMs=f,h.timeoutRetry.retryDelayMs=f;break;case"MaxRetryTimeout":h.errorRetry.maxRetryDelayMs=f,h.timeoutRetry.maxRetryDelayMs=f}}}),c.length&&e.warn(`hls.js config: "${c.join('", "')}" setting(s) are deprecated, use "${a}": ${It(t[a])}`)}),ct(ct({},i),t)}(n.DefaultConfig,e,i);this.userConfig=e,r.progressive&&function Jee(n,t){const e=n.loader;e!==$P&&e!==VP?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):function Vee(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}()&&(n.loader=$P,n.progressive=!0,n.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}(r,i);const{abrController:s,bufferController:o,capLevelController:a,errorController:l,fpsController:c}=r,u=new l(this),d=this.abrController=new s(this),f=new mZ(this),h=r.interstitialsController,p=h?this.interstitialsController=new h(this,n):null,g=this.bufferController=new o(this,f),m=this.capLevelController=new a(this),_=new c(this),y=new hte(this),b=r.contentSteeringController,S=b?new b(this):null,C=this.levelController=new ate(this,S),k=new ste(this),I=new fte(this.config,this.logger),M=this.streamController=new dte(this,f,I),O=this.gapController=new ite(this,f);m.setStreamController(M),_.setStreamController(M);const x=[y,C,M];p&&x.splice(1,0,p),S&&x.splice(1,0,S),this.networkControllers=x;const B=[d,g,O,m,_,k,f];this.audioTrackController=this.createController(r.audioTrackController,x);const K=r.audioStreamController;K&&x.push(this.audioStreamController=new K(this,f,I)),this.subtitleTrackController=this.createController(r.subtitleTrackController,x);const ee=r.subtitleStreamController;ee&&x.push(this.subtititleStreamController=new ee(this,f,I)),this.createController(r.timelineController,B),I.emeController=this.emeController=this.createController(r.emeController,B),this.cmcdController=this.createController(r.cmcdController,B),this.latencyController=this.createController(ote,B),this.coreComponents=B,x.push(u);const oe=u.onErrorOut;"function"==typeof oe&&this.on(v.ERROR,oe,u),this.on(v.MANIFEST_LOADED,y.onManifestLoaded,y)}createController(e,i){if(e){const r=new e(this);return i&&i.push(r),r}return null}on(e,i,r=this){this._emitter.on(e,i,r)}once(e,i,r=this){this._emitter.once(e,i,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,i,r=this,s){this._emitter.off(e,i,r,s)}listeners(e){return this._emitter.listeners(e)}emit(e,i,r){return this._emitter.emit(e,i,r)}trigger(e,i){if(this.config.debug)return this.emit(e,e,i);try{return this.emit(e,e,i)}catch(r){this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.triggeringException||(this.triggeringException=!0,this.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.INTERNAL_EXCEPTION,fatal:e===v.ERROR,event:e,error:r}),this.triggeringException=!1)}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(v.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(i=>i.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(i=>i.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const o=new Error(`attachMedia failed: invalid argument (${e})`);return void this.trigger(v.ERROR,{type:fe.OTHER_ERROR,details:N.ATTACH_MEDIA_ERROR,fatal:!0,error:o})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const i="media"in e,r=i?e.media:e,s=i?e:{media:r};this._media=r,this.trigger(v.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(v.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(v.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const i=this.media,r=this._url,s=this._url=Vb.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),i&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(i)),this.trigger(v.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,i){this.logger.log(`startLoad(${e+(i?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,i),this.started&&this.networkControllers);r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ce_MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e.audio=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e.subtitle=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,i=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),i&&this.startLoad(i))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=function iee(){try{return crypto.randomUUID()}catch{try{const t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch{let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==r?s:3&s|8).toString(16)})}}}()),e}get levels(){return this.levelController.levels||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const i=!!e;i!==this.config.capLevelToPlayerSize&&(i?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=i)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){(function eZ(n){return Qb.indexOf(n)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:i}}=this;if(!e)return 0;const r=e.length;for(let s=0;s<r;s++)if(e[s].maxBitrate>=i)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:i,maxHdcpLevel:r}=this;let s;if(s=-1===i&&null!=e&&e.length?e.length-1:i,r)for(let o=s;o--;){const a=e[o].attrs["HDCP-LEVEL"];if(a&&a<=r)return o}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var i;return(null==(i=this.audioTrackController)?void 0:i.setAudioOption(e))||null}setSubtitleOption(e){var i;return(null==(i=this.subtitleTrackController)?void 0:i.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const i=this.audioTrackController;i&&(i.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const i=this.subtitleTrackController;i&&(i.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const i=this.subtitleTrackController;i&&(i.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!(null==(e=this.bufferController)||!e.bufferedToEnd)}get interstitialsManager(){var e;return(null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,i=this.allAudioTracks){return TO(e,xO(i),navigator.mediaCapabilities)}}return n.defaultConfig=void 0,n})();var qP=function(n){return n[n.COMBINED=0]="COMBINED",n[n.VIDEO_ONLY=1]="VIDEO_ONLY",n[n.AUDIO_ONLY=2]="AUDIO_ONLY",n[n.OTHER=3]="OTHER",n}(qP||{});class pte extends Pn{constructor(t,e){super()}schedule(t,e=0){return this}}const kg={setInterval(n,t,...e){const{delegate:i}=kg;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=kg;return(t?.clearInterval||clearInterval)(n)},delegate:void 0},YP={now:()=>(YP.delegate||Date).now(),delegate:void 0};class wd{constructor(t,e=wd.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}wd.now=YP.now;const Z1=new class mte extends wd{constructor(t,e=wd.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}(class gte extends pte{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,e),this}requestAsyncId(t,e,i=0){return kg.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&kg.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,i=!1;try{this.work(t)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,tf(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}),_te=Z1;function X1(n=0,t,e=_te){let i=-1;return null!=t&&(fR(t)?e=t:i=t),new wt(r=>{let s=function yte(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;s<0&&(s=0);let o=0;return e.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}const Ite=["addListener","removeListener"],wte=["addEventListener","removeEventListener"],xte=["on","off"];function kn(n,t,e,i){if(Ze(e)&&(i=e,e=void 0),i)return kn(n,t,e).pipe(tb(i));const[r,s]=function Rte(n){return Ze(n.addEventListener)&&Ze(n.removeEventListener)}(n)?wte.map(o=>a=>n[o](t,a,e)):function Ate(n){return Ze(n.addListener)&&Ze(n.removeListener)}(n)?Ite.map(ZP(n,t)):function Mte(n){return Ze(n.on)&&Ze(n.off)}(n)?xte.map(ZP(n,t)):[];if(!r&&Jy(n))return Cn(o=>kn(o,t,e))(Dn(n));if(!r)throw new TypeError("Invalid event target");return new wt(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function ZP(n,t){return e=>i=>n[e](t,i)}const{isArray:kte}=Array;function XP(n){return 1===n.length&&kte(n[0])?n[0]:n}function JP(...n){return 1===(n=XP(n)).length?Dn(n[0]):new wt(function Ote(n){return t=>{let e=[];for(let i=0;e&&!t.closed&&i<n.length;i++)e.push(Dn(n[i]).subscribe(yt(t,r=>{if(e){for(let s=0;s<e.length;s++)s!==i&&e[s].unsubscribe();e=null}t.next(r)})))}}(n))}function J1(...n){const t=_p(n),e=XP(n);return e.length?new wt(i=>{let r=e.map(()=>[]),s=e.map(()=>!1);i.add(()=>{r=s=null});for(let o=0;!i.closed&&o<e.length;o++)Dn(e[o]).subscribe(yt(i,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(c=>c.shift());i.next(t?t(...l):l),r.some((c,u)=>!c.length&&s[u])&&i.complete()}},()=>{s[o]=!0,!r[o].length&&i.complete()}));return()=>{r=s=null}}):ui}function eE(...n){const t=_p(n);return Qt((e,i)=>{const r=n.length,s=new Array(r);let o=n.map(()=>!1),a=!1;for(let l=0;l<r;l++)Dn(n[l]).subscribe(yt(i,c=>{s[l]=c,!a&&!o[l]&&(o[l]=!0,(a=o.every(as))&&(o=null))},Ec));e.subscribe(yt(i,l=>{if(a){const c=[l,...s];i.next(t?t(...c):c)}}))})}function eL(n,t){return t?e=>Gu(t.pipe(Qi(1),function Lte(){return Qt((n,t)=>{n.subscribe(yt(t,Ec))})}()),e.pipe(eL(n))):Cn((e,i)=>Dn(n(e,i)).pipe(Qi(1),function Fte(n){return Ne(()=>n)}(e)))}let tL=(()=>{class n{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,i){this._renderer=e,this._elementRef=i}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(i){return new(i||n)(F(Ss),F(lt))};static \u0275dir=ne({type:n})}return n})(),ya=(()=>{class n extends tL{static \u0275fac=(()=>{let e;return function(r){return(e||(e=xt(n)))(r||n)}})();static \u0275dir=ne({type:n,features:[Je]})}return n})();const nr=new W(""),Gte={provide:nr,useExisting:it(()=>ba),multi:!0},Wte=new W("");let ba=(()=>{class n extends tL{_compositionMode;_composing=!1;constructor(e,i,r){super(e,i),this._compositionMode=r,null==this._compositionMode&&(this._compositionMode=!function zte(){const n=ro()?ro().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(i){return new(i||n)(F(Ss),F(lt),F(Wte,8))};static \u0275dir=ne({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&j("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},standalone:!1,features:[St([Gte]),Je]})}return n})();const On=new W(""),yo=new W("");function dL(n){return null!=n}function fL(n){return bu(n)?an(n):n}function hL(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function pL(n,t){return t.map(e=>e(n))}function gL(n){return n.map(t=>function qte(n){return!n.validate}(t)?t:e=>t.validate(e))}function iE(n){return null!=n?function mL(n){if(!n)return null;const t=n.filter(dL);return 0==t.length?null:function(e){return hL(pL(e,t))}}(gL(n)):null}function rE(n){return null!=n?function _L(n){if(!n)return null;const t=n.filter(dL);return 0==t.length?null:function(e){return function jte(...n){const t=_p(n),{args:e,keys:i}=hR(n),r=new wt(s=>{const{length:o}=e;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;Dn(e[u]).subscribe(yt(s,f=>{d||(d=!0,c--),a[u]=f},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(i?pR(i,a):a),s.complete())}))}});return t?r.pipe(tb(t)):r}(pL(e,t).map(fL)).pipe(Ne(hL))}}(gL(n)):null}function vL(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function sE(n){return n?Array.isArray(n)?n:[n]:[]}function Ng(n,t){return Array.isArray(n)?n.includes(t):n===t}function EL(n,t){const e=sE(t);return sE(n).forEach(r=>{Ng(e,r)||e.push(r)}),e}function SL(n,t){return sE(t).filter(e=>!Ng(n,e))}class TL{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=iE(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=rE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Xn extends TL{name;get formDirective(){return null}get path(){return null}}class bo extends TL{_parent=null;name=null;valueAccessor=null}class DL{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}}let xd=(()=>{class n extends DL{constructor(e){super(e)}static \u0275fac=function(i){return new(i||n)(F(bo,2))};static \u0275dir=ne({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&Pe("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Je]})}return n})();const Ad="VALID",Lg="INVALID",oc="PENDING",Md="DISABLED";class ac{}class IL extends ac{value;source;constructor(t,e){super(),this.value=t,this.source=e}}class lE extends ac{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}}class cE extends ac{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}}class Fg extends ac{status;source;constructor(t,e){super(),this.status=t,this.source=e}}function Bg(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class fE{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return nn(this.statusReactive)}set status(t){nn(()=>this.statusReactive.set(t))}_status=ws(()=>this.statusReactive());statusReactive=Nr(void 0);get valid(){return this.status===Ad}get invalid(){return this.status===Lg}get pending(){return this.status==oc}get disabled(){return this.status===Md}get enabled(){return this.status!==Md}errors;get pristine(){return nn(this.pristineReactive)}set pristine(t){nn(()=>this.pristineReactive.set(t))}_pristine=ws(()=>this.pristineReactive());pristineReactive=Nr(!0);get dirty(){return!this.pristine}get touched(){return nn(this.touchedReactive)}set touched(t){nn(()=>this.touchedReactive.set(t))}_touched=ws(()=>this.touchedReactive());touchedReactive=Nr(!1);get untouched(){return!this.touched}_events=new ke;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(EL(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(EL(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(SL(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(SL(t,this._rawAsyncValidators))}hasValidator(t){return Ng(this._rawValidators,t)}hasAsyncValidator(t){return Ng(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){const e=!1===this.touched;this.touched=!0;const i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched({...t,sourceControl:i}),e&&!1!==t.emitEvent&&this._events.next(new cE(!0,i))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){const e=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const i=t.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:i})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,i),e&&!1!==t.emitEvent&&this._events.next(new cE(!1,i))}markAsDirty(t={}){const e=!0===this.pristine;this.pristine=!1;const i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty({...t,sourceControl:i}),e&&!1!==t.emitEvent&&this._events.next(new lE(!1,i))}markAsPristine(t={}){const e=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const i=t.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,i),e&&!1!==t.emitEvent&&this._events.next(new lE(!0,i))}markAsPending(t={}){this.status=oc;const e=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new Fg(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending({...t,sourceControl:e})}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Md,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue();const i=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new IL(this.value,i)),this._events.next(new Fg(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e},this),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Ad,this._forEachChild(i=>{i.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e},this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ad||this.status===oc)&&this._runAsyncValidator(i,t.emitEvent)}const e=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new IL(this.value,e)),this._events.next(new Fg(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity({...t,sourceControl:e})}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Md:Ad}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=oc,this._hasOwnPendingAsyncValidator={emitEvent:!1!==e};const i=fL(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent,this,e.shouldHaveEmitted)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,i){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||i)&&this._events.next(new Fg(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,i)}_initObservables(){this.valueChanges=new ve,this.statusChanges=new ve}_calculateStatus(){return this._allControlsDisabled()?Md:this.errors?Lg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(oc)?oc:this._anyControlsHaveStatus(Lg)?Lg:Ad}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){const i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),r&&this._events.next(new lE(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new cE(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Bg(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function nne(n){return Array.isArray(n)?iE(n):n||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function ine(n){return Array.isArray(n)?rE(n):n||null}(this._rawAsyncValidators)}}const lc=new W("",{providedIn:"root",factory:()=>Ug}),Ug="always";function Rd(n,t,e=Ug){(function pE(n,t){const e=function yL(n){return n._rawValidators}(n);null!==t.validator?n.setValidators(vL(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=function bL(n){return n._rawAsyncValidators}(n);null!==t.asyncValidator?n.setAsyncValidators(vL(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();jg(t._rawValidators,r),jg(t._rawAsyncValidators,r)})(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(n.disabled),function one(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&RL(n,t)})}(n,t),function lne(n,t){const e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function ane(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&RL(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function sne(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function jg(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function RL(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function NL(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function PL(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}Promise.resolve();const LL=class extends fE{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,i){super(function uE(n){return(Bg(n)?n.validators:n)||null}(e),function dE(n,t){return(Bg(t)?t.asyncValidators:n)||null}(i,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Bg(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=PL(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){NL(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){NL(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){PL(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},vne={provide:bo,useExisting:it(()=>cc)},FL=Promise.resolve();let cc=(()=>{class n extends bo{_changeDetectorRef;callSetDisabledState;control=new LL;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new ve;constructor(e,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function _E(n,t){if(!t)return null;let e,i,r;return Array.isArray(t),t.forEach(s=>{s.constructor===ba?e=s:function dne(n){return Object.getPrototypeOf(n.constructor)===ya}(s)?i=s:r=s}),r||i||e||null}(0,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function mE(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Rd(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){FL.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&Ll(i);FL.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function $g(n,t){return[...t.path,n]}(e,this._parent):[e]}static \u0275fac=function(i){return new(i||n)(F(Xn,9),F(On,10),F(yo,10),F(nr,10),F(zi,8),F(lc,8))};static \u0275dir=ne({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[St([vne]),Je,Fn]})}return n})();const Ane={provide:nr,useExisting:it(()=>Yg),multi:!0};function zL(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let Yg=(()=>{class n extends ya{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;const r=zL(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function Mne(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xt(n)))(r||n)}})();static \u0275dir=ne({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&j("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[St([Ane]),Je]})}return n})(),WL=(()=>{class n{_element;_renderer;_select;id;constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(zL(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(F(lt),F(Ss),F(Yg,9))};static \u0275dir=ne({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();const Rne={provide:nr,useExisting:it(()=>vE),multi:!0};function KL(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let vE=(()=>{class n extends ya{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const c=this._getOptionValue(o[a].value);r.push(c)}}else{const o=i.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function kne(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xt(n)))(r||n)}})();static \u0275dir=ne({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&j("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[St([Rne]),Je]})}return n})(),qL=(()=>{class n{_element;_renderer;_select;id;_value;constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(KL(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(KL(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(F(lt),F(Ss),F(vE,9))};static \u0275dir=ne({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),Vne=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=bt({type:n});static \u0275inj=dt({})}return n})(),Hne=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:lc,useValue:e.callSetDisabledState??Ug}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=bt({type:n});static \u0275inj=dt({imports:[Vne]})}return n})();var Gne={left:"right",right:"left",bottom:"top",top:"bottom"};function Qg(n){return n.replace(/left|right|bottom|top/g,function(t){return Gne[t]})}function is(n){return n.split("-")[0]}var zne={start:"end",end:"start"};function rF(n){return n.replace(/start|end/g,function(t){return zne[t]})}var Oi="top",Dr="bottom",Cr="right",Ni="left",bE="auto",Nd=[Oi,Dr,Cr,Ni],uc="start",Pd="end",sF="viewport",Ld="popper",oF=Nd.reduce(function(n,t){return n.concat([t+"-"+uc,t+"-"+Pd])},[]),aF=[].concat(Nd,[bE]).reduce(function(n,t){return n.concat([t,t+"-"+uc,t+"-"+Pd])},[]),iie=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Pi(n){if(null==n)return window;if("[object Window]"!==n.toString()){var t=n.ownerDocument;return t&&t.defaultView||window}return n}function Sa(n){return n instanceof Pi(n).Element||n instanceof Element}function ir(n){return n instanceof Pi(n).HTMLElement||n instanceof HTMLElement}function EE(n){return!(typeof ShadowRoot>"u")&&(n instanceof Pi(n).ShadowRoot||n instanceof ShadowRoot)}function Eo(n){return((Sa(n)?n.ownerDocument:n.document)||window.document).documentElement}var Ta=Math.max,Zg=Math.min,dc=Math.round;function SE(){var n=navigator.userAgentData;return null!=n&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function lF(){return!/^((?!chrome|android).)*safari/i.test(SE())}function fc(n,t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var i=n.getBoundingClientRect(),r=1,s=1;t&&ir(n)&&(r=n.offsetWidth>0&&dc(i.width)/n.offsetWidth||1,s=n.offsetHeight>0&&dc(i.height)/n.offsetHeight||1);var a=(Sa(n)?Pi(n):window).visualViewport,l=!lF()&&e,c=(i.left+(l&&a?a.offsetLeft:0))/r,u=(i.top+(l&&a?a.offsetTop:0))/s,d=i.width/r,f=i.height/s;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c,x:c,y:u}}function TE(n){var t=Pi(n);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function DE(n){return fc(Eo(n)).left+TE(n).scrollLeft}function Fs(n){return Pi(n).getComputedStyle(n)}function rs(n){return n?(n.nodeName||"").toLowerCase():null}function Xg(n){return"html"===rs(n)?n:n.assignedSlot||n.parentNode||(EE(n)?n.host:null)||Eo(n)}function CE(n){var t=Fs(n);return/auto|scroll|overlay|hidden/.test(t.overflow+t.overflowY+t.overflowX)}function cF(n){return["html","body","#document"].indexOf(rs(n))>=0?n.ownerDocument.body:ir(n)&&CE(n)?n:cF(Xg(n))}function Fd(n,t){var e;void 0===t&&(t=[]);var i=cF(n),r=i===(null==(e=n.ownerDocument)?void 0:e.body),s=Pi(i),o=r?[s].concat(s.visualViewport||[],CE(i)?i:[]):i,a=t.concat(o);return r?a:a.concat(Fd(Xg(o)))}function oie(n){return["table","td","th"].indexOf(rs(n))>=0}function uF(n){return ir(n)&&"fixed"!==Fs(n).position?n.offsetParent:null}function Bd(n){for(var t=Pi(n),e=uF(n);e&&oie(e)&&"static"===Fs(e).position;)e=uF(e);return e&&("html"===rs(e)||"body"===rs(e)&&"static"===Fs(e).position)?t:e||function aie(n){var t=/firefox/i.test(SE());if(/Trident/i.test(SE())&&ir(n)&&"fixed"===Fs(n).position)return null;var r=Xg(n);for(EE(r)&&(r=r.host);ir(r)&&["html","body"].indexOf(rs(r))<0;){var s=Fs(r);if("none"!==s.transform||"none"!==s.perspective||"paint"===s.contain||-1!==["transform","perspective"].indexOf(s.willChange)||t&&"filter"===s.willChange||t&&s.filter&&"none"!==s.filter)return r;r=r.parentNode}return null}(n)||t}function dF(n,t){var e=t.getRootNode&&t.getRootNode();if(n.contains(t))return!0;if(e&&EE(e)){var i=t;do{if(i&&n.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function IE(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function fF(n,t,e){return t===sF?IE(function rie(n,t){var e=Pi(n),i=Eo(n),r=e.visualViewport,s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var c=lF();(c||!c&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+DE(n),y:l}}(n,e)):Sa(t)?function lie(n,t){var e=fc(n,!1,"fixed"===t);return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}(t,e):IE(function sie(n){var t,e=Eo(n),i=TE(n),r=null==(t=n.ownerDocument)?void 0:t.body,s=Ta(e.scrollWidth,e.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Ta(e.scrollHeight,e.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+DE(n),l=-i.scrollTop;return"rtl"===Fs(r||e).direction&&(a+=Ta(e.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(Eo(n)))}function hc(n){return n.split("-")[1]}function wE(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function hF(n){var l,t=n.reference,e=n.element,i=n.placement,r=i?is(i):null,s=i?hc(i):null,o=t.x+t.width/2-e.width/2,a=t.y+t.height/2-e.height/2;switch(r){case Oi:l={x:o,y:t.y-e.height};break;case Dr:l={x:o,y:t.y+t.height};break;case Cr:l={x:t.x+t.width,y:a};break;case Ni:l={x:t.x-e.width,y:a};break;default:l={x:t.x,y:t.y}}var c=r?wE(r):null;if(null!=c){var u="y"===c?"height":"width";switch(s){case uc:l[c]=l[c]-(t[u]/2-e[u]/2);break;case Pd:l[c]=l[c]+(t[u]/2-e[u]/2)}}return l}function gF(n){return Object.assign({},{top:0,right:0,bottom:0,left:0},n)}function mF(n,t){return t.reduce(function(e,i){return e[i]=n,e},{})}function xE(n,t){void 0===t&&(t={});var i=t.placement,r=void 0===i?n.placement:i,s=t.strategy,o=void 0===s?n.strategy:s,a=t.boundary,l=void 0===a?"clippingParents":a,c=t.rootBoundary,u=void 0===c?sF:c,d=t.elementContext,f=void 0===d?Ld:d,h=t.altBoundary,p=void 0!==h&&h,g=t.padding,m=void 0===g?0:g,_=gF("number"!=typeof m?m:mF(m,Nd)),b=n.rects.popper,S=n.elements[p?f===Ld?"reference":Ld:f],C=function uie(n,t,e,i){var r="clippingParents"===t?function cie(n){var t=Fd(Xg(n)),i=["absolute","fixed"].indexOf(Fs(n).position)>=0&&ir(n)?Bd(n):n;return Sa(i)?t.filter(function(r){return Sa(r)&&dF(r,i)&&"body"!==rs(r)}):[]}(n):[].concat(t),s=[].concat(r,[e]),a=s.reduce(function(l,c){var u=fF(n,c,i);return l.top=Ta(u.top,l.top),l.right=Zg(u.right,l.right),l.bottom=Zg(u.bottom,l.bottom),l.left=Ta(u.left,l.left),l},fF(n,s[0],i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(Sa(S)?S:S.contextElement||Eo(n.elements.popper),l,u,o),k=fc(n.elements.reference),I=hF({reference:k,element:b,strategy:"absolute",placement:r}),M=IE(Object.assign({},b,I)),O=f===Ld?M:k,x={top:C.top-O.top+_.top,bottom:O.bottom-C.bottom+_.bottom,left:C.left-O.left+_.left,right:O.right-C.right+_.right},B=n.modifiersData.offset;if(f===Ld&&B){var K=B[r];Object.keys(x).forEach(function(ee){var oe=[Cr,Dr].indexOf(ee)>=0?1:-1,se=[Oi,Dr].indexOf(ee)>=0?"y":"x";x[ee]+=K[se]*oe})}return x}const pie={name:"flip",enabled:!0,phase:"main",fn:function hie(n){var t=n.state,e=n.options,i=n.name;if(!t.modifiersData[i]._skip){for(var r=e.mainAxis,s=void 0===r||r,o=e.altAxis,a=void 0===o||o,l=e.fallbackPlacements,c=e.padding,u=e.boundary,d=e.rootBoundary,f=e.altBoundary,h=e.flipVariations,p=void 0===h||h,g=e.allowedAutoPlacements,m=t.options.placement,_=is(m),b=l||(_!==m&&p?function fie(n){if(is(n)===bE)return[];var t=Qg(n);return[rF(n),t,rF(t)]}(m):[Qg(m)]),S=[m].concat(b).reduce(function(We,Te){return We.concat(is(Te)===bE?function die(n,t){void 0===t&&(t={});var r=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=void 0===l?aF:l,u=hc(t.placement),d=u?a?oF:oF.filter(function(p){return hc(p)===u}):Nd,f=d.filter(function(p){return c.indexOf(p)>=0});0===f.length&&(f=d);var h=f.reduce(function(p,g){return p[g]=xE(n,{placement:g,boundary:r,rootBoundary:s,padding:o})[is(g)],p},{});return Object.keys(h).sort(function(p,g){return h[p]-h[g]})}(t,{placement:Te,boundary:u,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:g}):Te)},[]),C=t.rects.reference,k=t.rects.popper,I=new Map,M=!0,O=S[0],x=0;x<S.length;x++){var B=S[x],K=is(B),ee=hc(B)===uc,oe=[Oi,Dr].indexOf(K)>=0,se=oe?"width":"height",G=xE(t,{placement:B,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),ie=oe?ee?Cr:Ni:ee?Dr:Oi;C[se]>k[se]&&(ie=Qg(ie));var te=Qg(ie),ae=[];if(s&&ae.push(G[K]<=0),a&&ae.push(G[ie]<=0,G[te]<=0),ae.every(function(We){return We})){O=B,M=!1;break}I.set(B,ae)}if(M)for(var Z=function(Te){var Be=S.find(function(Xt){var kt=I.get(Xt);if(kt)return kt.slice(0,Te).every(function(Un){return Un})});if(Be)return O=Be,"break"},q=p?3:1;q>0&&"break"!==Z(q);q--);t.placement!==O&&(t.modifiersData[i]._skip=!0,t.placement=O,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Ud(n,t,e){return Ta(n,Zg(t,e))}function AE(n){var t=fc(n),e=n.offsetWidth,i=n.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:n.offsetLeft,y:n.offsetTop,width:e,height:i}}const vie={name:"preventOverflow",enabled:!0,phase:"main",fn:function _ie(n){var t=n.state,e=n.options,i=n.name,r=e.mainAxis,s=void 0===r||r,o=e.altAxis,a=void 0!==o&&o,f=e.tether,h=void 0===f||f,p=e.tetherOffset,g=void 0===p?0:p,m=xE(t,{boundary:e.boundary,rootBoundary:e.rootBoundary,padding:e.padding,altBoundary:e.altBoundary}),_=is(t.placement),y=hc(t.placement),b=!y,S=wE(_),C=function gie(n){return"x"===n?"y":"x"}(S),k=t.modifiersData.popperOffsets,I=t.rects.reference,M=t.rects.popper,O="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,x="number"==typeof O?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),B=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,K={x:0,y:0};if(k){if(s){var ee,oe="y"===S?Oi:Ni,se="y"===S?Dr:Cr,G="y"===S?"height":"width",ie=k[S],te=ie+m[oe],ae=ie-m[se],ge=h?-M[G]/2:0,Z=y===uc?I[G]:M[G],q=y===uc?-M[G]:-I[G],Re=t.elements.arrow,We=h&&Re?AE(Re):{width:0,height:0},Te=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Be=Te[oe],Xt=Te[se],kt=Ud(0,I[G],We[G]),Un=b?I[G]/2-ge-kt-Be-x.mainAxis:Z-kt-Be-x.mainAxis,sr=b?-I[G]/2+ge+kt+Xt+x.mainAxis:q+kt+Xt+x.mainAxis,wr=t.elements.arrow&&Bd(t.elements.arrow),WE=wr?"y"===S?wr.clientTop||0:wr.clientLeft||0:0,vc=null!=(ee=B?.[S])?ee:0,M2=ie+sr-vc,qe=Ud(h?Zg(te,ie+Un-vc-WE):te,ie,h?Ta(ae,M2):ae);k[S]=qe,K[S]=qe-ie}if(a){var yn,bn=k[C],xr="y"===C?"height":"width",ss=bn+m["x"===S?Oi:Ni],zd=bn-m["x"===S?Dr:Cr],So=-1!==[Oi,Ni].indexOf(_),Wd=null!=(yn=B?.[C])?yn:0,To=So?ss:bn-I[xr]-M[xr]-Wd+x.altAxis,Kd=So?bn+I[xr]+M[xr]-Wd-x.altAxis:zd,gm=h&&So?function mie(n,t,e){var i=Ud(n,t,e);return i>e?e:i}(To,bn,Kd):Ud(h?To:ss,bn,h?Kd:zd);k[C]=gm,K[C]=gm-bn}t.modifiersData[i]=K}},requiresIfExists:["offset"]},Sie={name:"arrow",enabled:!0,phase:"main",fn:function bie(n){var t,e=n.state,i=n.name,r=n.options,s=e.elements.arrow,o=e.modifiersData.popperOffsets,a=is(e.placement),l=wE(a),u=[Ni,Cr].indexOf(a)>=0?"height":"width";if(s&&o){var d=function(t,e){return gF("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:mF(t,Nd))}(r.padding,e),f=AE(s),h="y"===l?Oi:Ni,p="y"===l?Dr:Cr,g=e.rects.reference[u]+e.rects.reference[l]-o[l]-e.rects.popper[u],m=o[l]-e.rects.reference[l],_=Bd(s),y=_?"y"===l?_.clientHeight||0:_.clientWidth||0:0,k=y/2-f[u]/2+(g/2-m/2),I=Ud(d[h],k,y-f[u]-d[p]);e.modifiersData[i]=((t={})[l]=I,t.centerOffset=I-k,t)}},effect:function Eie(n){var t=n.state,i=n.options.element,r=void 0===i?"[data-popper-arrow]":i;null!=r&&("string"==typeof r&&!(r=t.elements.popper.querySelector(r))||dF(t.elements.popper,r)&&(t.elements.arrow=r))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Iie(n,t,e){void 0===e&&(e=!1);var i=ir(t),r=ir(t)&&function Cie(n){var t=n.getBoundingClientRect(),e=dc(t.width)/n.offsetWidth||1,i=dc(t.height)/n.offsetHeight||1;return 1!==e||1!==i}(t),s=Eo(t),o=fc(n,r,e),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!e)&&(("body"!==rs(t)||CE(s))&&(a=function Die(n){return n!==Pi(n)&&ir(n)?function Tie(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}(n):TE(n)}(t)),ir(t)?((l=fc(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=DE(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function wie(n){var t=new Map,e=new Set,i=[];function r(s){e.add(s.name),[].concat(s.requires||[],s.requiresIfExists||[]).forEach(function(a){if(!e.has(a)){var l=t.get(a);l&&r(l)}}),i.push(s)}return n.forEach(function(s){t.set(s.name,s)}),n.forEach(function(s){e.has(s.name)||r(s)}),i}function Aie(n){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(n())})})),t}}var _F={placement:"bottom",modifiers:[],strategy:"absolute"};function vF(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return!t.some(function(i){return!(i&&"function"==typeof i.getBoundingClientRect)})}function Rie(n){void 0===n&&(n={});var e=n.defaultModifiers,i=void 0===e?[]:e,r=n.defaultOptions,s=void 0===r?_F:r;return function(a,l,c){void 0===c&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},_F,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,h={state:u,setOptions:function(_){var y="function"==typeof _?_(u.options):_;g(),u.options=Object.assign({},s,u.options,y),u.scrollParents={reference:Sa(a)?Fd(a):a.contextElement?Fd(a.contextElement):[],popper:Fd(l)};var b=function xie(n){var t=wie(n);return iie.reduce(function(e,i){return e.concat(t.filter(function(r){return r.phase===i}))},[])}(function Mie(n){var t=n.reduce(function(e,i){var r=e[i.name];return e[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,e},{});return Object.keys(t).map(function(e){return t[e]})}([].concat(i,u.options.modifiers)));return u.orderedModifiers=b.filter(function(S){return S.enabled}),function p(){u.orderedModifiers.forEach(function(m){var y=m.options,S=m.effect;if("function"==typeof S){var C=S({state:u,name:m.name,instance:h,options:void 0===y?{}:y});d.push(C||function(){})}})}(),h.update()},forceUpdate:function(){if(!f){var _=u.elements,y=_.reference,b=_.popper;if(vF(y,b)){u.rects={reference:Iie(y,Bd(b),"fixed"===u.options.strategy),popper:AE(b)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(x){return u.modifiersData[x.name]=Object.assign({},x.data)});for(var S=0;S<u.orderedModifiers.length;S++)if(!0!==u.reset){var C=u.orderedModifiers[S],k=C.fn,I=C.options;"function"==typeof k&&(u=k({state:u,options:void 0===I?{}:I,name:C.name,instance:h})||u)}else u.reset=!1,S=-1}}},update:Aie(function(){return new Promise(function(m){h.forceUpdate(),m(u)})}),destroy:function(){g(),f=!0}};if(!vF(a,l))return h;function g(){d.forEach(function(m){return m()}),d=[]}return h.setOptions(c).then(function(m){!f&&c.onFirstUpdate&&c.onFirstUpdate(m)}),h}}var Jg={passive:!0};const Oie={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function kie(n){var t=n.state,e=n.instance,i=n.options,r=i.scroll,s=void 0===r||r,o=i.resize,a=void 0===o||o,l=Pi(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",e.update,Jg)}),a&&l.addEventListener("resize",e.update,Jg),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",e.update,Jg)}),a&&l.removeEventListener("resize",e.update,Jg)}},data:{}},Pie={name:"popperOffsets",enabled:!0,phase:"read",fn:function Nie(n){var t=n.state;t.modifiersData[n.name]=hF({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var Lie={top:"auto",right:"auto",bottom:"auto",left:"auto"};function yF(n){var t,e=n.popper,i=n.popperRect,r=n.placement,s=n.variation,o=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,d=n.isFixed,f=o.x,h=void 0===f?0:f,p=o.y,g=void 0===p?0:p,m="function"==typeof u?u({x:h,y:g}):{x:h,y:g};h=m.x,g=m.y;var _=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),b=Ni,S=Oi,C=window;if(c){var k=Bd(e),I="clientHeight",M="clientWidth";k===Pi(e)&&"static"!==Fs(k=Eo(e)).position&&"absolute"===a&&(I="scrollHeight",M="scrollWidth"),(r===Oi||(r===Ni||r===Cr)&&s===Pd)&&(S=Dr,g-=(d&&k===C&&C.visualViewport?C.visualViewport.height:k[I])-i.height,g*=l?1:-1),r!==Ni&&(r!==Oi&&r!==Dr||s!==Pd)||(b=Cr,h-=(d&&k===C&&C.visualViewport?C.visualViewport.width:k[M])-i.width,h*=l?1:-1)}var ee,B=Object.assign({position:a},c&&Lie),K=!0===u?function Fie(n,t){var i=n.y,r=t.devicePixelRatio||1;return{x:dc(n.x*r)/r||0,y:dc(i*r)/r||0}}({x:h,y:g},Pi(e)):{x:h,y:g};return h=K.x,g=K.y,Object.assign({},B,l?((ee={})[S]=y?"0":"",ee[b]=_?"0":"",ee.transform=(C.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",ee):((t={})[S]=y?g+"px":"",t[b]=_?h+"px":"",t.transform="",t))}const Uie={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function Bie(n){var t=n.state,e=n.options,i=e.gpuAcceleration,r=void 0===i||i,s=e.adaptive,o=void 0===s||s,a=e.roundOffsets,l=void 0===a||a,c={placement:is(t.placement),variation:hc(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,yF(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,yF(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var jie=[Oie,Pie,Uie,{name:"applyStyles",enabled:!0,phase:"write",fn:function $ie(n){var t=n.state;Object.keys(t.elements).forEach(function(e){var i=t.styles[e]||{},r=t.attributes[e]||{},s=t.elements[e];!ir(s)||!rs(s)||(Object.assign(s.style,i),Object.keys(r).forEach(function(o){var a=r[o];!1===a?s.removeAttribute(o):s.setAttribute(o,!0===a?"":a)}))})},effect:function Vie(n){var t=n.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],s=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:e[i]).reduce(function(l,c){return l[c]="",l},{});!ir(r)||!rs(r)||(Object.assign(r.style,a),Object.keys(s).forEach(function(l){r.removeAttribute(l)}))})}},requires:["computeStyles"]}],Hie=Rie({defaultModifiers:jie});const Wie={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function zie(n){var t=n.state,i=n.name,r=n.options.offset,s=void 0===r?[0,0]:r,o=aF.reduce(function(u,d){return u[d]=function Gie(n,t,e){var i=is(n),r=[Ni,Oi].indexOf(i)>=0?-1:1,s="function"==typeof e?e(Object.assign({},t,{placement:n})):e,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[Ni,Cr].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}(d,t.rects,s),u},{}),a=o[t.placement],c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=a.x,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=o}},bF=["*"],Dre=["dialog"],SF={animation:!0,transitionTimerDelayMs:5};let em=(()=>{class n{constructor(){this.animation=SF.animation}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function pc(n){return"string"==typeof n}function Da(n){return null!=n}function gc(n){return(n||document.body).getBoundingClientRect()}function CF(n=document){const t=n?.activeElement;return t?t.shadowRoot?CF(t.shadowRoot):t:null}const _se=()=>{},{transitionTimerDelayMs:vse}=SF,$d=new Map,rr=(n,t,e,i)=>{let r=i.context||{};const s=$d.get(t);if(s)switch(i.runningTransition){case"continue":return ui;case"stop":n.run(()=>s.transition$.complete()),r=Object.assign(s.context,r),$d.delete(t)}const o=e(t,i.animation,r)||_se;if(!i.animation||"none"===window.getComputedStyle(t).transitionProperty)return n.run(()=>o()),be(void 0).pipe(function mse(n){return t=>new wt(e=>t.subscribe({next:o=>n.run(()=>e.next(o)),error:o=>n.run(()=>e.error(o)),complete:()=>n.run(()=>e.complete())}))}(n));const a=new ke,l=new ke,c=a.pipe(function Pte(...n){return t=>Gu(t,be(...n))}(!0));$d.set(t,{transition$:a,complete:()=>{l.next(),l.complete()},context:r});const u=function hse(n){const{transitionDelay:t,transitionDuration:e}=window.getComputedStyle(n);return 1e3*(parseFloat(t)+parseFloat(e))}(t);return n.runOutsideAngular(()=>{const d=kn(t,"transitionend").pipe(Oe(c),mn(({target:h})=>h===t));JP(X1(u+vse).pipe(Oe(c)),d,l).pipe(Oe(c)).subscribe(()=>{$d.delete(t),n.run(()=>{o(),a.next(),a.complete()})})}),a.asObservable()};let AF=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),MF=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),OF=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),NF=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})();const om=(n,t)=>!!t&&t.some(e=>e.contains(n)),UF=(n,t)=>!t||null!=function gse(n,t){return!t||typeof n.closest>"u"?null:n.closest(t)}(n,t),zse=typeof navigator<"u"&&!!navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));function $F(n,t,e,i,r,s,o,a){e&&n.runOutsideAngular((n=>zse?()=>setTimeout(()=>n(),100):n)(()=>{const c=kn(t,"keydown").pipe(Oe(r),mn(f=>"Escape"===f.key),et(f=>f.preventDefault())),u=kn(t,"mousedown").pipe(Ne(f=>{const h=f.target;return 2!==f.button&&!om(h,o)&&("inside"===e?om(h,s)&&UF(h,a):"outside"===e?!om(h,s):UF(h,a)||!om(h,s))}),Oe(r)),d=kn(t,"mouseup").pipe(eE(u),mn(([f,h])=>h),function Bte(n,t=Z1){const e=X1(n,t);return eL(()=>e)}(0),Oe(r));JP([c.pipe(Ne(f=>0)),d.pipe(Ne(f=>1))]).subscribe(f=>n.run(()=>i(f)))}))}const VF=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function jF(n){const t=Array.from(n.querySelectorAll(VF)).filter(e=>-1!==e.tabIndex);return[t[0],t[t.length-1]]}let Kse=(()=>{class n{constructor(){this._element=w(rn).documentElement}isRTL(){return"rtl"===(this._element.getAttribute("dir")||"").toLowerCase()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const qse=/\s+/,Yse=/  +/gi,Qse={top:["top"],bottom:["bottom"],start:["left","right"],left:["left"],end:["right","left"],right:["right"],"top-start":["top-start","top-end"],"top-left":["top-start"],"top-end":["top-end","top-start"],"top-right":["top-end"],"bottom-start":["bottom-start","bottom-end"],"bottom-left":["bottom-start"],"bottom-end":["bottom-end","bottom-start"],"bottom-right":["bottom-end"],"start-top":["left-start","right-start"],"left-top":["left-start"],"start-bottom":["left-end","right-end"],"left-bottom":["left-end"],"end-top":["right-start","left-start"],"right-top":["right-start"],"end-bottom":["right-end","left-end"],"right-bottom":["right-end"]},Xse=/^left/,Jse=/^right/,eoe=/^start/,toe=/^end/;function GF({placement:n,baseClass:t},e){let i=Array.isArray(n)?n:n.split(qse),s=i.findIndex(c=>"auto"===c);s>=0&&["top","bottom","start","end","top-start","top-end","bottom-start","bottom-end","start-top","start-bottom","end-top","end-bottom"].forEach(function(c){null==i.find(u=>-1!==u.search("^"+c))&&i.splice(s++,1,c)});const o=i.map(c=>function Zse(n,t){const[e,i]=Qse[n];return t&&i||e}(c,e.isRTL()));return{placement:o.shift(),modifiers:[{name:"bootstrapClasses",enabled:!!t,phase:"write",fn({state:c}){const u=new RegExp(t+"(-[a-z]+)*","gi"),d=c.elements.popper,f=c.placement;let h=d.className;h=h.replace(u,""),h+=` ${function noe(n,t){let[e,i]=t.split("-");const r=e.replace(Xse,"start").replace(Jse,"end");let s=[r];if(i){let o=i;("left"===e||"right"===e)&&(o=o.replace(eoe,"top").replace(toe,"bottom")),s.push(`${r}-${o}`)}return n&&(s=s.map(o=>`${n}-${o}`)),s.join(" ")}(t,f)}`,h=h.trim().replace(Yse," "),d.className=h}},pie,vie,Sie,{enabled:!0,name:"flip",options:{fallbackPlacements:o}}]}}function zF(n){return n}new Date(1882,10,12),new Date(2174,10,25);let r2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),voe=(()=>{class n{constructor(){this.autoClose=!0,this.placement=["bottom-start","bottom-end","top-start","top-end"],this.popperOptions=e=>e,this.container=null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),um=(()=>{class n{constructor(){this._disabled=!1,this.nativeElement=w(lt).nativeElement,this.tabindex=0}set disabled(e){this._disabled=""===e||!0===e}get disabled(){return this._disabled}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ne({type:n,selectors:[["","ngbDropdownItem",""]],hostAttrs:[1,"dropdown-item"],hostVars:3,hostBindings:function(i,r){2&i&&(Hi("tabIndex",r.disabled?-1:r.tabindex),Pe("disabled",r.disabled))},inputs:{tabindex:"tabindex",disabled:"disabled"}})}}return n})(),s2=(()=>{class n{constructor(){this.item=w(um)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ne({type:n,selectors:[["button","ngbDropdownItem",""]],hostVars:1,hostBindings:function(i,r){2&i&&Hi("disabled",r.item.disabled)}})}}return n})(),jE=(()=>{class n{constructor(){this.dropdown=w(fm),this.nativeElement=w(lt).nativeElement}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ne({type:n,selectors:[["","ngbDropdownMenu",""]],contentQueries:function(i,r,s){if(1&i&&gn(s,um,4),2&i){let o;gt(o=mt())&&(r.menuItems=o)}},hostAttrs:[1,"dropdown-menu"],hostVars:2,hostBindings:function(i,r){1&i&&j("keydown.ArrowUp",function(o){return r.dropdown.onKeyDown(o)})("keydown.ArrowDown",function(o){return r.dropdown.onKeyDown(o)})("keydown.Home",function(o){return r.dropdown.onKeyDown(o)})("keydown.End",function(o){return r.dropdown.onKeyDown(o)})("keydown.Enter",function(o){return r.dropdown.onKeyDown(o)})("keydown.Space",function(o){return r.dropdown.onKeyDown(o)})("keydown.Tab",function(o){return r.dropdown.onKeyDown(o)})("keydown.Shift.Tab",function(o){return r.dropdown.onKeyDown(o)}),2&i&&Pe("show",r.dropdown.isOpen())}})}}return n})(),dm=(()=>{class n{constructor(){this.dropdown=w(fm),this.nativeElement=w(lt).nativeElement}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ne({type:n,selectors:[["","ngbDropdownAnchor",""]],hostAttrs:[1,"dropdown-toggle"],hostVars:3,hostBindings:function(i,r){2&i&&(Et("aria-expanded",r.dropdown.isOpen()),Pe("show",r.dropdown.isOpen()))}})}}return n})(),o2=(()=>{class n extends dm{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=xt(n)))(r||n)}})()}static{this.\u0275dir=ne({type:n,selectors:[["","ngbDropdownToggle",""]],hostAttrs:[1,"dropdown-toggle"],hostVars:3,hostBindings:function(i,r){1&i&&j("click",function(){return r.dropdown.toggle()})("keydown.ArrowUp",function(o){return r.dropdown.onKeyDown(o)})("keydown.ArrowDown",function(o){return r.dropdown.onKeyDown(o)})("keydown.Home",function(o){return r.dropdown.onKeyDown(o)})("keydown.End",function(o){return r.dropdown.onKeyDown(o)})("keydown.Tab",function(o){return r.dropdown.onKeyDown(o)})("keydown.Shift.Tab",function(o){return r.dropdown.onKeyDown(o)}),2&i&&(Et("aria-expanded",r.dropdown.isOpen()),Pe("show",r.dropdown.isOpen()))},features:[St([{provide:dm,useExisting:it(()=>n)}]),Je]})}}return n})(),fm=(()=>{class n{constructor(){this._changeDetector=w(zi),this._config=w(voe),this._document=w(rn),this._injector=w(ht),this._ngZone=w($e),this._nativeElement=w(lt).nativeElement,this._destroyCloseHandlers$=new ke,this._bodyContainer=null,this._positioning=function WF(){const n=w(Kse);let t=null;return{createPopper(e){if(!t){let r=(e.updatePopperOptions||zF)(GF(e,n));t=Hie(e.hostElement,e.targetElement,r)}},update(){t&&t.update()},setOptions(e){if(t){let r=(e.updatePopperOptions||zF)(GF(e,n));t.setOptions(r)}},destroy(){t&&(t.destroy(),t=null)}}}(),this.autoClose=this._config.autoClose,this._open=!1,this.placement=this._config.placement,this.popperOptions=this._config.popperOptions,this.container=this._config.container,this.openChange=new ve}ngOnInit(){this.display||(this.display=this._nativeElement.closest(".navbar")?"static":"dynamic")}ngAfterContentInit(){Wo({write:()=>{this._applyPlacementClasses(),this._open&&this._setCloseHandlers()}},{injector:this._injector})}ngOnChanges(e){if(e.container&&this._open&&this._applyContainer(this.container),e.placement&&!e.placement.firstChange&&(this._positioning.setOptions({hostElement:this._anchor.nativeElement,targetElement:this._bodyContainer||this._menu.nativeElement,placement:this.placement}),this._applyPlacementClasses()),e.dropdownClass){const{currentValue:i,previousValue:r}=e.dropdownClass;this._applyCustomDropdownClass(i,r)}e.autoClose&&this._open&&(this.autoClose=e.autoClose.currentValue,this._setCloseHandlers())}isOpen(){return this._open}open(){this._open||(this._open=!0,this._applyContainer(this.container),this.openChange.emit(!0),this._setCloseHandlers(),this._anchor&&(this._anchor.nativeElement.focus(),"dynamic"===this.display&&this._ngZone.runOutsideAngular(()=>{this._positioning.createPopper({hostElement:this._anchor.nativeElement,targetElement:this._bodyContainer||this._menu.nativeElement,placement:this.placement,updatePopperOptions:e=>this.popperOptions(function YF(n){return t=>(t.modifiers.push(Wie,{name:"offset",options:{offset:()=>n}}),t)}([0,2])(e))}),this._applyPlacementClasses(),this._afterRenderRef=function Yf(n,t){!t?.injector&&Lo();const e=t?.injector??w(ht);return ri("NgAfterRender"),fD(n,e,t,!1)}({write:()=>{this._positionMenu()}},{injector:this._injector})})))}_setCloseHandlers(){this._destroyCloseHandlers$.next(),$F(this._ngZone,this._document,this.autoClose,e=>{this.close(),0===e&&this._anchor.nativeElement.focus()},this._destroyCloseHandlers$,this._menu?[this._menu.nativeElement]:[],this._anchor?[this._anchor.nativeElement]:[],".dropdown-item,.dropdown-divider")}close(){this._open&&(this._open=!1,this._resetContainer(),this._positioning.destroy(),this._afterRenderRef?.destroy(),this._destroyCloseHandlers$.next(),this.openChange.emit(!1),this._changeDetector.markForCheck())}toggle(){this.isOpen()?this.close():this.open()}ngOnDestroy(){this.close()}onKeyDown(e){const{key:i}=e,r=this._getMenuElements();let s=-1,o=null;const a=this._isEventFromToggle(e);if(!a&&r.length&&r.forEach((l,c)=>{l.contains(e.target)&&(o=l),l===CF(this._document)&&(s=c)})," "!==i&&"Enter"!==i){if("Tab"!==i){if(a||o){if(this.open(),r.length){switch(i){case"ArrowDown":s=Math.min(s+1,r.length-1);break;case"ArrowUp":if(this._isDropup()&&-1===s){s=r.length-1;break}s=Math.max(s-1,0);break;case"Home":s=0;break;case"End":s=r.length-1}r[s].focus()}e.preventDefault()}}else if(e.target&&this.isOpen()&&this.autoClose){if(this._anchor.nativeElement===e.target)return void("body"!==this.container||e.shiftKey?e.shiftKey&&this.close():(this._menu.nativeElement.setAttribute("tabindex","0"),this._menu.nativeElement.focus(),this._menu.nativeElement.removeAttribute("tabindex")));if("body"===this.container){const l=this._menu.nativeElement.querySelectorAll(VF);e.shiftKey&&e.target===l[0]?(this._anchor.nativeElement.focus(),e.preventDefault()):!e.shiftKey&&e.target===l[l.length-1]&&(this._anchor.nativeElement.focus(),this.close())}else kn(e.target,"focusout").pipe(Qi(1)).subscribe(({relatedTarget:l})=>{this._nativeElement.contains(l)||this.close()})}}else o&&(!0===this.autoClose||"inside"===this.autoClose)&&kn(o,"click").pipe(Qi(1)).subscribe(()=>this.close())}_isDropup(){return this._nativeElement.classList.contains("dropup")}_isEventFromToggle(e){return this._anchor.nativeElement.contains(e.target)}_getMenuElements(){return this._menu?this._menu.menuItems.filter(({disabled:e})=>!e).map(({nativeElement:e})=>e):[]}_positionMenu(){const e=this._menu;this.isOpen()&&e&&("dynamic"===this.display?(this._positioning.update(),this._applyPlacementClasses()):this._applyPlacementClasses(this._getFirstPlacement(this.placement)))}_getFirstPlacement(e){return Array.isArray(e)?e[0]:e.split(" ")[0]}_resetContainer(){this._menu&&this._nativeElement.appendChild(this._menu.nativeElement),this._bodyContainer&&(this._document.body.removeChild(this._bodyContainer),this._bodyContainer=null)}_applyContainer(e=null){if(this._resetContainer(),"body"===e){const i=this._menu.nativeElement,r=this._bodyContainer=this._bodyContainer||this._document.createElement("div");r.style.position="absolute",i.style.position="static",r.style.zIndex="1055",r.appendChild(i),this._document.body.appendChild(r)}this._applyCustomDropdownClass(this.dropdownClass)}_applyCustomDropdownClass(e,i){const r="body"===this.container?this._bodyContainer:this._nativeElement;r&&(i&&r.classList.remove(i),e&&r.classList.add(e))}_applyPlacementClasses(e){if(this._menu){e||(e=this._getFirstPlacement(this.placement)),this._nativeElement.classList.remove("dropup","dropdown"),"static"===this.display?this._menu.nativeElement.setAttribute("data-bs-popper","static"):this._menu.nativeElement.removeAttribute("data-bs-popper");const i=-1!==e.search("^top")?"dropup":"dropdown";this._nativeElement.classList.add(i),this._bodyContainer&&(this._bodyContainer.classList.remove("dropup","dropdown"),this._bodyContainer.classList.add(i))}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ne({type:n,selectors:[["","ngbDropdown",""]],contentQueries:function(i,r,s){if(1&i&&(gn(s,jE,5),gn(s,dm,5)),2&i){let o;gt(o=mt())&&(r._menu=o.first),gt(o=mt())&&(r._anchor=o.first)}},hostVars:2,hostBindings:function(i,r){2&i&&Pe("show",r.isOpen())},inputs:{autoClose:"autoClose",dropdownClass:"dropdownClass",_open:[0,"open","_open"],placement:"placement",popperOptions:"popperOptions",container:"container",display:"display"},outputs:{openChange:"openChange"},exportAs:["ngbDropdown"],features:[Fn]})}}return n})(),a2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),yoe=(()=>{class n{constructor(){this._ngbConfig=w(em),this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0,this.role="dialog"}get animation(){return this._animation??this._ngbConfig.animation}set animation(e){this._animation=e}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();class Aa{constructor(t,e,i){this.nodes=t,this.viewRef=e,this.componentRef=i}}let boe=(()=>{class n{constructor(){this._document=w(rn)}hide(){const e=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,r=i.style,{overflow:s,paddingRight:o}=r;if(e>0){const a=parseFloat(window.getComputedStyle(i).paddingRight);r.paddingRight=`${a+e}px`}return r.overflow="hidden",()=>{e>0&&(r.paddingRight=o),r.overflow=s}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Eoe=(()=>{class n{constructor(){this._nativeElement=w(lt).nativeElement,this._zone=w($e),this._injector=w(ht)}ngOnInit(){Wo({mixedReadWrite:()=>rr(this._zone,this._nativeElement,(e,i)=>{i&&gc(e),e.classList.add("show")},{animation:this.animation,runningTransition:"continue"})},{injector:this._injector})}hide(){return rr(this._zone,this._nativeElement,({classList:e})=>e.remove("show"),{animation:this.animation,runningTransition:"stop"})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Rt({type:n,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(i,r){2&i&&(Tu("modal-backdrop"+(r.backdropClass?" "+r.backdropClass:"")),Pe("show",!r.animation)("fade",r.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(i,r){},encapsulation:2})}}return n})();class l2{update(t){}close(t){}dismiss(t){}}const Soe=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","role","scrollable","size","windowClass","modalDialogClass"],Toe=["animation","backdropClass"];class Doe{_applyWindowOptions(t,e){Soe.forEach(i=>{Da(e[i])&&(t[i]=e[i])})}_applyBackdropOptions(t,e){Toe.forEach(i=>{Da(e[i])&&(t[i]=e[i])})}update(t){this._applyWindowOptions(this._windowCmptRef.instance,t),this._backdropCmptRef&&this._backdropCmptRef.instance&&this._applyBackdropOptions(this._backdropCmptRef.instance,t)}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Oe(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Oe(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}constructor(t,e,i,r){this._windowCmptRef=t,this._contentRef=e,this._backdropCmptRef=i,this._beforeDismiss=r,this._closed=new ke,this._dismissed=new ke,this._hidden=new ke,t.instance.dismissEvent.subscribe(s=>{this.dismiss(s)}),this.result=new Promise((s,o)=>{this._resolve=s,this._reject=o}),this.result.then(null,()=>{})}close(t){this._windowCmptRef&&(this._closed.next(t),this._resolve(t),this._removeModalElements())}_dismiss(t){this._dismissed.next(t),this._reject(t),this._removeModalElements()}dismiss(t){if(this._windowCmptRef)if(this._beforeDismiss){const e=this._beforeDismiss();!function TF(n){return n&&n.then}(e)?!1!==e&&this._dismiss(t):e.then(i=>{!1!==i&&this._dismiss(t)},()=>{})}else this._dismiss(t)}_removeModalElements(){const t=this._windowCmptRef.instance.hide(),e=this._backdropCmptRef?this._backdropCmptRef.instance.hide():be(void 0);t.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef?.viewRef?.destroy(),this._windowCmptRef=null,this._contentRef=null}),e.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),J1(t,e).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var HE=function(n){return n[n.BACKDROP_CLICK=0]="BACKDROP_CLICK",n[n.ESC=1]="ESC",n}(HE||{});let Coe=(()=>{class n{constructor(){this._document=w(rn),this._elRef=w(lt),this._zone=w($e),this._injector=w(ht),this._closed$=new ke,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.role="dialog",this.dismissEvent=new ve,this.shown=new ke,this.hidden=new ke}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":pc(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(e){this.dismissEvent.emit(e)}ngOnInit(){this._elWithFocus=this._document.activeElement,Wo({mixedReadWrite:()=>this._show()},{injector:this._injector})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:e}=this._elRef,i={animation:this.animation,runningTransition:"stop"},o=J1(rr(this._zone,e,()=>e.classList.remove("show"),i),rr(this._zone,this._dialogEl.nativeElement,()=>{},i));return o.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),o}_show(){const e={animation:this.animation,runningTransition:"continue"};J1(rr(this._zone,this._elRef.nativeElement,(s,o)=>{o&&gc(s),s.classList.add("show")},e),rr(this._zone,this._dialogEl.nativeElement,()=>{},e)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:e}=this._elRef;this._zone.runOutsideAngular(()=>{kn(e,"keydown").pipe(Oe(this._closed$),mn(r=>"Escape"===r.key)).subscribe(r=>{this.keyboard?requestAnimationFrame(()=>{r.defaultPrevented||this._zone.run(()=>this.dismiss(HE.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;kn(this._dialogEl.nativeElement,"mousedown").pipe(Oe(this._closed$),et(()=>i=!1),Yi(()=>kn(e,"mouseup").pipe(Oe(this._closed$),Qi(1))),mn(({target:r})=>e===r)).subscribe(()=>{i=!0}),kn(e,"click").pipe(Oe(this._closed$)).subscribe(({target:r})=>{e===r&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(HE.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:e}=this._elRef;if(!e.contains(document.activeElement)){const i=e.querySelector("[ngbAutofocus]"),r=jF(e)[0];(i||r||e).focus()}}_restoreFocus(){const e=this._document.body,i=this._elWithFocus;let r;r=i&&i.focus&&e.contains(i)?i:e,this._zone.runOutsideAngular(()=>{setTimeout(()=>r.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&rr(this._zone,this._elRef.nativeElement,({classList:e})=>(e.add("modal-static"),()=>e.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Rt({type:n,selectors:[["ngb-modal-window"]],viewQuery:function(i,r){if(1&i&&Hr(Dre,7),2&i){let s;gt(s=mt())&&(r._dialogEl=s.first)}},hostAttrs:["tabindex","-1"],hostVars:8,hostBindings:function(i,r){2&i&&(Et("aria-modal",!0)("aria-labelledby",r.ariaLabelledBy)("aria-describedby",r.ariaDescribedBy)("role",r.role),Tu("modal d-block"+(r.windowClass?" "+r.windowClass:"")),Pe("fade",r.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",role:"role",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:bF,decls:4,vars:2,consts:[["dialog",""],["role","document"],[1,"modal-content"]],template:function(i,r){1&i&&(jh(),D(0,"div",1,0)(2,"div",2),Hh(3),T()()),2&i&&Tu("modal-dialog"+(r.size?" modal-"+r.size:"")+(r.centered?" modal-dialog-centered":"")+r.fullscreenClass+(r.scrollable?" modal-dialog-scrollable":"")+(r.modalDialogClass?" "+r.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2})}}return n})(),Ioe=(()=>{class n{constructor(){this._applicationRef=w(ai),this._injector=w(ht),this._environmentInjector=w(An),this._document=w(rn),this._scrollBar=w(boe),this._activeWindowCmptHasChanged=new ke,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._modalRefs=[],this._windowCmpts=[],this._activeInstances=new ve;const e=w($e);this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const i=this._windowCmpts[this._windowCmpts.length-1];((n,t,e,i=!1)=>{n.runOutsideAngular(()=>{const r=kn(t,"focusin").pipe(Oe(e),Ne(s=>s.target));kn(t,"keydown").pipe(Oe(e),mn(s=>"Tab"===s.key),eE(r)).subscribe(([s,o])=>{const[a,l]=jF(t);(o===a||o===t)&&s.shiftKey&&(l.focus(),s.preventDefault()),o===l&&!s.shiftKey&&(a.focus(),s.preventDefault())}),i&&kn(t,"click").pipe(Oe(e),eE(r),Ne(s=>s[1])).subscribe(s=>s.focus())})})(e,i.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(i.location.nativeElement)}})}_restoreScrollBar(){const e=this._scrollBarRestoreFn;e&&(this._scrollBarRestoreFn=null,e())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(e,i,r){const s=r.container instanceof HTMLElement?r.container:Da(r.container)?this._document.querySelector(r.container):this._document.body;if(!s)throw new Error(`The specified modal container "${r.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const o=new l2,a=(e=r.injector||e).get(An,null)||this._environmentInjector,l=this._getContentRef(e,a,i,o,r);let c=!1!==r.backdrop?this._attachBackdrop(s):void 0,u=this._attachWindowComponent(s,l.nodes),d=new Doe(u,l,c,r.beforeDismiss);return this._registerModalRef(d),this._registerWindowCmpt(u),d.hidden.pipe(Qi(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(this._document.body.classList.remove("modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),o.close=f=>{d.close(f)},o.dismiss=f=>{d.dismiss(f)},o.update=f=>{d.update(f)},d.update(r),1===this._modalRefs.length&&this._document.body.classList.add("modal-open"),c&&c.instance&&c.changeDetectorRef.detectChanges(),u.changeDetectorRef.detectChanges(),d}get activeInstances(){return this._activeInstances}dismissAll(e){this._modalRefs.forEach(i=>i.dismiss(e))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(e){let i=Ty(Eoe,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector});return this._applicationRef.attachView(i.hostView),e.appendChild(i.location.nativeElement),i}_attachWindowComponent(e,i){let r=Ty(Coe,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector,projectableNodes:i});return this._applicationRef.attachView(r.hostView),e.appendChild(r.location.nativeElement),r}_getContentRef(e,i,r,s,o){return r?r instanceof tn?this._createFromTemplateRef(r,s):pc(r)?this._createFromString(r):this._createFromComponent(e,i,r,s,o):new Aa([])}_createFromTemplateRef(e,i){const s=e.createEmbeddedView({$implicit:i,close(o){i.close(o)},dismiss(o){i.dismiss(o)}});return this._applicationRef.attachView(s),new Aa([s.rootNodes],s)}_createFromString(e){const i=this._document.createTextNode(`${e}`);return new Aa([[i]])}_createFromComponent(e,i,r,s,o){const l=Ty(r,{environmentInjector:i,elementInjector:ht.create({providers:[{provide:l2,useValue:s}],parent:e})}),c=l.location.nativeElement;return o.scrollable&&c.classList.add("component-host-scrollable"),this._applicationRef.attachView(l.hostView),new Aa([[c]],l.hostView,l)}_setAriaHidden(e){const i=e.parentElement;i&&e!==this._document.body&&(Array.from(i.children).forEach(r=>{r!==e&&"SCRIPT"!==r.nodeName&&(this._ariaHiddenValues.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((e,i)=>{e?i.setAttribute("aria-hidden",e):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(e){const i=()=>{const r=this._modalRefs.indexOf(e);r>-1&&(this._modalRefs.splice(r,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(e),this._activeInstances.emit(this._modalRefs),e.result.then(i,i)}_registerWindowCmpt(e){this._windowCmpts.push(e),this._activeWindowCmptHasChanged.next(),e.onDestroy(()=>{const i=this._windowCmpts.indexOf(e);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),woe=(()=>{class n{constructor(){this._injector=w(ht),this._modalStack=w(Ioe),this._config=w(yoe)}open(e,i={}){const r={...this._config,animation:this._config.animation,...i};return this._modalStack.open(this._injector,e,r)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(e){this._modalStack.dismissAll(e)}hasOpenModals(){return this._modalStack.hasOpenModals()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),c2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({providers:[woe]})}}return n})(),f2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),b2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),E2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),S2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),T2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),D2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),C2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),I2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),w2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})();new W("live announcer delay",{providedIn:"root",factory:()=>100});let x2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})(),A2=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({})}}return n})();const joe=[AF,MF,OF,NF,r2,a2,c2,f2,A2,b2,E2,S2,T2,D2,C2,I2,w2,x2];let Hoe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n})}static{this.\u0275inj=dt({imports:[joe,AF,MF,OF,NF,r2,a2,c2,f2,A2,b2,E2,S2,T2,D2,C2,I2,w2,x2]})}}return n})();const Goe=["videoEl"];function zoe(n,t){if(1&n){const e=Se();D(0,"button",15),j("click",function(){const r=X(e).$implicit;return J(A(2).changeSource(r))}),P(1),T()}if(2&n){const e=t.$implicit;E(),Ds("",e.ekydum_label,"",e.ekydum_isCurrent?"*":"","")}}function Woe(n,t){if(1&n){const e=Se();D(0,"button",15),j("click",function(){const r=X(e).$implicit;return J(A(2).changeLang(r))}),P(1),T()}if(2&n){const e=t.$implicit,i=A(2);E(),Ds("",e,"",i.selectedLanguage===e?"*":"","")}}function Koe(n,t){if(1&n){const e=Se();D(0,"button",15),j("click",function(){const r=X(e).$implicit;return J(A(3).goToChapter(r))}),P(1),T()}if(2&n){const e=t.$implicit,i=t.index;E(),Ds("",i+1,". ",e.title,"")}}function qoe(n,t){if(1&n&&(D(0,"div",16)(1,"div",11)(2,"button",17),P(3),T(),D(4,"div",18),Y(5,Koe,2,2,"button",9),T()()()),2&n){const e=A(2);E(3),Le(e.i18nStrings.chapters),E(2),R("ngForOf",e.video.chapters)}}function Yoe(n,t){if(1&n&&(D(0,"div",4)(1,"div",5)(2,"div",6)(3,"button",7),P(4),T(),D(5,"div",8),Y(6,zoe,2,2,"button",9),T()()(),D(7,"div",10)(8,"div",11)(9,"button",12),P(10),T(),D(11,"div",13),Y(12,Woe,2,2,"button",9),T()()(),Y(13,qoe,6,2,"div",14),T()),2&n){const e=A();E(4),Le((null==e.selectedFormat?null:e.selectedFormat.ekydum_label)||"-"),E(2),R("ngForOf",e.localizedFormats),E(4),Le(e.selectedLanguage),E(2),R("ngForOf",e.availableLanguages),E(),R("ngIf",null==e.video||null==e.video.chapters?null:e.video.chapters.length)}}let Qoe=(()=>{class n{get player(){return this.videoElementRef.nativeElement}constructor(e,i,r){this.auth=e,this.cdr=i,this.i18nService=r,this.showCustomControls=!0,this.i18nDict=qi_player,this.i18nStrings={},this.FALLBACK_CONTENT_LANG="en",this.PREF_AUTOPLAY=!0,this.PREF_DEFAULT_QUALITY="max",this.PREF_DEFAULT_CONTENT_LANG="en",this.CAP_HAS_NATIVE_HLS_SUPPORT=!1,this.CAP_HAS_HLS_PLAYER_SUPPORT=!1,this.posterUrl="",this.availableLanguages=[],this.selectedLanguage="en",this.combinedFormats=[],this.localizedFormats=[],this.selectedFormat=null,this.sourceManifestUrl="",this.isFirstLoad=!0,this.qssStrategyMax=!0,this.qssStrategyMin=!1,this.qssStrategyClosest=720,this.qssAvoidNonHls=!0,this.hlsPlayerOptions={debug:!1,enableWorker:!0},this.alive$=new ke,this.render$=new ke,this.SERVER_URL=this.auth.getServerUrl()||"http://localhost:3000"}ngAfterViewInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(e=>{this.i18nStrings=e,this.render$.next()})).subscribe(),this.discoverRuntimeCapabilities(),this.setupRenderer(),this.preferences&&this.applyPreferences(),this.video&&(this.posterUrl=this.video?.thumbnail||"",this.parseFormats(),this.setSelectedSource(this.getDefaultSourceToPlay()),this.CAP_HAS_HLS_PLAYER_SUPPORT&&this.initHlsPlayer(),this.loadSelectedSource()),this.render$.next()}ngOnDestroy(){this.alive$.next(),this.alive$.complete(),this.hls&&this.hls.destroy()}play(){this.player.play().catch(e=>{console.error("Playback Error:",e)})}pause(){this.player.pause()}goToChapter(e){this.player.currentTime=e.start_time,this.render$.next()}changeSource(e){e&&(this.setSelectedSource(e),this.loadSelectedSource())}changeLang(e){this.selectedLanguage=e,this.localizedFormats=this.getLocalizedFormats(this.combinedFormats),this.changeSource(this.getDefaultSourceToPlay())}setSelectedSource(e){e&&(e.ekydum_isCurrent=!0,this.localizedFormats.forEach(i=>{e.format_id===i.format_id?i.ekydum_isCurrent||(i.ekydum_isCurrent=!0):i.ekydum_isCurrent&&(i.ekydum_isCurrent=!1)}),this.selectedFormat=e)}loadSelectedSource(){var e=this.selectedFormat;if(e){this.sourceManifestUrl=this.getProxiedManifestUrl(e.url);var i=this.capturePlayerState();this.hls?(this.hls.loadSource(this.sourceManifestUrl),this.hls.once(sc.Events.MANIFEST_PARSED,()=>{console.log("Manifest loaded"),i.restore()})):this.CAP_HAS_NATIVE_HLS_SUPPORT&&(this.player.src=this.sourceManifestUrl,i.restore()),e.language&&(!this.selectedLanguage||!e.language.startsWith(this.selectedLanguage))&&(this.selectedLanguage=e.language),this.render$.next()}}applyPreferences(){var e=this.preferences;if(Array.isArray(e)){var i=e.find(a=>"DEFAULT_QUALITY"===a.key);if(i)if(this.PREF_DEFAULT_QUALITY=i.value,"max"===this.PREF_DEFAULT_QUALITY)this.qssStrategyMax=!0,this.qssStrategyMin=!1;else if("min"===this.PREF_DEFAULT_QUALITY)this.qssStrategyMax=!1,this.qssStrategyMin=!0;else if(/^\d+p$/.test(this.PREF_DEFAULT_QUALITY+"")){var r=~~+this.PREF_DEFAULT_QUALITY.replace("p","");r>100&&r<1e5&&(this.qssStrategyMax=!1,this.qssStrategyMin=!1,this.qssStrategyClosest=r)}var s=e.find(a=>"LANG"===a.key);s&&(this.PREF_DEFAULT_CONTENT_LANG=(s.value+"").toLowerCase(),this.selectedLanguage=this.PREF_DEFAULT_CONTENT_LANG);var o=e.find(a=>"AUTO_PLAY"===a.key);o&&(this.PREF_AUTOPLAY=!!+o.value)}}initHlsPlayer(){this.hls=new sc(this.hlsPlayerOptions),this.hls.attachMedia(this.player),this.hls.on(sc.Events.ERROR,(e,i)=>this.handleHlsError(i))}parseFormats(){var e=this.video.formats;this.availableLanguages=this.extractAvailableLanguages(e),this.combinedFormats=this.sortFormatsByHeight(this.getCombinedFormats(e)),this.localizedFormats=this.getLocalizedFormats(this.combinedFormats)}getDefaultSourceToPlay(){var e=this.localizedFormats;return this.qssStrategyMax&&this.qssGetMaxQuality(e)||this.qssStrategyMin&&this.qssGetMinQuality(e)||this.qssStrategyClosest&&this.qssGetClosestQuality(e,this.qssStrategyClosest)||e[0]}extractAvailableLanguages(e){return Array.from(new Set(e.map(i=>i.language).filter(i=>!!i)))}getCombinedFormats(e){return e.filter(i=>i.vcodec&&"none"!==i.vcodec&&i.acodec&&"none"!==i.acodec).map(i=>{var r=(i?.protocol||"")+"",s=r.includes("m3u8"),o=i.height+"p"+(s?" HLS":" "+r.toUpperCase());return Object.assign({},i,{ekydum_sourceKind:qP.COMBINED,ekydum_isCurrent:!1,ekydum_isHls:s,ekydum_label:o})})}sortFormatsByHeight(e){return e.sort((i,r)=>(r.height||0)-(i.height||0))}getLocalizedFormats(e){var i=this.selectedLanguage,r=this.FALLBACK_CONTENT_LANG,s=e.filter(o=>o.language===i);return 0===s.length&&r!==i&&(s=e.filter(o=>o.language===r)),0===s.length&&(s=e),s}getProxiedManifestUrl(e){return`${this.SERVER_URL}/hls/m3u8?url=${encodeURIComponent(e)}&token=${this.auth.getAccountToken()}`}capturePlayerState(){var e=this.player;return{currentTime:e.currentTime,wasPlaying:!e.paused,self:this,restore(){e.currentTime=this.currentTime;var i=this.self;i.isFirstLoad?(i.isFirstLoad=!1,i.PREF_AUTOPLAY&&i.play()):this.wasPlaying&&i.play()}}}handleHlsError(e){if(e.fatal){var i=e.type;i===sc.ErrorTypes.NETWORK_ERROR?(console.log("Network error, trying to recover..."),this.hls.startLoad()):i===sc.ErrorTypes.MEDIA_ERROR?(console.log("Media error, trying to recover..."),this.hls.recoverMediaError()):(console.log("Fatal error, destroying player..."),this.hls.destroy()),this.render$.next()}}discoverRuntimeCapabilities(){this.CAP_HAS_NATIVE_HLS_SUPPORT=!!this.player.canPlayType("application/vnd.apple.mpegurl"),this.CAP_HAS_HLS_PLAYER_SUPPORT=sc.isSupported()}setupRenderer(){this.render$.pipe(Oe(this.alive$),function bte(n,t=Z1,e){const i=X1(n,t);return function vte(n,t){return Qt((e,i)=>{const{leading:r=!0,trailing:s=!1}=t??{};let o=!1,a=null,l=null,c=!1;const u=()=>{l?.unsubscribe(),l=null,s&&(h(),c&&i.complete())},d=()=>{l=null,c&&i.complete()},f=p=>l=Dn(n(p)).subscribe(yt(i,u,d)),h=()=>{if(o){o=!1;const p=a;a=null,i.next(p),!c&&f(p)}};e.subscribe(yt(i,p=>{o=!0,a=p,(!l||l.closed)&&(r?h():f(p))},()=>{c=!0,(!(s&&o&&l)||l.closed)&&i.complete()}))})}(()=>i,e)}(100),et(()=>this.cdr.detectChanges())).subscribe()}qssGetMaxQuality(e){var i=0,r=null,s=this.qssAvoidNonHls;return e.forEach(o=>{(!s||o.ekydum_isHls)&&o.height&&o.height>i&&(i=o.height,r=o)}),r}qssGetMinQuality(e){var i=Number.MAX_SAFE_INTEGER,r=null,s=this.qssAvoidNonHls;return e.forEach(o=>{(!s||o.ekydum_isHls)&&o.height&&o.height<i&&(i=o.height,r=o)}),r}qssGetClosestQuality(e,i){var r=Number.MAX_SAFE_INTEGER,s=null,o=this.qssAvoidNonHls;return e.forEach(a=>{if((!o||a.ekydum_isHls)&&a.height){var l=Math.abs(a.height-i);l<r&&(r=l,s=a)}}),s}static{this.\u0275fac=function(i){return new(i||n)(F(ud),F(zi),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-ekydum-player"]],viewQuery:function(i,r){if(1&i&&Hr(Goe,5),2&i){let s;gt(s=mt())&&(r.videoElementRef=s.first)}},inputs:{video:"video",preferences:"preferences",showCustomControls:"showCustomControls"},standalone:!1,decls:4,vars:2,consts:[["videoEl",""],["data-bs-theme","dark",1,"player-container"],["controls","",1,"video-element",3,"poster"],["class","controls d-flex",4,"ngIf"],[1,"controls","d-flex"],[1,"control-item","quality-select"],["ngbDropdown","","placement","top-start",1,"d-inline-block"],["type","button","id","ctrlQuality","ngbDropdownToggle","",1,"btn","btn-sm","btn-outline-secondary"],["ngbDropdownMenu","","aria-labelledby","ctrlQuality",1,"multi-column-dropdown"],["ngbDropdownItem","",3,"click",4,"ngFor","ngForOf"],[1,"control-item","source-language-select"],["ngbDropdown","","display","dynamic","placement","top-start",1,"d-inline-block"],["type","button","id","ctrlLang","ngbDropdownToggle","",1,"btn","btn-sm","btn-outline-secondary"],["ngbDropdownMenu","","aria-labelledby","ctrlLang",1,"multi-column-dropdown"],["class","control-item chapters",4,"ngIf"],["ngbDropdownItem","",3,"click"],[1,"control-item","chapters"],["type","button","id","ctrlChapters","ngbDropdownToggle","",1,"btn","btn-sm","btn-outline-secondary"],["ngbDropdownMenu","","aria-labelledby","ctrlChapters",1,"multi-column-dropdown",2,"columns","2"]],template:function(i,r){1&i&&(D(0,"div",1),U(1,"video",2,0),Y(3,Yoe,14,5,"div",3),T()),2&i&&(E(),R("poster",r.posterUrl,cl),E(2),R("ngIf",r.showCustomControls))},dependencies:[vr,ci,fm,o2,jE,um,s2],styles:[".player-container[_ngcontent-%COMP%]{width:100%;background:#000}.player-container[_ngcontent-%COMP%]   .video-element[_ngcontent-%COMP%]{width:100%;aspect-ratio:16/9;background:#000}.player-container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:.6rem 1rem 1rem}.player-container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .multi-column-dropdown[_ngcontent-%COMP%]{columns:3;column-gap:1rem;max-height:600px;overflow-y:auto}.player-container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .multi-column-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{break-inside:avoid;page-break-inside:avoid}"],changeDetection:0})}}return n})();function Zoe(n,t){if(1&n){const e=Se();D(0,"button",7),j("click",function(){return X(e),J(A().clearQueue())}),U(1,"i",8),T()}2&n&&R("title",A().i18nStrings.btnClearQueue)}function Xoe(n,t){1&n&&(D(0,"div",22),U(1,"i",23),T())}function Joe(n,t){if(1&n&&U(0,"img",24),2&n){const e=A().$implicit;R("src",e.thumbnail,cl)("alt",e.title)}}function eae(n,t){if(1&n&&(D(0,"div",25),P(1),T()),2&n){const e=A().index;E(),Le(e+1)}}function tae(n,t){if(1&n&&(D(0,"div",26),U(1,"i",27),P(2),T()),2&n){const e=A().$implicit;E(2),de("",e.channel_name," ")}}function nae(n,t){if(1&n&&(D(0,"div",28),P(1),T()),2&n){const e=A().$implicit,i=A(2);E(),de(" ",i.formatDuration(e.duration)," ")}}function iae(n,t){if(1&n){const e=Se();D(0,"button",29),j("click",function(r){X(e);const s=A().$implicit;return J(A(2).removeFromQueue(r,s.yt_video_id))}),U(1,"i",30),T()}2&n&&R("title",A(3).i18nStrings.btnRemove)}function rae(n,t){if(1&n){const e=Se();D(0,"div",11),j("click",function(){const r=X(e).index;return J(A(2).playAt(r))}),Y(1,Xoe,2,0,"div",12),D(2,"div",13)(3,"div",14),Y(4,Joe,1,2,"img",15)(5,eae,2,1,"div",16),T(),D(6,"div",17)(7,"div",18),P(8),T(),Y(9,tae,3,1,"div",19)(10,nae,2,1,"div",20),T(),Y(11,iae,2,1,"button",21),T()()}if(2&n){const e=t.$implicit,i=t.index,r=A(2);Pe("active",i===r.currentIndex),E(),R("ngIf",i===r.currentIndex),E(3),R("ngIf",e.thumbnail),E(),R("ngIf",i!==r.currentIndex),E(3),Le(e.title),E(),R("ngIf",e.channel_name),E(),R("ngIf",e.duration),E(),R("ngIf",i!==r.currentIndex)}}function sae(n,t){if(1&n&&(D(0,"div",9),Y(1,rae,12,9,"div",10),T()),2&n){const e=A();E(),R("ngForOf",e.queue)}}function oae(n,t){if(1&n&&(D(0,"div",31),U(1,"i",32),D(2,"p",33),P(3),T(),D(4,"small",34),P(5),T()()),2&n){const e=A();E(3),Le(e.i18nStrings.queueEmpty),E(2),Le(e.i18nStrings.queueEmptyHint)}}let aae=(()=>{class n{constructor(e,i,r){this.playerService=e,this.router=i,this.i18nService=r,this.i18nDict=qi_player,this.i18nStrings={},this.destroy$=new ke,this.queue=[],this.currentIndex=-1}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.destroy$),et(e=>{this.i18nStrings=e})).subscribe(),this.playerService.queue$.pipe(Oe(this.destroy$)).subscribe(e=>{this.queue=e}),this.playerService.currentIndex$.pipe(Oe(this.destroy$)).subscribe(e=>{this.currentIndex=e})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}playAt(e){this.playerService.playVideoAtIndex(e)}removeFromQueue(e,i){e.stopPropagation(),this.playerService.queueRemove(i)}clearQueue(){confirm(this.i18nStrings.confirmClearQueue||"Clear all videos from queue?")&&this.playerService.queueClear()}formatDuration(e){if(!e)return"";var i=Math.floor(e/3600),r=Math.floor(e%3600/60),s=Math.floor(e%60);return i>0?`${i}:${r.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${r}:${s.toString().padStart(2,"0")}`}static{this.\u0275fac=function(i){return new(i||n)(F(lo),F(Yn),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-queue-sidebar"]],standalone:!1,decls:10,vars:5,consts:[[1,"queue-sidebar","glass-effect"],[1,"queue-header"],[1,"fas","fa-list","me-2"],[1,"badge","bg-secondary","ms-2"],["class","btn btn-sm btn-outline-danger",3,"title","click",4,"ngIf"],["class","queue-list",4,"ngIf"],["class","queue-empty",4,"ngIf"],[1,"btn","btn-sm","btn-outline-danger",3,"click","title"],[1,"fas","fa-trash"],[1,"queue-list"],["class","queue-item-wrapper",3,"active","click",4,"ngFor","ngForOf"],[1,"queue-item-wrapper",3,"click"],["class","current-indicator",4,"ngIf"],[1,"queue-item-content"],[1,"queue-thumbnail"],[3,"src","alt",4,"ngIf"],["class","queue-number",4,"ngIf"],[1,"queue-info"],[1,"queue-title"],["class","queue-channel",4,"ngIf"],["class","queue-duration",4,"ngIf"],["class","btn btn-sm queue-item-remove",3,"title","click",4,"ngIf"],[1,"current-indicator"],[1,"fas","fa-caret-right"],[3,"src","alt"],[1,"queue-number"],[1,"queue-channel"],[1,"fas","fa-user","me-1"],[1,"queue-duration"],[1,"btn","btn-sm","queue-item-remove",3,"click","title"],[1,"fas","fa-times"],[1,"queue-empty"],[1,"fas","fa-list-ul","mb-3"],[1,"mb-1"],[1,"text-muted"]],template:function(i,r){1&i&&(D(0,"div",0)(1,"div",1)(2,"h5"),U(3,"i",2),P(4),D(5,"span",3),P(6),T()(),Y(7,Zoe,2,1,"button",4),T(),Y(8,sae,2,1,"div",5)(9,oae,6,2,"div",6),T()),2&i&&(E(4),de(" ",r.i18nStrings.queueTitle," "),E(2),Le(r.queue.length),E(),R("ngIf",r.queue.length>0),E(),R("ngIf",r.queue.length>0),E(),R("ngIf",0===r.queue.length))},dependencies:[vr,ci],styles:[".queue-sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;color:#fff}.glass-effect[_ngcontent-%COMP%]{background:#1a1a1acc;backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%)}.queue-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px;border-bottom:1px solid rgba(255,255,255,.05);background:#0f0f0f80;backdrop-filter:blur(10px)}.queue-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;display:flex;align-items:center;text-shadow:0 2px 4px rgba(0,0,0,.3)}.queue-header[_ngcontent-%COMP%]   .btn-outline-danger[_ngcontent-%COMP%]{border-color:#dc35454d;color:#dc3545;background:#dc35451a;backdrop-filter:blur(10px);transition:all .2s cubic-bezier(.4,0,.2,1)}.queue-header[_ngcontent-%COMP%]   .btn-outline-danger[_ngcontent-%COMP%]:hover{background:#dc354533;border-color:#dc354580;transform:translateY(-2px);box-shadow:0 4px 12px #dc35454d}.queue-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px}.queue-item-wrapper[_ngcontent-%COMP%]{margin-bottom:8px;border-radius:8px;overflow:hidden;transition:all .2s cubic-bezier(.4,0,.2,1);background:#ffffff08;border:1px solid rgba(255,255,255,.05);cursor:pointer;position:relative}.queue-item-wrapper[_ngcontent-%COMP%]:hover{background:#ffffff14;border-color:#ffffff1a;transform:translate(4px);box-shadow:0 4px 12px #0000004d}.queue-item-wrapper.active[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);box-shadow:0 0 20px #0d6efd33}.current-indicator[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;display:flex;align-items:center;justify-content:center;width:32px;background:#0d6efd4d;border-right:2px solid rgba(13,110,253,.6);backdrop-filter:blur(10px);z-index:5}.current-indicator[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:#fff;text-shadow:0 2px 8px rgba(13,110,253,.8);animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{text-shadow:0 2px 8px rgba(13,110,253,.8)}50%{text-shadow:0 4px 16px rgba(13,110,253,1)}}.queue-item-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px;position:relative}.queue-item-wrapper.active[_ngcontent-%COMP%]   .queue-item-content[_ngcontent-%COMP%]{padding-left:40px}.queue-thumbnail[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;flex-shrink:0;border-radius:6px;overflow:hidden;background:#2a2a2a}.queue-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.queue-number[_ngcontent-%COMP%]{position:absolute;top:4px;left:4px;background:#000c;backdrop-filter:blur(10px);padding:4px 8px;border-radius:6px;font-size:12px;font-weight:600;color:#fff;box-shadow:0 2px 8px #0000004d}.queue-info[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:4px}.queue-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;color:#fff}.queue-channel[_ngcontent-%COMP%]{font-size:12px;color:#fff9;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.queue-duration[_ngcontent-%COMP%]{font-size:11px;color:#ffffff80}.queue-item-remove[_ngcontent-%COMP%]{opacity:0;transition:opacity .2s;background:#dc3545e6;backdrop-filter:blur(10px);border:none;color:#fff;padding:4px 8px;border-radius:6px;box-shadow:0 2px 8px #0000004d;align-self:flex-start;margin-top:4px}.queue-item-wrapper[_ngcontent-%COMP%]:hover   .queue-item-remove[_ngcontent-%COMP%]{opacity:1}.queue-item-remove[_ngcontent-%COMP%]:hover{background:#dc3545;transform:scale(1.1)}.queue-empty[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;color:#fff6;text-align:center}.queue-empty[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:64px;opacity:.2;margin-bottom:16px}.queue-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600}.queue-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.queue-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff05;border-radius:4px}.queue-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ffffff26;border-radius:4px;backdrop-filter:blur(10px)}.queue-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ffffff40}"]})}}return n})();const lae=["ekydumPlayer"];function cae(n,t){if(1&n){const e=Se();D(0,"div",24),j("click",function(){return X(e),J(A(2).close())}),T()}}function uae(n,t){if(1&n){const e=Se();D(0,"button",16),j("click",function(){return X(e),J(A(2).toggleQueue())}),U(1,"i",25),T()}if(2&n){const e=A(2);Pe("active",e.showQueue),R("title",e.i18nStrings.btnToggleQueue)}}function dae(n,t){if(1&n){const e=Se();D(0,"button",16),j("click",function(){return X(e),J(A(2).minimize())}),U(1,"i",26),T()}2&n&&R("title",A(2).i18nStrings.btnMinimize)}function fae(n,t){if(1&n){const e=Se();D(0,"button",16),j("click",function(){return X(e),J(A(2).hide())}),U(1,"i",27),T()}2&n&&R("title",A(2).i18nStrings.btnHideToSidebar)}function hae(n,t){if(1&n){const e=Se();D(0,"button",16),j("click",function(){return X(e),J(A(2).restore())}),U(1,"i",28),T()}2&n&&R("title",A(2).i18nStrings.btnRestore)}function pae(n,t){if(1&n&&U(0,"app-ekydum-player",29,0),2&n){const e=A(2);R("video",e.videoInfo)("preferences",e.preferences)("showCustomControls","floating"===e.displayMode)}}function gae(n,t){if(1&n&&(D(0,"p",33),P(1),T()),2&n){const e=A(3);E(),Le(e.i18nStrings.loadingVideo)}}function mae(n,t){if(1&n&&(D(0,"div",30),U(1,"div",31),Y(2,gae,2,1,"p",32),T()),2&n){const e=A(2);E(2),R("ngIf","floating"===e.displayMode)}}function _ae(n,t){1&n&&(D(0,"div",34),U(1,"app-queue-sidebar"),T())}function vae(n,t){if(1&n){const e=Se();D(0,"div",2),Y(1,cae,1,0,"div",3),D(2,"div",4),j("click",function(r){return X(e),J(r.stopPropagation())}),D(3,"div",5)(4,"div",6),P(5),T(),D(6,"div",7)(7,"button",8),j("click",function(){return X(e),J(A().previous())}),U(8,"i",9),T(),D(9,"button",10),j("click",function(){return X(e),J(A().togglePlayPause())}),U(10,"i",11),T(),D(11,"button",8),j("click",function(){return X(e),J(A().next())}),U(12,"i",12),T()(),D(13,"div",13),Y(14,uae,2,3,"button",14)(15,dae,2,1,"button",15)(16,fae,2,1,"button",15)(17,hae,2,1,"button",15),D(18,"button",16),j("click",function(){return X(e),J(A().close())}),U(19,"i",17),T()()(),D(20,"div",18)(21,"div",19)(22,"div",20),Y(23,pae,2,3,"app-ekydum-player",21),T(),Y(24,mae,3,1,"div",22),T(),Y(25,_ae,2,0,"div",23),T()()()}if(2&n){const e=A();Pe("mode-floating","floating"===e.displayMode)("mode-minimized","minimized"===e.displayMode)("mode-hidden","hidden"===e.displayMode)("with-queue",e.showQueue&&"floating"===e.displayMode),E(),R("ngIf","floating"===e.displayMode),E(4),de(" ",(null==e.currentVideo?null:e.currentVideo.title)||e.i18nStrings.nowPlaying," "),E(2),R("disabled",!e.hasPrevious)("title",e.i18nStrings.btnPrevious),E(2),R("title",e.isPlaying?e.i18nStrings.btnPause:e.i18nStrings.btnPlay),E(),Pe("fa-pause",e.isPlaying)("fa-play",!e.isPlaying),E(),R("disabled",!e.hasNext)("title",e.i18nStrings.btnNext),E(3),R("ngIf","floating"===e.displayMode&&e.queueLength>1),E(),R("ngIf","floating"===e.displayMode),E(),R("ngIf","minimized"===e.displayMode),E(),R("ngIf","minimized"===e.displayMode),E(),R("title",e.i18nStrings.btnClose),E(5),R("ngIf",e.videoInfo),E(),R("ngIf",e.loading),E(),R("ngIf",e.showQueue&&"floating"===e.displayMode)}}let yae=(()=>{class n{constructor(e,i,r){this.playerService=e,this.api=i,this.i18nService=r,this.i18nDict=qi_player,this.i18nStrings={},this.destroy$=new ke,this.displayMode=Bn.MODE_INACTIVE,this.currentVideo=null,this.videoInfo=null,this.preferences=[],this.loading=!1,this.showQueue=!1,this.isPlaying=!1,this.hasNext=!1,this.hasPrevious=!1,this.queueLength=0,this.currentVideoId=""}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.destroy$),et(e=>{this.i18nStrings=e})).subscribe(),this.playerService.displayMode$.pipe(Oe(this.destroy$)).subscribe(e=>{this.displayMode=e}),this.playerService.currentVideo$.pipe(Oe(this.destroy$)).subscribe(e=>{this.currentVideo=e,e&&e.yt_video_id!==this.currentVideoId&&(this.currentVideoId=e.yt_video_id,this.loadingSubscription&&this.loadingSubscription.unsubscribe(),this.loadVideoInfo(this.currentVideoId))}),this.playerService.isPlaying$.pipe(Oe(this.destroy$)).subscribe(e=>{this.isPlaying=e,this.ekydumPlayer?.player&&(e&&this.ekydumPlayer.player.paused?this.ekydumPlayer.play():!e&&!this.ekydumPlayer.player.paused&&this.ekydumPlayer.pause())}),this.playerService.queue$.pipe(Oe(this.destroy$)).subscribe(e=>{this.queueLength=e.length,this.hasNext=this.playerService.hasNext,this.hasPrevious=this.playerService.hasPrevious,this.showQueue=!(e.length<=1)}),this.playerService.currentIndex$.pipe(Oe(this.destroy$)).subscribe(()=>{this.hasNext=this.playerService.hasNext,this.hasPrevious=this.playerService.hasPrevious}),this.loadPreferences(),this.setupPlayerEvents()}ngOnDestroy(){this.loadingSubscription&&this.loadingSubscription.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}toggleQueue(){this.showQueue=!this.showQueue}minimize(){this.playerService.uiMinimize()}restore(){this.playerService.uiMaximize()}hide(){this.playerService.uiHide()}close(){this.playerService.stop()}togglePlayPause(){this.isPlaying?(this.playerService.pause(),this.ekydumPlayer?.player&&this.ekydumPlayer.pause()):(this.playerService.play(),this.ekydumPlayer?.player&&this.ekydumPlayer.play())}next(){this.playerService.next()}previous(){this.playerService.previous()}loadVideoInfo(e){this.loading=!0,this.videoInfo=null,this.loadingSubscription=this.api.getVideo(e).subscribe({next:i=>{e===this.currentVideoId&&(this.videoInfo=i,this.loading=!1,setTimeout(()=>{this.ekydumPlayer&&this.playerService.isPlaying&&this.ekydumPlayer.play()},100))},error:()=>{e===this.currentVideoId&&(this.loading=!1)}})}loadPreferences(){this.api.getSettings().subscribe({next:e=>{this.preferences=e?.settings||[]},error:()=>{this.preferences=[]}})}setupPlayerEvents(){setInterval(()=>{if(this.ekydumPlayer?.player){var e=this.ekydumPlayer.player;e.paused||this.playerService.updateTime(e.currentTime,e.duration),e.ended&&this.playerService.onVideoEnded();var i=!e.paused;i!==this.isPlaying&&(i?this.playerService.play():this.playerService.pause())}},500)}static{this.\u0275fac=function(i){return new(i||n)(F(lo),F(Kr),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-floating-player-modal"]],viewQuery:function(i,r){if(1&i&&Hr(lae,5),2&i){let s;gt(s=mt())&&(r.ekydumPlayer=s.first)}},standalone:!1,decls:1,vars:1,consts:[["ekydumPlayer",""],["class","player-container",3,"mode-floating","mode-minimized","mode-hidden","with-queue",4,"ngIf"],[1,"player-container"],["class","floating-overlay",3,"click",4,"ngIf"],[1,"player-wrapper",3,"click"],[1,"player-header"],[1,"player-title"],[1,"playback-controls"],[1,"btn","btn-sm","control-btn",3,"click","disabled","title"],[1,"fas","fa-step-backward"],[1,"btn","btn-sm","control-btn","play-pause-btn",3,"click","title"],[1,"fas"],[1,"fas","fa-step-forward"],[1,"player-actions"],["class","btn btn-sm action-btn",3,"active","title","click",4,"ngIf"],["class","btn btn-sm action-btn",3,"title","click",4,"ngIf"],[1,"btn","btn-sm","action-btn",3,"click","title"],[1,"fas","fa-times"],[1,"player-content"],[1,"player-video-section"],[1,"video-wrapper"],[3,"video","preferences","showCustomControls",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","queue-section",4,"ngIf"],[1,"floating-overlay",3,"click"],[1,"fas","fa-list"],[1,"fas","fa-window-minimize"],[1,"fas","fa-chevron-left"],[1,"fas","fa-window-restore"],[3,"video","preferences","showCustomControls"],[1,"loading-state"],["role","status",1,"spinner-border","text-primary"],["class","mt-3",4,"ngIf"],[1,"mt-3"],[1,"queue-section"]],template:function(i,r){1&i&&Y(0,vae,26,27,"div",1),2&i&&R("ngIf","inactive"!==r.displayMode)},dependencies:[ci,Qoe,aae],styles:[".player-container[_ngcontent-%COMP%]{position:fixed;z-index:1500;transition:all .3s cubic-bezier(.4,0,.2,1)}.floating-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000d9;backdrop-filter:blur(8px);animation:_ngcontent-%COMP%_fadeIn .2s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.player-container.mode-floating[_ngcontent-%COMP%]{inset:0;display:flex;align-items:center;justify-content:center;padding:20px}.player-container.mode-floating[_ngcontent-%COMP%]   .player-wrapper[_ngcontent-%COMP%]{position:relative;background:#1a1a1ae6;backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);border:1px solid rgba(255,255,255,.1);box-shadow:0 8px 32px #0000005e,inset 0 1px #ffffff0d;border-radius:16px;max-width:1200px;width:100%;max-height:90vh;display:flex;flex-direction:column;overflow:hidden}.player-container.mode-floating.with-queue[_ngcontent-%COMP%]   .player-wrapper[_ngcontent-%COMP%]{max-width:1600px}.player-container.mode-minimized[_ngcontent-%COMP%]{bottom:20px;right:20px;width:30vw;min-width:400px;max-width:600px}.player-container.mode-minimized[_ngcontent-%COMP%]   .player-wrapper[_ngcontent-%COMP%]{background:#1a1a1a73;backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);border:1px solid rgba(255,255,255,.1);border-radius:16px;box-shadow:0 8px 32px #00000080,inset 0 1px #ffffff0d;overflow:hidden;animation:_ngcontent-%COMP%_slideInUp .3s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_slideInUp{0%{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}.player-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:16px 20px;background:#0f0f0fcc;backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.05)}.player-container.mode-minimized[_ngcontent-%COMP%]   .player-header[_ngcontent-%COMP%]{padding:12px 16px;flex-wrap:wrap;justify-content:center}.player-title[_ngcontent-%COMP%]{color:#fff;font-weight:600;font-size:16px;flex:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-shadow:0 2px 4px rgba(0,0,0,.3)}.player-container.mode-minimized[_ngcontent-%COMP%]   .player-title[_ngcontent-%COMP%]{font-size:14px;text-align:center;flex:0 0 100%;margin-bottom:8px}.playback-controls[_ngcontent-%COMP%]{display:flex;gap:6px;align-items:center}.player-container.mode-minimized[_ngcontent-%COMP%]   .playback-controls[_ngcontent-%COMP%]{margin-right:12px}.control-btn[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);color:#fff;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s cubic-bezier(.4,0,.2,1);backdrop-filter:blur(10px)}.control-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ffffff1a;border-color:#fff3;transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.control-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.play-pause-btn[_ngcontent-%COMP%]{background:#0d6efd26;border-color:#0d6efd4d}.play-pause-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;box-shadow:0 4px 16px #0d6efd66}.player-actions[_ngcontent-%COMP%]{display:flex;gap:6px;align-items:center}.action-btn[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);color:#fff;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s cubic-bezier(.4,0,.2,1);backdrop-filter:blur(10px)}.action-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a;border-color:#fff3;transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.action-btn.active[_ngcontent-%COMP%]{background:#0d6efd26;border-color:#0d6efd4d}.player-content[_ngcontent-%COMP%]{display:flex;flex:1;overflow:hidden;position:relative}.player-video-section[_ngcontent-%COMP%]{flex:1;position:relative;background:#000;display:flex;align-items:center;justify-content:center}.video-wrapper[_ngcontent-%COMP%]{width:100%;height:100%}.player-container.mode-floating[_ngcontent-%COMP%]   .player-video-section[_ngcontent-%COMP%]{min-height:400px}.player-container.mode-minimized[_ngcontent-%COMP%]   .player-video-section[_ngcontent-%COMP%]{aspect-ratio:16 / 9}.player-container.mode-hidden[_ngcontent-%COMP%]{display:none}.loading-state[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;background:#000000b3;backdrop-filter:blur(4px);z-index:10;pointer-events:none}.loading-state[_ngcontent-%COMP%]   .spinner-border[_ngcontent-%COMP%]{pointer-events:auto}.queue-section[_ngcontent-%COMP%]{width:350px;flex-shrink:0;border-left:1px solid rgba(255,255,255,.05);overflow:hidden;background:#0f0f0f80}@media (max-width: 1200px){.player-container.mode-floating.with-queue[_ngcontent-%COMP%]   .player-wrapper[_ngcontent-%COMP%]{max-width:100%}.queue-section[_ngcontent-%COMP%]{width:300px}}@media (max-width: 768px){.player-container.mode-floating[_ngcontent-%COMP%]{padding:0}.player-container.mode-floating[_ngcontent-%COMP%]   .player-wrapper[_ngcontent-%COMP%]{max-width:100%;max-height:100vh;border-radius:0}.player-content[_ngcontent-%COMP%]{flex-direction:column}.queue-section[_ngcontent-%COMP%]{width:100%;max-height:40%;border-left:none;border-top:1px solid rgba(255,255,255,.05)}.player-title[_ngcontent-%COMP%]{font-size:14px}.player-container.mode-minimized[_ngcontent-%COMP%]{bottom:10px;right:10px;left:10px;width:auto;min-width:unset;max-width:unset}}"]})}}return n})();function bae(n,t){if(1&n&&(D(0,"div",34),P(1),T()),2&n){const e=A(2);E(),Le(e.currentVideo.channel_name)}}function Eae(n,t){if(1&n){const e=Se();D(0,"div",25),U(1,"div",26),D(2,"div",27)(3,"div",28)(4,"div",29),P(5),T(),Y(6,bae,2,1,"div",30),T(),D(7,"div",31)(8,"button",32),j("click",function(){return X(e),J(A().togglePlayPause())}),U(9,"i",2),T(),D(10,"button",32),j("click",function(){return X(e),J(A().showPlayer())}),U(11,"i",33),T()()()()}if(2&n){const e=A();E(5),Le(e.currentVideo.title),E(),R("ngIf",e.currentVideo.channel_name),E(2),R("title",e.isPlaying?e.i18nStrings.playerPause:e.i18nStrings.playerPlay),E(),Pe("fa-pause",e.isPlaying)("fa-play",!e.isPlaying),E(),R("title",e.i18nStrings.playerShow)}}function Sae(n,t){if(1&n){const e=Se();D(0,"div",35)(1,"div",36)(2,"strong",37),U(3,"i",2),P(4),Wh(5,"titlecase"),T(),D(6,"button",38),j("click",function(){const r=X(e).$implicit;return J(A().removeToast(r.id))}),T()(),D(7,"div",39),P(8),T()()}if(2&n){const e=t.$implicit;Pe("bg-success","success"===e.type)("bg-danger","error"===e.type)("bg-warning","warning"===e.type)("bg-info","info"===e.type),E(3),Pe("fa-check-circle","success"===e.type)("fa-exclamation-circle","error"===e.type)("fa-exclamation-triangle","warning"===e.type)("fa-info-circle","info"===e.type),E(),de(" ",aA(5,18,e.type)," "),E(4),Le(e.message)}}let Tae=(()=>{class n{constructor(e,i,r){this.toastService=e,this.playerService=i,this.i18nService=r,this.destroy$=new ke,this.i18nDict=qi_app,this.i18nStrings={},this.sidebarCollapsed=!1,this.toasts=[],this.currentVideo=null,this.displayMode="inactive",this.isPlaying=!1}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.destroy$),et(e=>{this.i18nStrings=e})).subscribe(),this.toastService.toasts$.subscribe(e=>{this.toasts=e}),this.playerService.currentVideo$.pipe(Oe(this.destroy$)).subscribe(e=>{this.currentVideo=e}),this.playerService.displayMode$.pipe(Oe(this.destroy$)).subscribe(e=>{this.displayMode=e}),this.playerService.isPlaying$.pipe(Oe(this.destroy$)).subscribe(e=>{this.isPlaying=e}),window.innerWidth<768&&(this.sidebarCollapsed=!0)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}toggleSidebar(){this.sidebarCollapsed=!this.sidebarCollapsed}closeSidebarOnMobile(){window.innerWidth<768&&(this.sidebarCollapsed=!0)}removeToast(e){this.toastService.remove(e)}togglePlayPause(){this.isPlaying?this.playerService.pause():this.playerService.play()}showPlayer(){this.playerService.uiUnhide()}static{this.\u0275fac=function(i){return new(i||n)(F(ju),F(lo),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-root"]],standalone:!1,decls:41,vars:18,consts:[[1,"app-container"],[1,"navbar-toggle",3,"click"],[1,"fas"],[1,"sidebar"],[1,"sidebar-header"],["src","/appicon/favicon-32x32.png","alt","","width","28","height","28",1,"logo","me-1"],[1,"app-name"],[1,"sidebar-menu"],["routerLink","/search","routerLinkActive","active",1,"menu-item",3,"click"],[1,"fas","fa-search"],["routerLink","/subscriptions","routerLinkActive","active",1,"menu-item",3,"click"],[1,"fas","fa-users"],["routerLink","/starred","routerLinkActive","active",1,"menu-item",3,"click"],[1,"fas","fa-star"],["routerLink","/watch-later","routerLinkActive","active",1,"menu-item",3,"click"],[1,"fas","fa-clock"],[1,"sidebar-divider"],["routerLink","/settings","routerLinkActive","active",1,"menu-item",3,"click"],[1,"fas","fa-cog"],["routerLink","/manage","routerLinkActive","active",1,"menu-item",3,"click"],[1,"fas","fa-users-cog"],["class","mini-player",4,"ngIf"],[1,"main-content"],[1,"toast-container"],["class","toast show mb-2","role","alert",3,"bg-success","bg-danger","bg-warning","bg-info",4,"ngFor","ngForOf"],[1,"mini-player"],[1,"mini-player-divider"],[1,"mini-player-content"],[1,"mini-player-info"],[1,"mini-player-title"],["class","mini-player-channel",4,"ngIf"],[1,"mini-player-controls"],[1,"btn","btn-sm","mini-control-btn",3,"click","title"],[1,"fas","fa-chevron-right"],[1,"mini-player-channel"],["role","alert",1,"toast","show","mb-2"],[1,"toast-header"],[1,"me-auto","text-white"],["type","button",1,"btn-close","btn-close-white",3,"click"],[1,"toast-body","text-white"]],template:function(i,r){1&i&&(D(0,"div",0)(1,"button",1),j("click",function(){return r.toggleSidebar()}),U(2,"i",2),T(),D(3,"nav",3)(4,"div",4),U(5,"img",5),D(6,"div",6),P(7,"Ekydum"),T()(),D(8,"ul",7)(9,"li")(10,"a",8),j("click",function(){return r.closeSidebarOnMobile()}),U(11,"i",9),P(12),T()(),D(13,"li")(14,"a",10),j("click",function(){return r.closeSidebarOnMobile()}),U(15,"i",11),P(16),T()(),D(17,"li")(18,"a",12),j("click",function(){return r.closeSidebarOnMobile()}),U(19,"i",13),P(20),T()(),D(21,"li")(22,"a",14),j("click",function(){return r.closeSidebarOnMobile()}),U(23,"i",15),P(24),T()()(),U(25,"div",16),D(26,"ul",7)(27,"li")(28,"a",17),j("click",function(){return r.closeSidebarOnMobile()}),U(29,"i",18),P(30),T()(),D(31,"li")(32,"a",19),j("click",function(){return r.closeSidebarOnMobile()}),U(33,"i",20),P(34),T()()(),Y(35,Eae,12,8,"div",21),T(),D(36,"main",22),U(37,"router-outlet"),T(),U(38,"app-floating-player-modal"),D(39,"div",23),Y(40,Sae,9,20,"div",24),T()()),2&i&&(E(),Pe("sidebar-collapsed",r.sidebarCollapsed),E(),Pe("fa-bars",r.sidebarCollapsed)("fa-times",!r.sidebarCollapsed),E(),Pe("collapsed",r.sidebarCollapsed),E(9),de(" ",r.i18nStrings.menuSearch," "),E(4),de(" ",r.i18nStrings.menuSubscriptions," "),E(4),de(" ",r.i18nStrings.menuStarred," "),E(4),de(" ",r.i18nStrings.menuWatchLater," "),E(6),de(" ",r.i18nStrings.menuSettings," "),E(4),de(" ",r.i18nStrings.menuManage," "),E(),R("ngIf",r.currentVideo&&"hidden"===r.displayMode),E(),Pe("expanded",r.sidebarCollapsed),E(4),R("ngForOf",r.toasts))},dependencies:[vr,ci,_b,pd,Wk,yae,kM],styles:['.app-container[_ngcontent-%COMP%]{display:flex;height:100vh;overflow:hidden;position:relative;margin:0;padding:0;background:radial-gradient(ellipse at 12% 23%,rgba(198,17,32,.08) 0%,transparent 25%),radial-gradient(ellipse at 87% 71%,rgba(13,110,253,.07) 0%,transparent 30%),radial-gradient(ellipse at 43% 89%,rgba(198,17,32,.06) 0%,transparent 28%),radial-gradient(ellipse at 76% 15%,rgba(13,110,253,.09) 0%,transparent 35%),radial-gradient(ellipse at 31% 54%,rgba(198,17,32,.05) 0%,transparent 22%),radial-gradient(ellipse at 68% 42%,rgba(13,110,253,.06) 0%,transparent 26%),radial-gradient(ellipse at 5% 78%,rgba(198,17,32,.07) 0%,transparent 24%),radial-gradient(ellipse at 93% 34%,rgba(13,110,253,.05) 0%,transparent 20%),#000}.app-container[_ngcontent-%COMP%]:before{content:"";position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;background:radial-gradient(circle at 27% 38%,rgba(255,255,255,.08) 0%,transparent 1.5%),radial-gradient(circle at 71% 64%,rgba(255,200,200,.06) 0%,transparent 2%),radial-gradient(circle at 54% 19%,rgba(200,220,255,.05) 0%,transparent 1.2%),radial-gradient(circle at 18% 81%,rgba(255,255,255,.04) 0%,transparent 1%),radial-gradient(circle at 89% 27%,rgba(255,200,200,.07) 0%,transparent 1.8%),radial-gradient(circle at 35% 67%,rgba(200,220,255,.05) 0%,transparent 1.3%);pointer-events:none}.app-container[_ngcontent-%COMP%]:after{content:"";position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;background-image:radial-gradient(1px 1px at 10% 20%,rgba(255,255,255,.8),transparent),radial-gradient(1px 1px at 90% 80%,rgba(255,255,255,.6),transparent),radial-gradient(1px 1px at 50% 50%,rgba(255,255,255,.7),transparent),radial-gradient(1px 1px at 30% 70%,rgba(255,255,255,.5),transparent),radial-gradient(1px 1px at 70% 30%,rgba(255,255,255,.8),transparent),radial-gradient(1px 1px at 20% 90%,rgba(255,255,255,.6),transparent),radial-gradient(1px 1px at 80% 10%,rgba(255,255,255,.7),transparent),radial-gradient(1px 1px at 60% 60%,rgba(255,255,255,.5),transparent),radial-gradient(1px 1px at 40% 40%,rgba(255,255,255,.6),transparent),radial-gradient(1px 1px at 85% 45%,rgba(255,255,255,.7),transparent);background-size:100% 100%;opacity:.5;pointer-events:none}.navbar-toggle[_ngcontent-%COMP%]{position:fixed;top:20px;left:20px;z-index:1100;background:#3c3c3ce6;border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(20px);color:#fff;width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 4px 16px #00000080;cursor:pointer;margin:0;padding:0}.navbar-toggle[_ngcontent-%COMP%]:hover{background:#505050f2;border-color:#ffffff4d;transform:translateY(-2px);box-shadow:0 6px 20px #0009}.navbar-toggle[_ngcontent-%COMP%]:active{transform:translateY(0)}.navbar-toggle.sidebar-collapsed[_ngcontent-%COMP%]{left:20px}.navbar-toggle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}.sidebar[_ngcontent-%COMP%]{width:240px;background:#1a1a1acc;backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);border-right:1px solid rgba(255,255,255,.05);display:flex;flex-direction:column;transition:all .3s cubic-bezier(.4,0,.2,1);position:fixed;left:0;top:0;height:100vh;z-index:1000;box-shadow:4px 0 24px #0000004d;overflow-y:auto;overflow-x:hidden;margin:0;padding:0}.sidebar.collapsed[_ngcontent-%COMP%]{transform:translate(-100%)}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff05}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ffffff1a;border-radius:3px;backdrop-filter:blur(10px)}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ffffff26}.sidebar-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:24px 20px;margin:52px 0 0;border-bottom:1px solid rgba(255,255,255,.05);background:#0f0f0f4d}.sidebar-header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{filter:drop-shadow(0 2px 8px rgba(255,255,255,.1));margin:0}.sidebar-header[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,.5);letter-spacing:.5px;margin:0}.sidebar-menu[_ngcontent-%COMP%]{list-style:none;padding:12px 8px;margin:0}.sidebar-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:0 0 4px;padding:0}.sidebar-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 16px;margin:0;color:#ffffffb3;text-decoration:none;border-radius:10px;transition:all .2s cubic-bezier(.4,0,.2,1);font-size:15px;font-weight:500;background:transparent;border:1px solid transparent}.sidebar-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:12px;font-size:16px;width:20px;text-align:center;opacity:.8}.sidebar-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover{color:#fff;background:#ffffff0d;border-color:#ffffff14;transform:translate(4px)}.sidebar-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{opacity:1}.sidebar-menu[_ngcontent-%COMP%]   .menu-item.active[_ngcontent-%COMP%]{color:#fff;background:#c6112026;border:1px solid rgba(198,17,32,.3);box-shadow:0 4px 12px #c6112033;font-weight:600}.sidebar-menu[_ngcontent-%COMP%]   .menu-item.active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:1;color:#ff646e}.sidebar-divider[_ngcontent-%COMP%]{height:1px;background:linear-gradient(to right,transparent,rgba(255,255,255,.08) 20%,rgba(255,255,255,.08) 80%,transparent);margin:12px 0;padding:0}.mini-player[_ngcontent-%COMP%]{margin-top:auto;padding:0 0 12px}.mini-player-divider[_ngcontent-%COMP%]{height:1px;background:linear-gradient(to right,transparent,rgba(255,255,255,.1) 20%,rgba(255,255,255,.1) 80%,transparent);margin:12px 0 8px}.mini-player-content[_ngcontent-%COMP%]{padding:12px;background:#0d6efd14;border:1px solid rgba(13,110,253,.15);border-radius:10px;margin:0 8px;backdrop-filter:blur(10px);box-shadow:0 4px 12px #0d6efd1a}.mini-player-info[_ngcontent-%COMP%]{margin-bottom:8px}.mini-player-title[_ngcontent-%COMP%]{color:#fff;font-size:13px;font-weight:600;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;margin-bottom:4px}.mini-player-channel[_ngcontent-%COMP%]{color:#fff9;font-size:11px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mini-player-controls[_ngcontent-%COMP%]{display:flex;gap:6px}.mini-control-btn[_ngcontent-%COMP%]{flex:1;background:#ffffff14;border:1px solid rgba(255,255,255,.12);color:#fff;padding:8px;border-radius:8px;backdrop-filter:blur(10px);transition:all .2s cubic-bezier(.4,0,.2,1);font-size:14px}.mini-control-btn[_ngcontent-%COMP%]:hover{background:#ffffff26;border-color:#fff3;transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.mini-control-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.main-content[_ngcontent-%COMP%]{flex:1;margin-left:240px;transition:margin-left .3s cubic-bezier(.4,0,.2,1);overflow-y:auto;min-height:100vh;padding:20px;position:relative;z-index:1}.main-content.expanded[_ngcontent-%COMP%]{margin-left:0}.toast-container[_ngcontent-%COMP%]{position:fixed;top:80px;right:20px;z-index:2000;max-width:350px}.toast[_ngcontent-%COMP%]{backdrop-filter:blur(20px);box-shadow:0 8px 24px #0006;border-radius:12px;border:1px solid rgba(255,255,255,.1);animation:_ngcontent-%COMP%_slideIn .3s cubic-bezier(.4,0,.2,1)}.toast.bg-success[_ngcontent-%COMP%]{background:#198754e6!important;border-color:#1987544d}.toast.bg-danger[_ngcontent-%COMP%]{background:#dc3545e6!important;border-color:#dc35454d}.toast.bg-warning[_ngcontent-%COMP%]{background:#ffc107e6!important;border-color:#ffc1074d}.toast.bg-info[_ngcontent-%COMP%]{background:#0dcaf0e6!important;border-color:#0dcaf04d}.toast[_ngcontent-%COMP%]   .toast-header[_ngcontent-%COMP%]{background:transparent;border-bottom:1px solid rgba(255,255,255,.15);padding:12px 16px}.toast[_ngcontent-%COMP%]   .toast-body[_ngcontent-%COMP%]{padding:12px 16px;font-size:14px}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{width:280px;box-shadow:8px 0 32px #00000080}.main-content[_ngcontent-%COMP%]{margin-left:0}.navbar-toggle[_ngcontent-%COMP%]{top:16px;left:16px}}']})}}return n})();function Dae(n,t){if(1&n&&(D(0,"div",13),U(1,"i",14),P(2),D(3,"a",15),P(4),T(),P(5,". "),T()),2&n){const e=A();E(2),de(" ",e.i18nStrings.configureWarning," "),E(2),Le(e.i18nStrings.linkSettings)}}function Cae(n,t){1&n&&(D(0,"div",16),U(1,"div",17),T())}function Iae(n,t){if(1&n&&(D(0,"div",18),U(1,"i",19),P(2),T()),2&n){const e=A();E(2),de(" ",e.i18nStrings.noSubscriptions," ")}}function wae(n,t){if(1&n){const e=Se();D(0,"div",22)(1,"div",23),j("click",function(){const r=X(e).$implicit;return J(A(2).openChannel(r.yt_channel_id))}),D(2,"div",24)(3,"h5",25),U(4,"i",26),P(5),T(),D(6,"p",27),U(7,"i",28),P(8),Wh(9,"date"),T(),D(10,"button",29),j("click",function(r){const s=X(e).$implicit;return J(A(2).unsubscribe(s.id,r))}),U(11,"i",30),P(12),T()()()()}if(2&n){const e=t.$implicit,i=A(2);E(5),de(" ",e.yt_channel_name||i.i18nStrings.channelDefault," "),E(3),Ds(" ",i.i18nStrings.subscribedLabel," ",ly(9,4,e.created_at,"short")," "),E(4),de(" ",i.i18nStrings.btnUnsubscribe," ")}}function xae(n,t){if(1&n&&(D(0,"div",20),Y(1,wae,13,7,"div",21),T()),2&n){const e=A();E(),R("ngForOf",e.subscriptions)}}function Aae(n,t){1&n&&(D(0,"div",40),U(1,"div",17),T())}function Mae(n,t){if(1&n&&(D(0,"div",18),U(1,"i",19),P(2),T()),2&n){const e=A(2);E(2),Ds(" ",e.i18nStrings.noChannelsFound,' "',e.searchQuery,'" ')}}function Rae(n,t){if(1&n){const e=Se();D(0,"div",43)(1,"div",44)(2,"div")(3,"h6",45),P(4),T(),D(5,"small",46),P(6),T()(),D(7,"button",47),j("click",function(){const r=X(e).$implicit;return J(A(3).subscribeToChannel(r.yt_id))}),U(8,"i",48),P(9),T()()()}if(2&n){const e=t.$implicit,i=A(3);E(4),Le(e.name),E(2),Le(e.yt_id),E(),R("disabled",i.isSubscribed(e.yt_id)),E(),Pe("fa-check",i.isSubscribed(e.yt_id))("fa-plus",!i.isSubscribed(e.yt_id)),E(),de(" ",i.isSubscribed(e.yt_id)?i.i18nStrings.btnSubscribed:i.i18nStrings.btnSubscribe," ")}}function kae(n,t){if(1&n&&(D(0,"div",41),Y(1,Rae,10,8,"div",42),T()),2&n){const e=A(2);E(),R("ngForOf",e.searchResults)}}function Oae(n,t){if(1&n){const e=Se();D(0,"div",31),j("click",function(){return X(e),J(A().closeSearch())}),D(1,"div",32),j("click",function(r){return X(e),J(r.stopPropagation())}),D(2,"div",33)(3,"h4",34),U(4,"i",35),P(5),T(),D(6,"button",36),j("click",function(){return X(e),J(A().closeSearch())}),U(7,"i",37),T()(),Y(8,Aae,2,0,"div",38)(9,Mae,3,2,"div",10)(10,kae,2,1,"div",39),T()()}if(2&n){const e=A();E(5),de(" ",e.i18nStrings.searchResultsTitle," "),E(3),R("ngIf",e.searching),E(),R("ngIf",!e.searching&&0===e.searchResults.length),E(),R("ngIf",!e.searching&&e.searchResults.length>0)}}let Nae=(()=>{class n{constructor(e,i,r,s,o){this.api=e,this.auth=i,this.toast=r,this.router=s,this.i18nService=o,this.i18nDict=qi_subscriptions,this.i18nStrings={},this.subscriptions=[],this.searchResults=[],this.searchQuery="",this.loading=!1,this.searching=!1,this.showSearchResults=!1,this.isAuthenticated=!1,this.alive$=new ke}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(e=>{this.i18nStrings=e})).subscribe(),this.isAuthenticated=this.auth.isAuthenticated(),this.isAuthenticated&&this.loadSubscriptions()}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}loadSubscriptions(){this.loading=!0,this.api.getSubscriptions().subscribe({next:e=>{this.subscriptions=e?.subscriptions||[],this.loading=!1},error:()=>{this.loading=!1}})}searchChannels(){this.searchQuery.trim()&&(this.searching=!0,this.showSearchResults=!0,this.searchResults=[],this.api.searchChannels(this.searchQuery).subscribe({next:e=>{this.searchResults=e?.channels||[],this.searching=!1},error:()=>{this.searching=!1}}))}subscribeToChannel(e){this.api.subscribe(e).subscribe({next:()=>{this.toast.success(this.i18nStrings.toastSubscribed),this.loadSubscriptions()}})}unsubscribe(e,i){i.stopPropagation(),this.api.unsubscribe(e).subscribe({next:()=>{this.toast.success(this.i18nStrings.toastUnsubscribed),this.loadSubscriptions()}})}isSubscribed(e){return this.subscriptions.some(i=>i.yt_channel_id===e)}openChannel(e){this.router.navigate(["/channel",e])}closeSearch(){this.showSearchResults=!1,this.searchResults=[],this.searchQuery=""}static{this.\u0275fac=function(i){return new(i||n)(F(Kr),F(ud),F(ju),F(Yn),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-subscriptions"]],standalone:!1,decls:15,vars:10,consts:[[1,"container-fluid"],[1,"mb-4","page-title","text-no-select",2,"margin-left","48px"],[1,"fas","fa-users","me-2"],[1,"mb-4"],[1,"input-group","search-group"],["type","text",1,"form-control","search-input",3,"ngModelChange","keyup.enter","placeholder","ngModel"],[1,"btn","btn-blue-glass",3,"click","disabled"],[1,"fas","fa-search","me-1"],["class","alert-custom alert-warning-custom",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["class","alert-custom alert-info-custom",4,"ngIf"],["class","row",4,"ngIf"],["class","search-overlay",3,"click",4,"ngIf"],[1,"alert-custom","alert-warning-custom"],[1,"fas","fa-exclamation-triangle","me-2"],["routerLink","/settings",1,"alert-link"],[1,"text-center","py-5"],["role","status",1,"spinner-border","spinner-custom"],[1,"alert-custom","alert-info-custom"],[1,"fas","fa-info-circle","me-2"],[1,"row"],["class","col-md-6 col-lg-4 col-xl-3 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-4","col-xl-3","mb-4"],[1,"card","channel-card","h-100","text-no-select",3,"click"],[1,"card-body"],[1,"card-title"],[1,"fas","fa-tv","me-2"],[1,"card-text","channel-meta","small"],[1,"fas","fa-calendar","me-1"],[1,"btn","btn-sm","btn-red-glass",3,"click"],[1,"fas","fa-times","me-1"],[1,"search-overlay",3,"click"],[1,"search-results",3,"click"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"text-white"],[1,"fas","fa-search","me-2"],[1,"btn","btn-sm","btn-glass",3,"click"],[1,"fas","fa-times"],["class","text-center py-3",4,"ngIf"],["class","results-list",4,"ngIf"],[1,"text-center","py-3"],[1,"results-list"],["class","result-item",4,"ngFor","ngForOf"],[1,"result-item"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-1","text-white"],[1,"text-muted-custom"],[1,"btn","btn-sm","btn-blue-glass",3,"click","disabled"],[1,"fas"]],template:function(i,r){1&i&&(D(0,"div",0)(1,"h2",1),U(2,"i",2),P(3),T(),D(4,"div",3)(5,"div",4)(6,"input",5),Ci("ngModelChange",function(o){return Gi(r.searchQuery,o)||(r.searchQuery=o),o}),j("keyup.enter",function(){return r.searchChannels()}),T(),D(7,"button",6),j("click",function(){return r.searchChannels()}),U(8,"i",7),P(9),T()()(),Y(10,Dae,6,2,"div",8)(11,Cae,2,0,"div",9)(12,Iae,3,1,"div",10)(13,xae,2,1,"div",11)(14,Oae,11,4,"div",12),T()),2&i&&(E(3),de(" ",r.i18nStrings.pageTitle," "),E(3),R("placeholder",r.i18nStrings.searchPlaceholder),Di("ngModel",r.searchQuery),E(),R("disabled",!r.searchQuery||r.searching),E(2),de(" ",r.i18nStrings.btnSearch," "),E(),R("ngIf",!r.isAuthenticated),E(),R("ngIf",r.loading),E(),R("ngIf",!r.loading&&0===r.subscriptions.length),E(),R("ngIf",!r.loading&&r.subscriptions.length>0),E(),R("ngIf",r.showSearchResults))},dependencies:[vr,ci,pd,ba,xd,cc,By],styles:[".page-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.5)}.search-group[_ngcontent-%COMP%]{box-shadow:0 4px 16px #0000004d}.search-input[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.15);color:#fff;backdrop-filter:blur(20px);border-radius:8px 0 0 8px;transition:all .2s ease}.search-input[_ngcontent-%COMP%]::placeholder{color:#fff6}.search-input[_ngcontent-%COMP%]:focus{background:#1a1a1ae6;border-color:#0d6efd80;color:#fff;box-shadow:0 0 0 .25rem #0d6efd26;outline:0}.btn-glass[_ngcontent-%COMP%]{background:#ffffff14;border:1px solid rgba(255,255,255,.15);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease}.btn-glass[_ngcontent-%COMP%]:hover{background:#ffffff26;border-color:#ffffff40;color:#fff;transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.btn-blue-glass[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600;border-radius:0 8px 8px 0}.btn-blue-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #0d6efd66}.btn-blue-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-red-glass[_ngcontent-%COMP%]{background:#c6112026;border:1px solid rgba(198,17,32,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-red-glass[_ngcontent-%COMP%]:hover{background:#c6112040;border-color:#c6112080;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #c6112066}.channel-card[_ngcontent-%COMP%]{cursor:pointer;background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:12px;transition:all .2s ease}.channel-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:#fff3;box-shadow:0 8px 24px #0006}.channel-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background:transparent}.channel-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{color:#fff;font-weight:600;margin-bottom:.75rem}.channel-meta[_ngcontent-%COMP%]{color:#ffffff80;margin-bottom:1rem}.search-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000d9;backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;z-index:1050;animation:_ngcontent-%COMP%_fadeIn .2s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.search-results[_ngcontent-%COMP%]{background:#1a1a1af2;border:1px solid rgba(255,255,255,.15);backdrop-filter:blur(30px);border-radius:16px;padding:24px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto;box-shadow:0 20px 60px #0009}.results-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.result-item[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(10px);border-radius:8px;padding:16px;transition:all .2s ease}.result-item[_ngcontent-%COMP%]:hover{background:#ffffff14;border-color:#ffffff26;transform:translate(4px)}.text-muted-custom[_ngcontent-%COMP%]{color:#ffffff80}.spinner-custom[_ngcontent-%COMP%]{color:#0d6efdcc}.alert-custom[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:10px;padding:16px;margin-bottom:20px}.alert-info-custom[_ngcontent-%COMP%]{color:#0dcaf0e6;border-color:#0dcaf04d;background:#0dcaf01a}.alert-warning-custom[_ngcontent-%COMP%]{color:#ffc107e6;border-color:#ffc1074d;background:#ffc1071a}.alert-link[_ngcontent-%COMP%]{color:#ffc107;text-decoration:underline;font-weight:600}.alert-link[_ngcontent-%COMP%]:hover{color:#ffc107cc}"]})}}return n})();const Pae=["*"];function Lae(n,t){if(1&n&&U(0,"img",9),2&n){const e=A();R("src",e.video.thumbnail,cl)("alt",e.video.title)}}function Fae(n,t){if(1&n){const e=Se();D(0,"button",13),j("click",function(r){return X(e),J(A(2).onAddToQueue(r))}),U(1,"i",14),T()}2&n&&R("title",A(2).i18nStrings.btnAddToQueue)}function Bae(n,t){if(1&n){const e=Se();D(0,"button",15),j("click",function(r){return X(e),J(A(2).onAddToWatchLater(r))}),U(1,"i",16),T()}2&n&&R("title",A(2).i18nStrings.btnAddToWatchLater)}function Uae(n,t){if(1&n&&(D(0,"div",10),Y(1,Fae,2,1,"button",11)(2,Bae,2,1,"button",12),T()),2&n){const e=A();E(),R("ngIf",e.showQueueButton),E(),R("ngIf",e.showWatchLaterButton)}}function $ae(n,t){if(1&n&&(D(0,"div",17),P(1),T()),2&n){const e=A();E(),de(" ",e.formatDuration(e.video.duration)," ")}}function Vae(n,t){if(1&n&&(D(0,"p",18),U(1,"i",19),P(2),T()),2&n){const e=A();E(2),de(" ",e.video.channel_name," ")}}function jae(n,t){if(1&n&&(D(0,"span"),U(1,"i",23),P(2),T()),2&n){const e=A(2);E(2),de(" ",e.formatViewCount(e.video.view_count)," ")}}function Hae(n,t){if(1&n&&(D(0,"span",24),U(1,"i",25),P(2),T()),2&n){const e=A(2);E(2),de(" ",e.formatDate(e.video.upload_date)," ")}}function Gae(n,t){if(1&n&&(D(0,"p",20),Y(1,jae,3,1,"span",21)(2,Hae,3,1,"span",22),T()),2&n){const e=A();E(),R("ngIf",e.video.view_count),E(),R("ngIf",e.video.upload_date)}}let Hd=(()=>{class n{constructor(e){this.i18nService=e,this.i18nDict=qi_player,this.i18nStrings={},this.mode="thumbnail",this.showActions=!0,this.showQueueButton=!0,this.showWatchLaterButton=!0,this.showMetadata=!0,this.videoClick=new ve,this.addToQueue=new ve,this.addToWatchLater=new ve,this.alive$=new ke}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(e=>{this.i18nStrings=e})).subscribe()}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}onVideoClick(){this.videoClick.emit(this.video)}onAddToQueue(e){e.stopPropagation(),this.addToQueue.emit(this.video)}onAddToWatchLater(e){e.stopPropagation(),this.addToWatchLater.emit(this.video)}formatDuration(e){var i=Math.floor(e/3600),r=Math.floor(e%3600/60),s=e%60;return i>0?`${i}:${r.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${r}:${s.toString().padStart(2,"0")}`}formatViewCount(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}formatDate(e){if(!e)return"";if(e.includes("-")){var i=new Date(e),s=(new Date).getTime()-i.getTime(),o=Math.floor(s/864e5);return 0===o?this.i18nStrings.dateToday||"Today":1===o?this.i18nStrings.dateYesterday||"Yesterday":o<7?`${o} ${this.i18nStrings.dateDaysAgo||"days ago"}`:o<30?`${Math.floor(o/7)} ${this.i18nStrings.dateWeeksAgo||"weeks ago"}`:o<365?`${Math.floor(o/30)} ${this.i18nStrings.dateMonthsAgo||"months ago"}`:`${Math.floor(o/365)} ${this.i18nStrings.dateYearsAgo||"years ago"}`}return e}static{this.\u0275fac=function(i){return new(i||n)(F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-video-item"]],inputs:{video:"video",mode:"mode",showActions:"showActions",showQueueButton:"showQueueButton",showWatchLaterButton:"showWatchLaterButton",showMetadata:"showMetadata"},outputs:{videoClick:"videoClick",addToQueue:"addToQueue",addToWatchLater:"addToWatchLater"},standalone:!1,ngContentSelectors:Pae,decls:11,vars:10,consts:[[1,"card","video-card","h-100","text-no-select"],[1,"video-thumbnail",3,"click"],[3,"src","alt",4,"ngIf"],["class","video-actions",4,"ngIf"],["class","duration-badge",4,"ngIf"],[1,"card-body"],[1,"card-title",3,"click"],["class","card-text video-channel small mb-1",4,"ngIf"],["class","card-text video-meta small mb-0",4,"ngIf"],[3,"src","alt"],[1,"video-actions"],["class","btn btn-sm video-action-btn video-action-queue",3,"title","click",4,"ngIf"],["class","btn btn-sm video-action-btn video-action-later ms-1",3,"title","click",4,"ngIf"],[1,"btn","btn-sm","video-action-btn","video-action-queue",3,"click","title"],[1,"fas","fa-plus"],[1,"btn","btn-sm","video-action-btn","video-action-later","ms-1",3,"click","title"],[1,"fas","fa-clock"],[1,"duration-badge"],[1,"card-text","video-channel","small","mb-1"],[1,"fas","fa-user","me-1"],[1,"card-text","video-meta","small","mb-0"],[4,"ngIf"],["class","ms-2",4,"ngIf"],[1,"fas","fa-eye","me-1"],[1,"ms-2"],[1,"fas","fa-calendar","me-1"]],template:function(i,r){1&i&&(jh(),D(0,"div",0)(1,"div",1),j("click",function(){return r.onVideoClick()}),Y(2,Lae,1,2,"img",2)(3,Uae,3,2,"div",3)(4,$ae,2,1,"div",4),T(),D(5,"div",5)(6,"h6",6),j("click",function(){return r.onVideoClick()}),P(7),T(),Y(8,Vae,3,1,"p",7)(9,Gae,3,2,"p",8),Hh(10),T()()),2&i&&(Pe("list-mode","list"===r.mode),E(2),R("ngIf",r.video.thumbnail),E(),R("ngIf",r.showActions),E(),R("ngIf",r.video.duration),E(),Pe("p-2","list"===r.mode),E(2),Le(r.video.title),E(),R("ngIf",r.video.channel_name),E(),R("ngIf",r.showMetadata))},dependencies:[ci],styles:[".video-card[_ngcontent-%COMP%]{cursor:pointer;background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:12px;overflow:hidden;transition:all .2s cubic-bezier(.4,0,.2,1)}.video-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:#fff3;box-shadow:0 8px 24px #0006}.video-card.list-mode[_ngcontent-%COMP%]{display:flex;flex-direction:row}.video-card.list-mode[_ngcontent-%COMP%]   .video-thumbnail[_ngcontent-%COMP%]{width:200px;padding-top:0;height:112px;flex-shrink:0}.video-card.list-mode[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex:1}.video-thumbnail[_ngcontent-%COMP%]{position:relative;width:100%;padding-top:56.25%;overflow:hidden;background:#1a1a1a;cursor:pointer}.video-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.video-card[_ngcontent-%COMP%]:hover   .video-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.05)}.video-actions[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;opacity:0;transition:opacity .2s ease;z-index:10;display:flex;gap:4px}.video-card[_ngcontent-%COMP%]:hover   .video-actions[_ngcontent-%COMP%]{opacity:1}.video-action-btn[_ngcontent-%COMP%]{background:#000c;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);color:#fff;width:32px;height:32px;padding:0;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s cubic-bezier(.4,0,.2,1);box-shadow:0 4px 12px #00000080}.video-action-queue[_ngcontent-%COMP%]:hover{background:#c61120e6;border-color:#c6112080;transform:scale(1.1);box-shadow:0 6px 16px #c6112099}.video-action-later[_ngcontent-%COMP%]:hover{background:#0d6efde6;border-color:#0d6efd80;transform:scale(1.1);box-shadow:0 6px 16px #0d6efd99}.duration-badge[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px;background:#000000e6;backdrop-filter:blur(10px);color:#fff;padding:4px 8px;border-radius:6px;font-size:12px;font-weight:600;border:1px solid rgba(255,255,255,.15);box-shadow:0 2px 8px #00000080}.card-body[_ngcontent-%COMP%]{background:transparent;border-top:1px solid rgba(255,255,255,.05)}.card-title[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;font-weight:600;margin-bottom:.5rem;cursor:pointer;color:#fff;line-height:1.3;transition:color .2s ease}.card-title[_ngcontent-%COMP%]:hover{color:#4299e1}.video-channel[_ngcontent-%COMP%]{color:#fff9}.video-meta[_ngcontent-%COMP%]{color:#ffffff80}.video-meta[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:.7}"]})}}return n})();function zae(n,t){1&n&&(D(0,"div",3),U(1,"div",4),T())}function Wae(n,t){if(1&n){const e=Se();D(0,"div",21)(1,"p",22),U(2,"i",14),P(3),T(),D(4,"button",23),j("click",function(){return X(e),J(A(3).playAllVideos())}),U(5,"i",24),P(6),T()()}if(2&n){const e=A(3);E(3),Ds(" ",e.videos.length," ",e.i18nStrings.videosCount," "),E(3),de(" ",e.i18nStrings.playAll," ")}}function Kae(n,t){1&n&&(D(0,"div",25),U(1,"div",4),T())}function qae(n,t){if(1&n&&(D(0,"div",26),U(1,"i",27),P(2),T()),2&n){const e=A(3);E(2),de(" ",e.i18nStrings.noVideos," ")}}function Yae(n,t){if(1&n){const e=Se();D(0,"div",30)(1,"app-video-item",31),j("videoClick",function(){const r=X(e).$implicit;return J(A(4).watchVideo(r))})("addToQueue",function(){const r=X(e).$implicit;return J(A(4).addToQueue(r))})("addToWatchLater",function(){const r=X(e).$implicit;return J(A(4).addToWatchLater(r))}),T()()}if(2&n){const e=t.$implicit;E(),R("video",e)("showMetadata",!0)}}function Qae(n,t){if(1&n&&(D(0,"div",28),Y(1,Yae,2,2,"div",29),T()),2&n){const e=A(3);E(),R("ngForOf",e.videos)}}function Zae(n,t){if(1&n&&(D(0,"span"),U(1,"i",34),P(2),T()),2&n){const e=A(4);E(2),de(" ",e.i18nStrings.loadMore," ")}}function Xae(n,t){if(1&n&&(D(0,"span"),U(1,"span",35),P(2),T()),2&n){const e=A(4);E(2),de(" ",e.i18nStrings.loading," ")}}function Jae(n,t){if(1&n){const e=Se();D(0,"div",32)(1,"button",33),j("click",function(){return X(e),J(A(3).loadMoreVideos())}),Y(2,Zae,3,1,"span",2)(3,Xae,3,1,"span",2),T()()}if(2&n){const e=A(3);E(),R("disabled",e.loadingMore),E(),R("ngIf",!e.loadingMore),E(),R("ngIf",e.loadingMore)}}function ele(n,t){if(1&n&&(D(0,"div"),Y(1,Wae,7,3,"div",16)(2,Kae,2,0,"div",17)(3,qae,3,1,"div",18)(4,Qae,2,1,"div",19)(5,Jae,4,3,"div",20),T()),2&n){const e=A(2);E(),R("ngIf",!e.loadingVideos&&e.videos.length>0),E(),R("ngIf",e.loadingVideos),E(),R("ngIf",!e.loadingVideos&&0===e.videos.length),E(),R("ngIf",!e.loadingVideos&&e.videos.length>0),E(),R("ngIf",e.videos.length>0&&!e.loadingVideos)}}function tle(n,t){1&n&&(D(0,"div",25),U(1,"div",4),T())}function nle(n,t){if(1&n&&(D(0,"div",26),U(1,"i",27),P(2),T()),2&n){const e=A(3);E(2),de(" ",e.i18nStrings.noPlaylists," ")}}function ile(n,t){if(1&n&&U(0,"img",43),2&n){const e=A().$implicit;R("src",e.thumbnail,cl)("alt",e.title)}}function rle(n,t){if(1&n){const e=Se();D(0,"div",30)(1,"div",36),j("click",function(){const r=X(e).$implicit;return J(A(4).openPlaylist(r.yt_id,r.title))}),D(2,"div",37),Y(3,ile,1,2,"img",38),D(4,"div",39),U(5,"i",40),P(6),T()(),D(7,"div",41)(8,"h6",42),P(9),T()()()()}if(2&n){const e=t.$implicit,i=A(4);E(3),R("ngIf",e.thumbnail),E(3),Ds(" ",e.video_count," ",i.i18nStrings.videosCount," "),E(3),Le(e.title)}}function sle(n,t){if(1&n&&(D(0,"div",28),Y(1,rle,10,4,"div",29),T()),2&n){const e=A(3);E(),R("ngForOf",e.playlists)}}function ole(n,t){if(1&n&&(D(0,"div"),Y(1,tle,2,0,"div",17)(2,nle,3,1,"div",18)(3,sle,2,1,"div",19),T()),2&n){const e=A(2);E(),R("ngIf",e.loadingPlaylists),E(),R("ngIf",!e.loadingPlaylists&&0===e.playlists.length),E(),R("ngIf",!e.loadingPlaylists&&e.playlists.length>0)}}function ale(n,t){if(1&n){const e=Se();D(0,"div")(1,"div",5)(2,"div")(3,"h2",6),U(4,"i",7),P(5),T()(),U(6,"div",8),D(7,"button",9),j("click",function(){return X(e),J(A().goBack())}),U(8,"i",10),T()(),D(9,"ul",11)(10,"li",12)(11,"a",13),j("click",function(){return X(e),J(A().switchTab("videos"))}),U(12,"i",14),P(13),T()(),D(14,"li",12)(15,"a",13),j("click",function(){return X(e),J(A().switchTab("playlists"))}),U(16,"i",15),P(17),T()()(),Y(18,ele,6,5,"div",2)(19,ole,4,3,"div",2),T()}if(2&n){const e=A();E(5),de(" ",e.channel.name," "),E(6),Pe("active","videos"===e.activeTab),E(2),de(" ",e.i18nStrings.tabVideos," "),E(2),Pe("active","playlists"===e.activeTab),E(2),de(" ",e.i18nStrings.tabPlaylists," "),E(),R("ngIf","videos"===e.activeTab),E(),R("ngIf","playlists"===e.activeTab)}}let lle=(()=>{class n{constructor(e,i,r,s,o){this.route=e,this.router=i,this.api=r,this.playerService=s,this.i18nService=o,this.channelId="",this.channel=null,this.activeTab="videos",this.i18nDict=qi_channel,this.i18nStrings={},this.videos=[],this.loading=!1,this.loadingVideos=!1,this.loadingMore=!1,this.currentPage=1,this.playlists=[],this.loadingPlaylists=!1,this.alive$=new ke}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(e=>{this.i18nStrings=e})).subscribe(),this.channelId=this.route.snapshot.paramMap.get("id")||"",this.route.queryParams.pipe(Oe(this.alive$),et(e=>{this.activeTab=e.tab||"videos"})).subscribe(),this.channelId&&(this.loadChannel(),this.loadVideos(),this.loadPlaylists())}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}switchTab(e){this.activeTab=e,this.router.navigate([],{relativeTo:this.route,queryParams:{tab:e},queryParamsHandling:"merge"})}loadChannel(){this.loading=!0,this.api.getChannel(this.channelId).subscribe({next:e=>{this.channel=e,this.loading=!1},error:()=>{this.loading=!1}})}loadVideos(){this.loadingVideos=!0,this.api.getChannelVideos(this.channelId,this.currentPage).subscribe({next:e=>{this.videos=(e?.items||[]).map(i=>this.mapToVideoItemData(i)),this.loadingVideos=!1},error:()=>{this.loadingVideos=!1}})}loadMoreVideos(){this.loadingMore=!0,this.currentPage++,this.api.getChannelVideos(this.channelId,this.currentPage).subscribe({next:e=>{var i=(e?.items||[]).map(r=>this.mapToVideoItemData(r));this.videos=[...this.videos,...i],this.loadingMore=!1},error:()=>{this.loadingMore=!1,this.currentPage--}})}loadPlaylists(){this.loadingPlaylists=!0,this.api.getChannelPlaylists(this.channelId).subscribe({next:e=>{this.playlists=e?.playlists||[],this.loadingPlaylists=!1},error:()=>{this.loadingPlaylists=!1}})}openPlaylist(e,i){this.router.navigate(["/playlist",e],{state:{title:i}})}watchVideo(e){this.playerService.playVideo(e)}addToWatchLater(e){this.api.addWatchLater(e.yt_video_id||e.yt_id||"",e.title,e.thumbnail||"",e.duration,e.channel_id,e.channel_name).subscribe()}playAllVideos(){this.playerService.queueSet(this.videos)}addToQueue(e){this.playerService.queueAdd(e)}goBack(){history.back()}mapToVideoItemData(e){return{yt_id:e.yt_id,yt_video_id:e.yt_id,title:e.title,thumbnail:e.thumbnail,duration:e.duration,view_count:e.view_count,channel_name:this.channel?.name,channel_id:this.channelId,upload_date:e.upload_date}}static{this.\u0275fac=function(i){return new(i||n)(F(da),F(Yn),F(Kr),F(lo),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-channel"]],standalone:!1,decls:3,vars:2,consts:[[1,"container-fluid"],["class","text-center py-5",4,"ngIf"],[4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","spinner-custom"],[1,"d-flex","align-items-center","mb-4"],[1,"mb-0","channel-title",2,"margin-left","48px"],[1,"fas","fa-tv","me-2"],[1,"d-flex","flex-row","flex-grow-1"],[1,"btn","btn-glass","me-3",3,"click"],[1,"fas","fa-arrow-left"],[1,"nav","nav-tabs-custom","mb-4","text-no-select",2,"margin-left","48px"],[1,"nav-item"],[1,"nav-link",3,"click"],[1,"fas","fa-video","me-2"],[1,"fas","fa-list","me-2"],["class","d-flex justify-content-between align-items-center mb-3",4,"ngIf"],["class","text-center py-3",4,"ngIf"],["class","alert-custom alert-info-custom",4,"ngIf"],["class","row",4,"ngIf"],["class","text-center mt-4",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"text-info","mb-0"],[1,"btn","btn-blue-glass","me-3",3,"click"],[1,"fas","fa-play","me-2"],[1,"text-center","py-3"],[1,"alert-custom","alert-info-custom"],[1,"fas","fa-info-circle","me-2"],[1,"row"],["class","col-md-6 col-lg-4 col-xl-3 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-4","col-xl-3","mb-4"],[3,"videoClick","addToQueue","addToWatchLater","video","showMetadata"],[1,"text-center","mt-4"],[1,"btn","btn-blue-glass",3,"click","disabled"],[1,"fas","fa-chevron-down","me-2"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"card","playlist-card","h-100","text-no-select",3,"click"],[1,"playlist-thumbnail"],[3,"src","alt",4,"ngIf"],[1,"playlist-badge"],[1,"fas","fa-list","me-1"],[1,"card-body"],[1,"card-title"],[3,"src","alt"]],template:function(i,r){1&i&&(D(0,"div",0),Y(1,zae,2,0,"div",1)(2,ale,20,9,"div",2),T()),2&i&&(E(),R("ngIf",r.loading),E(),R("ngIf",!r.loading&&r.channel))},dependencies:[vr,ci,Hd],styles:[".channel-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.5)}.nav-tabs-custom[_ngcontent-%COMP%]{border-bottom:1px solid rgba(255,255,255,.1)}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{cursor:pointer;color:#fff9;background:transparent;border:1px solid transparent;border-radius:8px 8px 0 0;padding:12px 20px;transition:all .2s ease}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#fff;background:#0d6efd1a;border-color:#0d6efd33}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#fff;background:#0d6efd26;border:1px solid rgba(13,110,253,.3);border-bottom-color:transparent;font-weight:600;box-shadow:0 -2px 8px #0d6efd33}.btn-glass[_ngcontent-%COMP%]{background:#ffffff14;border:1px solid rgba(255,255,255,.15);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease}.btn-glass[_ngcontent-%COMP%]:hover{background:#ffffff26;border-color:#ffffff40;color:#fff;transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.btn-blue-glass[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-blue-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #0d6efd66}.btn-blue-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.spinner-custom[_ngcontent-%COMP%]{color:#0d6efdcc}.alert-custom[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:10px;padding:16px;margin-bottom:20px}.alert-info-custom[_ngcontent-%COMP%]{color:#0dcaf0e6;border-color:#0dcaf04d;background:#0dcaf01a}.text-info[_ngcontent-%COMP%]{color:#ffffffb3!important}.playlist-card[_ngcontent-%COMP%]{cursor:pointer;background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:12px;overflow:hidden;transition:all .2s ease}.playlist-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:#fff3;box-shadow:0 8px 24px #0006}.playlist-thumbnail[_ngcontent-%COMP%]{position:relative;width:100%;padding-top:56.25%;overflow:hidden;background:#1a1a1a}.playlist-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.playlist-badge[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px;background:#000000e6;backdrop-filter:blur(10px);color:#fff;padding:6px 10px;border-radius:6px;font-size:12px;font-weight:600;border:1px solid rgba(255,255,255,.1)}.playlist-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background:transparent;border-top:1px solid rgba(255,255,255,.05)}.playlist-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;font-weight:600;margin-bottom:.5rem;color:#fff;line-height:1.3}"]})}}return n})();function cle(n,t){if(1&n&&(D(0,"div",19),U(1,"i",20),P(2),D(3,"strong"),P(4),T()()),2&n){const e=A();E(2),de(" ",e.i18nStrings.connectedAs," "),E(2),Le(e.accountInfo.name)}}function ule(n,t){1&n&&(D(0,"div",24),U(1,"div",25),T())}function dle(n,t){if(1&n){const e=Se();D(0,"div")(1,"div",7)(2,"label",8),P(3),T(),D(4,"select",26),Ci("ngModelChange",function(r){X(e);const s=A(2);return Gi(s.defaultQuality,r)||(s.defaultQuality=r),J(r)}),j("change",function(){return X(e),J(A(2).updateQuality())}),D(5,"option",27),P(6),T(),D(7,"option",28),P(8,"360p"),T(),D(9,"option",29),P(10,"480p"),T(),D(11,"option",30),P(12),T(),D(13,"option",31),P(14,"1080p"),T(),D(15,"option",32),P(16,"2K"),T(),D(17,"option",33),P(18,"4K"),T(),D(19,"option",34),P(20),T()()(),D(21,"div",7)(22,"label",8),P(23),T(),D(24,"select",26),Ci("ngModelChange",function(r){X(e);const s=A(2);return Gi(s.pageSize,r)||(s.pageSize=r),J(r)}),j("change",function(){return X(e),J(A(2).updatePageSize())}),D(25,"option",35),P(26,"10"),T(),D(27,"option",35),P(28,"20"),T(),D(29,"option",35),P(30,"30"),T(),D(31,"option",35),P(32,"50"),T(),D(33,"option",35),P(34,"100"),T(),D(35,"option",35),P(36,"200"),T(),D(37,"option",35),P(38,"300"),T(),D(39,"option",35),P(40,"500"),T()(),D(41,"small",10),P(42),T()(),D(43,"div",7)(44,"label",8),P(45,"Sprache | Language | Idioma | Langue | Bahasa | Lingua | \u8a00\u8a9e | \uc5b8\uc5b4 | Taal | J\u0119zyk | Idioma | \u042f\u0437\u044b\u043a | Dil | \u041c\u043e\u0432\u0430 | Ng\xf4n ng\u1eef | \u8bed\u8a00"),T(),D(46,"select",26),Ci("ngModelChange",function(r){X(e);const s=A(2);return Gi(s.lang,r)||(s.lang=r),J(r)}),j("change",function(){return X(e),J(A(2).updateLang())}),D(47,"option",35),P(48,"Deutsch (DE)"),T(),D(49,"option",35),P(50,"English (EN)"),T(),D(51,"option",35),P(52,"Espa\xf1ol (ES)"),T(),D(53,"option",35),P(54,"Fran\xe7ais (FR)"),T(),D(55,"option",35),P(56,"Indonesia (ID)"),T(),D(57,"option",35),P(58,"Italiano (IT)"),T(),D(59,"option",35),P(60,"\u65e5\u672c\u8a9e (JA)"),T(),D(61,"option",35),P(62,"\ud55c\uad6d\uc5b4 (KO)"),T(),D(63,"option",35),P(64,"Nederlands (NL)"),T(),D(65,"option",35),P(66,"Polski (PL)"),T(),D(67,"option",35),P(68,"Portugu\xeas (PT)"),T(),D(69,"option",35),P(70,"\u0420\u0443\u0441\u0441\u043a\u0438\u0439 (RU)"),T(),D(71,"option",35),P(72,"T\xfcrk\xe7e (TR)"),T(),D(73,"option",35),P(74,"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430 (UA)"),T(),D(75,"option",35),P(76,"Ti\u1ebfng Vi\u1ec7t (VI)"),T(),D(77,"option",35),P(78,"\u4e2d\u6587 (ZH)"),T()()()()}if(2&n){const e=A(2);E(3),Le(e.i18nStrings.defaultQuality),E(),Di("ngModel",e.defaultQuality),E(2),Le(e.i18nStrings.qualityMinimum),E(6),Le(e.i18nStrings.qualityRecommended),E(8),Le(e.i18nStrings.qualityMaximum),E(3),Le(e.i18nStrings.pageSize),E(),Di("ngModel",e.pageSize),E(),R("value",10),E(2),R("value",20),E(2),R("value",30),E(2),R("value",50),E(2),R("value",100),E(2),R("value",200),E(2),R("value",300),E(2),R("value",500),E(3),Le(e.i18nStrings.pageSizeHint),E(4),Di("ngModel",e.lang),E(),R("value",e.LANG_CODE.de),E(2),R("value",e.LANG_CODE.en),E(2),R("value",e.LANG_CODE.es),E(2),R("value",e.LANG_CODE.fr),E(2),R("value",e.LANG_CODE.id),E(2),R("value",e.LANG_CODE.it),E(2),R("value",e.LANG_CODE.ja),E(2),R("value",e.LANG_CODE.ko),E(2),R("value",e.LANG_CODE.nl),E(2),R("value",e.LANG_CODE.pl),E(2),R("value",e.LANG_CODE.pt),E(2),R("value",e.LANG_CODE.ru),E(2),R("value",e.LANG_CODE.tr),E(2),R("value",e.LANG_CODE.ua),E(2),R("value",e.LANG_CODE.vi),E(2),R("value",e.LANG_CODE.zh)}}function fle(n,t){if(1&n&&(D(0,"div",21)(1,"div",4)(2,"h5",5),P(3),T()(),D(4,"div",6),Y(5,ule,2,0,"div",22)(6,dle,79,33,"div",23),T()()),2&n){const e=A();E(3),Le(e.i18nStrings.userPreferences),E(2),R("ngIf",e.loadingSettings),E(),R("ngIf",!e.loadingSettings)}}let hle=(()=>{class n{constructor(e,i,r,s){this.api=e,this.auth=i,this.toast=r,this.i18nService=s,this.i18nDict=qi_settings,this.i18nStrings={},this.LANG_CODE=co,this.serverUrl="http://localhost:3000",this.accountToken="",this.isConnected=!1,this.saving=!1,this.accountInfo=null,this.loadingSettings=!1,this.defaultQuality="720p",this.pageSize=40,this.lang=co.en,this.autoPlay=1,this.alive$=new ke}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(r=>{this.i18nStrings=r})).subscribe();var e=this.auth.getServerUrl(),i=this.auth.getAccountToken();e&&(this.serverUrl=e),i&&(this.accountToken=i,this.isConnected=!0,this.loadAccountInfo(),this.loadSettings())}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}saveConnection(){this.serverUrl&&this.accountToken?(this.saving=!0,this.auth.setServerUrl(this.serverUrl),this.auth.setAccountToken(this.accountToken),this.api.getMe().subscribe({next:e=>{this.accountInfo=e,this.isConnected=!0,this.saving=!1,this.toast.success(this.i18nStrings.toastConnectedSuccess||"Connected successfully"),this.loadSettings()},error:()=>{this.saving=!1,this.isConnected=!1}})):this.toast.error(this.i18nStrings.toastFillFields||"Please fill in all fields")}disconnect(){this.auth.clearAccountToken(),this.accountToken="",this.isConnected=!1,this.accountInfo=null,this.toast.info(this.i18nStrings.toastDisconnected||"Disconnected")}loadAccountInfo(){this.api.getMe().subscribe({next:e=>{this.accountInfo=e}})}loadSettings(){this.loadingSettings=!0,this.api.getSettings().pipe(Ne(e=>e.settings)).subscribe({next:e=>{var i=e.find(l=>"DEFAULT_QUALITY"===l.key),r=e.find(l=>"PAGE_SIZE"===l.key),s=e.find(l=>"LANG"===l.key),o=e.find(l=>"AUTO_PLAY"===l.key);if(i&&(this.defaultQuality=i.value),r&&(this.pageSize=parseInt(r.value)),s){var a=(s.value+"").toLowerCase();this.lang=Object.values(co).includes(a)?a:co.en}o&&(this.autoPlay=+o.value||0),this.loadingSettings=!1},error:()=>{this.loadingSettings=!1}})}updateQuality(){this.api.updateSetting("DEFAULT_QUALITY",this.defaultQuality).subscribe({next:()=>{this.toast.success(this.i18nStrings.toastQualityUpdated||"Quality updated")}})}updatePageSize(){this.api.updateSetting("PAGE_SIZE",this.pageSize).subscribe({next:()=>{this.toast.success(this.i18nStrings.toastPageSizeUpdated||"Page size updated")}})}updateLang(){this.lang&&(this.i18nService.setLang(this.lang),setTimeout(()=>{this.api.updateSetting("LANG",this.lang).subscribe({next:()=>{this.toast.success(this.i18nStrings.toastLanguageUpdated||"Language updated")}})},500))}static{this.\u0275fac=function(i){return new(i||n)(F(Kr),F(ud),F(ju),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-settings"]],standalone:!1,decls:30,vars:15,consts:[[1,"container"],[1,"mb-4","page-title","text-no-select",2,"margin-left","48px"],[1,"fas","fa-cog","me-2"],[1,"card","settings-card","mb-4"],[1,"card-header"],[1,"mb-0","text-no-select"],[1,"card-body"],[1,"mb-3"],[1,"form-label","text-no-select"],["type","text","placeholder","http://localhost:3000",1,"form-control","settings-input",3,"ngModelChange","ngModel"],[1,"form-text","text-muted-custom","text-no-select"],["type","password",1,"form-control","settings-input",3,"ngModelChange","ngModel","placeholder"],[1,"d-flex","gap-2"],[1,"btn","btn-blue-glass",3,"click","disabled"],[1,"fas","fa-save","me-2"],[1,"btn","btn-red-glass",3,"click","disabled"],[1,"fas","fa-sign-out-alt","me-2"],["class","alert-custom alert-success-custom mt-3",4,"ngIf"],["class","card settings-card",4,"ngIf"],[1,"alert-custom","alert-success-custom","mt-3"],[1,"fas","fa-check-circle","me-2"],[1,"card","settings-card"],["class","text-center py-3",4,"ngIf"],[4,"ngIf"],[1,"text-center","py-3"],["role","status",1,"spinner-border","spinner-custom"],[1,"form-select","settings-select",3,"ngModelChange","change","ngModel"],["value","min"],["value","360p"],["value","480p"],["value","720p"],["value","1080p"],["value","2k"],["value","4k"],["value","max"],[3,"value"]],template:function(i,r){1&i&&(D(0,"div",0)(1,"h2",1),U(2,"i",2),P(3),T(),D(4,"div",3)(5,"div",4)(6,"h5",5),P(7),T()(),D(8,"div",6)(9,"div",7)(10,"label",8),P(11),T(),D(12,"input",9),Ci("ngModelChange",function(o){return Gi(r.serverUrl,o)||(r.serverUrl=o),o}),T(),D(13,"small",10),P(14),T()(),D(15,"div",7)(16,"label",8),P(17),T(),D(18,"input",11),Ci("ngModelChange",function(o){return Gi(r.accountToken,o)||(r.accountToken=o),o}),T(),D(19,"small",10),P(20),T()(),D(21,"div",12)(22,"button",13),j("click",function(){return r.saveConnection()}),U(23,"i",14),P(24),T(),D(25,"button",15),j("click",function(){return r.disconnect()}),U(26,"i",16),P(27),T()(),Y(28,cle,5,2,"div",17),T()(),Y(29,fle,7,3,"div",18),T()),2&i&&(E(3),de(" ",r.i18nStrings.pageTitle," "),E(4),Le(r.i18nStrings.serverConfig),E(4),Le(r.i18nStrings.serverUrl),E(),Di("ngModel",r.serverUrl),E(2),Le(r.i18nStrings.serverUrlHint),E(3),Le(r.i18nStrings.accountToken),E(),Di("ngModel",r.accountToken),R("placeholder",r.i18nStrings.accountTokenPlaceholder),E(2),Le(r.i18nStrings.accountTokenHint),E(2),R("disabled",r.saving),E(2),de(" ",r.saving?r.i18nStrings.btnSaving:r.i18nStrings.btnSaveConnect," "),E(),R("disabled",!r.isConnected),E(2),de(" ",r.i18nStrings.btnDisconnect," "),E(),R("ngIf",r.accountInfo),E(),R("ngIf",r.isConnected))},dependencies:[ci,WL,qL,ba,Yg,xd,cc],styles:[".page-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.5)}.settings-card[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:12px;overflow:hidden}.settings-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:#0d6efd1a;border-bottom:1px solid rgba(13,110,253,.2);padding:16px 20px}.settings-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#fff;font-weight:600}.settings-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background:transparent;padding:20px}.form-label[_ngcontent-%COMP%]{color:#ffffffe6;font-weight:500;margin-bottom:8px}.settings-input[_ngcontent-%COMP%], .settings-select[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.15);color:#fff;backdrop-filter:blur(10px);border-radius:8px;padding:10px 14px;transition:all .2s ease}.settings-input[_ngcontent-%COMP%]::placeholder{color:#fff6}.settings-input[_ngcontent-%COMP%]:focus, .settings-select[_ngcontent-%COMP%]:focus{background:#ffffff14;border-color:#0d6efd80;color:#fff;box-shadow:0 0 0 .25rem #0d6efd26;outline:0}.settings-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background:#1a1a1a;color:#fff}.text-muted-custom[_ngcontent-%COMP%]{color:#ffffff80;font-size:.875rem}.btn-blue-glass[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-blue-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #0d6efd66}.btn-blue-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-red-glass[_ngcontent-%COMP%]{background:#c6112026;border:1px solid rgba(198,17,32,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-red-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#c6112040;border-color:#c6112080;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #c6112066}.btn-red-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.spinner-custom[_ngcontent-%COMP%]{color:#0d6efdcc}.alert-custom[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:10px;padding:16px}.alert-success-custom[_ngcontent-%COMP%]{color:#198754;border-color:#1987544d;background:#1987541a}"]})}}return n})();function ple(n,t){1&n&&(D(0,"div",19),U(1,"i",20),P(2," Admin access granted "),T())}function gle(n,t){1&n&&(D(0,"div",35),U(1,"div",36),T())}function mle(n,t){1&n&&(D(0,"div",37),U(1,"i",38),P(2," No accounts found "),T())}function _le(n,t){if(1&n&&(D(0,"div"),P(1),T()),2&n){const e=A().$implicit;E(),de(" ",e.name," ")}}function vle(n,t){if(1&n){const e=Se();D(0,"input",49),Ci("ngModelChange",function(r){X(e);const s=A(4);return Gi(s.editingName,r)||(s.editingName=r),J(r)}),j("keyup.enter",function(){X(e);const r=A().$implicit;return J(A(3).saveEdit(r.id))}),T()}2&n&&Di("ngModel",A(4).editingName)}function yle(n,t){if(1&n){const e=Se();D(0,"div",50)(1,"button",51),j("click",function(){X(e);const r=A().$implicit;return J(A(3).startEdit(r))}),U(2,"i",52),T(),D(3,"button",53),j("click",function(){X(e);const r=A().$implicit;return J(A(3).deleteAccount(r.id))}),U(4,"i",54),T()()}}function ble(n,t){if(1&n){const e=Se();D(0,"div",50)(1,"button",55),j("click",function(){X(e);const r=A().$implicit;return J(A(3).saveEdit(r.id))}),U(2,"i",56),T(),D(3,"button",57),j("click",function(){return X(e),J(A(4).cancelEdit())}),U(4,"i",58),T()()}}function Ele(n,t){if(1&n){const e=Se();D(0,"tr")(1,"td"),Y(2,_le,2,1,"div",18)(3,vle,1,1,"input",43),T(),D(4,"td")(5,"code",44),P(6),T(),D(7,"button",45),j("click",function(){const r=X(e).$implicit;return J(A(3).copyToken(r.token))}),U(8,"i",46),T()(),D(9,"td")(10,"small",47),P(11),Wh(12,"date"),T()(),D(13,"td"),Y(14,yle,5,0,"div",48)(15,ble,5,0,"div",48),T()()}if(2&n){const e=t.$implicit,i=A(3);E(2),R("ngIf",i.editingId!==e.id),E(),R("ngIf",i.editingId===e.id),E(3),de("",e.token.substring(0,20),"..."),E(5),Le(ly(12,6,e.created_at,"short")),E(3),R("ngIf",i.editingId!==e.id),E(),R("ngIf",i.editingId===e.id)}}function Sle(n,t){if(1&n&&(D(0,"div",39)(1,"table",40)(2,"thead")(3,"tr",41)(4,"th"),P(5,"Name"),T(),D(6,"th"),P(7,"Token"),T(),D(8,"th"),P(9,"Created"),T(),D(10,"th"),P(11,"Actions"),T()()(),D(12,"tbody"),Y(13,Ele,16,9,"tr",42),T()()()),2&n){const e=A(2);E(13),R("ngForOf",e.accounts)}}function Tle(n,t){if(1&n){const e=Se();D(0,"div")(1,"div",3)(2,"div",4)(3,"h5",5),P(4,"Create New Account"),T()(),D(5,"div",6)(6,"div",21)(7,"div",22)(8,"input",23),Ci("ngModelChange",function(r){X(e);const s=A();return Gi(s.newAccountName,r)||(s.newAccountName=r),J(r)}),T()(),D(9,"div",24)(10,"button",25),j("click",function(){return X(e),J(A().createAccount())}),U(11,"i",26),P(12),T()()()()(),D(13,"div",27)(14,"div",28)(15,"h5",5),P(16,"Accounts"),T(),D(17,"button",29),j("click",function(){return X(e),J(A().loadAccounts())}),U(18,"i",30),P(19," Refresh "),T()(),D(20,"div",31),Y(21,gle,2,0,"div",32)(22,mle,3,0,"div",33)(23,Sle,14,1,"div",34),T()()()}if(2&n){const e=A();E(8),Di("ngModel",e.newAccountName),E(2),R("disabled",!e.newAccountName||e.creating),E(2),de(" ",e.creating?"Creating...":"Create"," "),E(9),R("ngIf",e.loading),E(),R("ngIf",!e.loading&&0===e.accounts.length),E(),R("ngIf",!e.loading&&e.accounts.length>0)}}let Dle=(()=>{class n{constructor(e,i,r){this.api=e,this.auth=i,this.toast=r,this.serverUrl="http://localhost:3000",this.adminToken="",this.isAdmin=!1,this.accounts=[],this.loading=!1,this.creating=!1,this.newAccountName="",this.editingId=null,this.editingName=""}ngOnInit(){var e=this.auth.getServerUrl();e&&(this.serverUrl=e);var i=this.auth.getAdminToken();i&&(this.adminToken=i,this.isAdmin=!0,this.loadAccounts())}saveAdminToken(){this.serverUrl?(this.auth.setServerUrl(this.serverUrl),this.adminToken?(this.auth.setAdminToken(this.adminToken),this.api.getAccounts().subscribe({next:()=>{this.isAdmin=!0,this.toast.success("Admin access granted"),this.loadAccounts()},error:()=>{this.auth.clearAdminToken(),this.isAdmin=!1,this.adminToken=""}})):this.toast.error("Please enter admin token")):this.toast.error("Please enter server URL")}adminLogout(){this.auth.clearAdminToken(),this.adminToken="",this.isAdmin=!1,this.accounts=[],this.toast.info("Admin logged out")}loadAccounts(){this.loading=!0,this.api.getAccounts().subscribe({next:e=>{this.accounts=e?.accounts||[],this.loading=!1},error:()=>{this.loading=!1}})}createAccount(){this.newAccountName?(this.creating=!0,this.api.createAccount(this.newAccountName).subscribe({next:e=>{this.toast.success("Account created successfully"),this.newAccountName="",this.creating=!1,this.loadAccounts(),this.toast.info("Token: "+e.token)},error:()=>{this.creating=!1}})):this.toast.error("Please enter account name")}startEdit(e){this.editingId=e.id,this.editingName=e.name}saveEdit(e){this.editingName?this.api.updateAccount(e,this.editingName).subscribe({next:()=>{this.toast.success("Account updated"),this.editingId=null,this.editingName="",this.loadAccounts()}}):this.toast.error("Name cannot be empty")}cancelEdit(){this.editingId=null,this.editingName=""}deleteAccount(e){confirm("Are you sure you want to delete this account?")&&this.api.deleteAccount(e).subscribe({next:()=>{this.toast.success("Account deleted"),this.loadAccounts()}})}copyToken(e){navigator.clipboard.writeText(e).then(()=>{this.toast.success("Token copied to clipboard")}).catch(()=>{this.toast.error("Failed to copy token")})}static{this.\u0275fac=function(i){return new(i||n)(F(Kr),F(ud),F(ju))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-manage"]],standalone:!1,decls:28,vars:7,consts:[[1,"container"],[1,"mb-4","page-title","text-no-select",2,"margin-left","48px"],[1,"fas","fa-users-cog","me-2"],[1,"card","settings-card","mb-4"],[1,"card-header"],[1,"mb-0","text-no-select"],[1,"card-body"],[1,"mb-3"],[1,"form-label","text-no-select"],["type","text","placeholder","http://localhost:3000",1,"form-control","settings-input",3,"ngModelChange","ngModel"],[1,"form-text","text-muted-custom","text-no-select"],["type","password","placeholder","Enter admin token",1,"form-control","settings-input",3,"ngModelChange","ngModel","disabled"],[1,"d-flex","gap-2"],[1,"btn","btn-blue-glass",3,"click","disabled"],[1,"fas","fa-save","me-2"],[1,"btn","btn-red-glass",3,"click","disabled"],[1,"fas","fa-sign-out-alt","me-2"],["class","alert-custom alert-success-custom mt-3",4,"ngIf"],[4,"ngIf"],[1,"alert-custom","alert-success-custom","mt-3"],[1,"fas","fa-check-circle","me-2"],[1,"row","g-2"],[1,"col"],["type","text","placeholder","Account name",1,"form-control","settings-input",3,"ngModelChange","ngModel"],[1,"col-auto"],[1,"btn","btn-success-glass",3,"click","disabled"],[1,"fas","fa-plus","me-2"],[1,"card","settings-card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-glass",3,"click"],[1,"fas","fa-sync","me-1"],[1,"card-body","p-0"],["class","text-center py-3",4,"ngIf"],["class","alert-custom alert-info-custom",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"text-center","py-3"],["role","status",1,"spinner-border","spinner-custom"],[1,"alert-custom","alert-info-custom"],[1,"fas","fa-info-circle","me-2"],[1,"table-responsive"],[1,"table","table-dark-glass"],[1,"text-no-select"],[4,"ngFor","ngForOf"],["type","text","class","form-control form-control-sm settings-input",3,"ngModel","ngModelChange","keyup.enter",4,"ngIf"],[1,"token-code"],["title","Copy token",1,"btn","btn-sm","btn-glass-icon","ms-2",3,"click"],[1,"fas","fa-copy"],[1,"text-muted-custom"],["class","btn-group btn-group-sm",4,"ngIf"],["type","text",1,"form-control","form-control-sm","settings-input",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn-group","btn-group-sm"],[1,"btn","btn-blue-glass",3,"click"],[1,"fas","fa-edit"],[1,"btn","btn-red-glass",3,"click"],[1,"fas","fa-trash"],[1,"btn","btn-success-glass",3,"click"],[1,"fas","fa-check"],[1,"btn","btn-glass",3,"click"],[1,"fas","fa-times"]],template:function(i,r){1&i&&(D(0,"div",0)(1,"h2",1),U(2,"i",2),P(3," Manage Accounts "),T(),D(4,"div",3)(5,"div",4)(6,"h5",5),P(7,"Admin Authentication"),T()(),D(8,"div",6)(9,"div",7)(10,"label",8),P(11,"Server URL"),T(),D(12,"input",9),Ci("ngModelChange",function(o){return Gi(r.serverUrl,o)||(r.serverUrl=o),o}),T(),D(13,"small",10),P(14,"Ekydum server URL"),T()(),D(15,"div",7)(16,"label",8),P(17,"Admin Token"),T(),D(18,"input",11),Ci("ngModelChange",function(o){return Gi(r.adminToken,o)||(r.adminToken=o),o}),T()(),D(19,"div",12)(20,"button",13),j("click",function(){return r.saveAdminToken()}),U(21,"i",14),P(22," Save & Login "),T(),D(23,"button",15),j("click",function(){return r.adminLogout()}),U(24,"i",16),P(25," Admin Logout "),T()(),Y(26,ple,3,0,"div",17),T()(),Y(27,Tle,24,6,"div",18),T()),2&i&&(E(12),Di("ngModel",r.serverUrl),E(6),Di("ngModel",r.adminToken),R("disabled",r.isAdmin),E(2),R("disabled",r.isAdmin||!r.adminToken),E(3),R("disabled",!r.isAdmin),E(3),R("ngIf",r.isAdmin),E(),R("ngIf",r.isAdmin))},dependencies:[vr,ci,ba,xd,cc,By],styles:[".page-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.5)}.settings-card[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:12px;overflow:hidden}.settings-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:#0d6efd1a;border-bottom:1px solid rgba(13,110,253,.2);padding:16px 20px}.settings-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#fff;font-weight:600}.settings-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background:transparent;padding:20px}.form-label[_ngcontent-%COMP%]{color:#ffffffe6;font-weight:500;margin-bottom:8px}.settings-input[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.15);color:#fff;backdrop-filter:blur(10px);border-radius:8px;padding:10px 14px;transition:all .2s ease}.settings-input[_ngcontent-%COMP%]::placeholder{color:#fff6}.settings-input[_ngcontent-%COMP%]:focus{background:#ffffff14;border-color:#0d6efd80;color:#fff;box-shadow:0 0 0 .25rem #0d6efd26;outline:0}.settings-input[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.text-muted-custom[_ngcontent-%COMP%]{color:#ffffff80;font-size:.875rem}.btn-glass[_ngcontent-%COMP%]{background:#ffffff14;border:1px solid rgba(255,255,255,.15);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease}.btn-glass[_ngcontent-%COMP%]:hover{background:#ffffff26;border-color:#ffffff40;color:#fff;transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.btn-glass-icon[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);color:#ffffffb3;backdrop-filter:blur(10px);transition:all .2s ease;padding:4px 8px}.btn-glass-icon[_ngcontent-%COMP%]:hover{background:#ffffff1a;border-color:#fff3;color:#fff}.btn-blue-glass[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-blue-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #0d6efd66}.btn-blue-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-red-glass[_ngcontent-%COMP%]{background:#c6112026;border:1px solid rgba(198,17,32,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-red-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#c6112040;border-color:#c6112080;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #c6112066}.btn-red-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-success-glass[_ngcontent-%COMP%]{background:#19875426;border:1px solid rgba(25,135,84,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-success-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#19875440;border-color:#19875480;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #19875466}.btn-success-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.table-dark-glass[_ngcontent-%COMP%]{--bs-table-bg: transparent;--bs-table-striped-bg: rgba(0, 0, 0, .2);--bs-table-hover-bg: rgba(13, 110, 253, .1);color:#fff;margin-bottom:0;overflow:hidden}.table-dark-glass[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#0d6efd26;border-bottom:1px solid rgba(13,110,253,.3);color:#fff;font-weight:600;padding:12px}.table-dark-glass[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{background:transparent}.table-dark-glass[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#0000004d!important;border-bottom:1px solid rgba(255,255,255,.05);transition:all .2s ease}.table-dark-glass[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#0d6efd1a!important;transform:scale(1.01)}.table-dark-glass[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;vertical-align:middle;color:#ffffffe6}.token-code[_ngcontent-%COMP%]{background:#0006;border:1px solid rgba(255,255,255,.1);color:#0dcaf0e6;padding:4px 8px;border-radius:4px;font-size:.875rem;font-family:Courier New,monospace}.spinner-custom[_ngcontent-%COMP%]{color:#0d6efdcc}.alert-custom[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:10px;padding:16px}.alert-success-custom[_ngcontent-%COMP%]{color:#198754;border-color:#1987544d;background:#1987541a}.alert-info-custom[_ngcontent-%COMP%]{color:#0dcaf0e6;border-color:#0dcaf04d;background:#0dcaf01a}"]})}}return n})(),Cle=(()=>{class n{constructor(){this.searchQuery="",this.lastSearchQuery="",this.videos=[],this.searched=!1,this.currentOffset=0,this.pageSize=20}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Ile(n,t){if(1&n&&(D(0,"div",13),U(1,"div",14),D(2,"p",15),P(3),T()()),2&n){const e=A();E(3),Le(e.i18nStrings.searching)}}function wle(n,t){if(1&n&&(D(0,"div",16),U(1,"i",17),P(2),T()),2&n){const e=A();E(2),ty(" ",e.i18nStrings.noResults,' "',e.st.lastSearchQuery,'". ',e.i18nStrings.tryDifferent," ")}}function xle(n,t){if(1&n){const e=Se();D(0,"div",25)(1,"app-video-item",26),j("videoClick",function(r){return X(e),J(A(2).watchVideo(r))})("addToQueue",function(r){return X(e),J(A(2).addToQueue(r))})("addToWatchLater",function(r){return X(e),J(A(2).addToWatchLater(r))}),T()()}if(2&n){const e=t.$implicit;E(),R("video",e)("showMetadata",!0)}}function Ale(n,t){if(1&n){const e=Se();D(0,"div",18)(1,"div",19)(2,"p",20),U(3,"i",21),P(4),T(),D(5,"button",22),j("click",function(){return X(e),J(A().playAllVideos())}),U(6,"i",23),P(7),T()(),Y(8,xle,2,2,"div",24),T()}if(2&n){const e=A();E(4),ny(" ",e.i18nStrings.foundVideos," ",e.st.videos.length," ",e.i18nStrings.videosFor,' "',e.st.lastSearchQuery,'" '),E(3),de(" ",e.i18nStrings.playAll," "),E(),R("ngForOf",e.st.videos)}}function Mle(n,t){if(1&n&&(D(0,"span"),U(1,"i",30),P(2),T()),2&n){const e=A(2);E(2),de(" ",e.i18nStrings.loadMore," ")}}function Rle(n,t){if(1&n&&(D(0,"span"),U(1,"span",31),P(2),T()),2&n){const e=A(2);E(2),de(" ",e.i18nStrings.loading," ")}}function kle(n,t){if(1&n){const e=Se();D(0,"div",27)(1,"button",28),j("click",function(){return X(e),J(A().loadMore())}),Y(2,Mle,3,1,"span",29)(3,Rle,3,1,"span",29),T()()}if(2&n){const e=A();E(),R("disabled",e.loadingMore),E(),R("ngIf",!e.loadingMore),E(),R("ngIf",e.loadingMore)}}let Ole=(()=>{class n{constructor(e,i,r,s){this.api=e,this.st=i,this.playerService=r,this.i18nService=s,this.i18nDict=qi_search,this.i18nStrings={},this.loading=!1,this.loadingMore=!1,this.alive$=new ke,this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(o=>{this.i18nStrings=o})).subscribe()}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}search(){this.st.searchQuery.trim()&&(this.loading=!0,this.st.lastSearchQuery=this.st.searchQuery,this.st.currentOffset=0,this.api.searchVideos(this.st.searchQuery,0,this.st.pageSize).subscribe({next:e=>{this.st.videos=e?.videos||[],this.loading=!1,this.st.searched=!0},error:()=>{this.loading=!1,this.st.searched=!0,this.st.videos=[]}}))}loadMore(){this.loadingMore=!0,this.st.currentOffset+=this.st.pageSize,this.api.searchVideos(this.st.lastSearchQuery,this.st.currentOffset,this.st.pageSize).subscribe({next:e=>{this.st.videos=[...this.st.videos,...e?.videos||[]],this.loadingMore=!1},error:()=>{this.loadingMore=!1,this.st.currentOffset-=this.st.pageSize}})}watchVideo(e){this.playerService.playVideo(e)}addToWatchLater(e){this.api.addWatchLater(e.yt_video_id||e.yt_id||"",e.title,e.thumbnail||"",e.duration,e.channel_id,e.channel_name).subscribe()}playAllVideos(){this.playerService.queueSet(this.st.videos)}addToQueue(e){this.playerService.queueAdd(e)}static{this.\u0275fac=function(i){return new(i||n)(F(Kr),F(Cle),F(lo),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-search"]],standalone:!1,decls:16,vars:10,consts:[[1,"container-fluid"],[1,"d-flex","align-items-center","mb-4"],[1,"mb-0","page-title","text-no-select",2,"margin-left","48px"],[1,"fas","fa-search","me-2"],[1,"row","mb-4"],[1,"col-md-8","col-lg-6","mx-auto"],[1,"input-group","input-group-lg","search-group"],["type","text",1,"form-control","search-input",3,"ngModelChange","keyup.enter","placeholder","ngModel","disabled"],["type","button",1,"btn","btn-blue-glass",3,"click","disabled"],["class","text-center py-5",4,"ngIf"],["class","alert-custom alert-info-custom text-center",4,"ngIf"],["class","row",4,"ngIf"],["class","text-center mt-4",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","spinner-custom"],[1,"mt-3","text-light"],[1,"alert-custom","alert-info-custom","text-center"],[1,"fas","fa-info-circle","me-2"],[1,"row"],[1,"col-12","mb-3","d-flex","justify-content-between","align-items-center"],[1,"text-info","mb-0"],[1,"fas","fa-video","me-2"],[1,"btn","btn-blue-glass",3,"click"],[1,"fas","fa-play","me-2"],["class","col-md-6 col-lg-4 col-xl-3 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-4","col-xl-3","mb-4"],[3,"videoClick","addToQueue","addToWatchLater","video","showMetadata"],[1,"text-center","mt-4"],[1,"btn","btn-blue-glass",3,"click","disabled"],[4,"ngIf"],[1,"fas","fa-chevron-down","me-2"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(i,r){1&i&&(D(0,"div",0)(1,"div",1)(2,"h2",2),U(3,"i",3),P(4),T()(),D(5,"div",4)(6,"div",5)(7,"div",6)(8,"input",7),Ci("ngModelChange",function(o){return Gi(r.st.searchQuery,o)||(r.st.searchQuery=o),o}),j("keyup.enter",function(){return r.search()}),T(),D(9,"button",8),j("click",function(){return r.search()}),U(10,"i",3),P(11),T()()()(),Y(12,Ile,4,1,"div",9)(13,wle,3,3,"div",10)(14,Ale,9,6,"div",11)(15,kle,4,3,"div",12),T()),2&i&&(E(4),de(" ",r.i18nStrings.pageTitle," "),E(4),R("placeholder",r.i18nStrings.inputPlaceholder),Di("ngModel",r.st.searchQuery),R("disabled",r.loading),E(),R("disabled",r.loading||!r.st.searchQuery.trim()),E(2),de(" ",r.i18nStrings.btnSearch," "),E(),R("ngIf",r.loading),E(),R("ngIf",!r.loading&&r.st.searched&&0===r.st.videos.length),E(),R("ngIf",!r.loading&&r.st.videos.length>0),E(),R("ngIf",r.st.videos.length>0&&!r.loading))},dependencies:[vr,ci,ba,xd,cc,Hd],styles:[".page-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.5)}.search-group[_ngcontent-%COMP%]{box-shadow:0 8px 32px #0006}.search-input[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.15);color:#fff;backdrop-filter:blur(20px);border-radius:12px 0 0 12px;padding:12px 20px;transition:all .2s ease}.search-input[_ngcontent-%COMP%]::placeholder{color:#fff6}.search-input[_ngcontent-%COMP%]:focus{background:#1a1a1ae6;border-color:#0d6efd80;color:#fff;box-shadow:0 0 0 .25rem #0d6efd26;outline:0}.search-input[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-blue-glass[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600;border-radius:0 12px 12px 0;padding:12px 24px}.btn-blue-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #0d6efd66}.btn-blue-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.spinner-custom[_ngcontent-%COMP%]{color:#0d6efdcc}.text-light[_ngcontent-%COMP%]{color:#ffffffb3!important}.alert-custom[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:10px;padding:16px;margin-bottom:20px}.alert-info-custom[_ngcontent-%COMP%]{color:#0dcaf0e6;border-color:#0dcaf04d;background:#0dcaf01a}.text-info[_ngcontent-%COMP%]{color:#ffffffb3!important}"]})}}return n})();function Nle(n,t){1&n&&(D(0,"div",3),U(1,"div",4),T())}function Ple(n,t){if(1&n&&(D(0,"div",16),U(1,"i",17),P(2),T()),2&n){const e=A(2);E(2),de(" ",e.i18nStrings.noVideos," ")}}function Lle(n,t){if(1&n){const e=Se();D(0,"div",20)(1,"app-video-item",21),j("videoClick",function(r){return X(e),J(A(3).watchVideo(r))})("addToQueue",function(r){return X(e),J(A(3).addToQueue(r))})("addToWatchLater",function(r){return X(e),J(A(3).addToWatchLater(r))}),T()()}if(2&n){const e=t.$implicit;E(),R("video",e)("showMetadata",!0)}}function Fle(n,t){if(1&n&&(D(0,"div",18),Y(1,Lle,2,2,"div",19),T()),2&n){const e=A(2);E(),R("ngForOf",e.videos)}}function Ble(n,t){if(1&n&&(D(0,"span"),U(1,"i",24),P(2),T()),2&n){const e=A(3);E(2),de(" ",e.i18nStrings.loadMore," ")}}function Ule(n,t){if(1&n&&(D(0,"span"),U(1,"span",25),P(2),T()),2&n){const e=A(3);E(2),de(" ",e.i18nStrings.loading," ")}}function $le(n,t){if(1&n){const e=Se();D(0,"div",22)(1,"button",23),j("click",function(){return X(e),J(A(2).loadMore())}),Y(2,Ble,3,1,"span",2)(3,Ule,3,1,"span",2),T()()}if(2&n){const e=A(2);E(),R("disabled",e.loadingMore),E(),R("ngIf",!e.loadingMore),E(),R("ngIf",e.loadingMore)}}function Vle(n,t){if(1&n){const e=Se();D(0,"div")(1,"div",5)(2,"h2",6),U(3,"i",7),P(4),T(),U(5,"div",8),D(6,"button",9),j("click",function(){return X(e),J(A().playAllVideos())}),U(7,"i",10),P(8),T(),D(9,"button",11),j("click",function(){return X(e),J(A().goBack())}),U(10,"i",12),T()(),Y(11,Ple,3,1,"div",13)(12,Fle,2,1,"div",14)(13,$le,4,3,"div",15),T()}if(2&n){const e=A();E(4),de(" ",e.playlistTitle||e.i18nStrings.defaultTitle," "),E(2),R("disabled",0===e.videos.length),E(2),de(" ",e.i18nStrings.playAll," "),E(3),R("ngIf",0===e.videos.length&&!e.loading),E(),R("ngIf",e.videos.length>0),E(),R("ngIf",e.videos.length>0&&!e.loading)}}let jle=(()=>{class n{constructor(e,i,r,s,o){this.route=e,this.router=i,this.api=r,this.playerService=s,this.i18nService=o,this.i18nDict=qi_playlist,this.i18nStrings={},this.playlistId="",this.playlistTitle="",this.videos=[],this.loading=!1,this.loadingMore=!1,this.currentPage=1,this.alive$=new ke;var a=this.router.getCurrentNavigation();a?.extras?.state&&(this.playlistTitle=a.extras.state.title||"")}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(e=>{this.i18nStrings=e})).subscribe(),this.playlistId=this.route.snapshot.paramMap.get("id")||"",this.playlistId&&this.loadVideos()}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}loadVideos(){this.loading=!0,this.api.getPlaylistVideos(this.playlistId,this.currentPage).subscribe({next:e=>{this.videos=(e?.items||[]).map(i=>this.mapToVideoItemData(i)),this.loading=!1},error:()=>{this.loading=!1}})}loadMore(){this.loadingMore=!0,this.currentPage++,this.api.getPlaylistVideos(this.playlistId,this.currentPage).subscribe({next:e=>{var i=(e?.items||[]).map(r=>this.mapToVideoItemData(r));this.videos=[...this.videos,...i],this.loadingMore=!1},error:()=>{this.loadingMore=!1,this.currentPage--}})}watchVideo(e){this.playerService.playVideo(e)}addToWatchLater(e){this.api.addWatchLater(e.yt_video_id||e.yt_id||"",e.title,e.thumbnail||"",e.duration,e.channel_id,e.channel_name).subscribe()}playAllVideos(){this.playerService.queueSet(this.videos)}addToQueue(e){this.playerService.queueAdd(e)}goBack(){window.history.back()}mapToVideoItemData(e){return{yt_id:e.yt_id,yt_video_id:e.yt_id,title:e.title,thumbnail:e.thumbnail,duration:e.duration,view_count:e.view_count,channel_name:e.channel_name,channel_id:e.channel_id,upload_date:e.upload_date}}static{this.\u0275fac=function(i){return new(i||n)(F(da),F(Yn),F(Kr),F(lo),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-playlist"]],standalone:!1,decls:3,vars:2,consts:[[1,"container-fluid"],["class","text-center py-5",4,"ngIf"],[4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","spinner-custom"],[1,"d-flex","align-items-center","mb-4"],[1,"mb-0","page-title",2,"margin-left","48px"],[1,"fas","fa-list","me-2"],[1,"d-flex","flex-row","flex-grow-1"],[1,"btn","btn-blue-glass","me-2",3,"click","disabled"],[1,"fas","fa-play","me-2"],[1,"btn","btn-glass","me-3",3,"click"],[1,"fas","fa-arrow-left"],["class","alert-custom alert-info-custom",4,"ngIf"],["class","row",4,"ngIf"],["class","text-center mt-4",4,"ngIf"],[1,"alert-custom","alert-info-custom"],[1,"fas","fa-info-circle","me-2"],[1,"row"],["class","col-md-6 col-lg-4 col-xl-3 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-4","col-xl-3","mb-4"],[3,"videoClick","addToQueue","addToWatchLater","video","showMetadata"],[1,"text-center","mt-4"],[1,"btn","btn-blue-glass",3,"click","disabled"],[1,"fas","fa-chevron-down","me-2"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(i,r){1&i&&(D(0,"div",0),Y(1,Nle,2,0,"div",1)(2,Vle,14,6,"div",2),T()),2&i&&(E(),R("ngIf",r.loading),E(),R("ngIf",!r.loading))},dependencies:[vr,ci,Hd],styles:[".page-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.5)}.btn-glass[_ngcontent-%COMP%]{background:#ffffff14;border:1px solid rgba(255,255,255,.15);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease}.btn-glass[_ngcontent-%COMP%]:hover{background:#ffffff26;border-color:#ffffff40;color:#fff;transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.btn-blue-glass[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-blue-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #0d6efd66}.btn-blue-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.spinner-custom[_ngcontent-%COMP%]{color:#0d6efdcc}.alert-custom[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:10px;padding:16px;margin-bottom:20px}.alert-info-custom[_ngcontent-%COMP%]{color:#0dcaf0e6;border-color:#0dcaf04d;background:#0dcaf01a}"]})}}return n})();function Hle(n,t){1&n&&(D(0,"div",10),U(1,"div",11),T())}function Gle(n,t){if(1&n&&(D(0,"div",12),U(1,"i",13),P(2),T()),2&n){const e=A();E(2),de(" ",e.i18nStrings.noStarred," ")}}function zle(n,t){if(1&n){const e=Se();D(0,"div",16)(1,"app-video-item",17),j("videoClick",function(r){return X(e),J(A(2).watchVideo(r))})("addToQueue",function(r){return X(e),J(A(2).addToQueue(r))})("addToWatchLater",function(r){return X(e),J(A(2).addToWatchLater(r))}),D(2,"button",18),j("click",function(){const r=X(e).$implicit;return J(A(2).removeStar(r.yt_video_id))}),U(3,"i",19),P(4),T()()()}if(2&n){const e=t.$implicit,i=A(2);E(),R("video",e)("showWatchLaterButton",!0)("showQueueButton",!0),E(3),de(" ",i.i18nStrings.btnRemove," ")}}function Wle(n,t){if(1&n&&(D(0,"div",14),Y(1,zle,5,4,"div",15),T()),2&n){const e=A();E(),R("ngForOf",e.videos)}}let Kle=(()=>{class n{constructor(e,i,r,s){this.router=e,this.api=i,this.playerService=r,this.i18nService=s,this.i18nDict=qi_starred,this.i18nStrings={},this.videos=[],this.loading=!1,this.alive$=new ke}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(e=>{this.i18nStrings=e})).subscribe(),this.loadStarred()}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}loadStarred(){this.loading=!0,this.api.getStarred().subscribe({next:e=>{this.videos=e?.videos||[],this.loading=!1},error:()=>{this.loading=!1}})}watchVideo(e){this.playerService.playVideo(e)}addToWatchLater(e){this.api.addWatchLater(e.yt_video_id||e.yt_id||"",e.title,e.thumbnail||"",e.duration,e.channel_id,e.channel_name).subscribe()}playAllVideos(){this.playerService.queueSet(this.videos)}addToQueue(e){this.playerService.queueAdd(e)}removeStar(e){this.api.removeStarred(e).subscribe({next:()=>{this.videos=this.videos.filter(i=>i.yt_video_id!==e)}})}static{this.\u0275fac=function(i){return new(i||n)(F(Yn),F(Kr),F(lo),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-starred"]],standalone:!1,decls:12,vars:6,consts:[[1,"container-fluid"],[1,"d-flex","align-items-center","mb-4"],[1,"mb-0","page-title","text-no-select",2,"margin-left","48px"],[1,"fas","fa-star","me-2"],[1,"d-flex","flex-row","flex-grow-1"],[1,"btn","btn-blue-glass","me-3",3,"click","disabled"],[1,"fas","fa-play","me-2"],["class","text-center py-5",4,"ngIf"],["class","alert-custom alert-info-custom text-center",4,"ngIf"],["class","row",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","spinner-custom"],[1,"alert-custom","alert-info-custom","text-center"],[1,"fas","fa-info-circle","me-2"],[1,"row"],["class","col-md-6 col-lg-4 col-xl-3 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-4","col-xl-3","mb-4"],[3,"videoClick","addToQueue","addToWatchLater","video","showWatchLaterButton","showQueueButton"],[1,"btn","btn-sm","btn-red-glass","w-100","mt-2",3,"click"],[1,"fas","fa-star","me-1"]],template:function(i,r){1&i&&(D(0,"div",0)(1,"div",1)(2,"h2",2),U(3,"i",3),P(4),T(),U(5,"div",4),D(6,"button",5),j("click",function(){return r.playAllVideos()}),U(7,"i",6),P(8),T()(),Y(9,Hle,2,0,"div",7)(10,Gle,3,1,"div",8)(11,Wle,2,1,"div",9),T()),2&i&&(E(4),de(" ",r.i18nStrings.pageTitle," "),E(2),R("disabled",0===r.videos.length),E(2),de(" ",r.i18nStrings.playAll," "),E(),R("ngIf",r.loading),E(),R("ngIf",!r.loading&&0===r.videos.length),E(),R("ngIf",!r.loading&&r.videos.length>0))},dependencies:[vr,ci,Hd],styles:[".page-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.5)}.btn-blue-glass[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-blue-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #0d6efd66}.btn-blue-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-red-glass[_ngcontent-%COMP%]{background:#c6112026;border:1px solid rgba(198,17,32,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-red-glass[_ngcontent-%COMP%]:hover{background:#c6112040;border-color:#c6112080;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #c6112066}.spinner-custom[_ngcontent-%COMP%]{color:#0d6efdcc}.alert-custom[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:10px;padding:16px;margin-bottom:20px}.alert-info-custom[_ngcontent-%COMP%]{color:#0dcaf0e6;border-color:#0dcaf04d;background:#0dcaf01a}"]})}}return n})();function qle(n,t){1&n&&(D(0,"div",10),U(1,"div",11),T())}function Yle(n,t){if(1&n&&(D(0,"div",12),U(1,"i",13),P(2),T()),2&n){const e=A();E(2),de(" ",e.i18nStrings.noVideos," ")}}function Qle(n,t){if(1&n){const e=Se();D(0,"div",16)(1,"app-video-item",17),j("videoClick",function(r){return X(e),J(A(2).watchVideo(r))})("addToQueue",function(r){return X(e),J(A(2).addToQueue(r))}),D(2,"button",18),j("click",function(){const r=X(e).$implicit;return J(A(2).remove(r.yt_video_id))}),U(3,"i",19),P(4),T()()()}if(2&n){const e=t.$implicit,i=A(2);E(),R("video",e)("showWatchLaterButton",!1)("showQueueButton",!0),E(3),de(" ",i.i18nStrings.btnRemove," ")}}function Zle(n,t){if(1&n&&(D(0,"div",14),Y(1,Qle,5,4,"div",15),T()),2&n){const e=A();E(),R("ngForOf",e.videos)}}const Xle=[{path:"",redirectTo:"/subscriptions",pathMatch:"full"},{path:"search",component:Ole},{path:"subscriptions",component:Nae},{path:"starred",component:Kle},{path:"watch-later",component:(()=>{class n{constructor(e,i,r,s){this.router=e,this.api=i,this.playerService=r,this.i18nService=s,this.i18nDict=qi_watchLater,this.i18nStrings={},this.videos=[],this.loading=!1,this.alive$=new ke}ngOnInit(){this.i18nService.translate(this.i18nDict).pipe(Oe(this.alive$),et(e=>{this.i18nStrings=e})).subscribe(),this.loadWatchLater()}ngOnDestroy(){this.alive$.next(),this.alive$.complete()}loadWatchLater(){this.loading=!0,this.api.getWatchLater().subscribe({next:e=>{this.videos=e?.videos||[],this.loading=!1},error:()=>{this.loading=!1}})}watchVideo(e){this.playerService.playVideo(e)}playAllVideos(){this.playerService.queueSet(this.videos)}addToQueue(e){this.playerService.queueAdd(e)}remove(e){this.api.removeWatchLater(e).subscribe({next:()=>{this.videos=this.videos.filter(i=>i.yt_video_id!==e)}})}static{this.\u0275fac=function(i){return new(i||n)(F(Yn),F(Kr),F(lo),F(Ji))}}static{this.\u0275cmp=Rt({type:n,selectors:[["app-watch-later"]],standalone:!1,decls:12,vars:6,consts:[[1,"container-fluid"],[1,"d-flex","align-items-center","mb-4"],[1,"mb-0","page-title","text-no-select",2,"margin-left","48px"],[1,"fas","fa-clock","me-2"],[1,"d-flex","flex-row","flex-grow-1"],[1,"btn","btn-blue-glass","me-3",3,"click","disabled"],[1,"fas","fa-play","me-2"],["class","text-center py-5",4,"ngIf"],["class","alert-custom alert-info-custom text-center",4,"ngIf"],["class","row",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","spinner-custom"],[1,"alert-custom","alert-info-custom","text-center"],[1,"fas","fa-info-circle","me-2"],[1,"row"],["class","col-md-6 col-lg-4 col-xl-3 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-4","col-xl-3","mb-4"],[3,"videoClick","addToQueue","video","showWatchLaterButton","showQueueButton"],[1,"btn","btn-sm","btn-red-glass","w-100","mt-2",3,"click"],[1,"fas","fa-clock","me-1"]],template:function(i,r){1&i&&(D(0,"div",0)(1,"div",1)(2,"h2",2),U(3,"i",3),P(4),T(),U(5,"div",4),D(6,"button",5),j("click",function(){return r.playAllVideos()}),U(7,"i",6),P(8),T()(),Y(9,qle,2,0,"div",7)(10,Yle,3,1,"div",8)(11,Zle,2,1,"div",9),T()),2&i&&(E(4),de(" ",r.i18nStrings.pageTitle," "),E(2),R("disabled",0===r.videos.length),E(2),de(" ",r.i18nStrings.playAll," "),E(),R("ngIf",r.loading),E(),R("ngIf",!r.loading&&0===r.videos.length),E(),R("ngIf",!r.loading&&r.videos.length>0))},dependencies:[vr,ci,Hd],styles:[".page-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.5)}.btn-blue-glass[_ngcontent-%COMP%]{background:#0d6efd26;border:1px solid rgba(13,110,253,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-blue-glass[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d6efd40;border-color:#0d6efd80;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #0d6efd66}.btn-blue-glass[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-red-glass[_ngcontent-%COMP%]{background:#c6112026;border:1px solid rgba(198,17,32,.3);color:#fff;backdrop-filter:blur(10px);transition:all .2s ease;font-weight:600}.btn-red-glass[_ngcontent-%COMP%]:hover{background:#c6112040;border-color:#c6112080;color:#fff;transform:translateY(-2px);box-shadow:0 4px 16px #c6112066}.spinner-custom[_ngcontent-%COMP%]{color:#0d6efdcc}.alert-custom[_ngcontent-%COMP%]{background:#1a1a1acc;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(20px);border-radius:10px;padding:16px;margin-bottom:20px}.alert-info-custom[_ngcontent-%COMP%]{color:#0dcaf0e6;border-color:#0dcaf04d;background:#0dcaf01a}"]})}}return n})()},{path:"channel/:id",component:lle},{path:"playlist/:id",component:jle},{path:"settings",component:hle},{path:"manage",component:Dle}];let Jle=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=bt({type:n,bootstrap:[Tae]})}static{this.\u0275inj=dt({providers:[E7()],imports:[NM,aQ.forRoot(Xle),UK,Hne,Hoe]})}}return n})();BK().bootstrapModule(Jle).catch(n=>console.error(n))}},Us=>{var mi=Ft=>Us(Us.s=Ft);mi(532),mi(867)}]);