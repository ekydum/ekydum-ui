<div class="app-container">
  <button class="navbar-toggle" [class.sidebar-collapsed]="sidebarCollapsed" (click)="toggleSidebar()">
    <i class="fas" [class.fa-bars]="sidebarCollapsed" [class.fa-times]="!sidebarCollapsed"></i>
  </button>

  <nav class="sidebar" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-header">
      <img src="/appicon/favicon-32x32.png" alt="" class="logo me-1" width="28" height="28">
      <div class="app-name">Ekydum</div>
    </div>

    <ul class="sidebar-menu">
      <li>
        <a class="menu-item" routerLink="/search" routerLinkActive="active" (click)="closeSidebarOnMobile()">
          <i class="fas fa-search"></i>
          Search
        </a>
      </li>
      <li>
        <a class="menu-item" routerLink="/subscriptions" routerLinkActive="active" (click)="closeSidebarOnMobile()">
          <i class="fas fa-users"></i>
          Subscriptions
        </a>
      </li>
      <li>
        <a class="menu-item" routerLink="/starred" routerLinkActive="active" (click)="closeSidebarOnMobile()">
          <i class="fas fa-star"></i>
          Starred
        </a>
      </li>
      <li>
        <a class="menu-item" routerLink="/watch-later" routerLinkActive="active" (click)="closeSidebarOnMobile()">
          <i class="fas fa-clock"></i>
          Watch Later
        </a>
      </li>
    </ul>

    <div class="sidebar-divider"></div>

    <ul class="sidebar-menu">
      <li>
        <a class="menu-item" routerLink="/settings" routerLinkActive="active" (click)="closeSidebarOnMobile()">
          <i class="fas fa-cog"></i>
          Settings
        </a>
      </li>
      <li>
        <a class="menu-item" routerLink="/manage" routerLinkActive="active" (click)="closeSidebarOnMobile()">
          <i class="fas fa-users-cog"></i>
          Manage
        </a>
      </li>
    </ul>

    <!-- Mini player (only when hidden) -->
    <div class="mini-player" *ngIf="currentVideo && displayMode === 'hidden'">
      <div class="mini-player-divider"></div>
      <div class="mini-player-content">
        <div class="mini-player-info">
          <div class="mini-player-title">{{ currentVideo.title }}</div>
          <div class="mini-player-channel" *ngIf="currentVideo.channel_name">{{ currentVideo.channel_name }}</div>
        </div>
        <div class="mini-player-controls">
          <button class="btn btn-sm mini-control-btn" (click)="togglePlayPause()" title="{{ isPlaying ? 'Pause' : 'Play' }}">
            <i class="fas" [class.fa-pause]="isPlaying" [class.fa-play]="!isPlaying"></i>
          </button>
          <button class="btn btn-sm mini-control-btn" (click)="showPlayer()" title="Show Player">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <main class="main-content" [class.expanded]="sidebarCollapsed">
    <router-outlet></router-outlet>
  </main>

  <app-floating-player-modal></app-floating-player-modal>

  <div class="toast-container">
    <div *ngFor="let toast of toasts"
         class="toast show mb-2"
         role="alert"
         [class.bg-success]="toast.type === 'success'"
         [class.bg-danger]="toast.type === 'error'"
         [class.bg-warning]="toast.type === 'warning'"
         [class.bg-info]="toast.type === 'info'">
      <div class="toast-header">
        <strong class="me-auto text-white">
          <i class="fas"
             [class.fa-check-circle]="toast.type === 'success'"
             [class.fa-exclamation-circle]="toast.type === 'error'"
             [class.fa-exclamation-triangle]="toast.type === 'warning'"
             [class.fa-info-circle]="toast.type === 'info'"></i>
          {{ toast.type | titlecase }}
        </strong>
        <button type="button" class="btn-close btn-close-white" (click)="removeToast(toast.id)"></button>
      </div>
      <div class="toast-body text-white">{{ toast.message }}</div>
    </div>
  </div>
</div>
